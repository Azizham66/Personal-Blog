(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function qT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Cg={exports:{}},Cl={};var Nv;function zI(){if(Nv)return Cl;Nv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var a=null;if(o!==void 0&&(a=""+o),s.key!==void 0&&(a=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:a,ref:s!==void 0?s:null,props:o}}return Cl.Fragment=e,Cl.jsx=t,Cl.jsxs=t,Cl}var Lv;function UI(){return Lv||(Lv=1,Cg.exports=zI()),Cg.exports}var O=UI(),kg={exports:{}},_e={};var Dv;function HI(){if(Dv)return _e;Dv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),w=Symbol.iterator;function _(I){return I===null||typeof I!="object"?null:(I=w&&I[w]||I["@@iterator"],typeof I=="function"?I:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function A(I,$,te){this.props=I,this.context=$,this.refs=T,this.updater=te||v}A.prototype.isReactComponent={},A.prototype.setState=function(I,$){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,$,"setState")},A.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function L(){}L.prototype=A.prototype;function z(I,$,te){this.props=I,this.context=$,this.refs=T,this.updater=te||v}var j=z.prototype=new L;j.constructor=z,C(j,A.prototype),j.isPureReactComponent=!0;var Z=Array.isArray;function ne(){}var M={H:null,A:null,T:null,S:null},J=Object.prototype.hasOwnProperty;function Y(I,$,te){var ae=te.ref;return{$$typeof:i,type:I,key:$,ref:ae!==void 0?ae:null,props:te}}function ie(I,$){return Y(I.type,$,I.props)}function Ee(I){return typeof I=="object"&&I!==null&&I.$$typeof===i}function Ve(I){var $={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(te){return $[te]})}var ot=/\/+/g;function rt(I,$){return typeof I=="object"&&I!==null&&I.key!=null?Ve(""+I.key):$.toString(36)}function Ne(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(ne,ne):(I.status="pending",I.then(function($){I.status==="pending"&&(I.status="fulfilled",I.value=$)},function($){I.status==="pending"&&(I.status="rejected",I.reason=$)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function H(I,$,te,ae,be){var ye=typeof I;(ye==="undefined"||ye==="boolean")&&(I=null);var Re=!1;if(I===null)Re=!0;else switch(ye){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(I.$$typeof){case i:case e:Re=!0;break;case m:return Re=I._init,H(Re(I._payload),$,te,ae,be)}}if(Re)return be=be(I),Re=ae===""?"."+rt(I,0):ae,Z(be)?(te="",Re!=null&&(te=Re.replace(ot,"$&/")+"/"),H(be,$,te,"",function(jn){return jn})):be!=null&&(Ee(be)&&(be=ie(be,te+(be.key==null||I&&I.key===be.key?"":(""+be.key).replace(ot,"$&/")+"/")+Re)),$.push(be)),1;Re=0;var kt=ae===""?".":ae+":";if(Z(I))for(var We=0;We<I.length;We++)ae=I[We],ye=kt+rt(ae,We),Re+=H(ae,$,te,ye,be);else if(We=_(I),typeof We=="function")for(I=We.call(I),We=0;!(ae=I.next()).done;)ae=ae.value,ye=kt+rt(ae,We++),Re+=H(ae,$,te,ye,be);else if(ye==="object"){if(typeof I.then=="function")return H(Ne(I),$,te,ae,be);throw $=String(I),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return Re}function X(I,$,te){if(I==null)return I;var ae=[],be=0;return H(I,ae,"","",function(ye){return $.call(te,ye,be++)}),ae}function de(I){if(I._status===-1){var $=I._result;$=$(),$.then(function(te){(I._status===0||I._status===-1)&&(I._status=1,I._result=te)},function(te){(I._status===0||I._status===-1)&&(I._status=2,I._result=te)}),I._status===-1&&(I._status=0,I._result=$)}if(I._status===1)return I._result.default;throw I._result}var Te=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},we={map:X,forEach:function(I,$,te){X(I,function(){$.apply(this,arguments)},te)},count:function(I){var $=0;return X(I,function(){$++}),$},toArray:function(I){return X(I,function($){return $})||[]},only:function(I){if(!Ee(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return _e.Activity=g,_e.Children=we,_e.Component=A,_e.Fragment=t,_e.Profiler=s,_e.PureComponent=z,_e.StrictMode=n,_e.Suspense=u,_e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,_e.__COMPILER_RUNTIME={__proto__:null,c:function(I){return M.H.useMemoCache(I)}},_e.cache=function(I){return function(){return I.apply(null,arguments)}},_e.cacheSignal=function(){return null},_e.cloneElement=function(I,$,te){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var ae=C({},I.props),be=I.key;if($!=null)for(ye in $.key!==void 0&&(be=""+$.key),$)!J.call($,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&$.ref===void 0||(ae[ye]=$[ye]);var ye=arguments.length-2;if(ye===1)ae.children=te;else if(1<ye){for(var Re=Array(ye),kt=0;kt<ye;kt++)Re[kt]=arguments[kt+2];ae.children=Re}return Y(I.type,be,ae)},_e.createContext=function(I){return I={$$typeof:a,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:o,_context:I},I},_e.createElement=function(I,$,te){var ae,be={},ye=null;if($!=null)for(ae in $.key!==void 0&&(ye=""+$.key),$)J.call($,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(be[ae]=$[ae]);var Re=arguments.length-2;if(Re===1)be.children=te;else if(1<Re){for(var kt=Array(Re),We=0;We<Re;We++)kt[We]=arguments[We+2];be.children=kt}if(I&&I.defaultProps)for(ae in Re=I.defaultProps,Re)be[ae]===void 0&&(be[ae]=Re[ae]);return Y(I,ye,be)},_e.createRef=function(){return{current:null}},_e.forwardRef=function(I){return{$$typeof:c,render:I}},_e.isValidElement=Ee,_e.lazy=function(I){return{$$typeof:m,_payload:{_status:-1,_result:I},_init:de}},_e.memo=function(I,$){return{$$typeof:h,type:I,compare:$===void 0?null:$}},_e.startTransition=function(I){var $=M.T,te={};M.T=te;try{var ae=I(),be=M.S;be!==null&&be(te,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(ne,Te)}catch(ye){Te(ye)}finally{$!==null&&te.types!==null&&($.types=te.types),M.T=$}},_e.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},_e.use=function(I){return M.H.use(I)},_e.useActionState=function(I,$,te){return M.H.useActionState(I,$,te)},_e.useCallback=function(I,$){return M.H.useCallback(I,$)},_e.useContext=function(I){return M.H.useContext(I)},_e.useDebugValue=function(){},_e.useDeferredValue=function(I,$){return M.H.useDeferredValue(I,$)},_e.useEffect=function(I,$){return M.H.useEffect(I,$)},_e.useEffectEvent=function(I){return M.H.useEffectEvent(I)},_e.useId=function(){return M.H.useId()},_e.useImperativeHandle=function(I,$,te){return M.H.useImperativeHandle(I,$,te)},_e.useInsertionEffect=function(I,$){return M.H.useInsertionEffect(I,$)},_e.useLayoutEffect=function(I,$){return M.H.useLayoutEffect(I,$)},_e.useMemo=function(I,$){return M.H.useMemo(I,$)},_e.useOptimistic=function(I,$){return M.H.useOptimistic(I,$)},_e.useReducer=function(I,$,te){return M.H.useReducer(I,$,te)},_e.useRef=function(I){return M.H.useRef(I)},_e.useState=function(I){return M.H.useState(I)},_e.useSyncExternalStore=function(I,$,te){return M.H.useSyncExternalStore(I,$,te)},_e.useTransition=function(){return M.H.useTransition()},_e.version="19.2.4",_e}var Fv;function Eh(){return Fv||(Fv=1,kg.exports=HI()),kg.exports}var P=Eh();const Wo=qT(P);var Tg={exports:{}},kl={},Eg={exports:{}},Sg={};var zv;function jI(){return zv||(zv=1,(function(i){function e(H,X){var de=H.length;H.push(X);e:for(;0<de;){var Te=de-1>>>1,we=H[Te];if(0<s(we,X))H[Te]=X,H[de]=we,de=Te;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var X=H[0],de=H.pop();if(de!==X){H[0]=de;e:for(var Te=0,we=H.length,I=we>>>1;Te<I;){var $=2*(Te+1)-1,te=H[$],ae=$+1,be=H[ae];if(0>s(te,de))ae<we&&0>s(be,te)?(H[Te]=be,H[ae]=de,Te=ae):(H[Te]=te,H[$]=de,Te=$);else if(ae<we&&0>s(be,de))H[Te]=be,H[ae]=de,Te=ae;else break e}}return X}function s(H,X){var de=H.sortIndex-X.sortIndex;return de!==0?de:H.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();i.unstable_now=function(){return a.now()-c}}var u=[],h=[],m=1,g=null,w=3,_=!1,v=!1,C=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function j(H){for(var X=t(h);X!==null;){if(X.callback===null)n(h);else if(X.startTime<=H)n(h),X.sortIndex=X.expirationTime,e(u,X);else break;X=t(h)}}function Z(H){if(C=!1,j(H),!v)if(t(u)!==null)v=!0,ne||(ne=!0,Ve());else{var X=t(h);X!==null&&Ne(Z,X.startTime-H)}}var ne=!1,M=-1,J=5,Y=-1;function ie(){return T?!0:!(i.unstable_now()-Y<J)}function Ee(){if(T=!1,ne){var H=i.unstable_now();Y=H;var X=!0;try{e:{v=!1,C&&(C=!1,L(M),M=-1),_=!0;var de=w;try{t:{for(j(H),g=t(u);g!==null&&!(g.expirationTime>H&&ie());){var Te=g.callback;if(typeof Te=="function"){g.callback=null,w=g.priorityLevel;var we=Te(g.expirationTime<=H);if(H=i.unstable_now(),typeof we=="function"){g.callback=we,j(H),X=!0;break t}g===t(u)&&n(u),j(H)}else n(u);g=t(u)}if(g!==null)X=!0;else{var I=t(h);I!==null&&Ne(Z,I.startTime-H),X=!1}}break e}finally{g=null,w=de,_=!1}X=void 0}}finally{X?Ve():ne=!1}}}var Ve;if(typeof z=="function")Ve=function(){z(Ee)};else if(typeof MessageChannel<"u"){var ot=new MessageChannel,rt=ot.port2;ot.port1.onmessage=Ee,Ve=function(){rt.postMessage(null)}}else Ve=function(){A(Ee,0)};function Ne(H,X){M=A(function(){H(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(H){H.callback=null},i.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<H?Math.floor(1e3/H):5},i.unstable_getCurrentPriorityLevel=function(){return w},i.unstable_next=function(H){switch(w){case 1:case 2:case 3:var X=3;break;default:X=w}var de=w;w=X;try{return H()}finally{w=de}},i.unstable_requestPaint=function(){T=!0},i.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var de=w;w=H;try{return X()}finally{w=de}},i.unstable_scheduleCallback=function(H,X,de){var Te=i.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Te+de:Te):de=Te,H){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=de+we,H={id:m++,callback:X,priorityLevel:H,startTime:de,expirationTime:we,sortIndex:-1},de>Te?(H.sortIndex=de,e(h,H),t(u)===null&&H===t(h)&&(C?(L(M),M=-1):C=!0,Ne(Z,de-Te))):(H.sortIndex=we,e(u,H),v||_||(v=!0,ne||(ne=!0,Ve()))),H},i.unstable_shouldYield=ie,i.unstable_wrapCallback=function(H){var X=w;return function(){var de=w;w=X;try{return H.apply(this,arguments)}finally{w=de}}}})(Sg)),Sg}var Uv;function qI(){return Uv||(Uv=1,Eg.exports=jI()),Eg.exports}var Ag={exports:{}},Yt={};var Hv;function WI(){if(Hv)return Yt;Hv=1;var i=Eh();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(u,h,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:u,containerInfo:h,implementation:m}}var a=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Yt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Yt.createPortal=function(u,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return o(u,h,null,m)},Yt.flushSync=function(u){var h=a.T,m=n.p;try{if(a.T=null,n.p=2,u)return u()}finally{a.T=h,n.p=m,n.d.f()}},Yt.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(u,h))},Yt.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},Yt.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var m=h.as,g=c(m,h.crossOrigin),w=typeof h.integrity=="string"?h.integrity:void 0,_=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?n.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:w,fetchPriority:_}):m==="script"&&n.d.X(u,{crossOrigin:g,integrity:w,fetchPriority:_,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Yt.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=c(h.as,h.crossOrigin);n.d.M(u,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(u)},Yt.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,g=c(m,h.crossOrigin);n.d.L(u,m,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Yt.preloadModule=function(u,h){if(typeof u=="string")if(h){var m=c(h.as,h.crossOrigin);n.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(u)},Yt.requestFormReset=function(u){n.d.r(u)},Yt.unstable_batchedUpdates=function(u,h){return u(h)},Yt.useFormState=function(u,h,m){return a.H.useFormState(u,h,m)},Yt.useFormStatus=function(){return a.H.useHostTransitionStatus()},Yt.version="19.2.4",Yt}var jv;function $I(){if(jv)return Ag.exports;jv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ag.exports=WI(),Ag.exports}var qv;function GI(){if(qv)return kl;qv=1;var i=qI(),e=Eh(),t=$I();function n(r){var l="https://react.dev/errors/"+r;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var l=r,d=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,(l.flags&4098)!==0&&(d=l.return),r=l.return;while(r)}return l.tag===3?d:null}function a(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function c(r){if(r.tag===31){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function u(r){if(o(r)!==r)throw Error(n(188))}function h(r){var l=r.alternate;if(!l){if(l=o(r),l===null)throw Error(n(188));return l!==r?null:r}for(var d=r,f=l;;){var p=d.return;if(p===null)break;var b=p.alternate;if(b===null){if(f=p.return,f!==null){d=f;continue}break}if(p.child===b.child){for(b=p.child;b;){if(b===d)return u(p),r;if(b===f)return u(p),l;b=b.sibling}throw Error(n(188))}if(d.return!==f.return)d=p,f=b;else{for(var y=!1,k=p.child;k;){if(k===d){y=!0,d=p,f=b;break}if(k===f){y=!0,f=p,d=b;break}k=k.sibling}if(!y){for(k=b.child;k;){if(k===d){y=!0,d=b,f=p;break}if(k===f){y=!0,f=b,d=p;break}k=k.sibling}if(!y)throw Error(n(189))}}if(d.alternate!==f)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:l}function m(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r;for(r=r.child;r!==null;){if(l=m(r),l!==null)return l;r=r.sibling}return null}var g=Object.assign,w=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),L=Symbol.for("react.consumer"),z=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),Ee=Symbol.iterator;function Ve(r){return r===null||typeof r!="object"?null:(r=Ee&&r[Ee]||r["@@iterator"],typeof r=="function"?r:null)}var ot=Symbol.for("react.client.reference");function rt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ot?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case Z:return"Suspense";case ne:return"SuspenseList";case Y:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case v:return"Portal";case z:return r.displayName||"Context";case L:return(r._context.displayName||"Context")+".Consumer";case j:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case M:return l=r.displayName||null,l!==null?l:rt(r.type)||"Memo";case J:l=r._payload,r=r._init;try{return rt(r(l))}catch{}}return null}var Ne=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},Te=[],we=-1;function I(r){return{current:r}}function $(r){0>we||(r.current=Te[we],Te[we]=null,we--)}function te(r,l){we++,Te[we]=r.current,r.current=l}var ae=I(null),be=I(null),ye=I(null),Re=I(null);function kt(r,l){switch(te(ye,l),te(be,r),te(ae,null),l.nodeType){case 9:case 11:r=(r=l.documentElement)&&(r=r.namespaceURI)?ov(r):0;break;default:if(r=l.tagName,l=l.namespaceURI)l=ov(l),r=rv(l,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}$(ae),te(ae,r)}function We(){$(ae),$(be),$(ye)}function jn(r){r.memoizedState!==null&&te(Re,r);var l=ae.current,d=rv(l,r.type);l!==d&&(te(be,r),te(ae,d))}function qi(r){be.current===r&&($(ae),$(be)),Re.current===r&&($(Re),wl._currentValue=de)}var Kt,Uc;function go(r){if(Kt===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);Kt=l&&l[1]||"",Uc=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kt+r+Uc}var of=!1;function rf(r,l){if(!r||of)return"";of=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(U){var D=U}Reflect.construct(r,[],G)}else{try{G.call()}catch(U){D=U}r.call(G.prototype)}}else{try{throw Error()}catch(U){D=U}(G=r())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(U){if(U&&D&&typeof U.stack=="string")return[U.stack,D.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),y=b[0],k=b[1];if(y&&k){var S=y.split(`
`),B=k.split(`
`);for(p=f=0;f<S.length&&!S[f].includes("DetermineComponentFrameRoot");)f++;for(;p<B.length&&!B[p].includes("DetermineComponentFrameRoot");)p++;if(f===S.length||p===B.length)for(f=S.length-1,p=B.length-1;1<=f&&0<=p&&S[f]!==B[p];)p--;for(;1<=f&&0<=p;f--,p--)if(S[f]!==B[p]){if(f!==1||p!==1)do if(f--,p--,0>p||S[f]!==B[p]){var q=`
`+S[f].replace(" at new "," at ");return r.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",r.displayName)),q}while(1<=f&&0<=p);break}}}finally{of=!1,Error.prepareStackTrace=d}return(d=r?r.displayName||r.name:"")?go(d):""}function bx(r,l){switch(r.tag){case 26:case 27:case 5:return go(r.type);case 16:return go("Lazy");case 13:return r.child!==l&&l!==null?go("Suspense Fallback"):go("Suspense");case 19:return go("SuspenseList");case 0:case 15:return rf(r.type,!1);case 11:return rf(r.type.render,!1);case 1:return rf(r.type,!0);case 31:return go("Activity");default:return""}}function Nw(r){try{var l="",d=null;do l+=bx(r,d),d=r,r=r.return;while(r);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var af=Object.prototype.hasOwnProperty,lf=i.unstable_scheduleCallback,cf=i.unstable_cancelCallback,wx=i.unstable_shouldYield,_x=i.unstable_requestPaint,Tn=i.unstable_now,yx=i.unstable_getCurrentPriorityLevel,Lw=i.unstable_ImmediatePriority,Dw=i.unstable_UserBlockingPriority,Hc=i.unstable_NormalPriority,vx=i.unstable_LowPriority,Fw=i.unstable_IdlePriority,Cx=i.log,kx=i.unstable_setDisableYieldValue,Pa=null,En=null;function Rs(r){if(typeof Cx=="function"&&kx(r),En&&typeof En.setStrictMode=="function")try{En.setStrictMode(Pa,r)}catch{}}var Sn=Math.clz32?Math.clz32:Sx,Tx=Math.log,Ex=Math.LN2;function Sx(r){return r>>>=0,r===0?32:31-(Tx(r)/Ex|0)|0}var jc=256,qc=262144,Wc=4194304;function po(r){var l=r&42;if(l!==0)return l;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function $c(r,l,d){var f=r.pendingLanes;if(f===0)return 0;var p=0,b=r.suspendedLanes,y=r.pingedLanes;r=r.warmLanes;var k=f&134217727;return k!==0?(f=k&~b,f!==0?p=po(f):(y&=k,y!==0?p=po(y):d||(d=k&~r,d!==0&&(p=po(d))))):(k=f&~b,k!==0?p=po(k):y!==0?p=po(y):d||(d=f&~r,d!==0&&(p=po(d)))),p===0?0:l!==0&&l!==p&&(l&b)===0&&(b=p&-p,d=l&-l,b>=d||b===32&&(d&4194048)!==0)?l:p}function Ra(r,l){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&l)===0}function Ax(r,l){switch(r){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zw(){var r=Wc;return Wc<<=1,(Wc&62914560)===0&&(Wc=4194304),r}function uf(r){for(var l=[],d=0;31>d;d++)l.push(r);return l}function Oa(r,l){r.pendingLanes|=l,l!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function xx(r,l,d,f,p,b){var y=r.pendingLanes;r.pendingLanes=d,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=d,r.entangledLanes&=d,r.errorRecoveryDisabledLanes&=d,r.shellSuspendCounter=0;var k=r.entanglements,S=r.expirationTimes,B=r.hiddenUpdates;for(d=y&~d;0<d;){var q=31-Sn(d),G=1<<q;k[q]=0,S[q]=-1;var D=B[q];if(D!==null)for(B[q]=null,q=0;q<D.length;q++){var U=D[q];U!==null&&(U.lane&=-536870913)}d&=~G}f!==0&&Uw(r,f,0),b!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=b&~(y&~l))}function Uw(r,l,d){r.pendingLanes|=l,r.suspendedLanes&=~l;var f=31-Sn(l);r.entangledLanes|=l,r.entanglements[f]=r.entanglements[f]|1073741824|d&261930}function Hw(r,l){var d=r.entangledLanes|=l;for(r=r.entanglements;d;){var f=31-Sn(d),p=1<<f;p&l|r[f]&l&&(r[f]|=l),d&=~p}}function jw(r,l){var d=l&-l;return d=(d&42)!==0?1:df(d),(d&(r.suspendedLanes|l))!==0?0:d}function df(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function hf(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function qw(){var r=X.p;return r!==0?r:(r=window.event,r===void 0?32:Iv(r.type))}function Ww(r,l){var d=X.p;try{return X.p=r,l()}finally{X.p=d}}var Os=Math.random().toString(36).slice(2),Ft="__reactFiber$"+Os,ln="__reactProps$"+Os,fr="__reactContainer$"+Os,ff="__reactEvents$"+Os,Ix="__reactListeners$"+Os,Px="__reactHandles$"+Os,$w="__reactResources$"+Os,Va="__reactMarker$"+Os;function mf(r){delete r[Ft],delete r[ln],delete r[ff],delete r[Ix],delete r[Px]}function mr(r){var l=r[Ft];if(l)return l;for(var d=r.parentNode;d;){if(l=d[fr]||d[Ft]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(r=fv(r);r!==null;){if(d=r[Ft])return d;r=fv(r)}return l}r=d,d=r.parentNode}return null}function gr(r){if(r=r[Ft]||r[fr]){var l=r.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return r}return null}function Ba(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r.stateNode;throw Error(n(33))}function pr(r){var l=r[$w];return l||(l=r[$w]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Bt(r){r[Va]=!0}var Gw=new Set,Kw={};function bo(r,l){br(r,l),br(r+"Capture",l)}function br(r,l){for(Kw[r]=l,r=0;r<l.length;r++)Gw.add(l[r])}var Rx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Yw={},Jw={};function Ox(r){return af.call(Jw,r)?!0:af.call(Yw,r)?!1:Rx.test(r)?Jw[r]=!0:(Yw[r]=!0,!1)}function Gc(r,l,d){if(Ox(l))if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":r.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(l);return}}r.setAttribute(l,""+d)}}function Kc(r,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttribute(l,""+d)}}function Wi(r,l,d,f){if(f===null)r.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(d);return}r.setAttributeNS(l,d,""+f)}}function qn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Qw(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Vx(r,l,d){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,l);if(!r.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var p=f.get,b=f.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return p.call(this)},set:function(y){d=""+y,b.call(this,y)}}),Object.defineProperty(r,l,{enumerable:f.enumerable}),{getValue:function(){return d},setValue:function(y){d=""+y},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function gf(r){if(!r._valueTracker){var l=Qw(r)?"checked":"value";r._valueTracker=Vx(r,l,""+r[l])}}function Xw(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var d=l.getValue(),f="";return r&&(f=Qw(r)?r.checked?"true":"false":r.value),r=f,r!==d?(l.setValue(r),!0):!1}function Yc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Bx=/[\n"\\]/g;function Wn(r){return r.replace(Bx,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function pf(r,l,d,f,p,b,y,k){r.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?r.type=y:r.removeAttribute("type"),l!=null?y==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+qn(l)):r.value!==""+qn(l)&&(r.value=""+qn(l)):y!=="submit"&&y!=="reset"||r.removeAttribute("value"),l!=null?bf(r,y,qn(l)):d!=null?bf(r,y,qn(d)):f!=null&&r.removeAttribute("value"),p==null&&b!=null&&(r.defaultChecked=!!b),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+qn(k):r.removeAttribute("name")}function Zw(r,l,d,f,p,b,y,k){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),l!=null||d!=null){if(!(b!=="submit"&&b!=="reset"||l!=null)){gf(r);return}d=d!=null?""+qn(d):"",l=l!=null?""+qn(l):d,k||l===r.value||(r.value=l),r.defaultValue=l}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=k?r.checked:!!f,r.defaultChecked=!!f,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.name=y),gf(r)}function bf(r,l,d){l==="number"&&Yc(r.ownerDocument)===r||r.defaultValue===""+d||(r.defaultValue=""+d)}function wr(r,l,d,f){if(r=r.options,l){l={};for(var p=0;p<d.length;p++)l["$"+d[p]]=!0;for(d=0;d<r.length;d++)p=l.hasOwnProperty("$"+r[d].value),r[d].selected!==p&&(r[d].selected=p),p&&f&&(r[d].defaultSelected=!0)}else{for(d=""+qn(d),l=null,p=0;p<r.length;p++){if(r[p].value===d){r[p].selected=!0,f&&(r[p].defaultSelected=!0);return}l!==null||r[p].disabled||(l=r[p])}l!==null&&(l.selected=!0)}}function e_(r,l,d){if(l!=null&&(l=""+qn(l),l!==r.value&&(r.value=l),d==null)){r.defaultValue!==l&&(r.defaultValue=l);return}r.defaultValue=d!=null?""+qn(d):""}function t_(r,l,d,f){if(l==null){if(f!=null){if(d!=null)throw Error(n(92));if(Ne(f)){if(1<f.length)throw Error(n(93));f=f[0]}d=f}d==null&&(d=""),l=d}d=qn(l),r.defaultValue=d,f=r.textContent,f===d&&f!==""&&f!==null&&(r.value=f),gf(r)}function _r(r,l){if(l){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=l;return}}r.textContent=l}var Mx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function n_(r,l,d){var f=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?f?r.setProperty(l,""):l==="float"?r.cssFloat="":r[l]="":f?r.setProperty(l,d):typeof d!="number"||d===0||Mx.has(l)?l==="float"?r.cssFloat=d:r[l]=(""+d).trim():r[l]=d+"px"}function i_(r,l,d){if(l!=null&&typeof l!="object")throw Error(n(62));if(r=r.style,d!=null){for(var f in d)!d.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var p in l)f=l[p],l.hasOwnProperty(p)&&d[p]!==f&&n_(r,p,f)}else for(var b in l)l.hasOwnProperty(b)&&n_(r,b,l[b])}function wf(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jc(r){return Lx.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function $i(){}var _f=null;function yf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var yr=null,vr=null;function s_(r){var l=gr(r);if(l&&(r=l.stateNode)){var d=r[ln]||null;e:switch(r=l.stateNode,l.type){case"input":if(pf(r,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Wn(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var f=d[l];if(f!==r&&f.form===r.form){var p=f[ln]||null;if(!p)throw Error(n(90));pf(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(l=0;l<d.length;l++)f=d[l],f.form===r.form&&Xw(f)}break e;case"textarea":e_(r,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&wr(r,!!d.multiple,l,!1)}}}var vf=!1;function o_(r,l,d){if(vf)return r(l,d);vf=!0;try{var f=r(l);return f}finally{if(vf=!1,(yr!==null||vr!==null)&&(Lu(),yr&&(l=yr,r=vr,vr=yr=null,s_(l),r)))for(l=0;l<r.length;l++)s_(r[l])}}function Ma(r,l){var d=r.stateNode;if(d===null)return null;var f=d[ln]||null;if(f===null)return null;d=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,l,typeof d));return d}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cf=!1;if(Gi)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{Cf=!1}var Vs=null,kf=null,Qc=null;function r_(){if(Qc)return Qc;var r,l=kf,d=l.length,f,p="value"in Vs?Vs.value:Vs.textContent,b=p.length;for(r=0;r<d&&l[r]===p[r];r++);var y=d-r;for(f=1;f<=y&&l[d-f]===p[b-f];f++);return Qc=p.slice(r,1<f?1-f:void 0)}function Xc(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function Zc(){return!0}function a_(){return!1}function cn(r){function l(d,f,p,b,y){this._reactName=d,this._targetInst=p,this.type=f,this.nativeEvent=b,this.target=y,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(d=r[k],this[k]=d?d(b):b[k]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Zc:a_,this.isPropagationStopped=a_,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Zc)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Zc)},persist:function(){},isPersistent:Zc}),l}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eu=cn(wo),La=g({},wo,{view:0,detail:0}),Dx=cn(La),Tf,Ef,Da,tu=g({},La,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Af,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Da&&(Da&&r.type==="mousemove"?(Tf=r.screenX-Da.screenX,Ef=r.screenY-Da.screenY):Ef=Tf=0,Da=r),Tf)},movementY:function(r){return"movementY"in r?r.movementY:Ef}}),l_=cn(tu),Fx=g({},tu,{dataTransfer:0}),zx=cn(Fx),Ux=g({},La,{relatedTarget:0}),Sf=cn(Ux),Hx=g({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),jx=cn(Hx),qx=g({},wo,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Wx=cn(qx),$x=g({},wo,{data:0}),c_=cn($x),Gx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jx(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=Yx[r])?!!l[r]:!1}function Af(){return Jx}var Qx=g({},La,{key:function(r){if(r.key){var l=Gx[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=Xc(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Kx[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Af,charCode:function(r){return r.type==="keypress"?Xc(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Xc(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Xx=cn(Qx),Zx=g({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u_=cn(Zx),e5=g({},La,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Af}),t5=cn(e5),n5=g({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),i5=cn(n5),s5=g({},tu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),o5=cn(s5),r5=g({},wo,{newState:0,oldState:0}),a5=cn(r5),l5=[9,13,27,32],xf=Gi&&"CompositionEvent"in window,Fa=null;Gi&&"documentMode"in document&&(Fa=document.documentMode);var c5=Gi&&"TextEvent"in window&&!Fa,d_=Gi&&(!xf||Fa&&8<Fa&&11>=Fa),h_=" ",f_=!1;function m_(r,l){switch(r){case"keyup":return l5.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g_(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Cr=!1;function u5(r,l){switch(r){case"compositionend":return g_(l);case"keypress":return l.which!==32?null:(f_=!0,h_);case"textInput":return r=l.data,r===h_&&f_?null:r;default:return null}}function d5(r,l){if(Cr)return r==="compositionend"||!xf&&m_(r,l)?(r=r_(),Qc=kf=Vs=null,Cr=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return d_&&l.locale!=="ko"?null:l.data;default:return null}}var h5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p_(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!h5[r.type]:l==="textarea"}function b_(r,l,d,f){yr?vr?vr.push(f):vr=[f]:yr=f,l=qu(l,"onChange"),0<l.length&&(d=new eu("onChange","change",null,d,f),r.push({event:d,listeners:l}))}var za=null,Ua=null;function f5(r){Zy(r,0)}function nu(r){var l=Ba(r);if(Xw(l))return r}function w_(r,l){if(r==="change")return l}var __=!1;if(Gi){var If;if(Gi){var Pf="oninput"in document;if(!Pf){var y_=document.createElement("div");y_.setAttribute("oninput","return;"),Pf=typeof y_.oninput=="function"}If=Pf}else If=!1;__=If&&(!document.documentMode||9<document.documentMode)}function v_(){za&&(za.detachEvent("onpropertychange",C_),Ua=za=null)}function C_(r){if(r.propertyName==="value"&&nu(Ua)){var l=[];b_(l,Ua,r,yf(r)),o_(f5,l)}}function m5(r,l,d){r==="focusin"?(v_(),za=l,Ua=d,za.attachEvent("onpropertychange",C_)):r==="focusout"&&v_()}function g5(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return nu(Ua)}function p5(r,l){if(r==="click")return nu(l)}function b5(r,l){if(r==="input"||r==="change")return nu(l)}function w5(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var An=typeof Object.is=="function"?Object.is:w5;function Ha(r,l){if(An(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var d=Object.keys(r),f=Object.keys(l);if(d.length!==f.length)return!1;for(f=0;f<d.length;f++){var p=d[f];if(!af.call(l,p)||!An(r[p],l[p]))return!1}return!0}function k_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function T_(r,l){var d=k_(r);r=0;for(var f;d;){if(d.nodeType===3){if(f=r+d.textContent.length,r<=l&&f>=l)return{node:d,offset:l-r};r=f}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=k_(d)}}function E_(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?E_(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function S_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var l=Yc(r.document);l instanceof r.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)r=l.contentWindow;else break;l=Yc(r.document)}return l}function Rf(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}var _5=Gi&&"documentMode"in document&&11>=document.documentMode,kr=null,Of=null,ja=null,Vf=!1;function A_(r,l,d){var f=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Vf||kr==null||kr!==Yc(f)||(f=kr,"selectionStart"in f&&Rf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ja&&Ha(ja,f)||(ja=f,f=qu(Of,"onSelect"),0<f.length&&(l=new eu("onSelect","select",null,l,d),r.push({event:l,listeners:f}),l.target=kr)))}function _o(r,l){var d={};return d[r.toLowerCase()]=l.toLowerCase(),d["Webkit"+r]="webkit"+l,d["Moz"+r]="moz"+l,d}var Tr={animationend:_o("Animation","AnimationEnd"),animationiteration:_o("Animation","AnimationIteration"),animationstart:_o("Animation","AnimationStart"),transitionrun:_o("Transition","TransitionRun"),transitionstart:_o("Transition","TransitionStart"),transitioncancel:_o("Transition","TransitionCancel"),transitionend:_o("Transition","TransitionEnd")},Bf={},x_={};Gi&&(x_=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);function yo(r){if(Bf[r])return Bf[r];if(!Tr[r])return r;var l=Tr[r],d;for(d in l)if(l.hasOwnProperty(d)&&d in x_)return Bf[r]=l[d];return r}var I_=yo("animationend"),P_=yo("animationiteration"),R_=yo("animationstart"),y5=yo("transitionrun"),v5=yo("transitionstart"),C5=yo("transitioncancel"),O_=yo("transitionend"),V_=new Map,Mf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mf.push("scrollEnd");function li(r,l){V_.set(r,l),bo(l,[r])}var iu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},$n=[],Er=0,Nf=0;function su(){for(var r=Er,l=Nf=Er=0;l<r;){var d=$n[l];$n[l++]=null;var f=$n[l];$n[l++]=null;var p=$n[l];$n[l++]=null;var b=$n[l];if($n[l++]=null,f!==null&&p!==null){var y=f.pending;y===null?p.next=p:(p.next=y.next,y.next=p),f.pending=p}b!==0&&B_(d,p,b)}}function ou(r,l,d,f){$n[Er++]=r,$n[Er++]=l,$n[Er++]=d,$n[Er++]=f,Nf|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Lf(r,l,d,f){return ou(r,l,d,f),ru(r)}function vo(r,l){return ou(r,null,null,l),ru(r)}function B_(r,l,d){r.lanes|=d;var f=r.alternate;f!==null&&(f.lanes|=d);for(var p=!1,b=r.return;b!==null;)b.childLanes|=d,f=b.alternate,f!==null&&(f.childLanes|=d),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(p=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,p&&l!==null&&(p=31-Sn(d),r=b.hiddenUpdates,f=r[p],f===null?r[p]=[l]:f.push(l),l.lane=d|536870912),b):null}function ru(r){if(50<dl)throw dl=0,$m=null,Error(n(185));for(var l=r.return;l!==null;)r=l,l=r.return;return r.tag===3?r.stateNode:null}var Sr={};function k5(r,l,d,f){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(r,l,d,f){return new k5(r,l,d,f)}function Df(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ki(r,l){var d=r.alternate;return d===null?(d=xn(r.tag,l,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=l,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&65011712,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,l=r.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d.refCleanup=r.refCleanup,d}function M_(r,l){r.flags&=65011714;var d=r.alternate;return d===null?(r.childLanes=0,r.lanes=l,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=d.childLanes,r.lanes=d.lanes,r.child=d.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=d.memoizedProps,r.memoizedState=d.memoizedState,r.updateQueue=d.updateQueue,r.type=d.type,l=d.dependencies,r.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),r}function au(r,l,d,f,p,b){var y=0;if(f=r,typeof r=="function")Df(r)&&(y=1);else if(typeof r=="string")y=xI(r,d,ae.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case Y:return r=xn(31,d,l,p),r.elementType=Y,r.lanes=b,r;case C:return Co(d.children,p,b,l);case T:y=8,p|=24;break;case A:return r=xn(12,d,l,p|2),r.elementType=A,r.lanes=b,r;case Z:return r=xn(13,d,l,p),r.elementType=Z,r.lanes=b,r;case ne:return r=xn(19,d,l,p),r.elementType=ne,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case z:y=10;break e;case L:y=9;break e;case j:y=11;break e;case M:y=14;break e;case J:y=16,f=null;break e}y=29,d=Error(n(130,r===null?"null":typeof r,"")),f=null}return l=xn(y,d,l,p),l.elementType=r,l.type=f,l.lanes=b,l}function Co(r,l,d,f){return r=xn(7,r,f,l),r.lanes=d,r}function Ff(r,l,d){return r=xn(6,r,null,l),r.lanes=d,r}function N_(r){var l=xn(18,null,null,0);return l.stateNode=r,l}function zf(r,l,d){return l=xn(4,r.children!==null?r.children:[],r.key,l),l.lanes=d,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}var L_=new WeakMap;function Gn(r,l){if(typeof r=="object"&&r!==null){var d=L_.get(r);return d!==void 0?d:(l={value:r,source:l,stack:Nw(l)},L_.set(r,l),l)}return{value:r,source:l,stack:Nw(l)}}var Ar=[],xr=0,lu=null,qa=0,Kn=[],Yn=0,Bs=null,Ti=1,Ei="";function Yi(r,l){Ar[xr++]=qa,Ar[xr++]=lu,lu=r,qa=l}function D_(r,l,d){Kn[Yn++]=Ti,Kn[Yn++]=Ei,Kn[Yn++]=Bs,Bs=r;var f=Ti;r=Ei;var p=32-Sn(f)-1;f&=~(1<<p),d+=1;var b=32-Sn(l)+p;if(30<b){var y=p-p%5;b=(f&(1<<y)-1).toString(32),f>>=y,p-=y,Ti=1<<32-Sn(l)+p|d<<p|f,Ei=b+r}else Ti=1<<b|d<<p|f,Ei=r}function Uf(r){r.return!==null&&(Yi(r,1),D_(r,1,0))}function Hf(r){for(;r===lu;)lu=Ar[--xr],Ar[xr]=null,qa=Ar[--xr],Ar[xr]=null;for(;r===Bs;)Bs=Kn[--Yn],Kn[Yn]=null,Ei=Kn[--Yn],Kn[Yn]=null,Ti=Kn[--Yn],Kn[Yn]=null}function F_(r,l){Kn[Yn++]=Ti,Kn[Yn++]=Ei,Kn[Yn++]=Bs,Ti=l.id,Ei=l.overflow,Bs=r}var zt=null,nt=null,Oe=!1,Ms=null,Jn=!1,jf=Error(n(519));function Ns(r){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Wa(Gn(l,r)),jf}function z_(r){var l=r.stateNode,d=r.type,f=r.memoizedProps;switch(l[Ft]=r,l[ln]=f,d){case"dialog":Ae("cancel",l),Ae("close",l);break;case"iframe":case"object":case"embed":Ae("load",l);break;case"video":case"audio":for(d=0;d<fl.length;d++)Ae(fl[d],l);break;case"source":Ae("error",l);break;case"img":case"image":case"link":Ae("error",l),Ae("load",l);break;case"details":Ae("toggle",l);break;case"input":Ae("invalid",l),Zw(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ae("invalid",l);break;case"textarea":Ae("invalid",l),t_(l,f.value,f.defaultValue,f.children)}d=f.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||f.suppressHydrationWarning===!0||iv(l.textContent,d)?(f.popover!=null&&(Ae("beforetoggle",l),Ae("toggle",l)),f.onScroll!=null&&Ae("scroll",l),f.onScrollEnd!=null&&Ae("scrollend",l),f.onClick!=null&&(l.onclick=$i),l=!0):l=!1,l||Ns(r,!0)}function U_(r){for(zt=r.return;zt;)switch(zt.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:zt=zt.return}}function Ir(r){if(r!==zt)return!1;if(!Oe)return U_(r),Oe=!0,!1;var l=r.tag,d;if((d=l!==3&&l!==27)&&((d=l===5)&&(d=r.type,d=!(d!=="form"&&d!=="button")||ag(r.type,r.memoizedProps)),d=!d),d&&nt&&Ns(r),U_(r),l===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));nt=hv(r)}else if(l===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));nt=hv(r)}else l===27?(l=nt,Js(r.type)?(r=hg,hg=null,nt=r):nt=l):nt=zt?Xn(r.stateNode.nextSibling):null;return!0}function ko(){nt=zt=null,Oe=!1}function qf(){var r=Ms;return r!==null&&(fn===null?fn=r:fn.push.apply(fn,r),Ms=null),r}function Wa(r){Ms===null?Ms=[r]:Ms.push(r)}var Wf=I(null),To=null,Ji=null;function Ls(r,l,d){te(Wf,l._currentValue),l._currentValue=d}function Qi(r){r._currentValue=Wf.current,$(Wf)}function $f(r,l,d){for(;r!==null;){var f=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),r===d)break;r=r.return}}function Gf(r,l,d,f){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var b=p.dependencies;if(b!==null){var y=p.child;b=b.firstContext;e:for(;b!==null;){var k=b;b=p;for(var S=0;S<l.length;S++)if(k.context===l[S]){b.lanes|=d,k=b.alternate,k!==null&&(k.lanes|=d),$f(b.return,d,r),f||(y=null);break e}b=k.next}}else if(p.tag===18){if(y=p.return,y===null)throw Error(n(341));y.lanes|=d,b=y.alternate,b!==null&&(b.lanes|=d),$f(y,d,r),y=null}else y=p.child;if(y!==null)y.return=p;else for(y=p;y!==null;){if(y===r){y=null;break}if(p=y.sibling,p!==null){p.return=y.return,y=p;break}y=y.return}p=y}}function Pr(r,l,d,f){r=null;for(var p=l,b=!1;p!==null;){if(!b){if((p.flags&524288)!==0)b=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var y=p.alternate;if(y===null)throw Error(n(387));if(y=y.memoizedProps,y!==null){var k=p.type;An(p.pendingProps.value,y.value)||(r!==null?r.push(k):r=[k])}}else if(p===Re.current){if(y=p.alternate,y===null)throw Error(n(387));y.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(wl):r=[wl])}p=p.return}r!==null&&Gf(l,r,d,f),l.flags|=262144}function cu(r){for(r=r.firstContext;r!==null;){if(!An(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Eo(r){To=r,Ji=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Ut(r){return H_(To,r)}function uu(r,l){return To===null&&Eo(r),H_(r,l)}function H_(r,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},Ji===null){if(r===null)throw Error(n(308));Ji=l,r.dependencies={lanes:0,firstContext:l},r.flags|=524288}else Ji=Ji.next=l;return d}var T5=typeof AbortController<"u"?AbortController:function(){var r=[],l=this.signal={aborted:!1,addEventListener:function(d,f){r.push(f)}};this.abort=function(){l.aborted=!0,r.forEach(function(d){return d()})}},E5=i.unstable_scheduleCallback,S5=i.unstable_NormalPriority,Tt={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new T5,data:new Map,refCount:0}}function $a(r){r.refCount--,r.refCount===0&&E5(S5,function(){r.controller.abort()})}var Ga=null,Yf=0,Rr=0,Or=null;function A5(r,l){if(Ga===null){var d=Ga=[];Yf=0,Rr=Xm(),Or={status:"pending",value:void 0,then:function(f){d.push(f)}}}return Yf++,l.then(j_,j_),l}function j_(){if(--Yf===0&&Ga!==null){Or!==null&&(Or.status="fulfilled");var r=Ga;Ga=null,Rr=0,Or=null;for(var l=0;l<r.length;l++)(0,r[l])()}}function x5(r,l){var d=[],f={status:"pending",value:null,reason:null,then:function(p){d.push(p)}};return r.then(function(){f.status="fulfilled",f.value=l;for(var p=0;p<d.length;p++)(0,d[p])(l)},function(p){for(f.status="rejected",f.reason=p,p=0;p<d.length;p++)(0,d[p])(void 0)}),f}var q_=H.S;H.S=function(r,l){Ay=Tn(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&A5(r,l),q_!==null&&q_(r,l)};var So=I(null);function Jf(){var r=So.current;return r!==null?r:Qe.pooledCache}function du(r,l){l===null?te(So,So.current):te(So,l.pool)}function W_(){var r=Jf();return r===null?null:{parent:Tt._currentValue,pool:r}}var Vr=Error(n(460)),Qf=Error(n(474)),hu=Error(n(542)),fu={then:function(){}};function $_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function G_(r,l,d){switch(d=r[d],d===void 0?r.push(l):d!==l&&(l.then($i,$i),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Y_(r),r;default:if(typeof l.status=="string")l.then($i,$i);else{if(r=Qe,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=l,r.status="pending",r.then(function(f){if(l.status==="pending"){var p=l;p.status="fulfilled",p.value=f}},function(f){if(l.status==="pending"){var p=l;p.status="rejected",p.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,Y_(r),r}throw xo=l,Vr}}function Ao(r){try{var l=r._init;return l(r._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(xo=d,Vr):d}}var xo=null;function K_(){if(xo===null)throw Error(n(459));var r=xo;return xo=null,r}function Y_(r){if(r===Vr||r===hu)throw Error(n(483))}var Br=null,Ka=0;function mu(r){var l=Ka;return Ka+=1,Br===null&&(Br=[]),G_(Br,r,l)}function Ya(r,l){l=l.props.ref,r.ref=l!==void 0?l:null}function gu(r,l){throw l.$$typeof===w?Error(n(525)):(r=Object.prototype.toString.call(l),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r)))}function J_(r){function l(R,x){if(r){var V=R.deletions;V===null?(R.deletions=[x],R.flags|=16):V.push(x)}}function d(R,x){if(!r)return null;for(;x!==null;)l(R,x),x=x.sibling;return null}function f(R){for(var x=new Map;R!==null;)R.key!==null?x.set(R.key,R):x.set(R.index,R),R=R.sibling;return x}function p(R,x){return R=Ki(R,x),R.index=0,R.sibling=null,R}function b(R,x,V){return R.index=V,r?(V=R.alternate,V!==null?(V=V.index,V<x?(R.flags|=67108866,x):V):(R.flags|=67108866,x)):(R.flags|=1048576,x)}function y(R){return r&&R.alternate===null&&(R.flags|=67108866),R}function k(R,x,V,W){return x===null||x.tag!==6?(x=Ff(V,R.mode,W),x.return=R,x):(x=p(x,V),x.return=R,x)}function S(R,x,V,W){var he=V.type;return he===C?q(R,x,V.props.children,W,V.key):x!==null&&(x.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===J&&Ao(he)===x.type)?(x=p(x,V.props),Ya(x,V),x.return=R,x):(x=au(V.type,V.key,V.props,null,R.mode,W),Ya(x,V),x.return=R,x)}function B(R,x,V,W){return x===null||x.tag!==4||x.stateNode.containerInfo!==V.containerInfo||x.stateNode.implementation!==V.implementation?(x=zf(V,R.mode,W),x.return=R,x):(x=p(x,V.children||[]),x.return=R,x)}function q(R,x,V,W,he){return x===null||x.tag!==7?(x=Co(V,R.mode,W,he),x.return=R,x):(x=p(x,V),x.return=R,x)}function G(R,x,V){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return x=Ff(""+x,R.mode,V),x.return=R,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case _:return V=au(x.type,x.key,x.props,null,R.mode,V),Ya(V,x),V.return=R,V;case v:return x=zf(x,R.mode,V),x.return=R,x;case J:return x=Ao(x),G(R,x,V)}if(Ne(x)||Ve(x))return x=Co(x,R.mode,V,null),x.return=R,x;if(typeof x.then=="function")return G(R,mu(x),V);if(x.$$typeof===z)return G(R,uu(R,x),V);gu(R,x)}return null}function D(R,x,V,W){var he=x!==null?x.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return he!==null?null:k(R,x,""+V,W);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case _:return V.key===he?S(R,x,V,W):null;case v:return V.key===he?B(R,x,V,W):null;case J:return V=Ao(V),D(R,x,V,W)}if(Ne(V)||Ve(V))return he!==null?null:q(R,x,V,W,null);if(typeof V.then=="function")return D(R,x,mu(V),W);if(V.$$typeof===z)return D(R,x,uu(R,V),W);gu(R,V)}return null}function U(R,x,V,W,he){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return R=R.get(V)||null,k(x,R,""+W,he);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _:return R=R.get(W.key===null?V:W.key)||null,S(x,R,W,he);case v:return R=R.get(W.key===null?V:W.key)||null,B(x,R,W,he);case J:return W=Ao(W),U(R,x,V,W,he)}if(Ne(W)||Ve(W))return R=R.get(V)||null,q(x,R,W,he,null);if(typeof W.then=="function")return U(R,x,V,mu(W),he);if(W.$$typeof===z)return U(R,x,V,uu(x,W),he);gu(x,W)}return null}function re(R,x,V,W){for(var he=null,Le=null,ce=x,Ce=x=0,Ie=null;ce!==null&&Ce<V.length;Ce++){ce.index>Ce?(Ie=ce,ce=null):Ie=ce.sibling;var De=D(R,ce,V[Ce],W);if(De===null){ce===null&&(ce=Ie);break}r&&ce&&De.alternate===null&&l(R,ce),x=b(De,x,Ce),Le===null?he=De:Le.sibling=De,Le=De,ce=Ie}if(Ce===V.length)return d(R,ce),Oe&&Yi(R,Ce),he;if(ce===null){for(;Ce<V.length;Ce++)ce=G(R,V[Ce],W),ce!==null&&(x=b(ce,x,Ce),Le===null?he=ce:Le.sibling=ce,Le=ce);return Oe&&Yi(R,Ce),he}for(ce=f(ce);Ce<V.length;Ce++)Ie=U(ce,R,Ce,V[Ce],W),Ie!==null&&(r&&Ie.alternate!==null&&ce.delete(Ie.key===null?Ce:Ie.key),x=b(Ie,x,Ce),Le===null?he=Ie:Le.sibling=Ie,Le=Ie);return r&&ce.forEach(function(to){return l(R,to)}),Oe&&Yi(R,Ce),he}function fe(R,x,V,W){if(V==null)throw Error(n(151));for(var he=null,Le=null,ce=x,Ce=x=0,Ie=null,De=V.next();ce!==null&&!De.done;Ce++,De=V.next()){ce.index>Ce?(Ie=ce,ce=null):Ie=ce.sibling;var to=D(R,ce,De.value,W);if(to===null){ce===null&&(ce=Ie);break}r&&ce&&to.alternate===null&&l(R,ce),x=b(to,x,Ce),Le===null?he=to:Le.sibling=to,Le=to,ce=Ie}if(De.done)return d(R,ce),Oe&&Yi(R,Ce),he;if(ce===null){for(;!De.done;Ce++,De=V.next())De=G(R,De.value,W),De!==null&&(x=b(De,x,Ce),Le===null?he=De:Le.sibling=De,Le=De);return Oe&&Yi(R,Ce),he}for(ce=f(ce);!De.done;Ce++,De=V.next())De=U(ce,R,Ce,De.value,W),De!==null&&(r&&De.alternate!==null&&ce.delete(De.key===null?Ce:De.key),x=b(De,x,Ce),Le===null?he=De:Le.sibling=De,Le=De);return r&&ce.forEach(function(FI){return l(R,FI)}),Oe&&Yi(R,Ce),he}function Ke(R,x,V,W){if(typeof V=="object"&&V!==null&&V.type===C&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case _:e:{for(var he=V.key;x!==null;){if(x.key===he){if(he=V.type,he===C){if(x.tag===7){d(R,x.sibling),W=p(x,V.props.children),W.return=R,R=W;break e}}else if(x.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===J&&Ao(he)===x.type){d(R,x.sibling),W=p(x,V.props),Ya(W,V),W.return=R,R=W;break e}d(R,x);break}else l(R,x);x=x.sibling}V.type===C?(W=Co(V.props.children,R.mode,W,V.key),W.return=R,R=W):(W=au(V.type,V.key,V.props,null,R.mode,W),Ya(W,V),W.return=R,R=W)}return y(R);case v:e:{for(he=V.key;x!==null;){if(x.key===he)if(x.tag===4&&x.stateNode.containerInfo===V.containerInfo&&x.stateNode.implementation===V.implementation){d(R,x.sibling),W=p(x,V.children||[]),W.return=R,R=W;break e}else{d(R,x);break}else l(R,x);x=x.sibling}W=zf(V,R.mode,W),W.return=R,R=W}return y(R);case J:return V=Ao(V),Ke(R,x,V,W)}if(Ne(V))return re(R,x,V,W);if(Ve(V)){if(he=Ve(V),typeof he!="function")throw Error(n(150));return V=he.call(V),fe(R,x,V,W)}if(typeof V.then=="function")return Ke(R,x,mu(V),W);if(V.$$typeof===z)return Ke(R,x,uu(R,V),W);gu(R,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,x!==null&&x.tag===6?(d(R,x.sibling),W=p(x,V),W.return=R,R=W):(d(R,x),W=Ff(V,R.mode,W),W.return=R,R=W),y(R)):d(R,x)}return function(R,x,V,W){try{Ka=0;var he=Ke(R,x,V,W);return Br=null,he}catch(ce){if(ce===Vr||ce===hu)throw ce;var Le=xn(29,ce,null,R.mode);return Le.lanes=W,Le.return=R,Le}}}var Io=J_(!0),Q_=J_(!1),Ds=!1;function Xf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zf(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Fs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function zs(r,l,d){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(ze&2)!==0){var p=f.pending;return p===null?l.next=l:(l.next=p.next,p.next=l),f.pending=l,l=ru(r),B_(r,null,d),l}return ou(r,f,l,d),ru(r)}function Ja(r,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194048)!==0)){var f=l.lanes;f&=r.pendingLanes,d|=f,l.lanes=d,Hw(r,d)}}function em(r,l){var d=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,d===f)){var p=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var y={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};b===null?p=b=y:b=b.next=y,d=d.next}while(d!==null);b===null?p=b=l:b=b.next=l}else p=b=l;d={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=l:r.next=l,d.lastBaseUpdate=l}var tm=!1;function Qa(){if(tm){var r=Or;if(r!==null)throw r}}function Xa(r,l,d,f){tm=!1;var p=r.updateQueue;Ds=!1;var b=p.firstBaseUpdate,y=p.lastBaseUpdate,k=p.shared.pending;if(k!==null){p.shared.pending=null;var S=k,B=S.next;S.next=null,y===null?b=B:y.next=B,y=S;var q=r.alternate;q!==null&&(q=q.updateQueue,k=q.lastBaseUpdate,k!==y&&(k===null?q.firstBaseUpdate=B:k.next=B,q.lastBaseUpdate=S))}if(b!==null){var G=p.baseState;y=0,q=B=S=null,k=b;do{var D=k.lane&-536870913,U=D!==k.lane;if(U?(xe&D)===D:(f&D)===D){D!==0&&D===Rr&&(tm=!0),q!==null&&(q=q.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var re=r,fe=k;D=l;var Ke=d;switch(fe.tag){case 1:if(re=fe.payload,typeof re=="function"){G=re.call(Ke,G,D);break e}G=re;break e;case 3:re.flags=re.flags&-65537|128;case 0:if(re=fe.payload,D=typeof re=="function"?re.call(Ke,G,D):re,D==null)break e;G=g({},G,D);break e;case 2:Ds=!0}}D=k.callback,D!==null&&(r.flags|=64,U&&(r.flags|=8192),U=p.callbacks,U===null?p.callbacks=[D]:U.push(D))}else U={lane:D,tag:k.tag,payload:k.payload,callback:k.callback,next:null},q===null?(B=q=U,S=G):q=q.next=U,y|=D;if(k=k.next,k===null){if(k=p.shared.pending,k===null)break;U=k,k=U.next,U.next=null,p.lastBaseUpdate=U,p.shared.pending=null}}while(!0);q===null&&(S=G),p.baseState=S,p.firstBaseUpdate=B,p.lastBaseUpdate=q,b===null&&(p.shared.lanes=0),Ws|=y,r.lanes=y,r.memoizedState=G}}function X_(r,l){if(typeof r!="function")throw Error(n(191,r));r.call(l)}function Z_(r,l){var d=r.callbacks;if(d!==null)for(r.callbacks=null,r=0;r<d.length;r++)X_(d[r],l)}var Mr=I(null),pu=I(0);function e0(r,l){r=rs,te(pu,r),te(Mr,l),rs=r|l.baseLanes}function nm(){te(pu,rs),te(Mr,Mr.current)}function im(){rs=pu.current,$(Mr),$(pu)}var In=I(null),Qn=null;function Us(r){var l=r.alternate;te(pt,pt.current&1),te(In,r),Qn===null&&(l===null||Mr.current!==null||l.memoizedState!==null)&&(Qn=r)}function sm(r){te(pt,pt.current),te(In,r),Qn===null&&(Qn=r)}function t0(r){r.tag===22?(te(pt,pt.current),te(In,r),Qn===null&&(Qn=r)):Hs()}function Hs(){te(pt,pt.current),te(In,In.current)}function Pn(r){$(In),Qn===r&&(Qn=null),$(pt)}var pt=I(0);function bu(r){for(var l=r;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||ug(d)||dg(d)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Xi=0,ve=null,$e=null,Et=null,wu=!1,Nr=!1,Po=!1,_u=0,Za=0,Lr=null,I5=0;function ft(){throw Error(n(321))}function om(r,l){if(l===null)return!1;for(var d=0;d<l.length&&d<r.length;d++)if(!An(r[d],l[d]))return!1;return!0}function rm(r,l,d,f,p,b){return Xi=b,ve=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=r===null||r.memoizedState===null?D0:vm,Po=!1,b=d(f,p),Po=!1,Nr&&(b=i0(l,d,f,p)),n0(r),b}function n0(r){H.H=nl;var l=$e!==null&&$e.next!==null;if(Xi=0,Et=$e=ve=null,wu=!1,Za=0,Lr=null,l)throw Error(n(300));r===null||St||(r=r.dependencies,r!==null&&cu(r)&&(St=!0))}function i0(r,l,d,f){ve=r;var p=0;do{if(Nr&&(Lr=null),Za=0,Nr=!1,25<=p)throw Error(n(301));if(p+=1,Et=$e=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}H.H=F0,b=l(d,f)}while(Nr);return b}function P5(){var r=H.H,l=r.useState()[0];return l=typeof l.then=="function"?el(l):l,r=r.useState()[0],($e!==null?$e.memoizedState:null)!==r&&(ve.flags|=1024),l}function am(){var r=_u!==0;return _u=0,r}function lm(r,l,d){l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~d}function cm(r){if(wu){for(r=r.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}wu=!1}Xi=0,Et=$e=ve=null,Nr=!1,Za=_u=0,Lr=null}function en(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?ve.memoizedState=Et=r:Et=Et.next=r,Et}function bt(){if($e===null){var r=ve.alternate;r=r!==null?r.memoizedState:null}else r=$e.next;var l=Et===null?ve.memoizedState:Et.next;if(l!==null)Et=l,$e=r;else{if(r===null)throw ve.alternate===null?Error(n(467)):Error(n(310));$e=r,r={memoizedState:$e.memoizedState,baseState:$e.baseState,baseQueue:$e.baseQueue,queue:$e.queue,next:null},Et===null?ve.memoizedState=Et=r:Et=Et.next=r}return Et}function yu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function el(r){var l=Za;return Za+=1,Lr===null&&(Lr=[]),r=G_(Lr,r,l),l=ve,(Et===null?l.memoizedState:Et.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?D0:vm),r}function vu(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return el(r);if(r.$$typeof===z)return Ut(r)}throw Error(n(438,String(r)))}function um(r){var l=null,d=ve.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var f=ve.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(p){return p.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=yu(),ve.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(r),f=0;f<r;f++)d[f]=ie;return l.index++,d}function Zi(r,l){return typeof l=="function"?l(r):l}function Cu(r){var l=bt();return dm(l,$e,r)}function dm(r,l,d){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=d;var p=r.baseQueue,b=f.pending;if(b!==null){if(p!==null){var y=p.next;p.next=b.next,b.next=y}l.baseQueue=p=b,f.pending=null}if(b=r.baseState,p===null)r.memoizedState=b;else{l=p.next;var k=y=null,S=null,B=l,q=!1;do{var G=B.lane&-536870913;if(G!==B.lane?(xe&G)===G:(Xi&G)===G){var D=B.revertLane;if(D===0)S!==null&&(S=S.next={lane:0,revertLane:0,gesture:null,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),G===Rr&&(q=!0);else if((Xi&D)===D){B=B.next,D===Rr&&(q=!0);continue}else G={lane:0,revertLane:B.revertLane,gesture:null,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},S===null?(k=S=G,y=b):S=S.next=G,ve.lanes|=D,Ws|=D;G=B.action,Po&&d(b,G),b=B.hasEagerState?B.eagerState:d(b,G)}else D={lane:G,revertLane:B.revertLane,gesture:B.gesture,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},S===null?(k=S=D,y=b):S=S.next=D,ve.lanes|=G,Ws|=G;B=B.next}while(B!==null&&B!==l);if(S===null?y=b:S.next=k,!An(b,r.memoizedState)&&(St=!0,q&&(d=Or,d!==null)))throw d;r.memoizedState=b,r.baseState=y,r.baseQueue=S,f.lastRenderedState=b}return p===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function hm(r){var l=bt(),d=l.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var f=d.dispatch,p=d.pending,b=l.memoizedState;if(p!==null){d.pending=null;var y=p=p.next;do b=r(b,y.action),y=y.next;while(y!==p);An(b,l.memoizedState)||(St=!0),l.memoizedState=b,l.baseQueue===null&&(l.baseState=b),d.lastRenderedState=b}return[b,f]}function s0(r,l,d){var f=ve,p=bt(),b=Oe;if(b){if(d===void 0)throw Error(n(407));d=d()}else d=l();var y=!An(($e||p).memoizedState,d);if(y&&(p.memoizedState=d,St=!0),p=p.queue,gm(a0.bind(null,f,p,r),[r]),p.getSnapshot!==l||y||Et!==null&&Et.memoizedState.tag&1){if(f.flags|=2048,Dr(9,{destroy:void 0},r0.bind(null,f,p,d,l),null),Qe===null)throw Error(n(349));b||(Xi&127)!==0||o0(f,l,d)}return d}function o0(r,l,d){r.flags|=16384,r={getSnapshot:l,value:d},l=ve.updateQueue,l===null?(l=yu(),ve.updateQueue=l,l.stores=[r]):(d=l.stores,d===null?l.stores=[r]:d.push(r))}function r0(r,l,d,f){l.value=d,l.getSnapshot=f,l0(l)&&c0(r)}function a0(r,l,d){return d(function(){l0(l)&&c0(r)})}function l0(r){var l=r.getSnapshot;r=r.value;try{var d=l();return!An(r,d)}catch{return!0}}function c0(r){var l=vo(r,2);l!==null&&mn(l,r,2)}function fm(r){var l=en();if(typeof r=="function"){var d=r;if(r=d(),Po){Rs(!0);try{d()}finally{Rs(!1)}}}return l.memoizedState=l.baseState=r,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:r},l}function u0(r,l,d,f){return r.baseState=d,dm(r,$e,typeof f=="function"?f:Zi)}function R5(r,l,d,f,p){if(Eu(r))throw Error(n(485));if(r=l.action,r!==null){var b={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){b.listeners.push(y)}};H.T!==null?d(!0):b.isTransition=!1,f(b),d=l.pending,d===null?(b.next=l.pending=b,d0(l,b)):(b.next=d.next,l.pending=d.next=b)}}function d0(r,l){var d=l.action,f=l.payload,p=r.state;if(l.isTransition){var b=H.T,y={};H.T=y;try{var k=d(p,f),S=H.S;S!==null&&S(y,k),h0(r,l,k)}catch(B){mm(r,l,B)}finally{b!==null&&y.types!==null&&(b.types=y.types),H.T=b}}else try{b=d(p,f),h0(r,l,b)}catch(B){mm(r,l,B)}}function h0(r,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(f){f0(r,l,f)},function(f){return mm(r,l,f)}):f0(r,l,d)}function f0(r,l,d){l.status="fulfilled",l.value=d,m0(l),r.state=d,l=r.pending,l!==null&&(d=l.next,d===l?r.pending=null:(d=d.next,l.next=d,d0(r,d)))}function mm(r,l,d){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=d,m0(l),l=l.next;while(l!==f)}r.action=null}function m0(r){r=r.listeners;for(var l=0;l<r.length;l++)(0,r[l])()}function g0(r,l){return l}function p0(r,l){if(Oe){var d=Qe.formState;if(d!==null){e:{var f=ve;if(Oe){if(nt){t:{for(var p=nt,b=Jn;p.nodeType!==8;){if(!b){p=null;break t}if(p=Xn(p.nextSibling),p===null){p=null;break t}}b=p.data,p=b==="F!"||b==="F"?p:null}if(p){nt=Xn(p.nextSibling),f=p.data==="F!";break e}}Ns(f)}f=!1}f&&(l=d[0])}}return d=en(),d.memoizedState=d.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:g0,lastRenderedState:l},d.queue=f,d=M0.bind(null,ve,f),f.dispatch=d,f=fm(!1),b=ym.bind(null,ve,!1,f.queue),f=en(),p={state:l,dispatch:null,action:r,pending:null},f.queue=p,d=R5.bind(null,ve,p,b,d),p.dispatch=d,f.memoizedState=r,[l,d,!1]}function b0(r){var l=bt();return w0(l,$e,r)}function w0(r,l,d){if(l=dm(r,l,g0)[0],r=Cu(Zi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=el(l)}catch(y){throw y===Vr?hu:y}else f=l;l=bt();var p=l.queue,b=p.dispatch;return d!==l.memoizedState&&(ve.flags|=2048,Dr(9,{destroy:void 0},O5.bind(null,p,d),null)),[f,b,r]}function O5(r,l){r.action=l}function _0(r){var l=bt(),d=$e;if(d!==null)return w0(l,d,r);bt(),l=l.memoizedState,d=bt();var f=d.queue.dispatch;return d.memoizedState=r,[l,f,!1]}function Dr(r,l,d,f){return r={tag:r,create:d,deps:f,inst:l,next:null},l=ve.updateQueue,l===null&&(l=yu(),ve.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=r.next=r:(f=d.next,d.next=r,r.next=f,l.lastEffect=r),r}function y0(){return bt().memoizedState}function ku(r,l,d,f){var p=en();ve.flags|=r,p.memoizedState=Dr(1|l,{destroy:void 0},d,f===void 0?null:f)}function Tu(r,l,d,f){var p=bt();f=f===void 0?null:f;var b=p.memoizedState.inst;$e!==null&&f!==null&&om(f,$e.memoizedState.deps)?p.memoizedState=Dr(l,b,d,f):(ve.flags|=r,p.memoizedState=Dr(1|l,b,d,f))}function v0(r,l){ku(8390656,8,r,l)}function gm(r,l){Tu(2048,8,r,l)}function V5(r){ve.flags|=4;var l=ve.updateQueue;if(l===null)l=yu(),ve.updateQueue=l,l.events=[r];else{var d=l.events;d===null?l.events=[r]:d.push(r)}}function C0(r){var l=bt().memoizedState;return V5({ref:l,nextImpl:r}),function(){if((ze&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function k0(r,l){return Tu(4,2,r,l)}function T0(r,l){return Tu(4,4,r,l)}function E0(r,l){if(typeof l=="function"){r=r();var d=l(r);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function S0(r,l,d){d=d!=null?d.concat([r]):null,Tu(4,4,E0.bind(null,l,r),d)}function pm(){}function A0(r,l){var d=bt();l=l===void 0?null:l;var f=d.memoizedState;return l!==null&&om(l,f[1])?f[0]:(d.memoizedState=[r,l],r)}function x0(r,l){var d=bt();l=l===void 0?null:l;var f=d.memoizedState;if(l!==null&&om(l,f[1]))return f[0];if(f=r(),Po){Rs(!0);try{r()}finally{Rs(!1)}}return d.memoizedState=[f,l],f}function bm(r,l,d){return d===void 0||(Xi&1073741824)!==0&&(xe&261930)===0?r.memoizedState=l:(r.memoizedState=d,r=Iy(),ve.lanes|=r,Ws|=r,d)}function I0(r,l,d,f){return An(d,l)?d:Mr.current!==null?(r=bm(r,d,f),An(r,l)||(St=!0),r):(Xi&42)===0||(Xi&1073741824)!==0&&(xe&261930)===0?(St=!0,r.memoizedState=d):(r=Iy(),ve.lanes|=r,Ws|=r,l)}function P0(r,l,d,f,p){var b=X.p;X.p=b!==0&&8>b?b:8;var y=H.T,k={};H.T=k,ym(r,!1,l,d);try{var S=p(),B=H.S;if(B!==null&&B(k,S),S!==null&&typeof S=="object"&&typeof S.then=="function"){var q=x5(S,f);tl(r,l,q,Vn(r))}else tl(r,l,f,Vn(r))}catch(G){tl(r,l,{then:function(){},status:"rejected",reason:G},Vn())}finally{X.p=b,y!==null&&k.types!==null&&(y.types=k.types),H.T=y}}function B5(){}function wm(r,l,d,f){if(r.tag!==5)throw Error(n(476));var p=R0(r).queue;P0(r,p,l,de,d===null?B5:function(){return O0(r),d(f)})}function R0(r){var l=r.memoizedState;if(l!==null)return l;l={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:de},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:d},next:null},r.memoizedState=l,r=r.alternate,r!==null&&(r.memoizedState=l),l}function O0(r){var l=R0(r);l.next===null&&(l=r.alternate.memoizedState),tl(r,l.next.queue,{},Vn())}function _m(){return Ut(wl)}function V0(){return bt().memoizedState}function B0(){return bt().memoizedState}function M5(r){for(var l=r.return;l!==null;){switch(l.tag){case 24:case 3:var d=Vn();r=Fs(d);var f=zs(l,r,d);f!==null&&(mn(f,l,d),Ja(f,l,d)),l={cache:Kf()},r.payload=l;return}l=l.return}}function N5(r,l,d){var f=Vn();d={lane:f,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Eu(r)?N0(l,d):(d=Lf(r,l,d,f),d!==null&&(mn(d,r,f),L0(d,l,f)))}function M0(r,l,d){var f=Vn();tl(r,l,d,f)}function tl(r,l,d,f){var p={lane:f,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(Eu(r))N0(l,p);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=l.lastRenderedReducer,b!==null))try{var y=l.lastRenderedState,k=b(y,d);if(p.hasEagerState=!0,p.eagerState=k,An(k,y))return ou(r,l,p,0),Qe===null&&su(),!1}catch{}if(d=Lf(r,l,p,f),d!==null)return mn(d,r,f),L0(d,l,f),!0}return!1}function ym(r,l,d,f){if(f={lane:2,revertLane:Xm(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Eu(r)){if(l)throw Error(n(479))}else l=Lf(r,d,f,2),l!==null&&mn(l,r,2)}function Eu(r){var l=r.alternate;return r===ve||l!==null&&l===ve}function N0(r,l){Nr=wu=!0;var d=r.pending;d===null?l.next=l:(l.next=d.next,d.next=l),r.pending=l}function L0(r,l,d){if((d&4194048)!==0){var f=l.lanes;f&=r.pendingLanes,d|=f,l.lanes=d,Hw(r,d)}}var nl={readContext:Ut,use:vu,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useLayoutEffect:ft,useInsertionEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useSyncExternalStore:ft,useId:ft,useHostTransitionStatus:ft,useFormState:ft,useActionState:ft,useOptimistic:ft,useMemoCache:ft,useCacheRefresh:ft};nl.useEffectEvent=ft;var D0={readContext:Ut,use:vu,useCallback:function(r,l){return en().memoizedState=[r,l===void 0?null:l],r},useContext:Ut,useEffect:v0,useImperativeHandle:function(r,l,d){d=d!=null?d.concat([r]):null,ku(4194308,4,E0.bind(null,l,r),d)},useLayoutEffect:function(r,l){return ku(4194308,4,r,l)},useInsertionEffect:function(r,l){ku(4,2,r,l)},useMemo:function(r,l){var d=en();l=l===void 0?null:l;var f=r();if(Po){Rs(!0);try{r()}finally{Rs(!1)}}return d.memoizedState=[f,l],f},useReducer:function(r,l,d){var f=en();if(d!==void 0){var p=d(l);if(Po){Rs(!0);try{d(l)}finally{Rs(!1)}}}else p=l;return f.memoizedState=f.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},f.queue=r,r=r.dispatch=N5.bind(null,ve,r),[f.memoizedState,r]},useRef:function(r){var l=en();return r={current:r},l.memoizedState=r},useState:function(r){r=fm(r);var l=r.queue,d=M0.bind(null,ve,l);return l.dispatch=d,[r.memoizedState,d]},useDebugValue:pm,useDeferredValue:function(r,l){var d=en();return bm(d,r,l)},useTransition:function(){var r=fm(!1);return r=P0.bind(null,ve,r.queue,!0,!1),en().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,l,d){var f=ve,p=en();if(Oe){if(d===void 0)throw Error(n(407));d=d()}else{if(d=l(),Qe===null)throw Error(n(349));(xe&127)!==0||o0(f,l,d)}p.memoizedState=d;var b={value:d,getSnapshot:l};return p.queue=b,v0(a0.bind(null,f,b,r),[r]),f.flags|=2048,Dr(9,{destroy:void 0},r0.bind(null,f,b,d,l),null),d},useId:function(){var r=en(),l=Qe.identifierPrefix;if(Oe){var d=Ei,f=Ti;d=(f&~(1<<32-Sn(f)-1)).toString(32)+d,l="_"+l+"R_"+d,d=_u++,0<d&&(l+="H"+d.toString(32)),l+="_"}else d=I5++,l="_"+l+"r_"+d.toString(32)+"_";return r.memoizedState=l},useHostTransitionStatus:_m,useFormState:p0,useActionState:p0,useOptimistic:function(r){var l=en();l.memoizedState=l.baseState=r;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=ym.bind(null,ve,!0,d),d.dispatch=l,[r,l]},useMemoCache:um,useCacheRefresh:function(){return en().memoizedState=M5.bind(null,ve)},useEffectEvent:function(r){var l=en(),d={impl:r};return l.memoizedState=d,function(){if((ze&2)!==0)throw Error(n(440));return d.impl.apply(void 0,arguments)}}},vm={readContext:Ut,use:vu,useCallback:A0,useContext:Ut,useEffect:gm,useImperativeHandle:S0,useInsertionEffect:k0,useLayoutEffect:T0,useMemo:x0,useReducer:Cu,useRef:y0,useState:function(){return Cu(Zi)},useDebugValue:pm,useDeferredValue:function(r,l){var d=bt();return I0(d,$e.memoizedState,r,l)},useTransition:function(){var r=Cu(Zi)[0],l=bt().memoizedState;return[typeof r=="boolean"?r:el(r),l]},useSyncExternalStore:s0,useId:V0,useHostTransitionStatus:_m,useFormState:b0,useActionState:b0,useOptimistic:function(r,l){var d=bt();return u0(d,$e,r,l)},useMemoCache:um,useCacheRefresh:B0};vm.useEffectEvent=C0;var F0={readContext:Ut,use:vu,useCallback:A0,useContext:Ut,useEffect:gm,useImperativeHandle:S0,useInsertionEffect:k0,useLayoutEffect:T0,useMemo:x0,useReducer:hm,useRef:y0,useState:function(){return hm(Zi)},useDebugValue:pm,useDeferredValue:function(r,l){var d=bt();return $e===null?bm(d,r,l):I0(d,$e.memoizedState,r,l)},useTransition:function(){var r=hm(Zi)[0],l=bt().memoizedState;return[typeof r=="boolean"?r:el(r),l]},useSyncExternalStore:s0,useId:V0,useHostTransitionStatus:_m,useFormState:_0,useActionState:_0,useOptimistic:function(r,l){var d=bt();return $e!==null?u0(d,$e,r,l):(d.baseState=r,[r,d.queue.dispatch])},useMemoCache:um,useCacheRefresh:B0};F0.useEffectEvent=C0;function Cm(r,l,d,f){l=r.memoizedState,d=d(f,l),d=d==null?l:g({},l,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var km={enqueueSetState:function(r,l,d){r=r._reactInternals;var f=Vn(),p=Fs(f);p.payload=l,d!=null&&(p.callback=d),l=zs(r,p,f),l!==null&&(mn(l,r,f),Ja(l,r,f))},enqueueReplaceState:function(r,l,d){r=r._reactInternals;var f=Vn(),p=Fs(f);p.tag=1,p.payload=l,d!=null&&(p.callback=d),l=zs(r,p,f),l!==null&&(mn(l,r,f),Ja(l,r,f))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var d=Vn(),f=Fs(d);f.tag=2,l!=null&&(f.callback=l),l=zs(r,f,d),l!==null&&(mn(l,r,d),Ja(l,r,d))}};function z0(r,l,d,f,p,b,y){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,b,y):l.prototype&&l.prototype.isPureReactComponent?!Ha(d,f)||!Ha(p,b):!0}function U0(r,l,d,f){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,f),l.state!==r&&km.enqueueReplaceState(l,l.state,null)}function Ro(r,l){var d=l;if("ref"in l){d={};for(var f in l)f!=="ref"&&(d[f]=l[f])}if(r=r.defaultProps){d===l&&(d=g({},d));for(var p in r)d[p]===void 0&&(d[p]=r[p])}return d}function H0(r){iu(r)}function j0(r){console.error(r)}function q0(r){iu(r)}function Su(r,l){try{var d=r.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function W0(r,l,d){try{var f=r.onCaughtError;f(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Tm(r,l,d){return d=Fs(d),d.tag=3,d.payload={element:null},d.callback=function(){Su(r,l)},d}function $0(r){return r=Fs(r),r.tag=3,r}function G0(r,l,d,f){var p=d.type.getDerivedStateFromError;if(typeof p=="function"){var b=f.value;r.payload=function(){return p(b)},r.callback=function(){W0(l,d,f)}}var y=d.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(r.callback=function(){W0(l,d,f),typeof p!="function"&&($s===null?$s=new Set([this]):$s.add(this));var k=f.stack;this.componentDidCatch(f.value,{componentStack:k!==null?k:""})})}function L5(r,l,d,f,p){if(d.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=d.alternate,l!==null&&Pr(l,d,p,!0),d=In.current,d!==null){switch(d.tag){case 31:case 13:return Qn===null?Du():d.alternate===null&&mt===0&&(mt=3),d.flags&=-257,d.flags|=65536,d.lanes=p,f===fu?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([f]):l.add(f),Ym(r,f,p)),!1;case 22:return d.flags|=65536,f===fu?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([f]):d.add(f)),Ym(r,f,p)),!1}throw Error(n(435,d.tag))}return Ym(r,f,p),Du(),!1}if(Oe)return l=In.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=p,f!==jf&&(r=Error(n(422),{cause:f}),Wa(Gn(r,d)))):(f!==jf&&(l=Error(n(423),{cause:f}),Wa(Gn(l,d))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,f=Gn(f,d),p=Tm(r.stateNode,f,p),em(r,p),mt!==4&&(mt=2)),!1;var b=Error(n(520),{cause:f});if(b=Gn(b,d),ul===null?ul=[b]:ul.push(b),mt!==4&&(mt=2),l===null)return!0;f=Gn(f,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,r=p&-p,d.lanes|=r,r=Tm(d.stateNode,f,r),em(d,r),!1;case 1:if(l=d.type,b=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&($s===null||!$s.has(b))))return d.flags|=65536,p&=-p,d.lanes|=p,p=$0(p),G0(p,r,d,f),em(d,p),!1}d=d.return}while(d!==null);return!1}var Em=Error(n(461)),St=!1;function Ht(r,l,d,f){l.child=r===null?Q_(l,null,d,f):Io(l,r.child,d,f)}function K0(r,l,d,f,p){d=d.render;var b=l.ref;if("ref"in f){var y={};for(var k in f)k!=="ref"&&(y[k]=f[k])}else y=f;return Eo(l),f=rm(r,l,d,y,b,p),k=am(),r!==null&&!St?(lm(r,l,p),es(r,l,p)):(Oe&&k&&Uf(l),l.flags|=1,Ht(r,l,f,p),l.child)}function Y0(r,l,d,f,p){if(r===null){var b=d.type;return typeof b=="function"&&!Df(b)&&b.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=b,J0(r,l,b,f,p)):(r=au(d.type,null,f,l,l.mode,p),r.ref=l.ref,r.return=l,l.child=r)}if(b=r.child,!Vm(r,p)){var y=b.memoizedProps;if(d=d.compare,d=d!==null?d:Ha,d(y,f)&&r.ref===l.ref)return es(r,l,p)}return l.flags|=1,r=Ki(b,f),r.ref=l.ref,r.return=l,l.child=r}function J0(r,l,d,f,p){if(r!==null){var b=r.memoizedProps;if(Ha(b,f)&&r.ref===l.ref)if(St=!1,l.pendingProps=f=b,Vm(r,p))(r.flags&131072)!==0&&(St=!0);else return l.lanes=r.lanes,es(r,l,p)}return Sm(r,l,d,f,p)}function Q0(r,l,d,f){var p=f.children,b=r!==null?r.memoizedState:null;if(r===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(b=b!==null?b.baseLanes|d:d,r!==null){for(f=l.child=r.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;f=p&~b}else f=0,l.child=null;return X0(r,l,b,d,f)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},r!==null&&du(l,b!==null?b.cachePool:null),b!==null?e0(l,b):nm(),t0(l);else return f=l.lanes=536870912,X0(r,l,b!==null?b.baseLanes|d:d,d,f)}else b!==null?(du(l,b.cachePool),e0(l,b),Hs(),l.memoizedState=null):(r!==null&&du(l,null),nm(),Hs());return Ht(r,l,p,d),l.child}function il(r,l){return r!==null&&r.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function X0(r,l,d,f,p){var b=Jf();return b=b===null?null:{parent:Tt._currentValue,pool:b},l.memoizedState={baseLanes:d,cachePool:b},r!==null&&du(l,null),nm(),t0(l),r!==null&&Pr(r,l,f,!0),l.childLanes=p,null}function Au(r,l){return l=Iu({mode:l.mode,children:l.children},r.mode),l.ref=r.ref,r.child=l,l.return=r,l}function Z0(r,l,d){return Io(l,r.child,null,d),r=Au(l,l.pendingProps),r.flags|=2,Pn(l),l.memoizedState=null,r}function D5(r,l,d){var f=l.pendingProps,p=(l.flags&128)!==0;if(l.flags&=-129,r===null){if(Oe){if(f.mode==="hidden")return r=Au(l,f),l.lanes=536870912,il(null,r);if(sm(l),(r=nt)?(r=dv(r,Jn),r=r!==null&&r.data==="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Bs!==null?{id:Ti,overflow:Ei}:null,retryLane:536870912,hydrationErrors:null},d=N_(r),d.return=l,l.child=d,zt=l,nt=null)):r=null,r===null)throw Ns(l);return l.lanes=536870912,null}return Au(l,f)}var b=r.memoizedState;if(b!==null){var y=b.dehydrated;if(sm(l),p)if(l.flags&256)l.flags&=-257,l=Z0(r,l,d);else if(l.memoizedState!==null)l.child=r.child,l.flags|=128,l=null;else throw Error(n(558));else if(St||Pr(r,l,d,!1),p=(d&r.childLanes)!==0,St||p){if(f=Qe,f!==null&&(y=jw(f,d),y!==0&&y!==b.retryLane))throw b.retryLane=y,vo(r,y),mn(f,r,y),Em;Du(),l=Z0(r,l,d)}else r=b.treeContext,nt=Xn(y.nextSibling),zt=l,Oe=!0,Ms=null,Jn=!1,r!==null&&F_(l,r),l=Au(l,f),l.flags|=4096;return l}return r=Ki(r.child,{mode:f.mode,children:f.children}),r.ref=l.ref,l.child=r,r.return=l,r}function xu(r,l){var d=l.ref;if(d===null)r!==null&&r.ref!==null&&(l.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(r===null||r.ref!==d)&&(l.flags|=4194816)}}function Sm(r,l,d,f,p){return Eo(l),d=rm(r,l,d,f,void 0,p),f=am(),r!==null&&!St?(lm(r,l,p),es(r,l,p)):(Oe&&f&&Uf(l),l.flags|=1,Ht(r,l,d,p),l.child)}function ey(r,l,d,f,p,b){return Eo(l),l.updateQueue=null,d=i0(l,f,d,p),n0(r),f=am(),r!==null&&!St?(lm(r,l,b),es(r,l,b)):(Oe&&f&&Uf(l),l.flags|=1,Ht(r,l,d,b),l.child)}function ty(r,l,d,f,p){if(Eo(l),l.stateNode===null){var b=Sr,y=d.contextType;typeof y=="object"&&y!==null&&(b=Ut(y)),b=new d(f,b),l.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=km,l.stateNode=b,b._reactInternals=l,b=l.stateNode,b.props=f,b.state=l.memoizedState,b.refs={},Xf(l),y=d.contextType,b.context=typeof y=="object"&&y!==null?Ut(y):Sr,b.state=l.memoizedState,y=d.getDerivedStateFromProps,typeof y=="function"&&(Cm(l,d,y,f),b.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(y=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),y!==b.state&&km.enqueueReplaceState(b,b.state,null),Xa(l,f,b,p),Qa(),b.state=l.memoizedState),typeof b.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(r===null){b=l.stateNode;var k=l.memoizedProps,S=Ro(d,k);b.props=S;var B=b.context,q=d.contextType;y=Sr,typeof q=="object"&&q!==null&&(y=Ut(q));var G=d.getDerivedStateFromProps;q=typeof G=="function"||typeof b.getSnapshotBeforeUpdate=="function",k=l.pendingProps!==k,q||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k||B!==y)&&U0(l,b,f,y),Ds=!1;var D=l.memoizedState;b.state=D,Xa(l,f,b,p),Qa(),B=l.memoizedState,k||D!==B||Ds?(typeof G=="function"&&(Cm(l,d,G,f),B=l.memoizedState),(S=Ds||z0(l,d,S,f,D,B,y))?(q||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=B),b.props=f,b.state=B,b.context=y,f=S):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{b=l.stateNode,Zf(r,l),y=l.memoizedProps,q=Ro(d,y),b.props=q,G=l.pendingProps,D=b.context,B=d.contextType,S=Sr,typeof B=="object"&&B!==null&&(S=Ut(B)),k=d.getDerivedStateFromProps,(B=typeof k=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(y!==G||D!==S)&&U0(l,b,f,S),Ds=!1,D=l.memoizedState,b.state=D,Xa(l,f,b,p),Qa();var U=l.memoizedState;y!==G||D!==U||Ds||r!==null&&r.dependencies!==null&&cu(r.dependencies)?(typeof k=="function"&&(Cm(l,d,k,f),U=l.memoizedState),(q=Ds||z0(l,d,q,f,D,U,S)||r!==null&&r.dependencies!==null&&cu(r.dependencies))?(B||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,U,S),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,U,S)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||y===r.memoizedProps&&D===r.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||y===r.memoizedProps&&D===r.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=U),b.props=f,b.state=U,b.context=S,f=q):(typeof b.componentDidUpdate!="function"||y===r.memoizedProps&&D===r.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||y===r.memoizedProps&&D===r.memoizedState||(l.flags|=1024),f=!1)}return b=f,xu(r,l),f=(l.flags&128)!==0,b||f?(b=l.stateNode,d=f&&typeof d.getDerivedStateFromError!="function"?null:b.render(),l.flags|=1,r!==null&&f?(l.child=Io(l,r.child,null,p),l.child=Io(l,null,d,p)):Ht(r,l,d,p),l.memoizedState=b.state,r=l.child):r=es(r,l,p),r}function ny(r,l,d,f){return ko(),l.flags|=256,Ht(r,l,d,f),l.child}var Am={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xm(r){return{baseLanes:r,cachePool:W_()}}function Im(r,l,d){return r=r!==null?r.childLanes&~d:0,l&&(r|=On),r}function iy(r,l,d){var f=l.pendingProps,p=!1,b=(l.flags&128)!==0,y;if((y=b)||(y=r!==null&&r.memoizedState===null?!1:(pt.current&2)!==0),y&&(p=!0,l.flags&=-129),y=(l.flags&32)!==0,l.flags&=-33,r===null){if(Oe){if(p?Us(l):Hs(),(r=nt)?(r=dv(r,Jn),r=r!==null&&r.data!=="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:Bs!==null?{id:Ti,overflow:Ei}:null,retryLane:536870912,hydrationErrors:null},d=N_(r),d.return=l,l.child=d,zt=l,nt=null)):r=null,r===null)throw Ns(l);return dg(r)?l.lanes=32:l.lanes=536870912,null}var k=f.children;return f=f.fallback,p?(Hs(),p=l.mode,k=Iu({mode:"hidden",children:k},p),f=Co(f,p,d,null),k.return=l,f.return=l,k.sibling=f,l.child=k,f=l.child,f.memoizedState=xm(d),f.childLanes=Im(r,y,d),l.memoizedState=Am,il(null,f)):(Us(l),Pm(l,k))}var S=r.memoizedState;if(S!==null&&(k=S.dehydrated,k!==null)){if(b)l.flags&256?(Us(l),l.flags&=-257,l=Rm(r,l,d)):l.memoizedState!==null?(Hs(),l.child=r.child,l.flags|=128,l=null):(Hs(),k=f.fallback,p=l.mode,f=Iu({mode:"visible",children:f.children},p),k=Co(k,p,d,null),k.flags|=2,f.return=l,k.return=l,f.sibling=k,l.child=f,Io(l,r.child,null,d),f=l.child,f.memoizedState=xm(d),f.childLanes=Im(r,y,d),l.memoizedState=Am,l=il(null,f));else if(Us(l),dg(k)){if(y=k.nextSibling&&k.nextSibling.dataset,y)var B=y.dgst;y=B,f=Error(n(419)),f.stack="",f.digest=y,Wa({value:f,source:null,stack:null}),l=Rm(r,l,d)}else if(St||Pr(r,l,d,!1),y=(d&r.childLanes)!==0,St||y){if(y=Qe,y!==null&&(f=jw(y,d),f!==0&&f!==S.retryLane))throw S.retryLane=f,vo(r,f),mn(y,r,f),Em;ug(k)||Du(),l=Rm(r,l,d)}else ug(k)?(l.flags|=192,l.child=r.child,l=null):(r=S.treeContext,nt=Xn(k.nextSibling),zt=l,Oe=!0,Ms=null,Jn=!1,r!==null&&F_(l,r),l=Pm(l,f.children),l.flags|=4096);return l}return p?(Hs(),k=f.fallback,p=l.mode,S=r.child,B=S.sibling,f=Ki(S,{mode:"hidden",children:f.children}),f.subtreeFlags=S.subtreeFlags&65011712,B!==null?k=Ki(B,k):(k=Co(k,p,d,null),k.flags|=2),k.return=l,f.return=l,f.sibling=k,l.child=f,il(null,f),f=l.child,k=r.child.memoizedState,k===null?k=xm(d):(p=k.cachePool,p!==null?(S=Tt._currentValue,p=p.parent!==S?{parent:S,pool:S}:p):p=W_(),k={baseLanes:k.baseLanes|d,cachePool:p}),f.memoizedState=k,f.childLanes=Im(r,y,d),l.memoizedState=Am,il(r.child,f)):(Us(l),d=r.child,r=d.sibling,d=Ki(d,{mode:"visible",children:f.children}),d.return=l,d.sibling=null,r!==null&&(y=l.deletions,y===null?(l.deletions=[r],l.flags|=16):y.push(r)),l.child=d,l.memoizedState=null,d)}function Pm(r,l){return l=Iu({mode:"visible",children:l},r.mode),l.return=r,r.child=l}function Iu(r,l){return r=xn(22,r,null,l),r.lanes=0,r}function Rm(r,l,d){return Io(l,r.child,null,d),r=Pm(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function sy(r,l,d){r.lanes|=l;var f=r.alternate;f!==null&&(f.lanes|=l),$f(r.return,l,d)}function Om(r,l,d,f,p,b){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:d,tailMode:p,treeForkCount:b}:(y.isBackwards=l,y.rendering=null,y.renderingStartTime=0,y.last=f,y.tail=d,y.tailMode=p,y.treeForkCount=b)}function oy(r,l,d){var f=l.pendingProps,p=f.revealOrder,b=f.tail;f=f.children;var y=pt.current,k=(y&2)!==0;if(k?(y=y&1|2,l.flags|=128):y&=1,te(pt,y),Ht(r,l,f,d),f=Oe?qa:0,!k&&r!==null&&(r.flags&128)!==0)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&sy(r,d,l);else if(r.tag===19)sy(r,d,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(d=l.child,p=null;d!==null;)r=d.alternate,r!==null&&bu(r)===null&&(p=d),d=d.sibling;d=p,d===null?(p=l.child,l.child=null):(p=d.sibling,d.sibling=null),Om(l,!1,p,d,b,f);break;case"backwards":case"unstable_legacy-backwards":for(d=null,p=l.child,l.child=null;p!==null;){if(r=p.alternate,r!==null&&bu(r)===null){l.child=p;break}r=p.sibling,p.sibling=d,d=p,p=r}Om(l,!0,d,null,b,f);break;case"together":Om(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function es(r,l,d){if(r!==null&&(l.dependencies=r.dependencies),Ws|=l.lanes,(d&l.childLanes)===0)if(r!==null){if(Pr(r,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(r!==null&&l.child!==r.child)throw Error(n(153));if(l.child!==null){for(r=l.child,d=Ki(r,r.pendingProps),l.child=d,d.return=l;r.sibling!==null;)r=r.sibling,d=d.sibling=Ki(r,r.pendingProps),d.return=l;d.sibling=null}return l.child}function Vm(r,l){return(r.lanes&l)!==0?!0:(r=r.dependencies,!!(r!==null&&cu(r)))}function F5(r,l,d){switch(l.tag){case 3:kt(l,l.stateNode.containerInfo),Ls(l,Tt,r.memoizedState.cache),ko();break;case 27:case 5:jn(l);break;case 4:kt(l,l.stateNode.containerInfo);break;case 10:Ls(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,sm(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Us(l),l.flags|=128,null):(d&l.child.childLanes)!==0?iy(r,l,d):(Us(l),r=es(r,l,d),r!==null?r.sibling:null);Us(l);break;case 19:var p=(r.flags&128)!==0;if(f=(d&l.childLanes)!==0,f||(Pr(r,l,d,!1),f=(d&l.childLanes)!==0),p){if(f)return oy(r,l,d);l.flags|=128}if(p=l.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),te(pt,pt.current),f)break;return null;case 22:return l.lanes=0,Q0(r,l,d,l.pendingProps);case 24:Ls(l,Tt,r.memoizedState.cache)}return es(r,l,d)}function ry(r,l,d){if(r!==null)if(r.memoizedProps!==l.pendingProps)St=!0;else{if(!Vm(r,d)&&(l.flags&128)===0)return St=!1,F5(r,l,d);St=(r.flags&131072)!==0}else St=!1,Oe&&(l.flags&1048576)!==0&&D_(l,qa,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(r=Ao(l.elementType),l.type=r,typeof r=="function")Df(r)?(f=Ro(r,f),l.tag=1,l=ty(null,l,r,f,d)):(l.tag=0,l=Sm(null,l,r,f,d));else{if(r!=null){var p=r.$$typeof;if(p===j){l.tag=11,l=K0(null,l,r,f,d);break e}else if(p===M){l.tag=14,l=Y0(null,l,r,f,d);break e}}throw l=rt(r)||r,Error(n(306,l,""))}}return l;case 0:return Sm(r,l,l.type,l.pendingProps,d);case 1:return f=l.type,p=Ro(f,l.pendingProps),ty(r,l,f,p,d);case 3:e:{if(kt(l,l.stateNode.containerInfo),r===null)throw Error(n(387));f=l.pendingProps;var b=l.memoizedState;p=b.element,Zf(r,l),Xa(l,f,null,d);var y=l.memoizedState;if(f=y.cache,Ls(l,Tt,f),f!==b.cache&&Gf(l,[Tt],d,!0),Qa(),f=y.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:y.cache},l.updateQueue.baseState=b,l.memoizedState=b,l.flags&256){l=ny(r,l,f,d);break e}else if(f!==p){p=Gn(Error(n(424)),l),Wa(p),l=ny(r,l,f,d);break e}else for(r=l.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,nt=Xn(r.firstChild),zt=l,Oe=!0,Ms=null,Jn=!0,d=Q_(l,null,f,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(ko(),f===p){l=es(r,l,d);break e}Ht(r,l,f,d)}l=l.child}return l;case 26:return xu(r,l),r===null?(d=bv(l.type,null,l.pendingProps,null))?l.memoizedState=d:Oe||(d=l.type,r=l.pendingProps,f=Wu(ye.current).createElement(d),f[Ft]=l,f[ln]=r,jt(f,d,r),Bt(f),l.stateNode=f):l.memoizedState=bv(l.type,r.memoizedProps,l.pendingProps,r.memoizedState),null;case 27:return jn(l),r===null&&Oe&&(f=l.stateNode=mv(l.type,l.pendingProps,ye.current),zt=l,Jn=!0,p=nt,Js(l.type)?(hg=p,nt=Xn(f.firstChild)):nt=p),Ht(r,l,l.pendingProps.children,d),xu(r,l),r===null&&(l.flags|=4194304),l.child;case 5:return r===null&&Oe&&((p=f=nt)&&(f=gI(f,l.type,l.pendingProps,Jn),f!==null?(l.stateNode=f,zt=l,nt=Xn(f.firstChild),Jn=!1,p=!0):p=!1),p||Ns(l)),jn(l),p=l.type,b=l.pendingProps,y=r!==null?r.memoizedProps:null,f=b.children,ag(p,b)?f=null:y!==null&&ag(p,y)&&(l.flags|=32),l.memoizedState!==null&&(p=rm(r,l,P5,null,null,d),wl._currentValue=p),xu(r,l),Ht(r,l,f,d),l.child;case 6:return r===null&&Oe&&((r=d=nt)&&(d=pI(d,l.pendingProps,Jn),d!==null?(l.stateNode=d,zt=l,nt=null,r=!0):r=!1),r||Ns(l)),null;case 13:return iy(r,l,d);case 4:return kt(l,l.stateNode.containerInfo),f=l.pendingProps,r===null?l.child=Io(l,null,f,d):Ht(r,l,f,d),l.child;case 11:return K0(r,l,l.type,l.pendingProps,d);case 7:return Ht(r,l,l.pendingProps,d),l.child;case 8:return Ht(r,l,l.pendingProps.children,d),l.child;case 12:return Ht(r,l,l.pendingProps.children,d),l.child;case 10:return f=l.pendingProps,Ls(l,l.type,f.value),Ht(r,l,f.children,d),l.child;case 9:return p=l.type._context,f=l.pendingProps.children,Eo(l),p=Ut(p),f=f(p),l.flags|=1,Ht(r,l,f,d),l.child;case 14:return Y0(r,l,l.type,l.pendingProps,d);case 15:return J0(r,l,l.type,l.pendingProps,d);case 19:return oy(r,l,d);case 31:return D5(r,l,d);case 22:return Q0(r,l,d,l.pendingProps);case 24:return Eo(l),f=Ut(Tt),r===null?(p=Jf(),p===null&&(p=Qe,b=Kf(),p.pooledCache=b,b.refCount++,b!==null&&(p.pooledCacheLanes|=d),p=b),l.memoizedState={parent:f,cache:p},Xf(l),Ls(l,Tt,p)):((r.lanes&d)!==0&&(Zf(r,l),Xa(l,null,null,d),Qa()),p=r.memoizedState,b=l.memoizedState,p.parent!==f?(p={parent:f,cache:f},l.memoizedState=p,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=p),Ls(l,Tt,f)):(f=b.cache,Ls(l,Tt,f),f!==p.cache&&Gf(l,[Tt],d,!0))),Ht(r,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function ts(r){r.flags|=4}function Bm(r,l,d,f,p){if((l=(r.mode&32)!==0)&&(l=!1),l){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(Vy())r.flags|=8192;else throw xo=fu,Qf}else r.flags&=-16777217}function ay(r,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Cv(l))if(Vy())r.flags|=8192;else throw xo=fu,Qf}function Pu(r,l){l!==null&&(r.flags|=4),r.flags&16384&&(l=r.tag!==22?zw():536870912,r.lanes|=l,Hr|=l)}function sl(r,l){if(!Oe)switch(r.tailMode){case"hidden":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function it(r){var l=r.alternate!==null&&r.alternate.child===r.child,d=0,f=0;if(l)for(var p=r.child;p!==null;)d|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)d|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=f,r.childLanes=d,l}function z5(r,l,d){var f=l.pendingProps;switch(Hf(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(l),null;case 1:return it(l),null;case 3:return d=l.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Qi(Tt),We(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(r===null||r.child===null)&&(Ir(l)?ts(l):r===null||r.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,qf())),it(l),null;case 26:var p=l.type,b=l.memoizedState;return r===null?(ts(l),b!==null?(it(l),ay(l,b)):(it(l),Bm(l,p,null,f,d))):b?b!==r.memoizedState?(ts(l),it(l),ay(l,b)):(it(l),l.flags&=-16777217):(r=r.memoizedProps,r!==f&&ts(l),it(l),Bm(l,p,r,f,d)),null;case 27:if(qi(l),d=ye.current,p=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&ts(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return it(l),null}r=ae.current,Ir(l)?z_(l):(r=mv(p,f,d),l.stateNode=r,ts(l))}return it(l),null;case 5:if(qi(l),p=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==f&&ts(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return it(l),null}if(b=ae.current,Ir(l))z_(l);else{var y=Wu(ye.current);switch(b){case 1:b=y.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:b=y.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":b=y.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":b=y.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":b=y.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof f.is=="string"?y.createElement("select",{is:f.is}):y.createElement("select"),f.multiple?b.multiple=!0:f.size&&(b.size=f.size);break;default:b=typeof f.is=="string"?y.createElement(p,{is:f.is}):y.createElement(p)}}b[Ft]=l,b[ln]=f;e:for(y=l.child;y!==null;){if(y.tag===5||y.tag===6)b.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===l)break e;for(;y.sibling===null;){if(y.return===null||y.return===l)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}l.stateNode=b;e:switch(jt(b,p,f),p){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ts(l)}}return it(l),Bm(l,l.type,r===null?null:r.memoizedProps,l.pendingProps,d),null;case 6:if(r&&l.stateNode!=null)r.memoizedProps!==f&&ts(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(n(166));if(r=ye.current,Ir(l)){if(r=l.stateNode,d=l.memoizedProps,f=null,p=zt,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}r[Ft]=l,r=!!(r.nodeValue===d||f!==null&&f.suppressHydrationWarning===!0||iv(r.nodeValue,d)),r||Ns(l,!0)}else r=Wu(r).createTextNode(f),r[Ft]=l,l.stateNode=r}return it(l),null;case 31:if(d=l.memoizedState,r===null||r.memoizedState!==null){if(f=Ir(l),d!==null){if(r===null){if(!f)throw Error(n(318));if(r=l.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Ft]=l}else ko(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;it(l),r=!1}else d=qf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=d),r=!0;if(!r)return l.flags&256?(Pn(l),l):(Pn(l),null);if((l.flags&128)!==0)throw Error(n(558))}return it(l),null;case 13:if(f=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=Ir(l),f!==null&&f.dehydrated!==null){if(r===null){if(!p)throw Error(n(318));if(p=l.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[Ft]=l}else ko(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;it(l),p=!1}else p=qf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return l.flags&256?(Pn(l),l):(Pn(l),null)}return Pn(l),(l.flags&128)!==0?(l.lanes=d,l):(d=f!==null,r=r!==null&&r.memoizedState!==null,d&&(f=l.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool),b=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==p&&(f.flags|=2048)),d!==r&&d&&(l.child.flags|=8192),Pu(l,l.updateQueue),it(l),null);case 4:return We(),r===null&&ng(l.stateNode.containerInfo),it(l),null;case 10:return Qi(l.type),it(l),null;case 19:if($(pt),f=l.memoizedState,f===null)return it(l),null;if(p=(l.flags&128)!==0,b=f.rendering,b===null)if(p)sl(f,!1);else{if(mt!==0||r!==null&&(r.flags&128)!==0)for(r=l.child;r!==null;){if(b=bu(r),b!==null){for(l.flags|=128,sl(f,!1),r=b.updateQueue,l.updateQueue=r,Pu(l,r),l.subtreeFlags=0,r=d,d=l.child;d!==null;)M_(d,r),d=d.sibling;return te(pt,pt.current&1|2),Oe&&Yi(l,f.treeForkCount),l.child}r=r.sibling}f.tail!==null&&Tn()>Mu&&(l.flags|=128,p=!0,sl(f,!1),l.lanes=4194304)}else{if(!p)if(r=bu(b),r!==null){if(l.flags|=128,p=!0,r=r.updateQueue,l.updateQueue=r,Pu(l,r),sl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!b.alternate&&!Oe)return it(l),null}else 2*Tn()-f.renderingStartTime>Mu&&d!==536870912&&(l.flags|=128,p=!0,sl(f,!1),l.lanes=4194304);f.isBackwards?(b.sibling=l.child,l.child=b):(r=f.last,r!==null?r.sibling=b:l.child=b,f.last=b)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=Tn(),r.sibling=null,d=pt.current,te(pt,p?d&1|2:d&1),Oe&&Yi(l,f.treeForkCount),r):(it(l),null);case 22:case 23:return Pn(l),im(),f=l.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(d&536870912)!==0&&(l.flags&128)===0&&(it(l),l.subtreeFlags&6&&(l.flags|=8192)):it(l),d=l.updateQueue,d!==null&&Pu(l,d.retryQueue),d=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==d&&(l.flags|=2048),r!==null&&$(So),null;case 24:return d=null,r!==null&&(d=r.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Qi(Tt),it(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function U5(r,l){switch(Hf(l),l.tag){case 1:return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return Qi(Tt),We(),r=l.flags,(r&65536)!==0&&(r&128)===0?(l.flags=r&-65537|128,l):null;case 26:case 27:case 5:return qi(l),null;case 31:if(l.memoizedState!==null){if(Pn(l),l.alternate===null)throw Error(n(340));ko()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 13:if(Pn(l),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(n(340));ko()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return $(pt),null;case 4:return We(),null;case 10:return Qi(l.type),null;case 22:case 23:return Pn(l),im(),r!==null&&$(So),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 24:return Qi(Tt),null;case 25:return null;default:return null}}function ly(r,l){switch(Hf(l),l.tag){case 3:Qi(Tt),We();break;case 26:case 27:case 5:qi(l);break;case 4:We();break;case 31:l.memoizedState!==null&&Pn(l);break;case 13:Pn(l);break;case 19:$(pt);break;case 10:Qi(l.type);break;case 22:case 23:Pn(l),im(),r!==null&&$(So);break;case 24:Qi(Tt)}}function ol(r,l){try{var d=l.updateQueue,f=d!==null?d.lastEffect:null;if(f!==null){var p=f.next;d=p;do{if((d.tag&r)===r){f=void 0;var b=d.create,y=d.inst;f=b(),y.destroy=f}d=d.next}while(d!==p)}}catch(k){He(l,l.return,k)}}function js(r,l,d){try{var f=l.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var b=p.next;f=b;do{if((f.tag&r)===r){var y=f.inst,k=y.destroy;if(k!==void 0){y.destroy=void 0,p=l;var S=d,B=k;try{B()}catch(q){He(p,S,q)}}}f=f.next}while(f!==b)}}catch(q){He(l,l.return,q)}}function cy(r){var l=r.updateQueue;if(l!==null){var d=r.stateNode;try{Z_(l,d)}catch(f){He(r,r.return,f)}}}function uy(r,l,d){d.props=Ro(r.type,r.memoizedProps),d.state=r.memoizedState;try{d.componentWillUnmount()}catch(f){He(r,l,f)}}function rl(r,l){try{var d=r.ref;if(d!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof d=="function"?r.refCleanup=d(f):d.current=f}}catch(p){He(r,l,p)}}function Si(r,l){var d=r.ref,f=r.refCleanup;if(d!==null)if(typeof f=="function")try{f()}catch(p){He(r,l,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(p){He(r,l,p)}else d.current=null}function dy(r){var l=r.type,d=r.memoizedProps,f=r.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&f.focus();break e;case"img":d.src?f.src=d.src:d.srcSet&&(f.srcset=d.srcSet)}}catch(p){He(r,r.return,p)}}function Mm(r,l,d){try{var f=r.stateNode;cI(f,r.type,d,l),f[ln]=l}catch(p){He(r,r.return,p)}}function hy(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Js(r.type)||r.tag===4}function Nm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||hy(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Js(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Lm(r,l,d){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(r,l):(l=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,l.appendChild(r),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=$i));else if(f!==4&&(f===27&&Js(r.type)&&(d=r.stateNode,l=null),r=r.child,r!==null))for(Lm(r,l,d),r=r.sibling;r!==null;)Lm(r,l,d),r=r.sibling}function Ru(r,l,d){var f=r.tag;if(f===5||f===6)r=r.stateNode,l?d.insertBefore(r,l):d.appendChild(r);else if(f!==4&&(f===27&&Js(r.type)&&(d=r.stateNode),r=r.child,r!==null))for(Ru(r,l,d),r=r.sibling;r!==null;)Ru(r,l,d),r=r.sibling}function fy(r){var l=r.stateNode,d=r.memoizedProps;try{for(var f=r.type,p=l.attributes;p.length;)l.removeAttributeNode(p[0]);jt(l,f,d),l[Ft]=r,l[ln]=d}catch(b){He(r,r.return,b)}}var ns=!1,At=!1,Dm=!1,my=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function H5(r,l){if(r=r.containerInfo,og=Xu,r=S_(r),Rf(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var f=d.getSelection&&d.getSelection();if(f&&f.rangeCount!==0){d=f.anchorNode;var p=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var y=0,k=-1,S=-1,B=0,q=0,G=r,D=null;t:for(;;){for(var U;G!==d||p!==0&&G.nodeType!==3||(k=y+p),G!==b||f!==0&&G.nodeType!==3||(S=y+f),G.nodeType===3&&(y+=G.nodeValue.length),(U=G.firstChild)!==null;)D=G,G=U;for(;;){if(G===r)break t;if(D===d&&++B===p&&(k=y),D===b&&++q===f&&(S=y),(U=G.nextSibling)!==null)break;G=D,D=G.parentNode}G=U}d=k===-1||S===-1?null:{start:k,end:S}}else d=null}d=d||{start:0,end:0}}else d=null;for(rg={focusedElem:r,selectionRange:d},Xu=!1,Mt=l;Mt!==null;)if(l=Mt,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,Mt=r;else for(;Mt!==null;){switch(l=Mt,b=l.alternate,r=l.flags,l.tag){case 0:if((r&4)!==0&&(r=l.updateQueue,r=r!==null?r.events:null,r!==null))for(d=0;d<r.length;d++)p=r[d],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,d=l,p=b.memoizedProps,b=b.memoizedState,f=d.stateNode;try{var re=Ro(d.type,p);r=f.getSnapshotBeforeUpdate(re,b),f.__reactInternalSnapshotBeforeUpdate=r}catch(fe){He(d,d.return,fe)}}break;case 3:if((r&1024)!==0){if(r=l.stateNode.containerInfo,d=r.nodeType,d===9)cg(r);else if(d===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":cg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=l.sibling,r!==null){r.return=l.return,Mt=r;break}Mt=l.return}}function gy(r,l,d){var f=d.flags;switch(d.tag){case 0:case 11:case 15:ss(r,d),f&4&&ol(5,d);break;case 1:if(ss(r,d),f&4)if(r=d.stateNode,l===null)try{r.componentDidMount()}catch(y){He(d,d.return,y)}else{var p=Ro(d.type,l.memoizedProps);l=l.memoizedState;try{r.componentDidUpdate(p,l,r.__reactInternalSnapshotBeforeUpdate)}catch(y){He(d,d.return,y)}}f&64&&cy(d),f&512&&rl(d,d.return);break;case 3:if(ss(r,d),f&64&&(r=d.updateQueue,r!==null)){if(l=null,d.child!==null)switch(d.child.tag){case 27:case 5:l=d.child.stateNode;break;case 1:l=d.child.stateNode}try{Z_(r,l)}catch(y){He(d,d.return,y)}}break;case 27:l===null&&f&4&&fy(d);case 26:case 5:ss(r,d),l===null&&f&4&&dy(d),f&512&&rl(d,d.return);break;case 12:ss(r,d);break;case 31:ss(r,d),f&4&&wy(r,d);break;case 13:ss(r,d),f&4&&_y(r,d),f&64&&(r=d.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(d=Q5.bind(null,d),bI(r,d))));break;case 22:if(f=d.memoizedState!==null||ns,!f){l=l!==null&&l.memoizedState!==null||At,p=ns;var b=At;ns=f,(At=l)&&!b?os(r,d,(d.subtreeFlags&8772)!==0):ss(r,d),ns=p,At=b}break;case 30:break;default:ss(r,d)}}function py(r){var l=r.alternate;l!==null&&(r.alternate=null,py(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&mf(l)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var at=null,un=!1;function is(r,l,d){for(d=d.child;d!==null;)by(r,l,d),d=d.sibling}function by(r,l,d){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Pa,d)}catch{}switch(d.tag){case 26:At||Si(d,l),is(r,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:At||Si(d,l);var f=at,p=un;Js(d.type)&&(at=d.stateNode,un=!1),is(r,l,d),gl(d.stateNode),at=f,un=p;break;case 5:At||Si(d,l);case 6:if(f=at,p=un,at=null,is(r,l,d),at=f,un=p,at!==null)if(un)try{(at.nodeType===9?at.body:at.nodeName==="HTML"?at.ownerDocument.body:at).removeChild(d.stateNode)}catch(b){He(d,l,b)}else try{at.removeChild(d.stateNode)}catch(b){He(d,l,b)}break;case 18:at!==null&&(un?(r=at,cv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,d.stateNode),Jr(r)):cv(at,d.stateNode));break;case 4:f=at,p=un,at=d.stateNode.containerInfo,un=!0,is(r,l,d),at=f,un=p;break;case 0:case 11:case 14:case 15:js(2,d,l),At||js(4,d,l),is(r,l,d);break;case 1:At||(Si(d,l),f=d.stateNode,typeof f.componentWillUnmount=="function"&&uy(d,l,f)),is(r,l,d);break;case 21:is(r,l,d);break;case 22:At=(f=At)||d.memoizedState!==null,is(r,l,d),At=f;break;default:is(r,l,d)}}function wy(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Jr(r)}catch(d){He(l,l.return,d)}}}function _y(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Jr(r)}catch(d){He(l,l.return,d)}}function j5(r){switch(r.tag){case 31:case 13:case 19:var l=r.stateNode;return l===null&&(l=r.stateNode=new my),l;case 22:return r=r.stateNode,l=r._retryCache,l===null&&(l=r._retryCache=new my),l;default:throw Error(n(435,r.tag))}}function Ou(r,l){var d=j5(r);l.forEach(function(f){if(!d.has(f)){d.add(f);var p=X5.bind(null,r,f);f.then(p,p)}})}function dn(r,l){var d=l.deletions;if(d!==null)for(var f=0;f<d.length;f++){var p=d[f],b=r,y=l,k=y;e:for(;k!==null;){switch(k.tag){case 27:if(Js(k.type)){at=k.stateNode,un=!1;break e}break;case 5:at=k.stateNode,un=!1;break e;case 3:case 4:at=k.stateNode.containerInfo,un=!0;break e}k=k.return}if(at===null)throw Error(n(160));by(b,y,p),at=null,un=!1,b=p.alternate,b!==null&&(b.return=null),p.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)yy(l,r),l=l.sibling}var ci=null;function yy(r,l){var d=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:dn(l,r),hn(r),f&4&&(js(3,r,r.return),ol(3,r),js(5,r,r.return));break;case 1:dn(l,r),hn(r),f&512&&(At||d===null||Si(d,d.return)),f&64&&ns&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(d=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=d===null?f:d.concat(f))));break;case 26:var p=ci;if(dn(l,r),hn(r),f&512&&(At||d===null||Si(d,d.return)),f&4){var b=d!==null?d.memoizedState:null;if(f=r.memoizedState,d===null)if(f===null)if(r.stateNode===null){e:{f=r.type,d=r.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":b=p.getElementsByTagName("title")[0],(!b||b[Va]||b[Ft]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=p.createElement(f),p.head.insertBefore(b,p.querySelector("head > title"))),jt(b,f,d),b[Ft]=r,Bt(b),f=b;break e;case"link":var y=yv("link","href",p).get(f+(d.href||""));if(y){for(var k=0;k<y.length;k++)if(b=y[k],b.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&b.getAttribute("rel")===(d.rel==null?null:d.rel)&&b.getAttribute("title")===(d.title==null?null:d.title)&&b.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){y.splice(k,1);break t}}b=p.createElement(f),jt(b,f,d),p.head.appendChild(b);break;case"meta":if(y=yv("meta","content",p).get(f+(d.content||""))){for(k=0;k<y.length;k++)if(b=y[k],b.getAttribute("content")===(d.content==null?null:""+d.content)&&b.getAttribute("name")===(d.name==null?null:d.name)&&b.getAttribute("property")===(d.property==null?null:d.property)&&b.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&b.getAttribute("charset")===(d.charSet==null?null:d.charSet)){y.splice(k,1);break t}}b=p.createElement(f),jt(b,f,d),p.head.appendChild(b);break;default:throw Error(n(468,f))}b[Ft]=r,Bt(b),f=b}r.stateNode=f}else vv(p,r.type,r.stateNode);else r.stateNode=_v(p,f,r.memoizedProps);else b!==f?(b===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):b.count--,f===null?vv(p,r.type,r.stateNode):_v(p,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Mm(r,r.memoizedProps,d.memoizedProps)}break;case 27:dn(l,r),hn(r),f&512&&(At||d===null||Si(d,d.return)),d!==null&&f&4&&Mm(r,r.memoizedProps,d.memoizedProps);break;case 5:if(dn(l,r),hn(r),f&512&&(At||d===null||Si(d,d.return)),r.flags&32){p=r.stateNode;try{_r(p,"")}catch(re){He(r,r.return,re)}}f&4&&r.stateNode!=null&&(p=r.memoizedProps,Mm(r,p,d!==null?d.memoizedProps:p)),f&1024&&(Dm=!0);break;case 6:if(dn(l,r),hn(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,d=r.stateNode;try{d.nodeValue=f}catch(re){He(r,r.return,re)}}break;case 3:if(Ku=null,p=ci,ci=$u(l.containerInfo),dn(l,r),ci=p,hn(r),f&4&&d!==null&&d.memoizedState.isDehydrated)try{Jr(l.containerInfo)}catch(re){He(r,r.return,re)}Dm&&(Dm=!1,vy(r));break;case 4:f=ci,ci=$u(r.stateNode.containerInfo),dn(l,r),hn(r),ci=f;break;case 12:dn(l,r),hn(r);break;case 31:dn(l,r),hn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ou(r,f)));break;case 13:dn(l,r),hn(r),r.child.flags&8192&&r.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Bu=Tn()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ou(r,f)));break;case 22:p=r.memoizedState!==null;var S=d!==null&&d.memoizedState!==null,B=ns,q=At;if(ns=B||p,At=q||S,dn(l,r),At=q,ns=B,hn(r),f&8192)e:for(l=r.stateNode,l._visibility=p?l._visibility&-2:l._visibility|1,p&&(d===null||S||ns||At||Oo(r)),d=null,l=r;;){if(l.tag===5||l.tag===26){if(d===null){S=d=l;try{if(b=S.stateNode,p)y=b.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{k=S.stateNode;var G=S.memoizedProps.style,D=G!=null&&G.hasOwnProperty("display")?G.display:null;k.style.display=D==null||typeof D=="boolean"?"":(""+D).trim()}}catch(re){He(S,S.return,re)}}}else if(l.tag===6){if(d===null){S=l;try{S.stateNode.nodeValue=p?"":S.memoizedProps}catch(re){He(S,S.return,re)}}}else if(l.tag===18){if(d===null){S=l;try{var U=S.stateNode;p?uv(U,!0):uv(S.stateNode,!1)}catch(re){He(S,S.return,re)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===r)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break e;for(;l.sibling===null;){if(l.return===null||l.return===r)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=r.updateQueue,f!==null&&(d=f.retryQueue,d!==null&&(f.retryQueue=null,Ou(r,d))));break;case 19:dn(l,r),hn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Ou(r,f)));break;case 30:break;case 21:break;default:dn(l,r),hn(r)}}function hn(r){var l=r.flags;if(l&2){try{for(var d,f=r.return;f!==null;){if(hy(f)){d=f;break}f=f.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var p=d.stateNode,b=Nm(r);Ru(r,b,p);break;case 5:var y=d.stateNode;d.flags&32&&(_r(y,""),d.flags&=-33);var k=Nm(r);Ru(r,k,y);break;case 3:case 4:var S=d.stateNode.containerInfo,B=Nm(r);Lm(r,B,S);break;default:throw Error(n(161))}}catch(q){He(r,r.return,q)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function vy(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var l=r;vy(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),r=r.sibling}}function ss(r,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)gy(r,l.alternate,l),l=l.sibling}function Oo(r){for(r=r.child;r!==null;){var l=r;switch(l.tag){case 0:case 11:case 14:case 15:js(4,l,l.return),Oo(l);break;case 1:Si(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&uy(l,l.return,d),Oo(l);break;case 27:gl(l.stateNode);case 26:case 5:Si(l,l.return),Oo(l);break;case 22:l.memoizedState===null&&Oo(l);break;case 30:Oo(l);break;default:Oo(l)}r=r.sibling}}function os(r,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,p=r,b=l,y=b.flags;switch(b.tag){case 0:case 11:case 15:os(p,b,d),ol(4,b);break;case 1:if(os(p,b,d),f=b,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(B){He(f,f.return,B)}if(f=b,p=f.updateQueue,p!==null){var k=f.stateNode;try{var S=p.shared.hiddenCallbacks;if(S!==null)for(p.shared.hiddenCallbacks=null,p=0;p<S.length;p++)X_(S[p],k)}catch(B){He(f,f.return,B)}}d&&y&64&&cy(b),rl(b,b.return);break;case 27:fy(b);case 26:case 5:os(p,b,d),d&&f===null&&y&4&&dy(b),rl(b,b.return);break;case 12:os(p,b,d);break;case 31:os(p,b,d),d&&y&4&&wy(p,b);break;case 13:os(p,b,d),d&&y&4&&_y(p,b);break;case 22:b.memoizedState===null&&os(p,b,d),rl(b,b.return);break;case 30:break;default:os(p,b,d)}l=l.sibling}}function Fm(r,l){var d=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==d&&(r!=null&&r.refCount++,d!=null&&$a(d))}function zm(r,l){r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&$a(r))}function ui(r,l,d,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Cy(r,l,d,f),l=l.sibling}function Cy(r,l,d,f){var p=l.flags;switch(l.tag){case 0:case 11:case 15:ui(r,l,d,f),p&2048&&ol(9,l);break;case 1:ui(r,l,d,f);break;case 3:ui(r,l,d,f),p&2048&&(r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&$a(r)));break;case 12:if(p&2048){ui(r,l,d,f),r=l.stateNode;try{var b=l.memoizedProps,y=b.id,k=b.onPostCommit;typeof k=="function"&&k(y,l.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(S){He(l,l.return,S)}}else ui(r,l,d,f);break;case 31:ui(r,l,d,f);break;case 13:ui(r,l,d,f);break;case 23:break;case 22:b=l.stateNode,y=l.alternate,l.memoizedState!==null?b._visibility&2?ui(r,l,d,f):al(r,l):b._visibility&2?ui(r,l,d,f):(b._visibility|=2,Fr(r,l,d,f,(l.subtreeFlags&10256)!==0||!1)),p&2048&&Fm(y,l);break;case 24:ui(r,l,d,f),p&2048&&zm(l.alternate,l);break;default:ui(r,l,d,f)}}function Fr(r,l,d,f,p){for(p=p&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var b=r,y=l,k=d,S=f,B=y.flags;switch(y.tag){case 0:case 11:case 15:Fr(b,y,k,S,p),ol(8,y);break;case 23:break;case 22:var q=y.stateNode;y.memoizedState!==null?q._visibility&2?Fr(b,y,k,S,p):al(b,y):(q._visibility|=2,Fr(b,y,k,S,p)),p&&B&2048&&Fm(y.alternate,y);break;case 24:Fr(b,y,k,S,p),p&&B&2048&&zm(y.alternate,y);break;default:Fr(b,y,k,S,p)}l=l.sibling}}function al(r,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=r,f=l,p=f.flags;switch(f.tag){case 22:al(d,f),p&2048&&Fm(f.alternate,f);break;case 24:al(d,f),p&2048&&zm(f.alternate,f);break;default:al(d,f)}l=l.sibling}}var ll=8192;function zr(r,l,d){if(r.subtreeFlags&ll)for(r=r.child;r!==null;)ky(r,l,d),r=r.sibling}function ky(r,l,d){switch(r.tag){case 26:zr(r,l,d),r.flags&ll&&r.memoizedState!==null&&II(d,ci,r.memoizedState,r.memoizedProps);break;case 5:zr(r,l,d);break;case 3:case 4:var f=ci;ci=$u(r.stateNode.containerInfo),zr(r,l,d),ci=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=ll,ll=16777216,zr(r,l,d),ll=f):zr(r,l,d));break;default:zr(r,l,d)}}function Ty(r){var l=r.alternate;if(l!==null&&(r=l.child,r!==null)){l.child=null;do l=r.sibling,r.sibling=null,r=l;while(r!==null)}}function cl(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var f=l[d];Mt=f,Sy(f,r)}Ty(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Ey(r),r=r.sibling}function Ey(r){switch(r.tag){case 0:case 11:case 15:cl(r),r.flags&2048&&js(9,r,r.return);break;case 3:cl(r);break;case 12:cl(r);break;case 22:var l=r.stateNode;r.memoizedState!==null&&l._visibility&2&&(r.return===null||r.return.tag!==13)?(l._visibility&=-3,Vu(r)):cl(r);break;default:cl(r)}}function Vu(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var f=l[d];Mt=f,Sy(f,r)}Ty(r)}for(r=r.child;r!==null;){switch(l=r,l.tag){case 0:case 11:case 15:js(8,l,l.return),Vu(l);break;case 22:d=l.stateNode,d._visibility&2&&(d._visibility&=-3,Vu(l));break;default:Vu(l)}r=r.sibling}}function Sy(r,l){for(;Mt!==null;){var d=Mt;switch(d.tag){case 0:case 11:case 15:js(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var f=d.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:$a(d.memoizedState.cache)}if(f=d.child,f!==null)f.return=d,Mt=f;else e:for(d=r;Mt!==null;){f=Mt;var p=f.sibling,b=f.return;if(py(f),f===d){Mt=null;break e}if(p!==null){p.return=b,Mt=p;break e}Mt=b}}}var q5={getCacheForType:function(r){var l=Ut(Tt),d=l.data.get(r);return d===void 0&&(d=r(),l.data.set(r,d)),d},cacheSignal:function(){return Ut(Tt).controller.signal}},W5=typeof WeakMap=="function"?WeakMap:Map,ze=0,Qe=null,Se=null,xe=0,Ue=0,Rn=null,qs=!1,Ur=!1,Um=!1,rs=0,mt=0,Ws=0,Vo=0,Hm=0,On=0,Hr=0,ul=null,fn=null,jm=!1,Bu=0,Ay=0,Mu=1/0,Nu=null,$s=null,Pt=0,Gs=null,jr=null,as=0,qm=0,Wm=null,xy=null,dl=0,$m=null;function Vn(){return(ze&2)!==0&&xe!==0?xe&-xe:H.T!==null?Xm():qw()}function Iy(){if(On===0)if((xe&536870912)===0||Oe){var r=qc;qc<<=1,(qc&3932160)===0&&(qc=262144),On=r}else On=536870912;return r=In.current,r!==null&&(r.flags|=32),On}function mn(r,l,d){(r===Qe&&(Ue===2||Ue===9)||r.cancelPendingCommit!==null)&&(qr(r,0),Ks(r,xe,On,!1)),Oa(r,d),((ze&2)===0||r!==Qe)&&(r===Qe&&((ze&2)===0&&(Vo|=d),mt===4&&Ks(r,xe,On,!1)),Ai(r))}function Py(r,l,d){if((ze&6)!==0)throw Error(n(327));var f=!d&&(l&127)===0&&(l&r.expiredLanes)===0||Ra(r,l),p=f?K5(r,l):Km(r,l,!0),b=f;do{if(p===0){Ur&&!f&&Ks(r,l,0,!1);break}else{if(d=r.current.alternate,b&&!$5(d)){p=Km(r,l,!1),b=!1;continue}if(p===2){if(b=l,r.errorRecoveryDisabledLanes&b)var y=0;else y=r.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){l=y;e:{var k=r;p=ul;var S=k.current.memoizedState.isDehydrated;if(S&&(qr(k,y).flags|=256),y=Km(k,y,!1),y!==2){if(Um&&!S){k.errorRecoveryDisabledLanes|=b,Vo|=b,p=4;break e}b=fn,fn=p,b!==null&&(fn===null?fn=b:fn.push.apply(fn,b))}p=y}if(b=!1,p!==2)continue}}if(p===1){qr(r,0),Ks(r,l,0,!0);break}e:{switch(f=r,b=p,b){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Ks(f,l,On,!qs);break e;case 2:fn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(p=Bu+300-Tn(),10<p)){if(Ks(f,l,On,!qs),$c(f,0,!0)!==0)break e;as=l,f.timeoutHandle=av(Ry.bind(null,f,d,fn,Nu,jm,l,On,Vo,Hr,qs,b,"Throttled",-0,0),p);break e}Ry(f,d,fn,Nu,jm,l,On,Vo,Hr,qs,b,null,-0,0)}}break}while(!0);Ai(r)}function Ry(r,l,d,f,p,b,y,k,S,B,q,G,D,U){if(r.timeoutHandle=-1,G=l.subtreeFlags,G&8192||(G&16785408)===16785408){G={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$i},ky(l,b,G);var re=(b&62914560)===b?Bu-Tn():(b&4194048)===b?Ay-Tn():0;if(re=PI(G,re),re!==null){as=b,r.cancelPendingCommit=re(Fy.bind(null,r,l,b,d,f,p,y,k,S,q,G,null,D,U)),Ks(r,b,y,!B);return}}Fy(r,l,b,d,f,p,y,k,S)}function $5(r){for(var l=r;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var f=0;f<d.length;f++){var p=d[f],b=p.getSnapshot;p=p.value;try{if(!An(b(),p))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ks(r,l,d,f){l&=~Hm,l&=~Vo,r.suspendedLanes|=l,r.pingedLanes&=~l,f&&(r.warmLanes|=l),f=r.expirationTimes;for(var p=l;0<p;){var b=31-Sn(p),y=1<<b;f[b]=-1,p&=~y}d!==0&&Uw(r,d,l)}function Lu(){return(ze&6)===0?(hl(0),!1):!0}function Gm(){if(Se!==null){if(Ue===0)var r=Se.return;else r=Se,Ji=To=null,cm(r),Br=null,Ka=0,r=Se;for(;r!==null;)ly(r.alternate,r),r=r.return;Se=null}}function qr(r,l){var d=r.timeoutHandle;d!==-1&&(r.timeoutHandle=-1,hI(d)),d=r.cancelPendingCommit,d!==null&&(r.cancelPendingCommit=null,d()),as=0,Gm(),Qe=r,Se=d=Ki(r.current,null),xe=l,Ue=0,Rn=null,qs=!1,Ur=Ra(r,l),Um=!1,Hr=On=Hm=Vo=Ws=mt=0,fn=ul=null,jm=!1,(l&8)!==0&&(l|=l&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=l;0<f;){var p=31-Sn(f),b=1<<p;l|=r[p],f&=~b}return rs=l,su(),d}function Oy(r,l){ve=null,H.H=nl,l===Vr||l===hu?(l=K_(),Ue=3):l===Qf?(l=K_(),Ue=4):Ue=l===Em?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Rn=l,Se===null&&(mt=1,Su(r,Gn(l,r.current)))}function Vy(){var r=In.current;return r===null?!0:(xe&4194048)===xe?Qn===null:(xe&62914560)===xe||(xe&536870912)!==0?r===Qn:!1}function By(){var r=H.H;return H.H=nl,r===null?nl:r}function My(){var r=H.A;return H.A=q5,r}function Du(){mt=4,qs||(xe&4194048)!==xe&&In.current!==null||(Ur=!0),(Ws&134217727)===0&&(Vo&134217727)===0||Qe===null||Ks(Qe,xe,On,!1)}function Km(r,l,d){var f=ze;ze|=2;var p=By(),b=My();(Qe!==r||xe!==l)&&(Nu=null,qr(r,l)),l=!1;var y=mt;e:do try{if(Ue!==0&&Se!==null){var k=Se,S=Rn;switch(Ue){case 8:Gm(),y=6;break e;case 3:case 2:case 9:case 6:In.current===null&&(l=!0);var B=Ue;if(Ue=0,Rn=null,Wr(r,k,S,B),d&&Ur){y=0;break e}break;default:B=Ue,Ue=0,Rn=null,Wr(r,k,S,B)}}G5(),y=mt;break}catch(q){Oy(r,q)}while(!0);return l&&r.shellSuspendCounter++,Ji=To=null,ze=f,H.H=p,H.A=b,Se===null&&(Qe=null,xe=0,su()),y}function G5(){for(;Se!==null;)Ny(Se)}function K5(r,l){var d=ze;ze|=2;var f=By(),p=My();Qe!==r||xe!==l?(Nu=null,Mu=Tn()+500,qr(r,l)):Ur=Ra(r,l);e:do try{if(Ue!==0&&Se!==null){l=Se;var b=Rn;t:switch(Ue){case 1:Ue=0,Rn=null,Wr(r,l,b,1);break;case 2:case 9:if($_(b)){Ue=0,Rn=null,Ly(l);break}l=function(){Ue!==2&&Ue!==9||Qe!==r||(Ue=7),Ai(r)},b.then(l,l);break e;case 3:Ue=7;break e;case 4:Ue=5;break e;case 7:$_(b)?(Ue=0,Rn=null,Ly(l)):(Ue=0,Rn=null,Wr(r,l,b,7));break;case 5:var y=null;switch(Se.tag){case 26:y=Se.memoizedState;case 5:case 27:var k=Se;if(y?Cv(y):k.stateNode.complete){Ue=0,Rn=null;var S=k.sibling;if(S!==null)Se=S;else{var B=k.return;B!==null?(Se=B,Fu(B)):Se=null}break t}}Ue=0,Rn=null,Wr(r,l,b,5);break;case 6:Ue=0,Rn=null,Wr(r,l,b,6);break;case 8:Gm(),mt=6;break e;default:throw Error(n(462))}}Y5();break}catch(q){Oy(r,q)}while(!0);return Ji=To=null,H.H=f,H.A=p,ze=d,Se!==null?0:(Qe=null,xe=0,su(),mt)}function Y5(){for(;Se!==null&&!wx();)Ny(Se)}function Ny(r){var l=ry(r.alternate,r,rs);r.memoizedProps=r.pendingProps,l===null?Fu(r):Se=l}function Ly(r){var l=r,d=l.alternate;switch(l.tag){case 15:case 0:l=ey(d,l,l.pendingProps,l.type,void 0,xe);break;case 11:l=ey(d,l,l.pendingProps,l.type.render,l.ref,xe);break;case 5:cm(l);default:ly(d,l),l=Se=M_(l,rs),l=ry(d,l,rs)}r.memoizedProps=r.pendingProps,l===null?Fu(r):Se=l}function Wr(r,l,d,f){Ji=To=null,cm(l),Br=null,Ka=0;var p=l.return;try{if(L5(r,p,l,d,xe)){mt=1,Su(r,Gn(d,r.current)),Se=null;return}}catch(b){if(p!==null)throw Se=p,b;mt=1,Su(r,Gn(d,r.current)),Se=null;return}l.flags&32768?(Oe||f===1?r=!0:Ur||(xe&536870912)!==0?r=!1:(qs=r=!0,(f===2||f===9||f===3||f===6)&&(f=In.current,f!==null&&f.tag===13&&(f.flags|=16384))),Dy(l,r)):Fu(l)}function Fu(r){var l=r;do{if((l.flags&32768)!==0){Dy(l,qs);return}r=l.return;var d=z5(l.alternate,l,rs);if(d!==null){Se=d;return}if(l=l.sibling,l!==null){Se=l;return}Se=l=r}while(l!==null);mt===0&&(mt=5)}function Dy(r,l){do{var d=U5(r.alternate,r);if(d!==null){d.flags&=32767,Se=d;return}if(d=r.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(r=r.sibling,r!==null)){Se=r;return}Se=r=d}while(r!==null);mt=6,Se=null}function Fy(r,l,d,f,p,b,y,k,S){r.cancelPendingCommit=null;do zu();while(Pt!==0);if((ze&6)!==0)throw Error(n(327));if(l!==null){if(l===r.current)throw Error(n(177));if(b=l.lanes|l.childLanes,b|=Nf,xx(r,d,b,y,k,S),r===Qe&&(Se=Qe=null,xe=0),jr=l,Gs=r,as=d,qm=b,Wm=p,xy=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Z5(Hc,function(){return qy(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=H.T,H.T=null,p=X.p,X.p=2,y=ze,ze|=4;try{H5(r,l,d)}finally{ze=y,X.p=p,H.T=f}}Pt=1,zy(),Uy(),Hy()}}function zy(){if(Pt===1){Pt=0;var r=Gs,l=jr,d=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||d){d=H.T,H.T=null;var f=X.p;X.p=2;var p=ze;ze|=4;try{yy(l,r);var b=rg,y=S_(r.containerInfo),k=b.focusedElem,S=b.selectionRange;if(y!==k&&k&&k.ownerDocument&&E_(k.ownerDocument.documentElement,k)){if(S!==null&&Rf(k)){var B=S.start,q=S.end;if(q===void 0&&(q=B),"selectionStart"in k)k.selectionStart=B,k.selectionEnd=Math.min(q,k.value.length);else{var G=k.ownerDocument||document,D=G&&G.defaultView||window;if(D.getSelection){var U=D.getSelection(),re=k.textContent.length,fe=Math.min(S.start,re),Ke=S.end===void 0?fe:Math.min(S.end,re);!U.extend&&fe>Ke&&(y=Ke,Ke=fe,fe=y);var R=T_(k,fe),x=T_(k,Ke);if(R&&x&&(U.rangeCount!==1||U.anchorNode!==R.node||U.anchorOffset!==R.offset||U.focusNode!==x.node||U.focusOffset!==x.offset)){var V=G.createRange();V.setStart(R.node,R.offset),U.removeAllRanges(),fe>Ke?(U.addRange(V),U.extend(x.node,x.offset)):(V.setEnd(x.node,x.offset),U.addRange(V))}}}}for(G=[],U=k;U=U.parentNode;)U.nodeType===1&&G.push({element:U,left:U.scrollLeft,top:U.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<G.length;k++){var W=G[k];W.element.scrollLeft=W.left,W.element.scrollTop=W.top}}Xu=!!og,rg=og=null}finally{ze=p,X.p=f,H.T=d}}r.current=l,Pt=2}}function Uy(){if(Pt===2){Pt=0;var r=Gs,l=jr,d=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||d){d=H.T,H.T=null;var f=X.p;X.p=2;var p=ze;ze|=4;try{gy(r,l.alternate,l)}finally{ze=p,X.p=f,H.T=d}}Pt=3}}function Hy(){if(Pt===4||Pt===3){Pt=0,_x();var r=Gs,l=jr,d=as,f=xy;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Pt=5:(Pt=0,jr=Gs=null,jy(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&($s=null),hf(d),l=l.stateNode,En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Pa,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=H.T,p=X.p,X.p=2,H.T=null;try{for(var b=r.onRecoverableError,y=0;y<f.length;y++){var k=f[y];b(k.value,{componentStack:k.stack})}}finally{H.T=l,X.p=p}}(as&3)!==0&&zu(),Ai(r),p=r.pendingLanes,(d&261930)!==0&&(p&42)!==0?r===$m?dl++:(dl=0,$m=r):dl=0,hl(0)}}function jy(r,l){(r.pooledCacheLanes&=l)===0&&(l=r.pooledCache,l!=null&&(r.pooledCache=null,$a(l)))}function zu(){return zy(),Uy(),Hy(),qy()}function qy(){if(Pt!==5)return!1;var r=Gs,l=qm;qm=0;var d=hf(as),f=H.T,p=X.p;try{X.p=32>d?32:d,H.T=null,d=Wm,Wm=null;var b=Gs,y=as;if(Pt=0,jr=Gs=null,as=0,(ze&6)!==0)throw Error(n(331));var k=ze;if(ze|=4,Ey(b.current),Cy(b,b.current,y,d),ze=k,hl(0,!1),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Pa,b)}catch{}return!0}finally{X.p=p,H.T=f,jy(r,l)}}function Wy(r,l,d){l=Gn(d,l),l=Tm(r.stateNode,l,2),r=zs(r,l,2),r!==null&&(Oa(r,2),Ai(r))}function He(r,l,d){if(r.tag===3)Wy(r,r,d);else for(;l!==null;){if(l.tag===3){Wy(l,r,d);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&($s===null||!$s.has(f))){r=Gn(d,r),d=$0(2),f=zs(l,d,2),f!==null&&(G0(d,f,l,r),Oa(f,2),Ai(f));break}}l=l.return}}function Ym(r,l,d){var f=r.pingCache;if(f===null){f=r.pingCache=new W5;var p=new Set;f.set(l,p)}else p=f.get(l),p===void 0&&(p=new Set,f.set(l,p));p.has(d)||(Um=!0,p.add(d),r=J5.bind(null,r,l,d),l.then(r,r))}function J5(r,l,d){var f=r.pingCache;f!==null&&f.delete(l),r.pingedLanes|=r.suspendedLanes&d,r.warmLanes&=~d,Qe===r&&(xe&d)===d&&(mt===4||mt===3&&(xe&62914560)===xe&&300>Tn()-Bu?(ze&2)===0&&qr(r,0):Hm|=d,Hr===xe&&(Hr=0)),Ai(r)}function $y(r,l){l===0&&(l=zw()),r=vo(r,l),r!==null&&(Oa(r,l),Ai(r))}function Q5(r){var l=r.memoizedState,d=0;l!==null&&(d=l.retryLane),$y(r,d)}function X5(r,l){var d=0;switch(r.tag){case 31:case 13:var f=r.stateNode,p=r.memoizedState;p!==null&&(d=p.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(l),$y(r,d)}function Z5(r,l){return lf(r,l)}var Uu=null,$r=null,Jm=!1,Hu=!1,Qm=!1,Ys=0;function Ai(r){r!==$r&&r.next===null&&($r===null?Uu=$r=r:$r=$r.next=r),Hu=!0,Jm||(Jm=!0,tI())}function hl(r,l){if(!Qm&&Hu){Qm=!0;do for(var d=!1,f=Uu;f!==null;){if(r!==0){var p=f.pendingLanes;if(p===0)var b=0;else{var y=f.suspendedLanes,k=f.pingedLanes;b=(1<<31-Sn(42|r)+1)-1,b&=p&~(y&~k),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(d=!0,Jy(f,b))}else b=xe,b=$c(f,f===Qe?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||Ra(f,b)||(d=!0,Jy(f,b));f=f.next}while(d);Qm=!1}}function eI(){Gy()}function Gy(){Hu=Jm=!1;var r=0;Ys!==0&&dI()&&(r=Ys);for(var l=Tn(),d=null,f=Uu;f!==null;){var p=f.next,b=Ky(f,l);b===0?(f.next=null,d===null?Uu=p:d.next=p,p===null&&($r=d)):(d=f,(r!==0||(b&3)!==0)&&(Hu=!0)),f=p}Pt!==0&&Pt!==5||hl(r),Ys!==0&&(Ys=0)}function Ky(r,l){for(var d=r.suspendedLanes,f=r.pingedLanes,p=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var y=31-Sn(b),k=1<<y,S=p[y];S===-1?((k&d)===0||(k&f)!==0)&&(p[y]=Ax(k,l)):S<=l&&(r.expiredLanes|=k),b&=~k}if(l=Qe,d=xe,d=$c(r,r===l?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,d===0||r===l&&(Ue===2||Ue===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&cf(f),r.callbackNode=null,r.callbackPriority=0;if((d&3)===0||Ra(r,d)){if(l=d&-d,l===r.callbackPriority)return l;switch(f!==null&&cf(f),hf(d)){case 2:case 8:d=Dw;break;case 32:d=Hc;break;case 268435456:d=Fw;break;default:d=Hc}return f=Yy.bind(null,r),d=lf(d,f),r.callbackPriority=l,r.callbackNode=d,l}return f!==null&&f!==null&&cf(f),r.callbackPriority=2,r.callbackNode=null,2}function Yy(r,l){if(Pt!==0&&Pt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var d=r.callbackNode;if(zu()&&r.callbackNode!==d)return null;var f=xe;return f=$c(r,r===Qe?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(Py(r,f,l),Ky(r,Tn()),r.callbackNode!=null&&r.callbackNode===d?Yy.bind(null,r):null)}function Jy(r,l){if(zu())return null;Py(r,l,!0)}function tI(){fI(function(){(ze&6)!==0?lf(Lw,eI):Gy()})}function Xm(){if(Ys===0){var r=Rr;r===0&&(r=jc,jc<<=1,(jc&261888)===0&&(jc=256)),Ys=r}return Ys}function Qy(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Jc(""+r)}function Xy(r,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,r.id&&d.setAttribute("form",r.id),l.parentNode.insertBefore(d,l),r=new FormData(r),d.parentNode.removeChild(d),r}function nI(r,l,d,f,p){if(l==="submit"&&d&&d.stateNode===p){var b=Qy((p[ln]||null).action),y=f.submitter;y&&(l=(l=y[ln]||null)?Qy(l.formAction):y.getAttribute("formAction"),l!==null&&(b=l,y=null));var k=new eu("action","action",null,f,p);r.push({event:k,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ys!==0){var S=y?Xy(p,y):new FormData(p);wm(d,{pending:!0,data:S,method:p.method,action:b},null,S)}}else typeof b=="function"&&(k.preventDefault(),S=y?Xy(p,y):new FormData(p),wm(d,{pending:!0,data:S,method:p.method,action:b},b,S))},currentTarget:p}]})}}for(var Zm=0;Zm<Mf.length;Zm++){var eg=Mf[Zm],iI=eg.toLowerCase(),sI=eg[0].toUpperCase()+eg.slice(1);li(iI,"on"+sI)}li(I_,"onAnimationEnd"),li(P_,"onAnimationIteration"),li(R_,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(y5,"onTransitionRun"),li(v5,"onTransitionStart"),li(C5,"onTransitionCancel"),li(O_,"onTransitionEnd"),br("onMouseEnter",["mouseout","mouseover"]),br("onMouseLeave",["mouseout","mouseover"]),br("onPointerEnter",["pointerout","pointerover"]),br("onPointerLeave",["pointerout","pointerover"]),bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bo("onBeforeInput",["compositionend","keypress","textInput","paste"]),bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fl));function Zy(r,l){l=(l&4)!==0;for(var d=0;d<r.length;d++){var f=r[d],p=f.event;f=f.listeners;e:{var b=void 0;if(l)for(var y=f.length-1;0<=y;y--){var k=f[y],S=k.instance,B=k.currentTarget;if(k=k.listener,S!==b&&p.isPropagationStopped())break e;b=k,p.currentTarget=B;try{b(p)}catch(q){iu(q)}p.currentTarget=null,b=S}else for(y=0;y<f.length;y++){if(k=f[y],S=k.instance,B=k.currentTarget,k=k.listener,S!==b&&p.isPropagationStopped())break e;b=k,p.currentTarget=B;try{b(p)}catch(q){iu(q)}p.currentTarget=null,b=S}}}}function Ae(r,l){var d=l[ff];d===void 0&&(d=l[ff]=new Set);var f=r+"__bubble";d.has(f)||(ev(l,r,2,!1),d.add(f))}function tg(r,l,d){var f=0;l&&(f|=4),ev(d,r,f,l)}var ju="_reactListening"+Math.random().toString(36).slice(2);function ng(r){if(!r[ju]){r[ju]=!0,Gw.forEach(function(d){d!=="selectionchange"&&(oI.has(d)||tg(d,!1,r),tg(d,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[ju]||(l[ju]=!0,tg("selectionchange",!1,l))}}function ev(r,l,d,f){switch(Iv(l)){case 2:var p=VI;break;case 8:p=BI;break;default:p=bg}d=p.bind(null,l,d,r),p=void 0,!Cf||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(p=!0),f?p!==void 0?r.addEventListener(l,d,{capture:!0,passive:p}):r.addEventListener(l,d,!0):p!==void 0?r.addEventListener(l,d,{passive:p}):r.addEventListener(l,d,!1)}function ig(r,l,d,f,p){var b=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var y=f.tag;if(y===3||y===4){var k=f.stateNode.containerInfo;if(k===p)break;if(y===4)for(y=f.return;y!==null;){var S=y.tag;if((S===3||S===4)&&y.stateNode.containerInfo===p)return;y=y.return}for(;k!==null;){if(y=mr(k),y===null)return;if(S=y.tag,S===5||S===6||S===26||S===27){f=b=y;continue e}k=k.parentNode}}f=f.return}o_(function(){var B=b,q=yf(d),G=[];e:{var D=V_.get(r);if(D!==void 0){var U=eu,re=r;switch(r){case"keypress":if(Xc(d)===0)break e;case"keydown":case"keyup":U=Xx;break;case"focusin":re="focus",U=Sf;break;case"focusout":re="blur",U=Sf;break;case"beforeblur":case"afterblur":U=Sf;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=l_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=zx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=t5;break;case I_:case P_:case R_:U=jx;break;case O_:U=i5;break;case"scroll":case"scrollend":U=Dx;break;case"wheel":U=o5;break;case"copy":case"cut":case"paste":U=Wx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=u_;break;case"toggle":case"beforetoggle":U=a5}var fe=(l&4)!==0,Ke=!fe&&(r==="scroll"||r==="scrollend"),R=fe?D!==null?D+"Capture":null:D;fe=[];for(var x=B,V;x!==null;){var W=x;if(V=W.stateNode,W=W.tag,W!==5&&W!==26&&W!==27||V===null||R===null||(W=Ma(x,R),W!=null&&fe.push(ml(x,W,V))),Ke)break;x=x.return}0<fe.length&&(D=new U(D,re,null,d,q),G.push({event:D,listeners:fe}))}}if((l&7)===0){e:{if(D=r==="mouseover"||r==="pointerover",U=r==="mouseout"||r==="pointerout",D&&d!==_f&&(re=d.relatedTarget||d.fromElement)&&(mr(re)||re[fr]))break e;if((U||D)&&(D=q.window===q?q:(D=q.ownerDocument)?D.defaultView||D.parentWindow:window,U?(re=d.relatedTarget||d.toElement,U=B,re=re?mr(re):null,re!==null&&(Ke=o(re),fe=re.tag,re!==Ke||fe!==5&&fe!==27&&fe!==6)&&(re=null)):(U=null,re=B),U!==re)){if(fe=l_,W="onMouseLeave",R="onMouseEnter",x="mouse",(r==="pointerout"||r==="pointerover")&&(fe=u_,W="onPointerLeave",R="onPointerEnter",x="pointer"),Ke=U==null?D:Ba(U),V=re==null?D:Ba(re),D=new fe(W,x+"leave",U,d,q),D.target=Ke,D.relatedTarget=V,W=null,mr(q)===B&&(fe=new fe(R,x+"enter",re,d,q),fe.target=V,fe.relatedTarget=Ke,W=fe),Ke=W,U&&re)t:{for(fe=rI,R=U,x=re,V=0,W=R;W;W=fe(W))V++;W=0;for(var he=x;he;he=fe(he))W++;for(;0<V-W;)R=fe(R),V--;for(;0<W-V;)x=fe(x),W--;for(;V--;){if(R===x||x!==null&&R===x.alternate){fe=R;break t}R=fe(R),x=fe(x)}fe=null}else fe=null;U!==null&&tv(G,D,U,fe,!1),re!==null&&Ke!==null&&tv(G,Ke,re,fe,!0)}}e:{if(D=B?Ba(B):window,U=D.nodeName&&D.nodeName.toLowerCase(),U==="select"||U==="input"&&D.type==="file")var Le=w_;else if(p_(D))if(__)Le=b5;else{Le=g5;var ce=m5}else U=D.nodeName,!U||U.toLowerCase()!=="input"||D.type!=="checkbox"&&D.type!=="radio"?B&&wf(B.elementType)&&(Le=w_):Le=p5;if(Le&&(Le=Le(r,B))){b_(G,Le,d,q);break e}ce&&ce(r,D,B),r==="focusout"&&B&&D.type==="number"&&B.memoizedProps.value!=null&&bf(D,"number",D.value)}switch(ce=B?Ba(B):window,r){case"focusin":(p_(ce)||ce.contentEditable==="true")&&(kr=ce,Of=B,ja=null);break;case"focusout":ja=Of=kr=null;break;case"mousedown":Vf=!0;break;case"contextmenu":case"mouseup":case"dragend":Vf=!1,A_(G,d,q);break;case"selectionchange":if(_5)break;case"keydown":case"keyup":A_(G,d,q)}var Ce;if(xf)e:{switch(r){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else Cr?m_(r,d)&&(Ie="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Ie="onCompositionStart");Ie&&(d_&&d.locale!=="ko"&&(Cr||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&Cr&&(Ce=r_()):(Vs=q,kf="value"in Vs?Vs.value:Vs.textContent,Cr=!0)),ce=qu(B,Ie),0<ce.length&&(Ie=new c_(Ie,r,null,d,q),G.push({event:Ie,listeners:ce}),Ce?Ie.data=Ce:(Ce=g_(d),Ce!==null&&(Ie.data=Ce)))),(Ce=c5?u5(r,d):d5(r,d))&&(Ie=qu(B,"onBeforeInput"),0<Ie.length&&(ce=new c_("onBeforeInput","beforeinput",null,d,q),G.push({event:ce,listeners:Ie}),ce.data=Ce)),nI(G,r,B,d,q)}Zy(G,l)})}function ml(r,l,d){return{instance:r,listener:l,currentTarget:d}}function qu(r,l){for(var d=l+"Capture",f=[];r!==null;){var p=r,b=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||b===null||(p=Ma(r,d),p!=null&&f.unshift(ml(r,p,b)),p=Ma(r,l),p!=null&&f.push(ml(r,p,b))),r.tag===3)return f;r=r.return}return[]}function rI(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function tv(r,l,d,f,p){for(var b=l._reactName,y=[];d!==null&&d!==f;){var k=d,S=k.alternate,B=k.stateNode;if(k=k.tag,S!==null&&S===f)break;k!==5&&k!==26&&k!==27||B===null||(S=B,p?(B=Ma(d,b),B!=null&&y.unshift(ml(d,B,S))):p||(B=Ma(d,b),B!=null&&y.push(ml(d,B,S)))),d=d.return}y.length!==0&&r.push({event:l,listeners:y})}var aI=/\r\n?/g,lI=/\u0000|\uFFFD/g;function nv(r){return(typeof r=="string"?r:""+r).replace(aI,`
`).replace(lI,"")}function iv(r,l){return l=nv(l),nv(r)===l}function Ge(r,l,d,f,p,b){switch(d){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||_r(r,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&_r(r,""+f);break;case"className":Kc(r,"class",f);break;case"tabIndex":Kc(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Kc(r,d,f);break;case"style":i_(r,f,b);break;case"data":if(l!=="object"){Kc(r,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||d!=="href")){r.removeAttribute(d);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(d);break}f=Jc(""+f),r.setAttribute(d,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(d==="formAction"?(l!=="input"&&Ge(r,l,"name",p.name,p,null),Ge(r,l,"formEncType",p.formEncType,p,null),Ge(r,l,"formMethod",p.formMethod,p,null),Ge(r,l,"formTarget",p.formTarget,p,null)):(Ge(r,l,"encType",p.encType,p,null),Ge(r,l,"method",p.method,p,null),Ge(r,l,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(d);break}f=Jc(""+f),r.setAttribute(d,f);break;case"onClick":f!=null&&(r.onclick=$i);break;case"onScroll":f!=null&&Ae("scroll",r);break;case"onScrollEnd":f!=null&&Ae("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(d=f.__html,d!=null){if(p.children!=null)throw Error(n(60));r.innerHTML=d}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}d=Jc(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(d,""+f):r.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(d,""):r.removeAttribute(d);break;case"capture":case"download":f===!0?r.setAttribute(d,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(d,f):r.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(d,f):r.removeAttribute(d);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(d):r.setAttribute(d,f);break;case"popover":Ae("beforetoggle",r),Ae("toggle",r),Gc(r,"popover",f);break;case"xlinkActuate":Wi(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Wi(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Wi(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Wi(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Wi(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Wi(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Wi(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Wi(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Wi(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Gc(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Nx.get(d)||d,Gc(r,d,f))}}function sg(r,l,d,f,p,b){switch(d){case"style":i_(r,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(d=f.__html,d!=null){if(p.children!=null)throw Error(n(60));r.innerHTML=d}}break;case"children":typeof f=="string"?_r(r,f):(typeof f=="number"||typeof f=="bigint")&&_r(r,""+f);break;case"onScroll":f!=null&&Ae("scroll",r);break;case"onScrollEnd":f!=null&&Ae("scrollend",r);break;case"onClick":f!=null&&(r.onclick=$i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kw.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(p=d.endsWith("Capture"),l=d.slice(2,p?d.length-7:void 0),b=r[ln]||null,b=b!=null?b[d]:null,typeof b=="function"&&r.removeEventListener(l,b,p),typeof f=="function")){typeof b!="function"&&b!==null&&(d in r?r[d]=null:r.hasAttribute(d)&&r.removeAttribute(d)),r.addEventListener(l,f,p);break e}d in r?r[d]=f:f===!0?r.setAttribute(d,""):Gc(r,d,f)}}}function jt(r,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",r),Ae("load",r);var f=!1,p=!1,b;for(b in d)if(d.hasOwnProperty(b)){var y=d[b];if(y!=null)switch(b){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Ge(r,l,b,y,d,null)}}p&&Ge(r,l,"srcSet",d.srcSet,d,null),f&&Ge(r,l,"src",d.src,d,null);return;case"input":Ae("invalid",r);var k=b=y=p=null,S=null,B=null;for(f in d)if(d.hasOwnProperty(f)){var q=d[f];if(q!=null)switch(f){case"name":p=q;break;case"type":y=q;break;case"checked":S=q;break;case"defaultChecked":B=q;break;case"value":b=q;break;case"defaultValue":k=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(n(137,l));break;default:Ge(r,l,f,q,d,null)}}Zw(r,b,k,S,B,y,p,!1);return;case"select":Ae("invalid",r),f=y=b=null;for(p in d)if(d.hasOwnProperty(p)&&(k=d[p],k!=null))switch(p){case"value":b=k;break;case"defaultValue":y=k;break;case"multiple":f=k;default:Ge(r,l,p,k,d,null)}l=b,d=y,r.multiple=!!f,l!=null?wr(r,!!f,l,!1):d!=null&&wr(r,!!f,d,!0);return;case"textarea":Ae("invalid",r),b=p=f=null;for(y in d)if(d.hasOwnProperty(y)&&(k=d[y],k!=null))switch(y){case"value":f=k;break;case"defaultValue":p=k;break;case"children":b=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(n(91));break;default:Ge(r,l,y,k,d,null)}t_(r,f,p,b);return;case"option":for(S in d)d.hasOwnProperty(S)&&(f=d[S],f!=null)&&(S==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":Ge(r,l,S,f,d,null));return;case"dialog":Ae("beforetoggle",r),Ae("toggle",r),Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":Ae("load",r);break;case"video":case"audio":for(f=0;f<fl.length;f++)Ae(fl[f],r);break;case"image":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"embed":case"source":case"link":Ae("error",r),Ae("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(B in d)if(d.hasOwnProperty(B)&&(f=d[B],f!=null))switch(B){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Ge(r,l,B,f,d,null)}return;default:if(wf(l)){for(q in d)d.hasOwnProperty(q)&&(f=d[q],f!==void 0&&sg(r,l,q,f,d,void 0));return}}for(k in d)d.hasOwnProperty(k)&&(f=d[k],f!=null&&Ge(r,l,k,f,d,null))}function cI(r,l,d,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,b=null,y=null,k=null,S=null,B=null,q=null;for(U in d){var G=d[U];if(d.hasOwnProperty(U)&&G!=null)switch(U){case"checked":break;case"value":break;case"defaultValue":S=G;default:f.hasOwnProperty(U)||Ge(r,l,U,null,f,G)}}for(var D in f){var U=f[D];if(G=d[D],f.hasOwnProperty(D)&&(U!=null||G!=null))switch(D){case"type":b=U;break;case"name":p=U;break;case"checked":B=U;break;case"defaultChecked":q=U;break;case"value":y=U;break;case"defaultValue":k=U;break;case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(137,l));break;default:U!==G&&Ge(r,l,D,U,f,G)}}pf(r,y,k,S,B,q,b,p);return;case"select":U=y=k=D=null;for(b in d)if(S=d[b],d.hasOwnProperty(b)&&S!=null)switch(b){case"value":break;case"multiple":U=S;default:f.hasOwnProperty(b)||Ge(r,l,b,null,f,S)}for(p in f)if(b=f[p],S=d[p],f.hasOwnProperty(p)&&(b!=null||S!=null))switch(p){case"value":D=b;break;case"defaultValue":k=b;break;case"multiple":y=b;default:b!==S&&Ge(r,l,p,b,f,S)}l=k,d=y,f=U,D!=null?wr(r,!!d,D,!1):!!f!=!!d&&(l!=null?wr(r,!!d,l,!0):wr(r,!!d,d?[]:"",!1));return;case"textarea":U=D=null;for(k in d)if(p=d[k],d.hasOwnProperty(k)&&p!=null&&!f.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Ge(r,l,k,null,f,p)}for(y in f)if(p=f[y],b=d[y],f.hasOwnProperty(y)&&(p!=null||b!=null))switch(y){case"value":D=p;break;case"defaultValue":U=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==b&&Ge(r,l,y,p,f,b)}e_(r,D,U);return;case"option":for(var re in d)D=d[re],d.hasOwnProperty(re)&&D!=null&&!f.hasOwnProperty(re)&&(re==="selected"?r.selected=!1:Ge(r,l,re,null,f,D));for(S in f)D=f[S],U=d[S],f.hasOwnProperty(S)&&D!==U&&(D!=null||U!=null)&&(S==="selected"?r.selected=D&&typeof D!="function"&&typeof D!="symbol":Ge(r,l,S,D,f,U));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in d)D=d[fe],d.hasOwnProperty(fe)&&D!=null&&!f.hasOwnProperty(fe)&&Ge(r,l,fe,null,f,D);for(B in f)if(D=f[B],U=d[B],f.hasOwnProperty(B)&&D!==U&&(D!=null||U!=null))switch(B){case"children":case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(137,l));break;default:Ge(r,l,B,D,f,U)}return;default:if(wf(l)){for(var Ke in d)D=d[Ke],d.hasOwnProperty(Ke)&&D!==void 0&&!f.hasOwnProperty(Ke)&&sg(r,l,Ke,void 0,f,D);for(q in f)D=f[q],U=d[q],!f.hasOwnProperty(q)||D===U||D===void 0&&U===void 0||sg(r,l,q,D,f,U);return}}for(var R in d)D=d[R],d.hasOwnProperty(R)&&D!=null&&!f.hasOwnProperty(R)&&Ge(r,l,R,null,f,D);for(G in f)D=f[G],U=d[G],!f.hasOwnProperty(G)||D===U||D==null&&U==null||Ge(r,l,G,D,f,U)}function sv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uI(){if(typeof performance.getEntriesByType=="function"){for(var r=0,l=0,d=performance.getEntriesByType("resource"),f=0;f<d.length;f++){var p=d[f],b=p.transferSize,y=p.initiatorType,k=p.duration;if(b&&k&&sv(y)){for(y=0,k=p.responseEnd,f+=1;f<d.length;f++){var S=d[f],B=S.startTime;if(B>k)break;var q=S.transferSize,G=S.initiatorType;q&&sv(G)&&(S=S.responseEnd,y+=q*(S<k?1:(k-B)/(S-B)))}if(--f,l+=8*(b+y)/(p.duration/1e3),r++,10<r)break}}if(0<r)return l/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var og=null,rg=null;function Wu(r){return r.nodeType===9?r:r.ownerDocument}function ov(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rv(r,l){if(r===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&l==="foreignObject"?0:r}function ag(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var lg=null;function dI(){var r=window.event;return r&&r.type==="popstate"?r===lg?!1:(lg=r,!0):(lg=null,!1)}var av=typeof setTimeout=="function"?setTimeout:void 0,hI=typeof clearTimeout=="function"?clearTimeout:void 0,lv=typeof Promise=="function"?Promise:void 0,fI=typeof queueMicrotask=="function"?queueMicrotask:typeof lv<"u"?function(r){return lv.resolve(null).then(r).catch(mI)}:av;function mI(r){setTimeout(function(){throw r})}function Js(r){return r==="head"}function cv(r,l){var d=l,f=0;do{var p=d.nextSibling;if(r.removeChild(d),p&&p.nodeType===8)if(d=p.data,d==="/$"||d==="/&"){if(f===0){r.removeChild(p),Jr(l);return}f--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")f++;else if(d==="html")gl(r.ownerDocument.documentElement);else if(d==="head"){d=r.ownerDocument.head,gl(d);for(var b=d.firstChild;b;){var y=b.nextSibling,k=b.nodeName;b[Va]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&b.rel.toLowerCase()==="stylesheet"||d.removeChild(b),b=y}}else d==="body"&&gl(r.ownerDocument.body);d=p}while(d);Jr(l)}function uv(r,l){var d=r;r=0;do{var f=d.nextSibling;if(d.nodeType===1?l?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(l?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),f&&f.nodeType===8)if(d=f.data,d==="/$"){if(r===0)break;r--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||r++;d=f}while(d)}function cg(r){var l=r.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":cg(d),mf(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}r.removeChild(d)}}function gI(r,l,d,f){for(;r.nodeType===1;){var p=d;if(r.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Va])switch(l){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(l==="input"&&r.type==="hidden"){var b=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=Xn(r.nextSibling),r===null)break}return null}function pI(r,l,d){if(l==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!d||(r=Xn(r.nextSibling),r===null))return null;return r}function dv(r,l){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Xn(r.nextSibling),r===null))return null;return r}function ug(r){return r.data==="$?"||r.data==="$~"}function dg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function bI(r,l){var d=r.ownerDocument;if(r.data==="$~")r._reactRetry=l;else if(r.data!=="$?"||d.readyState!=="loading")l();else{var f=function(){l(),d.removeEventListener("DOMContentLoaded",f)};d.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Xn(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return r}var hg=null;function hv(r){r=r.nextSibling;for(var l=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"||d==="/&"){if(l===0)return Xn(r.nextSibling);l--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||l++}r=r.nextSibling}return null}function fv(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(l===0)return r;l--}else d!=="/$"&&d!=="/&"||l++}r=r.previousSibling}return null}function mv(r,l,d){switch(l=Wu(d),r){case"html":if(r=l.documentElement,!r)throw Error(n(452));return r;case"head":if(r=l.head,!r)throw Error(n(453));return r;case"body":if(r=l.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function gl(r){for(var l=r.attributes;l.length;)r.removeAttributeNode(l[0]);mf(r)}var Zn=new Map,gv=new Set;function $u(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ls=X.d;X.d={f:wI,r:_I,D:yI,C:vI,L:CI,m:kI,X:EI,S:TI,M:SI};function wI(){var r=ls.f(),l=Lu();return r||l}function _I(r){var l=gr(r);l!==null&&l.tag===5&&l.type==="form"?O0(l):ls.r(r)}var Gr=typeof document>"u"?null:document;function pv(r,l,d){var f=Gr;if(f&&typeof l=="string"&&l){var p=Wn(l);p='link[rel="'+r+'"][href="'+p+'"]',typeof d=="string"&&(p+='[crossorigin="'+d+'"]'),gv.has(p)||(gv.add(p),r={rel:r,crossOrigin:d,href:l},f.querySelector(p)===null&&(l=f.createElement("link"),jt(l,"link",r),Bt(l),f.head.appendChild(l)))}}function yI(r){ls.D(r),pv("dns-prefetch",r,null)}function vI(r,l){ls.C(r,l),pv("preconnect",r,l)}function CI(r,l,d){ls.L(r,l,d);var f=Gr;if(f&&r&&l){var p='link[rel="preload"][as="'+Wn(l)+'"]';l==="image"&&d&&d.imageSrcSet?(p+='[imagesrcset="'+Wn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(p+='[imagesizes="'+Wn(d.imageSizes)+'"]')):p+='[href="'+Wn(r)+'"]';var b=p;switch(l){case"style":b=Kr(r);break;case"script":b=Yr(r)}Zn.has(b)||(r=g({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:r,as:l},d),Zn.set(b,r),f.querySelector(p)!==null||l==="style"&&f.querySelector(pl(b))||l==="script"&&f.querySelector(bl(b))||(l=f.createElement("link"),jt(l,"link",r),Bt(l),f.head.appendChild(l)))}}function kI(r,l){ls.m(r,l);var d=Gr;if(d&&r){var f=l&&typeof l.as=="string"?l.as:"script",p='link[rel="modulepreload"][as="'+Wn(f)+'"][href="'+Wn(r)+'"]',b=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Yr(r)}if(!Zn.has(b)&&(r=g({rel:"modulepreload",href:r},l),Zn.set(b,r),d.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(bl(b)))return}f=d.createElement("link"),jt(f,"link",r),Bt(f),d.head.appendChild(f)}}}function TI(r,l,d){ls.S(r,l,d);var f=Gr;if(f&&r){var p=pr(f).hoistableStyles,b=Kr(r);l=l||"default";var y=p.get(b);if(!y){var k={loading:0,preload:null};if(y=f.querySelector(pl(b)))k.loading=5;else{r=g({rel:"stylesheet",href:r,"data-precedence":l},d),(d=Zn.get(b))&&fg(r,d);var S=y=f.createElement("link");Bt(S),jt(S,"link",r),S._p=new Promise(function(B,q){S.onload=B,S.onerror=q}),S.addEventListener("load",function(){k.loading|=1}),S.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Gu(y,l,f)}y={type:"stylesheet",instance:y,count:1,state:k},p.set(b,y)}}}function EI(r,l){ls.X(r,l);var d=Gr;if(d&&r){var f=pr(d).hoistableScripts,p=Yr(r),b=f.get(p);b||(b=d.querySelector(bl(p)),b||(r=g({src:r,async:!0},l),(l=Zn.get(p))&&mg(r,l),b=d.createElement("script"),Bt(b),jt(b,"link",r),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(p,b))}}function SI(r,l){ls.M(r,l);var d=Gr;if(d&&r){var f=pr(d).hoistableScripts,p=Yr(r),b=f.get(p);b||(b=d.querySelector(bl(p)),b||(r=g({src:r,async:!0,type:"module"},l),(l=Zn.get(p))&&mg(r,l),b=d.createElement("script"),Bt(b),jt(b,"link",r),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(p,b))}}function bv(r,l,d,f){var p=(p=ye.current)?$u(p):null;if(!p)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=Kr(d.href),d=pr(p).hoistableStyles,f=d.get(l),f||(f={type:"style",instance:null,count:0,state:null},d.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){r=Kr(d.href);var b=pr(p).hoistableStyles,y=b.get(r);if(y||(p=p.ownerDocument||p,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,y),(b=p.querySelector(pl(r)))&&!b._p&&(y.instance=b,y.state.loading=5),Zn.has(r)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Zn.set(r,d),b||AI(p,r,d,y.state))),l&&f===null)throw Error(n(528,""));return y}if(l&&f!==null)throw Error(n(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Yr(d),d=pr(p).hoistableScripts,f=d.get(l),f||(f={type:"script",instance:null,count:0,state:null},d.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Kr(r){return'href="'+Wn(r)+'"'}function pl(r){return'link[rel="stylesheet"]['+r+"]"}function wv(r){return g({},r,{"data-precedence":r.precedence,precedence:null})}function AI(r,l,d,f){r.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=r.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),jt(l,"link",d),Bt(l),r.head.appendChild(l))}function Yr(r){return'[src="'+Wn(r)+'"]'}function bl(r){return"script[async]"+r}function _v(r,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var f=r.querySelector('style[data-href~="'+Wn(d.href)+'"]');if(f)return l.instance=f,Bt(f),f;var p=g({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),Bt(f),jt(f,"style",p),Gu(f,d.precedence,r),l.instance=f;case"stylesheet":p=Kr(d.href);var b=r.querySelector(pl(p));if(b)return l.state.loading|=4,l.instance=b,Bt(b),b;f=wv(d),(p=Zn.get(p))&&fg(f,p),b=(r.ownerDocument||r).createElement("link"),Bt(b);var y=b;return y._p=new Promise(function(k,S){y.onload=k,y.onerror=S}),jt(b,"link",f),l.state.loading|=4,Gu(b,d.precedence,r),l.instance=b;case"script":return b=Yr(d.src),(p=r.querySelector(bl(b)))?(l.instance=p,Bt(p),p):(f=d,(p=Zn.get(b))&&(f=g({},d),mg(f,p)),r=r.ownerDocument||r,p=r.createElement("script"),Bt(p),jt(p,"link",f),r.head.appendChild(p),l.instance=p);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,Gu(f,d.precedence,r));return l.instance}function Gu(r,l,d){for(var f=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,b=p,y=0;y<f.length;y++){var k=f[y];if(k.dataset.precedence===l)b=k;else if(b!==p)break}b?b.parentNode.insertBefore(r,b.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(r,l.firstChild))}function fg(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.title==null&&(r.title=l.title)}function mg(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.integrity==null&&(r.integrity=l.integrity)}var Ku=null;function yv(r,l,d){if(Ku===null){var f=new Map,p=Ku=new Map;p.set(d,f)}else p=Ku,f=p.get(d),f||(f=new Map,p.set(d,f));if(f.has(r))return f;for(f.set(r,null),d=d.getElementsByTagName(r),p=0;p<d.length;p++){var b=d[p];if(!(b[Va]||b[Ft]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var y=b.getAttribute(l)||"";y=r+y;var k=f.get(y);k?k.push(b):f.set(y,[b])}}return f}function vv(r,l,d){r=r.ownerDocument||r,r.head.insertBefore(d,l==="title"?r.querySelector("head > title"):null)}function xI(r,l,d){if(d===1||l.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(r=l.disabled,typeof l.precedence=="string"&&r==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Cv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function II(r,l,d,f){if(d.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var p=Kr(f.href),b=l.querySelector(pl(p));if(b){l=b._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(r.count++,r=Yu.bind(r),l.then(r,r)),d.state.loading|=4,d.instance=b,Bt(b);return}b=l.ownerDocument||l,f=wv(f),(p=Zn.get(p))&&fg(f,p),b=b.createElement("link"),Bt(b);var y=b;y._p=new Promise(function(k,S){y.onload=k,y.onerror=S}),jt(b,"link",f),d.instance=b}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(r.count++,d=Yu.bind(r),l.addEventListener("load",d),l.addEventListener("error",d))}}var gg=0;function PI(r,l){return r.stylesheets&&r.count===0&&Qu(r,r.stylesheets),0<r.count||0<r.imgCount?function(d){var f=setTimeout(function(){if(r.stylesheets&&Qu(r,r.stylesheets),r.unsuspend){var b=r.unsuspend;r.unsuspend=null,b()}},6e4+l);0<r.imgBytes&&gg===0&&(gg=62500*uI());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Qu(r,r.stylesheets),r.unsuspend)){var b=r.unsuspend;r.unsuspend=null,b()}},(r.imgBytes>gg?50:800)+l);return r.unsuspend=d,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(p)}}:null}function Yu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qu(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Ju=null;function Qu(r,l){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Ju=new Map,l.forEach(RI,r),Ju=null,Yu.call(r))}function RI(r,l){if(!(l.state.loading&4)){var d=Ju.get(r);if(d)var f=d.get(null);else{d=new Map,Ju.set(r,d);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<p.length;b++){var y=p[b];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(d.set(y.dataset.precedence,y),f=y)}f&&d.set(null,f)}p=l.instance,y=p.getAttribute("data-precedence"),b=d.get(y)||f,b===f&&d.set(null,p),d.set(y,p),this.count++,f=Yu.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),b?b.parentNode.insertBefore(p,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),l.state.loading|=4}}var wl={$$typeof:z,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function OI(r,l,d,f,p,b,y,k,S){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=uf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uf(0),this.hiddenUpdates=uf(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=b,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function kv(r,l,d,f,p,b,y,k,S,B,q,G){return r=new OI(r,l,d,y,S,B,q,G,k),l=1,b===!0&&(l|=24),b=xn(3,null,null,l),r.current=b,b.stateNode=r,l=Kf(),l.refCount++,r.pooledCache=l,l.refCount++,b.memoizedState={element:f,isDehydrated:d,cache:l},Xf(b),r}function Tv(r){return r?(r=Sr,r):Sr}function Ev(r,l,d,f,p,b){p=Tv(p),f.context===null?f.context=p:f.pendingContext=p,f=Fs(l),f.payload={element:d},b=b===void 0?null:b,b!==null&&(f.callback=b),d=zs(r,f,l),d!==null&&(mn(d,r,l),Ja(d,r,l))}function Sv(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<l?d:l}}function pg(r,l){Sv(r,l),(r=r.alternate)&&Sv(r,l)}function Av(r){if(r.tag===13||r.tag===31){var l=vo(r,67108864);l!==null&&mn(l,r,67108864),pg(r,67108864)}}function xv(r){if(r.tag===13||r.tag===31){var l=Vn();l=df(l);var d=vo(r,l);d!==null&&mn(d,r,l),pg(r,l)}}var Xu=!0;function VI(r,l,d,f){var p=H.T;H.T=null;var b=X.p;try{X.p=2,bg(r,l,d,f)}finally{X.p=b,H.T=p}}function BI(r,l,d,f){var p=H.T;H.T=null;var b=X.p;try{X.p=8,bg(r,l,d,f)}finally{X.p=b,H.T=p}}function bg(r,l,d,f){if(Xu){var p=wg(f);if(p===null)ig(r,l,f,Zu,d),Pv(r,f);else if(NI(p,r,l,d,f))f.stopPropagation();else if(Pv(r,f),l&4&&-1<MI.indexOf(r)){for(;p!==null;){var b=gr(p);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var y=po(b.pendingLanes);if(y!==0){var k=b;for(k.pendingLanes|=2,k.entangledLanes|=2;y;){var S=1<<31-Sn(y);k.entanglements[1]|=S,y&=~S}Ai(b),(ze&6)===0&&(Mu=Tn()+500,hl(0))}}break;case 31:case 13:k=vo(b,2),k!==null&&mn(k,b,2),Lu(),pg(b,2)}if(b=wg(f),b===null&&ig(r,l,f,Zu,d),b===p)break;p=b}p!==null&&f.stopPropagation()}else ig(r,l,f,null,d)}}function wg(r){return r=yf(r),_g(r)}var Zu=null;function _g(r){if(Zu=null,r=mr(r),r!==null){var l=o(r);if(l===null)r=null;else{var d=l.tag;if(d===13){if(r=a(l),r!==null)return r;r=null}else if(d===31){if(r=c(l),r!==null)return r;r=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return Zu=r,null}function Iv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yx()){case Lw:return 2;case Dw:return 8;case Hc:case vx:return 32;case Fw:return 268435456;default:return 32}default:return 32}}var yg=!1,Qs=null,Xs=null,Zs=null,_l=new Map,yl=new Map,eo=[],MI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pv(r,l){switch(r){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":_l.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":yl.delete(l.pointerId)}}function vl(r,l,d,f,p,b){return r===null||r.nativeEvent!==b?(r={blockedOn:l,domEventName:d,eventSystemFlags:f,nativeEvent:b,targetContainers:[p]},l!==null&&(l=gr(l),l!==null&&Av(l)),r):(r.eventSystemFlags|=f,l=r.targetContainers,p!==null&&l.indexOf(p)===-1&&l.push(p),r)}function NI(r,l,d,f,p){switch(l){case"focusin":return Qs=vl(Qs,r,l,d,f,p),!0;case"dragenter":return Xs=vl(Xs,r,l,d,f,p),!0;case"mouseover":return Zs=vl(Zs,r,l,d,f,p),!0;case"pointerover":var b=p.pointerId;return _l.set(b,vl(_l.get(b)||null,r,l,d,f,p)),!0;case"gotpointercapture":return b=p.pointerId,yl.set(b,vl(yl.get(b)||null,r,l,d,f,p)),!0}return!1}function Rv(r){var l=mr(r.target);if(l!==null){var d=o(l);if(d!==null){if(l=d.tag,l===13){if(l=a(d),l!==null){r.blockedOn=l,Ww(r.priority,function(){xv(d)});return}}else if(l===31){if(l=c(d),l!==null){r.blockedOn=l,Ww(r.priority,function(){xv(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ed(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var d=wg(r.nativeEvent);if(d===null){d=r.nativeEvent;var f=new d.constructor(d.type,d);_f=f,d.target.dispatchEvent(f),_f=null}else return l=gr(d),l!==null&&Av(l),r.blockedOn=d,!1;l.shift()}return!0}function Ov(r,l,d){ed(r)&&d.delete(l)}function LI(){yg=!1,Qs!==null&&ed(Qs)&&(Qs=null),Xs!==null&&ed(Xs)&&(Xs=null),Zs!==null&&ed(Zs)&&(Zs=null),_l.forEach(Ov),yl.forEach(Ov)}function td(r,l){r.blockedOn===l&&(r.blockedOn=null,yg||(yg=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,LI)))}var nd=null;function Vv(r){nd!==r&&(nd=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){nd===r&&(nd=null);for(var l=0;l<r.length;l+=3){var d=r[l],f=r[l+1],p=r[l+2];if(typeof f!="function"){if(_g(f||d)===null)continue;break}var b=gr(d);b!==null&&(r.splice(l,3),l-=3,wm(b,{pending:!0,data:p,method:d.method,action:f},f,p))}}))}function Jr(r){function l(S){return td(S,r)}Qs!==null&&td(Qs,r),Xs!==null&&td(Xs,r),Zs!==null&&td(Zs,r),_l.forEach(l),yl.forEach(l);for(var d=0;d<eo.length;d++){var f=eo[d];f.blockedOn===r&&(f.blockedOn=null)}for(;0<eo.length&&(d=eo[0],d.blockedOn===null);)Rv(d),d.blockedOn===null&&eo.shift();if(d=(r.ownerDocument||r).$$reactFormReplay,d!=null)for(f=0;f<d.length;f+=3){var p=d[f],b=d[f+1],y=p[ln]||null;if(typeof b=="function")y||Vv(d);else if(y){var k=null;if(b&&b.hasAttribute("formAction")){if(p=b,y=b[ln]||null)k=y.formAction;else if(_g(p)!==null)continue}else k=y.action;typeof k=="function"?d[f+1]=k:(d.splice(f,3),f-=3),Vv(d)}}}function Bv(){function r(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(y){return p=y})},focusReset:"manual",scroll:"manual"})}function l(){p!==null&&(p(),p=null),f||setTimeout(d,20)}function d(){if(!f&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(d,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),p!==null&&(p(),p=null)}}}function vg(r){this._internalRoot=r}id.prototype.render=vg.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(n(409));var d=l.current,f=Vn();Ev(d,f,r,l,null,null)},id.prototype.unmount=vg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;Ev(r.current,2,null,r,null,null),Lu(),l[fr]=null}};function id(r){this._internalRoot=r}id.prototype.unstable_scheduleHydration=function(r){if(r){var l=qw();r={blockedOn:null,target:r,priority:l};for(var d=0;d<eo.length&&l!==0&&l<eo[d].priority;d++);eo.splice(d,0,r),d===0&&Rv(r)}};var Mv=e.version;if(Mv!=="19.2.4")throw Error(n(527,Mv,"19.2.4"));X.findDOMNode=function(r){var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(l),r=r!==null?m(r):null,r=r===null?null:r.stateNode,r};var DI={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{Pa=sd.inject(DI),En=sd}catch{}}return kl.createRoot=function(r,l){if(!s(r))throw Error(n(299));var d=!1,f="",p=H0,b=j0,y=q0;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=kv(r,1,!1,null,null,d,f,null,p,b,y,Bv),r[fr]=l.current,ng(r),new vg(l)},kl.hydrateRoot=function(r,l,d){if(!s(r))throw Error(n(299));var f=!1,p="",b=H0,y=j0,k=q0,S=null;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(p=d.identifierPrefix),d.onUncaughtError!==void 0&&(b=d.onUncaughtError),d.onCaughtError!==void 0&&(y=d.onCaughtError),d.onRecoverableError!==void 0&&(k=d.onRecoverableError),d.formState!==void 0&&(S=d.formState)),l=kv(r,1,!0,l,d??null,f,p,S,b,y,k,Bv),l.context=Tv(null),d=l.current,f=Vn(),f=df(f),p=Fs(f),p.callback=null,zs(d,p,f),d=f,l.current.lanes=d,Oa(l,d),Ai(l),r[fr]=l.current,ng(r),new id(l)},kl.version="19.2.4",kl}var Wv;function KI(){if(Wv)return Tg.exports;Wv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Tg.exports=GI(),Tg.exports}var YI=KI(),xg={exports:{}},Ig={};var $v;function JI(){if($v)return Ig;$v=1;var i=Eh().__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;return Ig.c=function(e){return i.H.useMemoCache(e)},Ig}var Gv;function QI(){return Gv||(Gv=1,xg.exports=JI()),xg.exports}var vt=QI();var Kv="popstate";function Yv(i){return typeof i=="object"&&i!=null&&"pathname"in i&&"search"in i&&"hash"in i&&"state"in i&&"key"in i}function XI(i={}){function e(s,o){let{pathname:a="/",search:c="",hash:u=""}=Xo(s.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Bp("",{pathname:a,search:c,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(s,o){let a=s.document.querySelector("base"),c="";if(a&&a.getAttribute("href")){let u=s.location.href,h=u.indexOf("#");c=h===-1?u:u.slice(0,h)}return c+"#"+(typeof o=="string"?o:rc(o))}function n(s,o){_i(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return eP(e,t,n,i)}function ht(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function _i(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZI(){return Math.random().toString(36).substring(2,10)}function Jv(i,e){return{usr:i.state,key:i.key,idx:e,masked:i.unstable_mask?{pathname:i.pathname,search:i.search,hash:i.hash}:void 0}}function Bp(i,e,t=null,n,s){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Xo(e):e,state:t,key:e&&e.key||n||ZI(),unstable_mask:s}}function rc({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Xo(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function eP(i,e,t,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,a=s.history,c="POP",u=null,h=m();h==null&&(h=0,a.replaceState({...a.state,idx:h},""));function m(){return(a.state||{idx:null}).idx}function g(){c="POP";let T=m(),A=T==null?null:T-h;h=T,u&&u({action:c,location:C.location,delta:A})}function w(T,A){c="PUSH";let L=Yv(T)?T:Bp(C.location,T,A);t&&t(L,T),h=m()+1;let z=Jv(L,h),j=C.createHref(L.unstable_mask||L);try{a.pushState(z,"",j)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;s.location.assign(j)}o&&u&&u({action:c,location:C.location,delta:1})}function _(T,A){c="REPLACE";let L=Yv(T)?T:Bp(C.location,T,A);t&&t(L,T),h=m();let z=Jv(L,h),j=C.createHref(L.unstable_mask||L);a.replaceState(z,"",j),o&&u&&u({action:c,location:C.location,delta:0})}function v(T){return tP(T)}let C={get action(){return c},get location(){return i(s,a)},listen(T){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Kv,g),u=T,()=>{s.removeEventListener(Kv,g),u=null}},createHref(T){return e(s,T)},createURL:v,encodeLocation(T){let A=v(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:w,replace:_,go(T){return a.go(T)}};return C}function tP(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ht(t,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:rc(i);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function WT(i,e,t="/"){return nP(i,e,t,!1)}function nP(i,e,t,n){let s=typeof e=="string"?Xo(e):e,o=ks(s.pathname||"/",t);if(o==null)return null;let a=$T(i);iP(a);let c=null;for(let u=0;c==null&&u<a.length;++u){let h=mP(o);c=hP(a[u],h,n)}return c}function $T(i,e=[],t=[],n="",s=!1){let o=(a,c,u=s,h)=>{let m={relativePath:h===void 0?a.path||"":h,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&u)return;ht(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let g=Bi([n,m.relativePath]),w=t.concat(m);a.children&&a.children.length>0&&(ht(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),$T(a.children,e,w,g,u)),!(a.path==null&&!a.index)&&e.push({path:g,score:uP(g,a.index),routesMeta:w})};return i.forEach((a,c)=>{if(a.path===""||!a.path?.includes("?"))o(a,c);else for(let u of GT(a.path))o(a,c,!0,u)}),e}function GT(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let a=GT(n.join("/")),c=[];return c.push(...a.map(u=>u===""?o:[o,u].join("/"))),s&&c.push(...a),c.map(u=>i.startsWith("/")&&u===""?"/":u)}function iP(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:dP(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var sP=/^:[\w-]+$/,oP=3,rP=2,aP=1,lP=10,cP=-2,Qv=i=>i==="*";function uP(i,e){let t=i.split("/"),n=t.length;return t.some(Qv)&&(n+=cP),e&&(n+=rP),t.filter(s=>!Qv(s)).reduce((s,o)=>s+(sP.test(o)?oP:o===""?aP:lP),n)}function dP(i,e){return i.length===e.length&&i.slice(0,-1).every((n,s)=>n===e[s])?i[i.length-1]-e[e.length-1]:0}function hP(i,e,t=!1){let{routesMeta:n}=i,s={},o="/",a=[];for(let c=0;c<n.length;++c){let u=n[c],h=c===n.length-1,m=o==="/"?e:e.slice(o.length)||"/",g=Kd({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},m),w=u.route;if(!g&&h&&t&&!n[n.length-1].route.index&&(g=Kd({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},m)),!g)return null;Object.assign(s,g.params),a.push({params:s,pathname:Bi([o,g.pathname]),pathnameBase:wP(Bi([o,g.pathnameBase])),route:w}),g.pathnameBase!=="/"&&(o=Bi([o,g.pathnameBase]))}return a}function Kd(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=fP(i.path,i.caseSensitive,i.end),s=e.match(t);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((h,{paramName:m,isOptional:g},w)=>{if(m==="*"){let v=c[w]||"";a=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const _=c[w];return g&&!_?h[m]=void 0:h[m]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:a,pattern:i}}function fP(i,e=!1,t=!0){_i(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u,h,m)=>{if(n.push({paramName:c,isOptional:u!=null}),u){let g=m.charAt(h+a.length);return g&&g!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function mP(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return _i(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function ks(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}var gP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function pP(i,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof i=="string"?Xo(i):i,o;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?o=Xv(t.substring(1),"/"):o=Xv(t,e)):o=e,{pathname:o,search:_P(n),hash:yP(s)}}function Xv(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Pg(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function bP(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function KT(i){let e=bP(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Tb(i,e,t,n=!1){let s;typeof i=="string"?s=Xo(i):(s={...i},ht(!s.pathname||!s.pathname.includes("?"),Pg("?","pathname","search",s)),ht(!s.pathname||!s.pathname.includes("#"),Pg("#","pathname","hash",s)),ht(!s.search||!s.search.includes("#"),Pg("#","search","hash",s)));let o=i===""||s.pathname==="",a=o?"/":s.pathname,c;if(a==null)c=t;else{let g=e.length-1;if(!n&&a.startsWith("..")){let w=a.split("/");for(;w[0]==="..";)w.shift(),g-=1;s.pathname=w.join("/")}c=g>=0?e[g]:"/"}let u=pP(s,c),h=a&&a!=="/"&&a.endsWith("/"),m=(o||a===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(h||m)&&(u.pathname+="/"),u}var Bi=i=>i.join("/").replace(/\/\/+/g,"/"),wP=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),_P=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,yP=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,vP=class{constructor(i,e,t,n=!1){this.status=i,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function CP(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function kP(i){return i.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var YT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function JT(i,e){let t=i;if(typeof t!="string"||!gP.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,s=!1;if(YT)try{let o=new URL(window.location.href),a=t.startsWith("//")?new URL(o.protocol+t):new URL(t),c=ks(a.pathname,e);a.origin===o.origin&&c!=null?t=c+a.search+a.hash:s=!0}catch{_i(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var QT=["POST","PUT","PATCH","DELETE"];new Set(QT);var TP=["GET",...QT];new Set(TP);var ka=P.createContext(null);ka.displayName="DataRouter";var Sh=P.createContext(null);Sh.displayName="DataRouterState";var EP=P.createContext(!1),XT=P.createContext({isTransitioning:!1});XT.displayName="ViewTransition";var SP=P.createContext(new Map);SP.displayName="Fetchers";var AP=P.createContext(null);AP.displayName="Await";var ri=P.createContext(null);ri.displayName="Navigation";var xc=P.createContext(null);xc.displayName="Location";var Fi=P.createContext({outlet:null,matches:[],isDataRoute:!1});Fi.displayName="Route";var Eb=P.createContext(null);Eb.displayName="RouteError";var ZT="REACT_ROUTER_ERROR",xP="REDIRECT",IP="ROUTE_ERROR_RESPONSE";function PP(i){if(i.startsWith(`${ZT}:${xP}:{`))try{let e=JSON.parse(i.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function RP(i){if(i.startsWith(`${ZT}:${IP}:{`))try{let e=JSON.parse(i.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new vP(e.status,e.statusText,e.data)}catch{}}function OP(i,{relative:e}={}){ht(Ic(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=P.useContext(ri),{hash:s,pathname:o,search:a}=Pc(i,{relative:e}),c=o;return t!=="/"&&(c=o==="/"?t:Bi([t,o])),n.createHref({pathname:c,search:a,hash:s})}function Ic(){return P.useContext(xc)!=null}function zi(){return ht(Ic(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(xc).location}var eE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tE(i){P.useContext(ri).static||P.useLayoutEffect(i)}function Zo(){let{isDataRoute:i}=P.useContext(Fi);return i?WP():VP()}function VP(){ht(Ic(),"useNavigate() may be used only in the context of a <Router> component.");let i=P.useContext(ka),{basename:e,navigator:t}=P.useContext(ri),{matches:n}=P.useContext(Fi),{pathname:s}=zi(),o=JSON.stringify(KT(n)),a=P.useRef(!1);return tE(()=>{a.current=!0}),P.useCallback((u,h={})=>{if(_i(a.current,eE),!a.current)return;if(typeof u=="number"){t.go(u);return}let m=Tb(u,JSON.parse(o),s,h.relative==="path");i==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Bi([e,m.pathname])),(h.replace?t.replace:t.push)(m,h.state,h)},[e,t,o,s,i])}P.createContext(null);function nE(){let{matches:i}=P.useContext(Fi),e=i[i.length-1];return e?e.params:{}}function Pc(i,{relative:e}={}){let{matches:t}=P.useContext(Fi),{pathname:n}=zi(),s=JSON.stringify(KT(t));return P.useMemo(()=>Tb(i,JSON.parse(s),n,e==="path"),[i,s,n,e])}function BP(i,e){return iE(i,e)}function iE(i,e,t){ht(Ic(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=P.useContext(ri),{matches:s}=P.useContext(Fi),o=s[s.length-1],a=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",h=o&&o.route;{let T=h&&h.path||"";oE(c,!h||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=zi(),g;if(e){let T=typeof e=="string"?Xo(e):e;ht(u==="/"||T.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${T.pathname}" was given in the \`location\` prop.`),g=T}else g=m;let w=g.pathname||"/",_=w;if(u!=="/"){let T=u.replace(/^\//,"").split("/");_="/"+w.replace(/^\//,"").split("/").slice(T.length).join("/")}let v=WT(i,{pathname:_});_i(h||v!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),_i(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=FP(v&&v.map(T=>Object.assign({},T,{params:Object.assign({},a,T.params),pathname:Bi([u,n.encodeLocation?n.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?u:Bi([u,n.encodeLocation?n.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),s,t);return e&&C?P.createElement(xc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",unstable_mask:void 0,...g},navigationType:"POP"}},C):C}function MP(){let i=qP(),e=CP(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",i),a=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:o},"ErrorBoundary")," or"," ",P.createElement("code",{style:o},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:s},t):null,a)}var NP=P.createElement(MP,null),sE=class extends P.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const t=RP(i.digest);t&&(i=t)}let e=i!==void 0?P.createElement(Fi.Provider,{value:this.props.routeContext},P.createElement(Eb.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?P.createElement(LP,{error:i},e):e}};sE.contextType=EP;var Rg=new WeakMap;function LP({children:i,error:e}){let{basename:t}=P.useContext(ri);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=PP(e.digest);if(n){let s=Rg.get(e);if(s)throw s;let o=JT(n.location,t);if(YT&&!Rg.get(e))if(o.isExternal||n.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:n.replace}));throw Rg.set(e,a),a}return P.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return i}function DP({routeContext:i,match:e,children:t}){let n=P.useContext(ka);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(Fi.Provider,{value:i},t)}function FP(i,e=[],t){let n=t?.state;if(i==null){if(!n)return null;if(n.errors)i=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)i=n.matches;else return null}let s=i,o=n?.errors;if(o!=null){let m=s.findIndex(g=>g.route.id&&o?.[g.route.id]!==void 0);ht(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,m+1))}let a=!1,c=-1;if(t&&n){a=n.renderFallback;for(let m=0;m<s.length;m++){let g=s[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(c=m),g.route.id){let{loaderData:w,errors:_}=n,v=g.route.loader&&!w.hasOwnProperty(g.route.id)&&(!_||_[g.route.id]===void 0);if(g.route.lazy||v){t.isStatic&&(a=!0),c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}}let u=t?.onError,h=n&&u?(m,g)=>{u(m,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:kP(n.matches),errorInfo:g})}:void 0;return s.reduceRight((m,g,w)=>{let _,v=!1,C=null,T=null;n&&(_=o&&g.route.id?o[g.route.id]:void 0,C=g.route.errorElement||NP,a&&(c<0&&w===0?(oE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,T=null):c===w&&(v=!0,T=g.route.hydrateFallbackElement||null)));let A=e.concat(s.slice(0,w+1)),L=()=>{let z;return _?z=C:v?z=T:g.route.Component?z=P.createElement(g.route.Component,null):g.route.element?z=g.route.element:z=m,P.createElement(DP,{match:g,routeContext:{outlet:m,matches:A,isDataRoute:n!=null},children:z})};return n&&(g.route.ErrorBoundary||g.route.errorElement||w===0)?P.createElement(sE,{location:n.location,revalidation:n.revalidation,component:C,error:_,children:L(),routeContext:{outlet:null,matches:A,isDataRoute:!0},onError:h}):L()},null)}function Sb(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zP(i){let e=P.useContext(ka);return ht(e,Sb(i)),e}function UP(i){let e=P.useContext(Sh);return ht(e,Sb(i)),e}function HP(i){let e=P.useContext(Fi);return ht(e,Sb(i)),e}function Ab(i){let e=HP(i),t=e.matches[e.matches.length-1];return ht(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function jP(){return Ab("useRouteId")}function qP(){let i=P.useContext(Eb),e=UP("useRouteError"),t=Ab("useRouteError");return i!==void 0?i:e.errors?.[t]}function WP(){let{router:i}=zP("useNavigate"),e=Ab("useNavigate"),t=P.useRef(!1);return tE(()=>{t.current=!0}),P.useCallback(async(s,o={})=>{_i(t.current,eE),t.current&&(typeof s=="number"?await i.navigate(s):await i.navigate(s,{fromRouteId:e,...o}))},[i,e])}var Zv={};function oE(i,e,t){!e&&!Zv[i]&&(Zv[i]=!0,_i(!1,t))}P.memo($P);function $P({routes:i,future:e,state:t,isStatic:n,onError:s}){return iE(i,void 0,{state:t,isStatic:n,onError:s})}function Pi(i){ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GP({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:o=!1,unstable_useTransitions:a}){ht(!Ic(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=i.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:c,navigator:s,static:o,unstable_useTransitions:a,future:{}}),[c,s,o,a]);typeof t=="string"&&(t=Xo(t));let{pathname:h="/",search:m="",hash:g="",state:w=null,key:_="default",unstable_mask:v}=t,C=P.useMemo(()=>{let T=ks(h,c);return T==null?null:{location:{pathname:T,search:m,hash:g,state:w,key:_,unstable_mask:v},navigationType:n}},[c,h,m,g,w,_,n,v]);return _i(C!=null,`<Router basename="${c}"> is not able to match the URL "${h}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:P.createElement(ri.Provider,{value:u},P.createElement(xc.Provider,{children:e,value:C}))}function KP({children:i,location:e}){return BP(Mp(i),e)}function Mp(i,e=[]){let t=[];return P.Children.forEach(i,(n,s)=>{if(!P.isValidElement(n))return;let o=[...e,s];if(n.type===P.Fragment){t.push.apply(t,Mp(n.props.children,o));return}ht(n.type===Pi,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ht(!n.props.index||!n.props.children,"An index route cannot have child routes.");let a={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Mp(n.props.children,o)),t.push(a)}),t}var Bd="get",Md="application/x-www-form-urlencoded";function Ah(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function YP(i){return Ah(i)&&i.tagName.toLowerCase()==="button"}function JP(i){return Ah(i)&&i.tagName.toLowerCase()==="form"}function QP(i){return Ah(i)&&i.tagName.toLowerCase()==="input"}function XP(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function ZP(i,e){return i.button===0&&(!e||e==="_self")&&!XP(i)}var od=null;function eR(){if(od===null)try{new FormData(document.createElement("form"),0),od=!1}catch{od=!0}return od}var tR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Og(i){return i!=null&&!tR.has(i)?(_i(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Md}"`),null):i}function nR(i,e){let t,n,s,o,a;if(JP(i)){let c=i.getAttribute("action");n=c?ks(c,e):null,t=i.getAttribute("method")||Bd,s=Og(i.getAttribute("enctype"))||Md,o=new FormData(i)}else if(YP(i)||QP(i)&&(i.type==="submit"||i.type==="image")){let c=i.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=i.getAttribute("formaction")||c.getAttribute("action");if(n=u?ks(u,e):null,t=i.getAttribute("formmethod")||c.getAttribute("method")||Bd,s=Og(i.getAttribute("formenctype"))||Og(c.getAttribute("enctype"))||Md,o=new FormData(c,i),!eR()){let{name:h,type:m,value:g}=i;if(m==="image"){let w=h?`${h}.`:"";o.append(`${w}x`,"0"),o.append(`${w}y`,"0")}else h&&o.append(h,g)}}else{if(Ah(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bd,n=null,s=Md,a=i}return o&&s==="text/plain"&&(a=o,o=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xb(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function iR(i,e,t,n){let s=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${n}`:s.pathname=`${s.pathname}.${n}`:s.pathname==="/"?s.pathname=`_root.${n}`:e&&ks(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function sR(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function oR(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function rR(i,e,t){let n=await Promise.all(i.map(async s=>{let o=e.routes[s.route.id];if(o){let a=await sR(o,t);return a.links?a.links():[]}return[]}));return uR(n.flat(1).filter(oR).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function e1(i,e,t,n,s,o){let a=(u,h)=>t[h]?u.route.id!==t[h].route.id:!0,c=(u,h)=>t[h].pathname!==u.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==u.params["*"];return o==="assets"?e.filter((u,h)=>a(u,h)||c(u,h)):o==="data"?e.filter((u,h)=>{let m=n.routes[u.route.id];if(!m||!m.hasLoader)return!1;if(a(u,h)||c(u,h))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function aR(i,e,{includeHydrateFallback:t}={}){return lR(i.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function lR(i){return[...new Set(i)]}function cR(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function uR(i,e){let t=new Set;return new Set(e),i.reduce((n,s)=>{let o=JSON.stringify(cR(s));return t.has(o)||(t.add(o),n.push({key:o,link:s})),n},[])}function rE(){let i=P.useContext(ka);return xb(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function dR(){let i=P.useContext(Sh);return xb(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Ib=P.createContext(void 0);Ib.displayName="FrameworkContext";function aE(){let i=P.useContext(Ib);return xb(i,"You must render this element inside a <HydratedRouter> element"),i}function hR(i,e){let t=P.useContext(Ib),[n,s]=P.useState(!1),[o,a]=P.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:h,onMouseLeave:m,onTouchStart:g}=e,w=P.useRef(null);P.useEffect(()=>{if(i==="render"&&a(!0),i==="viewport"){let C=A=>{A.forEach(L=>{a(L.isIntersecting)})},T=new IntersectionObserver(C,{threshold:.5});return w.current&&T.observe(w.current),()=>{T.disconnect()}}},[i]),P.useEffect(()=>{if(n){let C=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(C)}}},[n]);let _=()=>{s(!0)},v=()=>{s(!1),a(!1)};return t?i!=="intent"?[o,w,{}]:[o,w,{onFocus:Tl(c,_),onBlur:Tl(u,v),onMouseEnter:Tl(h,_),onMouseLeave:Tl(m,v),onTouchStart:Tl(g,_)}]:[!1,w,{}]}function Tl(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function fR({page:i,...e}){let{router:t}=rE(),n=P.useMemo(()=>WT(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?P.createElement(gR,{page:i,matches:n,...e}):null}function mR(i){let{manifest:e,routeModules:t}=aE(),[n,s]=P.useState([]);return P.useEffect(()=>{let o=!1;return rR(i,e,t).then(a=>{o||s(a)}),()=>{o=!0}},[i,e,t]),n}function gR({page:i,matches:e,...t}){let n=zi(),{future:s,manifest:o,routeModules:a}=aE(),{basename:c}=rE(),{loaderData:u,matches:h}=dR(),m=P.useMemo(()=>e1(i,e,h,o,n,"data"),[i,e,h,o,n]),g=P.useMemo(()=>e1(i,e,h,o,n,"assets"),[i,e,h,o,n]),w=P.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let C=new Set,T=!1;if(e.forEach(L=>{let z=o.routes[L.route.id];!z||!z.hasLoader||(!m.some(j=>j.route.id===L.route.id)&&L.route.id in u&&a[L.route.id]?.shouldRevalidate||z.hasClientLoader?T=!0:C.add(L.route.id))}),C.size===0)return[];let A=iR(i,c,s.unstable_trailingSlashAwareDataRequests,"data");return T&&C.size>0&&A.searchParams.set("_routes",e.filter(L=>C.has(L.route.id)).map(L=>L.route.id).join(",")),[A.pathname+A.search]},[c,s.unstable_trailingSlashAwareDataRequests,u,n,o,m,e,i,a]),_=P.useMemo(()=>aR(g,o),[g,o]),v=mR(g);return P.createElement(P.Fragment,null,w.map(C=>P.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...t})),_.map(C=>P.createElement("link",{key:C,rel:"modulepreload",href:C,...t})),v.map(({key:C,link:T})=>P.createElement("link",{key:C,nonce:t.nonce,...T,crossOrigin:T.crossOrigin??t.crossOrigin})))}function pR(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var bR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bR&&(window.__reactRouterVersion="7.13.1")}catch{}function wR({basename:i,children:e,unstable_useTransitions:t,window:n}){let s=P.useRef();s.current==null&&(s.current=XI({window:n,v5Compat:!0}));let o=s.current,[a,c]=P.useState({action:o.action,location:o.location}),u=P.useCallback(h=>{t===!1?c(h):P.startTransition(()=>c(h))},[t]);return P.useLayoutEffect(()=>o.listen(u),[o,u]),P.createElement(GP,{basename:i,children:e,location:a.location,navigationType:a.action,navigator:o,unstable_useTransitions:t})}var lE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rc=P.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:o,replace:a,unstable_mask:c,state:u,target:h,to:m,preventScrollReset:g,viewTransition:w,unstable_defaultShouldRevalidate:_,...v},C){let{basename:T,navigator:A,unstable_useTransitions:L}=P.useContext(ri),z=typeof m=="string"&&lE.test(m),j=JT(m,T);m=j.to;let Z=OP(m,{relative:s}),ne=zi(),M=null;if(c){let Ne=Tb(c,[],ne.unstable_mask?ne.unstable_mask.pathname:"/",!0);T!=="/"&&(Ne.pathname=Ne.pathname==="/"?T:Bi([T,Ne.pathname])),M=A.createHref(Ne)}let[J,Y,ie]=hR(n,v),Ee=CR(m,{replace:a,unstable_mask:c,state:u,target:h,preventScrollReset:g,relative:s,viewTransition:w,unstable_defaultShouldRevalidate:_,unstable_useTransitions:L});function Ve(Ne){e&&e(Ne),Ne.defaultPrevented||Ee(Ne)}let ot=!(j.isExternal||o),rt=P.createElement("a",{...v,...ie,href:(ot?M:void 0)||j.absoluteURL||Z,onClick:ot?Ve:e,ref:pR(C,Y),target:h,"data-discover":!z&&t==="render"?"true":void 0});return J&&!z?P.createElement(P.Fragment,null,rt,P.createElement(fR,{page:Z})):rt});Rc.displayName="Link";var _R=P.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:o,to:a,viewTransition:c,children:u,...h},m){let g=Pc(a,{relative:h.relative}),w=zi(),_=P.useContext(Sh),{navigator:v,basename:C}=P.useContext(ri),T=_!=null&&AR(g)&&c===!0,A=v.encodeLocation?v.encodeLocation(g).pathname:g.pathname,L=w.pathname,z=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;t||(L=L.toLowerCase(),z=z?z.toLowerCase():null,A=A.toLowerCase()),z&&C&&(z=ks(z,C)||z);const j=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let Z=L===A||!s&&L.startsWith(A)&&L.charAt(j)==="/",ne=z!=null&&(z===A||!s&&z.startsWith(A)&&z.charAt(A.length)==="/"),M={isActive:Z,isPending:ne,isTransitioning:T},J=Z?e:void 0,Y;typeof n=="function"?Y=n(M):Y=[n,Z?"active":null,ne?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let ie=typeof o=="function"?o(M):o;return P.createElement(Rc,{...h,"aria-current":J,className:Y,ref:m,style:ie,to:a,viewTransition:c},typeof u=="function"?u(M):u)});_R.displayName="NavLink";var yR=P.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:o,method:a=Bd,action:c,onSubmit:u,relative:h,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:w,..._},v)=>{let{unstable_useTransitions:C}=P.useContext(ri),T=ER(),A=SR(c,{relative:h}),L=a.toLowerCase()==="get"?"get":"post",z=typeof c=="string"&&lE.test(c),j=Z=>{if(u&&u(Z),Z.defaultPrevented)return;Z.preventDefault();let ne=Z.nativeEvent.submitter,M=ne?.getAttribute("formmethod")||a,J=()=>T(ne||Z.currentTarget,{fetcherKey:e,method:M,navigate:t,replace:s,state:o,relative:h,preventScrollReset:m,viewTransition:g,unstable_defaultShouldRevalidate:w});C&&t!==!1?P.startTransition(()=>J()):J()};return P.createElement("form",{ref:v,method:L,action:A,onSubmit:n?u:j,..._,"data-discover":!z&&i==="render"?"true":void 0})});yR.displayName="Form";function vR(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cE(i){let e=P.useContext(ka);return ht(e,vR(i)),e}function CR(i,{target:e,replace:t,unstable_mask:n,state:s,preventScrollReset:o,relative:a,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:h}={}){let m=Zo(),g=zi(),w=Pc(i,{relative:a});return P.useCallback(_=>{if(ZP(_,e)){_.preventDefault();let v=t!==void 0?t:rc(g)===rc(w),C=()=>m(i,{replace:v,unstable_mask:n,state:s,preventScrollReset:o,relative:a,viewTransition:c,unstable_defaultShouldRevalidate:u});h?P.startTransition(()=>C()):C()}},[g,m,w,t,n,s,e,i,o,a,c,u,h])}var kR=0,TR=()=>`__${String(++kR)}__`;function ER(){let{router:i}=cE("useSubmit"),{basename:e}=P.useContext(ri),t=jP(),n=i.fetch,s=i.navigate;return P.useCallback(async(o,a={})=>{let{action:c,method:u,encType:h,formData:m,body:g}=nR(o,e);if(a.navigate===!1){let w=a.fetcherKey||TR();await n(w,t,a.action||c,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:m,body:g,formMethod:a.method||u,formEncType:a.encType||h,flushSync:a.flushSync})}else await s(a.action||c,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:m,body:g,formMethod:a.method||u,formEncType:a.encType||h,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,s,e,t])}function SR(i,{relative:e}={}){let{basename:t}=P.useContext(ri),n=P.useContext(Fi);ht(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...Pc(i||".",{relative:e})},a=zi();if(i==null){o.search=a.search;let c=new URLSearchParams(o.search),u=c.getAll("index");if(u.some(m=>m==="")){c.delete("index"),u.filter(g=>g).forEach(g=>c.append("index",g));let m=c.toString();o.search=m?`?${m}`:""}}return(!i||i===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Bi([t,o.pathname])),rc(o)}function AR(i,{relative:e}={}){let t=P.useContext(XT);ht(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=cE("useViewTransitionState"),s=Pc(i,{relative:e});if(!t.isTransitioning)return!1;let o=ks(t.currentLocation.pathname,n)||t.currentLocation.pathname,a=ks(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Kd(s.pathname,a)!=null||Kd(s.pathname,o)!=null}function Mn(i){const e=vt.c(3),{className:t,children:n}=i,s=t+" blog-container p-12 sm:p-10 ";let o;return e[0]!==n||e[1]!==s?(o=O.jsx("div",{className:s,children:n}),e[0]=n,e[1]=s,e[2]=o):o=e[2],o}function xh(i){const e=vt.c(3),{className:t,children:n}=i,s=t+" marker-h1 text-4xl text-marker-black mb-6";let o;return e[0]!==n||e[1]!==s?(o=O.jsx("h1",{className:s,children:n}),e[0]=n,e[1]=s,e[2]=o):o=e[2],o}function ps(i){const e=vt.c(5),{className:t,children:n,onClick:s,type:o,color:a}=i,c=o===void 0?"button":o,h=t+` ${a===void 0?"marker-btn-default":a} px-4 py-2 rounded-lg marker-btn shadow-[3px_3px_0_0_#111827]`;let m;return e[0]!==n||e[1]!==s||e[2]!==h||e[3]!==c?(m=O.jsx("button",{className:h,type:c,onClick:s,children:n}),e[0]=n,e[1]=s,e[2]=h,e[3]=c,e[4]=m):m=e[4],m}const uE=P.createContext(null),Ui=()=>{const i=P.useContext(uE);if(!i)throw new Error("useAuth must be used inside AuthProvider");return i};function Nn(){const i=vt.c(5),e=zi(),{loggedIn:t}=Ui(),s=xR(e.pathname);let o;i[0]===Symbol.for("react.memo_cache_sentinel")?(o=[{path:"/",label:"Home",page:"home"},{path:"/posts",label:"Posts",page:"posts"},{path:"/about",label:"About",page:"about"},{path:"/profile",label:"Profile",page:"profile"},{path:"/create-post",label:"+ New Post",page:"create-post"}],i[0]=o):o=i[0];const a=o;let c;i[1]===Symbol.for("react.memo_cache_sentinel")?(c=O.jsxs(xh,{children:["> Azizo Blog",O.jsx("span",{className:"text-red-500",children:" (Tech and programming)"})]}),i[1]=c):c=i[1];let u;return i[2]!==s||i[3]!==t?(u=O.jsxs("header",{className:"mb-8",children:[c,O.jsx("nav",{className:"flex flex-wrap gap-4 text-sm",children:a.map(h=>O.jsx(Rc,{to:h.path,children:O.jsx(ps,{color:s===h.page?"marker-btn-violet":"marker-btn-default",className:!t&&(h.page==="profile"||h.page==="create-post")?"hidden":"",children:h.label})},h.path))})]}),i[2]=s,i[3]=t,i[4]=u):u=i[4],u}function xR(i){switch(i){case"/":return"home";case"/posts":return"posts";case"/about":return"about";case"/profile":return"profile";case"/create-post":return"create-post";default:return""}}function ni(i){const e=vt.c(3),{className:t,children:n}=i,s=t+" marker-h2 text-3xl";let o;return e[0]!==n||e[1]!==s?(o=O.jsx("h2",{className:s,children:n}),e[0]=n,e[1]=s,e[2]=o):o=e[2],o}function rd(i=!1){const e=new Date,t=e.getDate(),n=e.getMonth()+1,s=e.getFullYear();if(!i)return`${t}-${n}-${s}`;const o=e.getHours(),a=e.getMinutes().toString().padStart(2,"0");return`${t}-${n}-${s} - ${o}:${a}`}const zl={help:{command:"help",description:"Lists all available commands",usage:"Usage: help",action:({print:i})=>{i("Available commands: ");for(const[e,{description:t,usage:n}]of Object.entries(zl))i(`- ${e}: ${t}`),i(`>> ${n}`)}},nav:{command:"nav",description:"Navigates to a given route",usage:"Usage: nav [route]",action:({nav:i,print:e},t)=>{const n=["/","/about","/posts","/post/:id"];function s(a){return n.some(c=>c.includes(":")?new RegExp("^"+c.replace(/:\w+/g,"\\w+")+"$").test(a):c===a)}if(!t||t.length===0){e(zl.nav.usage);return}const o=t[0];if(!s(o)){e(`Route: ${o} not found`);return}e(`Navigating to ${o}...`),i(o)}},echo:{command:"echo",description:"Prints a message",usage:"Usage: echo [message]",action:({print:i},e)=>{if(!e||e.length===0){i(zl.echo.usage);return}i(e.join(" "))}},clear:{command:"clear",description:"Clears the terminal",usage:"Usage: clear",action:({clear:i})=>{i()}},status:{command:"status",description:"Show system status",usage:"status",action:({print:i})=>{i("> SYSTEM DIAGNOSTICS RUNNING..."),i(`[${rd(!0)}]`),i("[OK] Core temperature stable"),i("[WARN] Caffeine reserves critically low"),i("[FAIL] Sleep module unresponsive"),i("[OK] Type safety integrity: 87%"),i("SYSTEM STATUS: OPERATIONAL")}},date:{command:"date",description:"Get current date",usage:'Usage: date [includeTime: "true or false" -optional]',action:({print:i},e)=>{if(!e||e.length===0){i(rd(!1));return}e[0]==="true"?i(rd(!0)):e[0]==="false"?i(rd(!1)):i(zl.date.usage)}}};function IR(i,e){const t=i.trim();if(!t)return;const[n,...s]=t.split(" "),o=zl[n];if(!o){e.print(`Error: Unknown command '${n}'. Type 'help' to see all commands.`);return}try{o.action(e,s)}catch(a){const c=a;e.print(`Error while executing '${n}': ${c.message}`)}}function PR(){const i=vt.c(24);let e;i[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],i[0]=e):e=i[0];const[t,n]=P.useState(e),[s,o]=P.useState(""),a=P.useRef(null),c=Zo();let u;i[1]===Symbol.for("react.memo_cache_sentinel")?(u=Y=>n(ie=>[...ie,Y]),i[1]=u):u=i[1];const h=u;let m;i[2]===Symbol.for("react.memo_cache_sentinel")?(m=()=>n([]),i[2]=m):m=i[2];const g=m;let w;i[3]!==c?(w={print:h,clear:g,nav:ie=>c(ie)},i[3]=c,i[4]=w):w=i[4];const _=w;let v;i[5]!==_||i[6]!==s?(v=Y=>{Y.preventDefault(),s.trim()&&(h(`$ ${s}`),IR(s,_),o(""))},i[5]=_,i[6]=s,i[7]=v):v=i[7];const C=v;let T;i[8]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{a.current?.scrollTo(0,a.current.scrollHeight)},i[8]=T):T=i[8];let A;i[9]!==t?(A=[t],i[9]=t,i[10]=A):A=i[10],P.useEffect(T,A);let L;i[11]===Symbol.for("react.memo_cache_sentinel")?(L=O.jsx("p",{className:"text-[rgb(107_114_128)]",children:"Aziz-Shell v1.0 [Type 'help' or 'status']"}),i[11]=L):L=i[11];let z;i[12]!==t?(z=t.map(RR),i[12]=t,i[13]=z):z=i[13];let j;i[14]===Symbol.for("react.memo_cache_sentinel")?(j=O.jsx("span",{children:"$ "}),i[14]=j):j=i[14];let Z;i[15]===Symbol.for("react.memo_cache_sentinel")?(Z=Y=>o(Y.target.value),i[15]=Z):Z=i[15];let ne;i[16]!==s?(ne=O.jsx("input",{className:"bg-transparent border-none outline-none text-green-400 w-3/4",id:"command-input",value:s,onChange:Z}),i[16]=s,i[17]=ne):ne=i[17];let M;i[18]!==C||i[19]!==ne?(M=O.jsxs("form",{onSubmit:C,children:[j,ne]}),i[18]=C,i[19]=ne,i[20]=M):M=i[20];let J;return i[21]!==M||i[22]!==z?(J=O.jsx("label",{htmlFor:"command-input",children:O.jsxs("div",{className:`\r
        bg-black \r
        text-green-400 \r
        p-4 \r
        font-mono \r
        mb-6\r
        h-96 \r
        overflow-y-auto \r
        rounded-xl \r
        [scrollbar-width:none] \r
        [-ms-overflow-style:none] \r
        [&::-webkit-scrollbar]:hidden \r
        selection:bg-green-500/20\r
    `,ref:a,children:[L,z,M]})}),i[21]=M,i[22]=z,i[23]=J):J=i[23],J}function RR(i,e){return O.jsx("div",{children:i},e)}function t1(i){const e=vt.c(3),{className:t,children:n}=i,s=t+" text-2xl marker-h3";let o;return e[0]!==n||e[1]!==s?(o=O.jsx("h3",{className:s,children:n}),e[0]=n,e[1]=s,e[2]=o):o=e[2],o}function OR(i,e=3){return i.slice().sort((t,n)=>{const s=new Date(t.createdAt).getTime();return new Date(n.createdAt).getTime()-s}).slice(0,e)}function dE(i){const e=vt.c(12),{id:t,className:n,title:s,publishDate:o,tags:a}=i,c=n+" p-4 border-2 border-marker-black rounded-lg shadow-[3px_3px_0_0_#111827] hover:bg-gray-100 transition duration-100",u=`/post/${t}`;let h;e[0]!==u||e[1]!==s?(h=O.jsx(Rc,{to:u,className:"text-xl text-{var(--marker-black)} primary-link",children:s}),e[0]=u,e[1]=s,e[2]=h):h=e[2];let m;e[3]!==a?(m=a.join(", "),e[3]=a,e[4]=m):m=e[4];let g;e[5]!==o||e[6]!==m?(g=O.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[o,"  ",m]}),e[5]=o,e[6]=m,e[7]=g):g=e[7];let w;return e[8]!==c||e[9]!==h||e[10]!==g?(w=O.jsxs("div",{className:c,children:[h,g]}),e[8]=c,e[9]=h,e[10]=g,e[11]=w):w=e[11],w}function hE(i){const[e,t]=P.useState(null),[n,s]=P.useState(!0),[o,a]=P.useState(null),c=P.useCallback(async()=>{s(!0),a(null);try{const u=await fetch(i);if(!u.ok)throw new Error(`Error: ${u.status} ${u.statusText}`);const h=await u.json();t(h)}catch(u){u instanceof Error?a(u.message):a("An unknown error occurred")}finally{s(!1)}},[i]);return P.useEffect(()=>{c()},[c]),{posts:e,loading:n,error:o,fetchPosts:c}}const ws="https://blogapi.techazizo.site";function VR(){const i=vt.c(32),{posts:e,loading:t,error:n,fetchPosts:s}=hE(`${ws}/api/posts`);let o,a;i[0]!==s?(o=()=>{s()},a=[s],i[0]=s,i[1]=o,i[2]=a):(o=i[1],a=i[2]),P.useEffect(o,a);const c=e?OR(e,4):[];let u,h;i[3]!==s?(u=()=>{const Y=setInterval(()=>{s()},1e4);return()=>clearInterval(Y)},h=[s],i[3]=s,i[4]=u,i[5]=h):(u=i[4],h=i[5]),P.useEffect(u,h);const m=Mn;let g,w,_,v,C,T,A;i[6]===Symbol.for("react.memo_cache_sentinel")?(w=O.jsx(Nn,{}),_=O.jsx(ni,{children:"Hello World: Welcome to the Scratchpad"}),v=O.jsx("p",{className:"mb-6 font-mono text-gray-700",children:"This is where I dump my thoughts on code, architecture, and why type safety is essential and dynamic languages suck. Think of it as a messy, caffeine-fueled journal powered by Node.js and TypeScript, where I argue with my own functions, debate if Redux is overkill, and suffering at 2 AM trying to figure out regex."}),C=O.jsx("p",{className:"mb-6 font-mono text-gray-700",children:"It's not polished, it's not always elegant, but it's real: notes on what worked, what broke, and what probably shouldn't exist in production but somehow does. A place to capture the chaotic thought process behind building things that run, crash, and run again."}),T=O.jsx(t1,{children:"Welcome, get started by trying my amazing CLI..."}),A=O.jsx(PR,{}),g=O.jsx(t1,{children:"...Or reading my latest posts"}),i[6]=g,i[7]=w,i[8]=_,i[9]=v,i[10]=C,i[11]=T,i[12]=A):(g=i[6],w=i[7],_=i[8],v=i[9],C=i[10],T=i[11],A=i[12]);let L;i[13]!==t?(L=t&&O.jsx("p",{children:"Loading posts..."}),i[13]=t,i[14]=L):L=i[14];let z;i[15]!==n?(z=n&&O.jsxs("p",{className:"text-red-500",children:["Error: ",n]}),i[15]=n,i[16]=z):z=i[16];const j=!t&&!n&&c.length===0&&O.jsx("p",{children:"No posts available."}),Z="space-y-6",ne=c.map(BR);let M;i[17]!==ne?(M=O.jsx("div",{className:Z,children:ne}),i[17]=ne,i[18]=M):M=i[18];let J;return i[19]!==m||i[20]!==g||i[21]!==L||i[22]!==z||i[23]!==j||i[24]!==M||i[25]!==w||i[26]!==_||i[27]!==v||i[28]!==C||i[29]!==T||i[30]!==A?(J=O.jsxs(m,{children:[w,_,v,C,T,A,g,L,z,j,M]}),i[19]=m,i[20]=g,i[21]=L,i[22]=z,i[23]=j,i[24]=M,i[25]=w,i[26]=_,i[27]=v,i[28]=C,i[29]=T,i[30]=A,i[31]=J):J=i[31],J}function BR(i){const{_id:e,title:t,tags:n,createdAt:s}=i;return O.jsx(dE,{id:e,title:t,tags:n,publishDate:new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},e)}function MR(){const i=vt.c(5);let e,t,n,s;i[0]===Symbol.for("react.memo_cache_sentinel")?(e=O.jsx(Nn,{}),t=O.jsx(xh,{children:"WHO AM I? (ABOUT ME)"}),n=O.jsx("p",{className:"text-md font-mono m-5 mr-0",children:"Hello! I'm Abdulaziz, a college student pursuing my CE degree. I like to call myself a full-stack engineer, basically, I write some nonsense and you get a user interface, an API or both. I love AI, and I'm aiming to become a data scientist or ML engineer, chasing the dream of working in big tech. When I'm not geeking out over AI, you'll find me gaming, building both useful and useless applications, diving into theoretical CS, or tinkering with computer hardware. If I don't pick up your call well, I'm probably busy trying to solve the P vs NP problem."}),s=O.jsx(ni,{className:"font-semibold",children:"My Skills()"}),i[0]=e,i[1]=t,i[2]=n,i[3]=s):(e=i[0],t=i[1],n=i[2],s=i[3]);let o;return i[4]===Symbol.for("react.memo_cache_sentinel")?(o=O.jsxs(Mn,{children:[e,t,n,s,O.jsxs("ul",{className:"font-mono",children:[O.jsx("li",{children:"* React.js, TypeScript, Tailwind, Next.js"}),O.jsx("li",{children:"* Responsive design, Pixel perfect implementation, Clean code"}),O.jsx("li",{children:"* Node.js, Express.js, MongoDB, MySQL"}),O.jsx("li",{children:"* Git, Github"}),O.jsx("li",{children:"* Basic Docker and CI/CD (Still learning)"}),O.jsx("li",{children:"* Drinking a lot of coffee"})]})]}),i[4]=o):o=i[4],o}function NR(){const i=vt.c(18),{posts:e,loading:t,error:n,fetchPosts:s}=hE(`${ws}/api/posts`);let o,a;i[0]!==s?(o=()=>{s()},a=[s],i[0]=s,i[1]=o,i[2]=a):(o=i[1],a=i[2]),P.useEffect(o,a);let c,u;if(i[3]!==s?(c=()=>{const _=setInterval(()=>{s()},18e5);return()=>clearInterval(_)},u=[s],i[3]=s,i[4]=c,i[5]=u):(c=i[4],u=i[5]),P.useEffect(c,u),t){let _;return i[6]===Symbol.for("react.memo_cache_sentinel")?(_=O.jsxs(Mn,{children:[O.jsx(Nn,{}),O.jsx(ni,{children:"Posts"}),O.jsx("p",{children:"Loading posts..."})]}),i[6]=_):_=i[6],_}if(n){let _,v;i[7]===Symbol.for("react.memo_cache_sentinel")?(_=O.jsx(Nn,{}),v=O.jsx(ni,{children:"Posts"}),i[7]=_,i[8]=v):(_=i[7],v=i[8]);let C;return i[9]!==n?(C=O.jsxs(Mn,{children:[_,v,O.jsxs("p",{className:"text-red-500",children:["Error: ",n]})]}),i[9]=n,i[10]=C):C=i[10],C}if(!e||e.length===0){let _;return i[11]===Symbol.for("react.memo_cache_sentinel")?(_=O.jsxs(Mn,{children:[O.jsx(Nn,{}),O.jsx(ni,{children:"Posts"}),O.jsx("p",{children:"No posts available."})]}),i[11]=_):_=i[11],_}let h,m;i[12]===Symbol.for("react.memo_cache_sentinel")?(h=O.jsx(Nn,{}),m=O.jsx(ni,{children:"Posts"}),i[12]=h,i[13]=m):(h=i[12],m=i[13]);let g;i[14]!==e?(g=e.map(LR),i[14]=e,i[15]=g):g=i[15];let w;return i[16]!==g?(w=O.jsxs(Mn,{children:[h,m,O.jsx("div",{className:"space-y-6",children:g})]}),i[16]=g,i[17]=w):w=i[17],w}function LR(i){const{_id:e,title:t,tags:n,createdAt:s}=i;return O.jsx(dE,{id:e,title:t,tags:n,publishDate:new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},e)}function DR(i,e,t){const[n,s]=P.useState(!1),[o,a]=P.useState(null),{token:c}=Ui();return{deleting:n,error:o,deletePost:async()=>{s(!0),a(null);try{const h={};c&&(h.Authorization=`Bearer ${c}`);const m=await fetch(`${i}/${e}`,{method:"DELETE",headers:h});if(!m.ok)throw new Error(`Error: ${m.status} ${m.statusText}`);t()}catch(h){h instanceof Error?a(h.message):a("An unknown error occurred while deleting post")}finally{s(!1)}}}}function FR(i){const e=vt.c(2),{children:t}=i;let n;return e[0]!==t?(n=O.jsx("span",{className:"px-3 py-1 text-sm rounded-full border-2 border-dashed border-red-500 text-red-700 bg-red-50 font-mono shadow-[3px_3px_0_0_#111827] hover:bg-red-100 transition-colors cursor-pointer",children:t}),e[0]=t,e[1]=n):n=e[1],n}function fE(i,e){const[t,n]=P.useState(null),[s,o]=P.useState(!0),[a,c]=P.useState(null),u=P.useCallback(async()=>{o(!0),c(null);try{const h=await fetch(`${i}/${e}`);if(!h.ok)throw new Error(`Error: ${h.status} ${h.statusText}`);const m=await h.json();n(m)}catch(h){h instanceof Error?c(h.message):c("An unknown error occured")}finally{o(!1)}},[i,e]);return P.useEffect(()=>{u()},[u]),{post:t,loading:s,error:a,fetchPost:u}}function zR(){const i=vt.c(42),{id:e}=nE(),t=e||"",n=HR,[s,o]=P.useState(!1),{loggedIn:a}=Ui(),c=Zo(),{deleting:u,deletePost:h}=DR(`${ws}/api/posts`,t,n),{post:m,loading:g,error:w,fetchPost:_}=fE(`${ws}/api/posts`,t);let v,C;i[0]!==_?(v=()=>{_()},C=[_],i[0]=_,i[1]=v,i[2]=C):(v=i[1],C=i[2]),P.useEffect(v,C);let T;i[3]===Symbol.for("react.memo_cache_sentinel")?(T=function(){o(!0)},i[3]=T):T=i[3];const A=T;let L;i[4]===Symbol.for("react.memo_cache_sentinel")?(L=function(){o(!1)},i[4]=L):L=i[4];const z=L;let j;i[5]!==h||i[6]!==c?(j=async function(){o(!1);try{await h(),c("/posts")}catch(I){const $=I;$ instanceof Error?c("/error",{state:{error:$.message}}):c("/error",{state:{error:"An unknown error occurred while deleting post"}})}},i[5]=h,i[6]=c,i[7]=j):j=i[7];const Z=j;let ne;i[8]!==c||i[9]!==t?(ne=()=>{c(`/edit-post/${t}`)},i[8]=c,i[9]=t,i[10]=ne):ne=i[10];const M=ne;if(g){let we;return i[11]===Symbol.for("react.memo_cache_sentinel")?(we=O.jsxs(Mn,{children:[O.jsx(Nn,{}),O.jsx(ni,{children:"Loading Post..."})]}),i[11]=we):we=i[11],we}if(w)return c("/error",{state:{error:w}}),null;if(!m){let we;return i[12]===Symbol.for("react.memo_cache_sentinel")?(we=O.jsxs(Mn,{children:[O.jsx(Nn,{}),O.jsx(ni,{children:"404 Post not found"})]}),i[12]=we):we=i[12],we}let J;i[13]===Symbol.for("react.memo_cache_sentinel")?(J=O.jsx(Nn,{}),i[13]=J):J=i[13];let Y;i[14]===Symbol.for("react.memo_cache_sentinel")?(Y=O.jsx("div",{className:"mb-8",children:O.jsx(Rc,{to:"/posts",className:"text-sm text-red-500 primary-link",children:" Back to all posts"})}),i[14]=Y):Y=i[14];let ie;i[15]!==m.title?(ie=O.jsx(ni,{children:m.title}),i[15]=m.title,i[16]=ie):ie=i[16];const Ee=m.author;let Ve;i[17]!==m.createdAt?(Ve=new Date(m.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),i[17]=m.createdAt,i[18]=Ve):Ve=i[18];let ot;i[19]!==m.author||i[20]!==Ve?(ot=O.jsxs("p",{className:"text-sm text-gray-500 mb-2",id:"post-metadata-display",children:["By ",Ee,"  Published"," ",Ve]}),i[19]=m.author,i[20]=Ve,i[21]=ot):ot=i[21];let rt;i[22]!==m.tags?(rt=m.tags.map(UR),i[22]=m.tags,i[23]=rt):rt=i[23];let Ne;i[24]!==rt?(Ne=O.jsx("div",{id:"post-tags-display",className:"mb-6 flex flex-wrap gap-2 font-mono",children:rt}),i[24]=rt,i[25]=Ne):Ne=i[25];let H;i[26]!==m.content?(H=O.jsx("div",{className:"font-mono text-gray-800 space-y-5 text-left font-500",id:"post-content-display",children:O.jsx("div",{className:"content",dangerouslySetInnerHTML:{__html:m.content}})}),i[26]=m.content,i[27]=H):H=i[27];let X;i[28]!==u||i[29]!==M||i[30]!==a?(X=a&&O.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t-2 border-dashed border-gray-300",children:[O.jsx(ps,{onClick:M,children:"Edit"}),O.jsx(ps,{color:"marker-btn-red",onClick:A,children:u?"Deleting...":"Delete"})]}),i[28]=u,i[29]=M,i[30]=a,i[31]=X):X=i[31];let de;i[32]!==Z||i[33]!==s?(de=s&&O.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:O.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm text-center",children:[O.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-900",children:"Delete Post?"}),O.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Are you sure you want to delete this post? This action cannot be undone."}),O.jsxs("div",{className:"flex justify-center gap-4",children:[O.jsx(ps,{onClick:z,children:"Cancel"}),O.jsx(ps,{color:"marker-btn-red",onClick:Z,children:"Confirm Delete"})]})]})}),i[32]=Z,i[33]=s,i[34]=de):de=i[34];let Te;return i[35]!==ot||i[36]!==Ne||i[37]!==H||i[38]!==X||i[39]!==de||i[40]!==ie?(Te=O.jsxs(Mn,{children:[J,Y,ie,ot,Ne,H,X,de]}),i[35]=ot,i[36]=Ne,i[37]=H,i[38]=X,i[39]=de,i[40]=ie,i[41]=Te):Te=i[41],Te}function UR(i){return O.jsx(FR,{children:i},i)}async function HR(){}function Yd(i){const e=vt.c(16),{className:t,placeholder:n,label:s,name:o,type:a,value:c,error:u,onChange:h}=i,m=a===void 0?"text":a;let g;e[0]!==s?(g=O.jsx("label",{htmlFor:s,className:"font-semibold text-xl font-mono block mt-4 mb-1 mx-1",children:s}),e[0]=s,e[1]=g):g=e[1];const w=t+" text-input px-4 py-2 rounded-lg shadow-[3px_3px_0_0_#111827]",_=c||"";let v;e[2]!==s||e[3]!==o||e[4]!==h||e[5]!==n||e[6]!==w||e[7]!==_||e[8]!==m?(v=O.jsx("input",{type:m,onChange:h,name:o,id:s,placeholder:n,className:w,value:_}),e[2]=s,e[3]=o,e[4]=h,e[5]=n,e[6]=w,e[7]=_,e[8]=m,e[9]=v):v=e[9];let C;e[10]!==u?(C=u&&O.jsx("p",{className:"text-red-500 text-sm mt-1",children:u}),e[10]=u,e[11]=C):C=e[11];let T;return e[12]!==g||e[13]!==v||e[14]!==C?(T=O.jsxs("div",{children:[g,v,C]}),e[12]=g,e[13]=v,e[14]=C,e[15]=T):T=e[15],T}function jR(){const i={resolve:null,promise:null};return i.promise=new Promise(e=>{i.resolve=e}),i}function qR(i){let e=null;return(...t)=>(e||(e={current:i(...t)}),e.current)}const Jt=new Array(256).fill("").map((i,e)=>("0"+e.toString(16)).slice(-2));function WR(){const[i,e,t,n]=crypto.getRandomValues(new Uint32Array(4));return"e"+Jt[i>>0&255]+Jt[i>>8&255]+Jt[i>>16&255]+Jt[i>>24&255]+Jt[e>>0&255]+Jt[e>>8&255]+Jt[e>>16&255]+Jt[e>>24&255]+Jt[t>>0&255]+Jt[t>>8&255]+Jt[t>>16&255]+Jt[t>>24&255]+Jt[n>>0&255]+Jt[n>>8&255]+Jt[n>>16&255]+Jt[n>>24&255]}function $R(i,e){const t=i.extraPlugins||[];return{...i,extraPlugins:[...t,...e.filter(n=>!t.includes(n))]}}function mE(i){return!!i&&/^\d+\.\d+\.\d+/.test(i)}function gE(i){return i?["nightly","alpha","internal","nightly-","staging"].some(e=>i.includes(e)):!1}function GR(i){return mE(i)||gE(i)}function KR(i){if(!mE(i))throw new Error(`Invalid semantic version: ${i||"<blank>"}.`);const[e,t,n]=i.split(".");return{major:Number.parseInt(e,10),minor:Number.parseInt(t,10),patch:Number.parseInt(n,10)}}function YR(i){if(gE(i))return 3;const{major:e}=KR(i);switch(!0){case e>=44:return 3;case e>=38:return 2;default:return 1}}function JR(){const{CKEDITOR_VERSION:i,CKEDITOR:e}=window;return GR(i)?{source:e?"cdn":"npm",version:i}:null}function QR(){const i=JR();return i?YR(i.version):null}function pE(i,e){switch(e||=QR()||void 0,e){case 1:case 2:return i===void 0;case 3:return i==="GPL";default:return!1}}function XR(i,e){return function(n){pE(n.config.get("licenseKey"))||n.on("collectUsageData",(s,{setUsageData:o})=>{o(`integration.${i}`,e)})}}var ZR=Object.defineProperty,e3=(i,e,t)=>e in i?ZR(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,bn=(i,e,t)=>e3(i,typeof e!="symbol"?e+"":e,t);const bE=class wE{constructor(e,t){bn(this,"_lifecycle"),bn(this,"_element"),bn(this,"_releaseLock",null),bn(this,"_value",null),bn(this,"_afterMountCallbacks",[]),bn(this,"_state",{destroyedBeforeInitialization:!1,mountingInProgress:null}),bn(this,"release",qR(()=>{const{_releaseLock:n,_state:s,_element:o,_lifecycle:a}=this;s.mountingInProgress?s.mountingInProgress.then(()=>a.unmount({element:o,mountResult:this.value})).catch(c=>{console.error("CKEditor unmounting error:",c)}).then(n.resolve).then(()=>{this._value=null}):(s.destroyedBeforeInitialization=!0,n.resolve())})),this._element=e,this._lifecycle=t,this._lock()}get value(){return this._value}discard(){this._value=null,this._releaseLock=null,this._afterMountCallbacks=[],this._state={destroyedBeforeInitialization:!1,mountingInProgress:null}}unsafeSetValue(e){this._value=e,this._afterMountCallbacks.forEach(t=>{this._lifecycle.isValueValid&&!this._lifecycle.isValueValid(e)||t(e)}),this._afterMountCallbacks=[]}runAfterMount(e){const{_value:t,_afterMountCallbacks:n}=this;if(t){if(this._lifecycle.isValueValid&&!this._lifecycle.isValueValid(t))return;e(t)}else n.push(e)}_lock(){const{_semaphores:e}=wE,{_state:t,_element:n,_lifecycle:s}=this,o=e.get(n)||Promise.resolve(null),a=jR();this._releaseLock=a;const c=o.then(()=>t.destroyedBeforeInitialization?Promise.resolve(void 0):(t.mountingInProgress=s.mount().then(u=>(u&&this.unsafeSetValue(u),u)),t.mountingInProgress)).then(async u=>{u&&s.afterMount&&await s.afterMount({element:n,mountResult:u})}).then(()=>a.promise).catch(u=>{console.error("CKEditor mounting error:",u)}).then(()=>{e.get(n)===c&&e.delete(n)});e.set(n,c)}};bn(bE,"_semaphores",new Map);let t3=bE;const n3="$__CKEditorReactContextMetadata";function i3(i,e){return{...e,[n3]:i}}const s3=Wo.createContext(null),o3=i=>!!i&&typeof i=="object"&&"status"in i&&["initializing","initialized","error"].includes(i.status),_E=i=>e=>o3(e)&&e.status===i,n1=_E("initializing"),r3=i=>_E("initialized")(i)&&i.watchdog.state==="ready";const a3=XR("react",{version:"11.0.1",frameworkVersion:Wo.version});function l3(i){return pE(i.licenseKey)?i:$R(i,[a3])}const Vg="Lock from React integration (@ckeditor/ckeditor5-react)";class yE extends Wo.Component{constructor(e){super(e),bn(this,"domContainer",Wo.createRef()),bn(this,"editorSemaphore",null),this._checkVersion()}_checkVersion(){const{CKEDITOR_VERSION:e}=window;if(!e)return console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.');const[t]=e.split(".").map(Number);t>=42||e.startsWith("0.0.0")||console.warn("The <CKEditor> component requires using CKEditor 5 in version 42+ or nightly build.")}get _semaphoreValue(){const{editorSemaphore:e}=this;return e?e.value:null}get watchdog(){const{_semaphoreValue:e}=this;return e?e.watchdog:null}get editor(){const{_semaphoreValue:e}=this;return e?e.instance:null}shouldComponentUpdate(e){const{props:t,editorSemaphore:n}=this;return e.id!==t.id||e.disableWatchdog!==t.disableWatchdog?!0:(n&&(n.runAfterMount(({instance:s})=>{this._shouldUpdateEditorData(t,e,s)&&s.data.set(e.data)}),"disabled"in e&&n.runAfterMount(({instance:s})=>{e.disabled?s.enableReadOnlyMode(Vg):s.disableReadOnlyMode(Vg)})),!1)}componentDidMount(){n1(this.context)||this._initLifeCycleSemaphore()}componentDidUpdate(){n1(this.context)||this._initLifeCycleSemaphore()}componentWillUnmount(){this._unlockLifeCycleSemaphore()}_unlockLifeCycleSemaphore(){this.editorSemaphore&&(this.editorSemaphore.release(),this.editorSemaphore=null)}_initLifeCycleSemaphore(){this._unlockLifeCycleSemaphore(),this.editorSemaphore=new t3(this.domContainer.current,{isValueValid:e=>e&&!!e.instance,mount:async()=>{var e,t;try{return await this._initializeEditor()}catch(n){throw(t=(e=this.props).onError)==null||t.call(e,n,{phase:"initialization",willEditorRestart:!1}),n}},afterMount:({mountResult:e})=>{const{onReady:t}=this.props;t&&this.domContainer.current!==null&&t(e.instance)},unmount:async({element:e,mountResult:t})=>{const{onAfterDestroy:n}=this.props;try{await this._destroyEditor(t),e.innerHTML=""}finally{n&&n(t.instance)}}})}render(){return Wo.createElement("div",{ref:this.domContainer})}async _initializeEditor(){if(this.props.disableWatchdog)return{instance:await this._createEditor(this.domContainer.current,this._getConfig()),watchdog:null};const e=r3(this.context)?new c3(this.context.watchdog):new this.props.editor.EditorWatchdog(this.props.editor,this.props.watchdogConfig),t={current:0};return e.setCreator(async(n,s)=>{var o;const{editorSemaphore:a}=this,{onAfterDestroy:c}=this.props;t.current>0&&c&&((o=a?.value)!=null&&o.instance)&&c(a.value.instance);const u=await this._createEditor(n,s);return a&&t.current>0&&(a.unsafeSetValue({instance:u,watchdog:e}),setTimeout(()=>{this.props.onReady&&this.props.onReady(e.editor)})),t.current++,u}),e.on("error",(n,{error:s,causesRestart:o})=>{(this.props.onError||console.error)(s,{phase:"runtime",willEditorRestart:o})}),await e.create(this.domContainer.current,this._getConfig()),{watchdog:e,instance:e.editor}}_createEditor(e,t){const{contextItemMetadata:n}=this.props;return n&&(t=i3(n,t)),this.props.editor.create(e,l3(t)).then(s=>{if("disabled"in this.props){this.props.disabled&&s.enableReadOnlyMode(Vg)}const o=s.model.document,a=s.editing.view.document;return o.on("change:data",c=>{this.props.onChange&&this.props.onChange(c,s)}),a.on("focus",c=>{this.props.onFocus&&this.props.onFocus(c,s)}),a.on("blur",c=>{this.props.onBlur&&this.props.onBlur(c,s)}),s})}async _destroyEditor(e){const{watchdog:t,instance:n}=e;return new Promise((s,o)=>{setTimeout(async()=>{try{if(t)return await t.destroy(),s();if(n)return await n.destroy(),s();s()}catch(a){console.error(a),o(a)}})})}_shouldUpdateEditorData(e,t,n){return!(e.data===t.data||n.data.get()===t.data)}_getConfig(){const e=this.props.config||{};return this.props.data&&e.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `content` property. The config value takes precedence over `content` property and will be used when both are specified."),{...e,initialData:e.initialData||this.props.data||""}}}bn(yE,"contextType",s3);class c3{constructor(e){bn(this,"_contextWatchdog"),bn(this,"_id"),bn(this,"_creator"),this._contextWatchdog=e,this._id=WR()}setCreator(e){this._creator=e}create(e,t){return this._contextWatchdog.add({sourceElementOrData:e,config:t,creator:this._creator,id:this._id,type:"editor"})}on(e,t){this._contextWatchdog.on("itemError",(n,{itemId:s,error:o})=>{s===this._id&&t(null,{error:o,causesRestart:void 0})})}destroy(){return this._contextWatchdog.state==="ready"?this._contextWatchdog.remove(this._id):Promise.resolve()}get editor(){return this._contextWatchdog.getItem(this._id)}}function vE(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}const u3=P.memo(P.forwardRef(({id:i,semaphore:e,rootName:t},n)=>{const s=P.useRef(null);return P.useEffect(()=>{let o,a;return e.runAfterMount(({instance:c})=>{if(!s.current)return;a=c;const{ui:u,model:h}=a,m=h.document.getRoot(t);m&&a.ui.getEditableElement(t)&&a.detachEditable(m),o=u.view.createEditable(t,s.current),u.addEditable(o),c.editing.view.forceRender()}),()=>{if(a&&a.state!=="destroyed"&&s.current){const c=a.model.document.getRoot(t);c&&a.detachEditable(c)}}},[e.revision]),Wo.createElement("div",{key:e.revision,id:i,ref:vE(n,s)})}));u3.displayName="EditorEditable";const d3=P.forwardRef(({editor:i},e)=>{const t=P.useRef(null);return P.useEffect(()=>{const n=t.current;if(!i||!n)return;const s=i.ui.view.toolbar.element;return n.appendChild(s),()=>{n.contains(s)&&n.removeChild(s)}},[i&&i.id]),Wo.createElement("div",{ref:vE(t,e)})});d3.displayName="EditorToolbarWrapper";function h3(i){return Number.isSafeInteger(i)&&i>=0}function f3(i){return i!=null&&typeof i!="function"&&h3(i.length)}function CE(i){return i}function ac(i){return i==="__proto__"}function kE(i){switch(typeof i){case"number":case"symbol":return!1;case"string":return i.includes(".")||i.includes("[")||i.includes("]")}}function Pb(i){return typeof i=="string"||typeof i=="symbol"?i:Object.is(i?.valueOf?.(),-0)?"-0":String(i)}function Rb(i){const e=[],t=i.length;if(t===0)return e;let n=0,s="",o="",a=!1;for(i.charCodeAt(0)===46&&(e.push(""),n++);n<t;){const c=i[n];o?c==="\\"&&n+1<t?(n++,s+=i[n]):c===o?o="":s+=c:a?c==='"'||c==="'"?o=c:c==="]"?(a=!1,e.push(s),s=""):s+=c:c==="["?(a=!0,s&&(e.push(s),s="")):c==="."?s&&(e.push(s),s=""):s+=c,n++}return s&&e.push(s),e}function ro(i,e,t){if(i==null)return t;switch(typeof e){case"string":{if(ac(e))return t;const n=i[e];return n===void 0?kE(e)?ro(i,Rb(e),t):t:n}case"number":case"symbol":{typeof e=="number"&&(e=Pb(e));const n=i[e];return n===void 0?t:n}default:{if(Array.isArray(e))return m3(i,e,t);if(Object.is(e?.valueOf(),-0)?e="-0":e=String(e),ac(e))return t;const n=i[e];return n===void 0?t:n}}}function m3(i,e,t){if(e.length===0)return t;let n=i;for(let s=0;s<e.length;s++){if(n==null||ac(e[s]))return t;n=n[e[s]]}return n===void 0?t:n}function g3(i){return function(e){return ro(e,i)}}function on(i){return i!==null&&(typeof i=="object"||typeof i=="function")}function Oc(i){return i==null||typeof i!="object"&&typeof i!="function"}function lc(i,e){return i===e||Number.isNaN(i)&&Number.isNaN(e)}function p3(i,e,t){return typeof t!="function"?Ob(i,e):Np(i,e,function n(s,o,a,c,u,h){const m=t(s,o,a,c,u,h);return m!==void 0?!!m:Np(s,o,n,h)},new Map)}function Np(i,e,t,n){if(e===i)return!0;switch(typeof e){case"object":return b3(i,e,t,n);case"function":return Object.keys(e).length>0?Np(i,{...e},t,n):lc(i,e);default:return on(i)?typeof e=="string"?e==="":!0:lc(i,e)}}function b3(i,e,t,n){if(e==null)return!0;if(Array.isArray(e))return TE(i,e,t,n);if(e instanceof Map)return w3(i,e,t,n);if(e instanceof Set)return _3(i,e,t,n);const s=Object.keys(e);if(i==null)return s.length===0;if(s.length===0)return!0;if(n&&n.has(e))return n.get(e)===i;n&&n.set(e,i);try{for(let o=0;o<s.length;o++){const a=s[o];if(!Oc(i)&&!(a in i)||e[a]===void 0&&i[a]!==void 0||e[a]===null&&i[a]!==null||!t(i[a],e[a],a,i,e,n))return!1}return!0}finally{n&&n.delete(e)}}function w3(i,e,t,n){if(e.size===0)return!0;if(!(i instanceof Map))return!1;for(const[s,o]of e.entries()){const a=i.get(s);if(t(a,o,s,i,e,n)===!1)return!1}return!0}function TE(i,e,t,n){if(e.length===0)return!0;if(!Array.isArray(i))return!1;const s=new Set;for(let o=0;o<e.length;o++){const a=e[o];let c=!1;for(let u=0;u<i.length;u++){if(s.has(u))continue;const h=i[u];let m=!1;if(t(h,a,o,i,e,n)&&(m=!0),m){s.add(u),c=!0;break}}if(!c)return!1}return!0}function _3(i,e,t,n){return e.size===0?!0:i instanceof Set?TE([...i],[...e],t,n):!1}function Ob(i,e){return p3(i,e,()=>{})}function Jd(i){return Object.getOwnPropertySymbols(i).filter(e=>Object.prototype.propertyIsEnumerable.call(i,e))}function wa(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}const Ih="[object RegExp]",_a="[object String]",Vc="[object Number]",Bc="[object Boolean]",ya="[object Arguments]",Ph="[object Symbol]",Rh="[object Date]",Oh="[object Map]",Vh="[object Set]",Vb="[object Array]",y3="[object Function]",Bh="[object ArrayBuffer]",$l="[object Object]",v3="[object Error]",Mh="[object DataView]",Bb="[object Uint8Array]",Mb="[object Uint8ClampedArray]",Nb="[object Uint16Array]",Lb="[object Uint32Array]",C3="[object BigUint64Array]",Db="[object Int8Array]",Fb="[object Int16Array]",zb="[object Int32Array]",k3="[object BigInt64Array]",Ub="[object Float32Array]",Hb="[object Float64Array]";function jb(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function T3(i,e){return Ho(i,void 0,i,new Map,e)}function Ho(i,e,t,n=new Map,s=void 0){const o=s?.(i,e,t,n);if(o!=null)return o;if(Oc(i))return i;if(n.has(i))return n.get(i);if(Array.isArray(i)){const a=new Array(i.length);n.set(i,a);for(let c=0;c<i.length;c++)a[c]=Ho(i[c],c,t,n,s);return Object.hasOwn(i,"index")&&(a.index=i.index),Object.hasOwn(i,"input")&&(a.input=i.input),a}if(i instanceof Date)return new Date(i.getTime());if(i instanceof RegExp){const a=new RegExp(i.source,i.flags);return a.lastIndex=i.lastIndex,a}if(i instanceof Map){const a=new Map;n.set(i,a);for(const[c,u]of i)a.set(c,Ho(u,c,t,n,s));return a}if(i instanceof Set){const a=new Set;n.set(i,a);for(const c of i)a.add(Ho(c,void 0,t,n,s));return a}if(typeof Buffer<"u"&&Buffer.isBuffer(i))return i.subarray();if(jb(i)){const a=new(Object.getPrototypeOf(i)).constructor(i.length);n.set(i,a);for(let c=0;c<i.length;c++)a[c]=Ho(i[c],c,t,n,s);return a}if(i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer)return i.slice(0);if(i instanceof DataView){const a=new DataView(i.buffer.slice(0),i.byteOffset,i.byteLength);return n.set(i,a),zo(a,i,t,n,s),a}if(typeof File<"u"&&i instanceof File){const a=new File([i],i.name,{type:i.type});return n.set(i,a),zo(a,i,t,n,s),a}if(i instanceof Blob){const a=new Blob([i],{type:i.type});return n.set(i,a),zo(a,i,t,n,s),a}if(i instanceof Error){const a=new i.constructor;return n.set(i,a),a.message=i.message,a.name=i.name,a.stack=i.stack,a.cause=i.cause,zo(a,i,t,n,s),a}if(typeof i=="object"&&E3(i)){const a=Object.create(Object.getPrototypeOf(i));return n.set(i,a),zo(a,i,t,n,s),a}return i}function zo(i,e,t=i,n,s){const o=[...Object.keys(e),...Jd(e)];for(let a=0;a<o.length;a++){const c=o[a],u=Object.getOwnPropertyDescriptor(i,c);(u==null||u.writable)&&(i[c]=Ho(e[c],c,t,n,s))}}function E3(i){switch(wa(i)){case ya:case Vb:case Bh:case Mh:case Bc:case Rh:case Ub:case Hb:case Db:case Fb:case zb:case Oh:case Vc:case $l:case Ih:case Vh:case _a:case Ph:case Bb:case Mb:case Nb:case Lb:return!0;default:return!1}}function S3(i){return Ho(i,void 0,i,new Map,void 0)}function A3(i){return i=S3(i),e=>Ob(e,i)}function Nh(i,e){return T3(i,(t,n,s,o)=>{const a=e?.(t,n,s,o);if(a!=null)return a;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case Vc:case _a:case Bc:{const c=new i.constructor(i?.valueOf());return zo(c,i),c}case ya:{const c={};return zo(c,i),c.length=i.length,c[Symbol.iterator]=i[Symbol.iterator],c}default:return}})}function Cn(i){return Nh(i)}const x3=/^(?:0|[1-9]\d*)$/;function EE(i,e=Number.MAX_SAFE_INTEGER){switch(typeof i){case"number":return Number.isInteger(i)&&i>=0&&i<e;case"symbol":return!1;case"string":return x3.test(i)}}function Lp(i){return i!==null&&typeof i=="object"&&wa(i)==="[object Arguments]"}function I3(i,e){let t;if(Array.isArray(e)?t=e:typeof e=="string"&&kE(e)&&i?.[e]==null?t=Rb(e):t=[e],t.length===0)return!1;let n=i;for(let s=0;s<t.length;s++){const o=t[s];if((n==null||!Object.hasOwn(n,o))&&!((Array.isArray(n)||Lp(n))&&EE(o)&&o<n.length))return!1;n=n[o]}return!0}function P3(i,e){switch(typeof i){case"object":{Object.is(i?.valueOf(),-0)&&(i="-0");break}case"number":{i=Pb(i);break}}return e=Cn(e),function(t){const n=ro(t,i);return n===void 0?I3(t,i):e===void 0?n===void 0:Ob(n,e)}}function R3(i){if(i==null)return CE;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?P3(i[0],i[1]):A3(i);case"string":case"symbol":case"number":return g3(i)}}function Dp(i){return typeof i=="object"&&i!==null}function SE(i){return typeof i=="symbol"||i instanceof Symbol}function O3(i){return SE(i)?NaN:Number(i)}function V3(i){return i?(i=O3(i),i===1/0||i===-1/0?(i<0?-1:1)*Number.MAX_VALUE:i===i?i:0):i===0?i:0}function B3(i){const e=V3(i),t=e%1;return t?e-t:e}function i1(i){return typeof i=="string"||i instanceof String}const M3=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N3=/^\w*$/;function L3(i,e){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||SE(i)?!0:typeof i=="string"&&(N3.test(i)||!M3.test(i))||e!=null&&Object.hasOwn(e,i)}function D3(i){return Array.isArray(i)}function El(i){return i}const F3=(i,e,t)=>{const n=i[e];(!(Object.hasOwn(i,e)&&lc(n,t))||t===void 0&&!(e in i))&&(i[e]=t)};function z3(i,e,t,n){if(i==null&&!on(i))return i;const s=L3(e,i)?[e]:Array.isArray(e)?e:typeof e=="string"?Rb(e):[e];let o=i;for(let a=0;a<s.length&&o!=null;a++){const c=Pb(s[a]);if(ac(c))continue;let u;if(a===s.length-1)u=t(o[c]);else{const h=o[c],m=n?.(h,c,i);u=m!==void 0?m:on(h)?h:EE(s[a+1])?[]:{}}F3(o,c,u),o=o[c]}return i}function AE(i,e,t){return z3(i,e,()=>t,()=>{})}function U3(i,e,{signal:t,edges:n}={}){let s,o=null;const a=n!=null&&n.includes("leading"),c=n==null||n.includes("trailing"),u=()=>{o!==null&&(i.apply(s,o),s=void 0,o=null)},h=()=>{c&&u(),_()};let m=null;const g=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,h()},e)},w=()=>{m!==null&&(clearTimeout(m),m=null)},_=()=>{w(),s=void 0,o=null},v=()=>{w(),u()},C=function(...T){if(t?.aborted)return;s=this,o=T;const A=m==null;g(),a&&A&&u()};return C.schedule=g,C.cancel=_,C.flush=v,t?.addEventListener("abort",_,{once:!0}),C}function Ni(i,e=0,t={}){typeof t!="object"&&(t={});const{leading:n=!1,trailing:s=!0,maxWait:o}=t,a=Array(2);n&&(a[0]="leading"),s&&(a[1]="trailing");let c,u=null;const h=U3(function(...w){c=i.apply(this,w),u=null},e,{edges:a}),m=function(...w){return o!=null&&(u===null&&(u=Date.now()),Date.now()-u>=o)?(c=i.apply(this,w),u=Date.now(),h.cancel(),h.schedule(),c):(h.apply(this,w),c)},g=()=>(h.flush(),c);return m.cancel=h.cancel,m.flush=g,m}function cc(i,e=0,t={}){typeof t!="object"&&(t={});const{leading:n=!0,trailing:s=!0}=t;return Ni(i,e,{leading:n,trailing:s,maxWait:e})}function xE(i){if(i==null)return"";if(typeof i=="string")return i;if(Array.isArray(i))return i.map(xE).join(",");const e=String(i);return e==="0"&&Object.is(Number(i),-0)?"-0":e}function s1(i){if(!i||typeof i!="object")return!1;const e=Object.getPrototypeOf(i);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(i)==="[object Object]":!1}function IE(i,e,t){return Ul(i,e,void 0,void 0,void 0,void 0,t)}function Ul(i,e,t,n,s,o,a){const c=a(i,e,t,n,s,o);if(c!==void 0)return c;if(typeof i==typeof e)switch(typeof i){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return i===e;case"number":return i===e||Object.is(i,e);case"function":return i===e;case"object":return Gl(i,e,o,a)}return Gl(i,e,o,a)}function Gl(i,e,t,n){if(Object.is(i,e))return!0;let s=wa(i),o=wa(e);if(s===ya&&(s=$l),o===ya&&(o=$l),s!==o)return!1;switch(s){case _a:return i.toString()===e.toString();case Vc:{const u=i.valueOf(),h=e.valueOf();return lc(u,h)}case Bc:case Rh:case Ph:return Object.is(i.valueOf(),e.valueOf());case Ih:return i.source===e.source&&i.flags===e.flags;case y3:return i===e}t=t??new Map;const a=t.get(i),c=t.get(e);if(a!=null&&c!=null)return a===e;t.set(i,e),t.set(e,i);try{switch(s){case Oh:{if(i.size!==e.size)return!1;for(const[u,h]of i.entries())if(!e.has(u)||!Ul(h,e.get(u),u,i,e,t,n))return!1;return!0}case Vh:{if(i.size!==e.size)return!1;const u=Array.from(i.values()),h=Array.from(e.values());for(let m=0;m<u.length;m++){const g=u[m],w=h.findIndex(_=>Ul(g,_,void 0,i,e,t,n));if(w===-1)return!1;h.splice(w,1)}return!0}case Vb:case Bb:case Mb:case Nb:case Lb:case C3:case Db:case Fb:case zb:case k3:case Ub:case Hb:{if(typeof Buffer<"u"&&Buffer.isBuffer(i)!==Buffer.isBuffer(e)||i.length!==e.length)return!1;for(let u=0;u<i.length;u++)if(!Ul(i[u],e[u],u,i,e,t,n))return!1;return!0}case Bh:return i.byteLength!==e.byteLength?!1:Gl(new Uint8Array(i),new Uint8Array(e),t,n);case Mh:return i.byteLength!==e.byteLength||i.byteOffset!==e.byteOffset?!1:Gl(new Uint8Array(i),new Uint8Array(e),t,n);case v3:return i.name===e.name&&i.message===e.message;case $l:{if(!(Gl(i.constructor,e.constructor,t,n)||s1(i)&&s1(e)))return!1;const h=[...Object.keys(i),...Jd(i)],m=[...Object.keys(e),...Jd(e)];if(h.length!==m.length)return!1;for(let g=0;g<h.length;g++){const w=h[g],_=i[w];if(!Object.hasOwn(e,w))return!1;const v=e[w];if(!Ul(_,v,w,i,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(i),t.delete(e)}}function PE(){}function o1(i,e){return IE(i,e,PE)}function H3(i){return typeof Buffer<"u"&&Buffer.isBuffer(i)}function j3(i){const e=i?.constructor,t=typeof e=="function"?e.prototype:Object.prototype;return i===t}function qb(i){return jb(i)}function q3(i,e){if(i=B3(i),i<1||!Number.isSafeInteger(i))return[];const t=new Array(i);for(let n=0;n<i;n++)t[n]=typeof e=="function"?e(n):n;return t}function W3(i){if(i==null)return[];switch(typeof i){case"object":case"function":return f3(i)?G3(i):j3(i)?$3(i):Qd(i);default:return Qd(Object(i))}}function Qd(i){const e=[];for(const t in i)e.push(t);return e}function $3(i){return Qd(i).filter(t=>t!=="constructor")}function G3(i){const e=q3(i.length,n=>`${n}`),t=new Set(e);return H3(i)&&(t.add("offset"),t.add("parent")),qb(i)&&(t.add("buffer"),t.add("byteLength"),t.add("byteOffset")),[...e,...Qd(i).filter(n=>!t.has(n))]}function RE(i,...e){for(let t=0;t<e.length;t++)K3(i,e[t]);return i}function K3(i,e){const t=W3(e);for(let n=0;n<t.length;n++){const s=t[n];(!(s in i)||!lc(i[s],e[s]))&&(i[s]=e[s])}}function Y3(i){if(Oc(i))return i;const e=wa(i);if(!J3(i))return{};if(D3(i)){const n=Array.from(i);return i.length>0&&typeof i[0]=="string"&&Object.hasOwn(i,"index")&&(n.index=i.index,n.input=i.input),n}if(qb(i)){const n=i,s=n.constructor;return new s(n.buffer,n.byteOffset,n.length)}if(e===Bh)return new ArrayBuffer(i.byteLength);if(e===Mh){const n=i,s=n.buffer,o=n.byteOffset,a=n.byteLength,c=new ArrayBuffer(a),u=new Uint8Array(s,o,a);return new Uint8Array(c).set(u),new DataView(c)}if(e===Bc||e===Vc||e===_a){const n=i.constructor,s=new n(i.valueOf());return e===_a?X3(s,i):Bg(s,i),s}if(e===Rh)return new Date(Number(i));if(e===Ih){const n=i,s=new RegExp(n.source,n.flags);return s.lastIndex=n.lastIndex,s}if(e===Ph)return Object(Symbol.prototype.valueOf.call(i));if(e===Oh){const n=i,s=new Map;return n.forEach((o,a)=>{s.set(a,o)}),s}if(e===Vh){const n=i,s=new Set;return n.forEach(o=>{s.add(o)}),s}if(e===ya){const n=i,s={};return Bg(s,n),s.length=n.length,s[Symbol.iterator]=n[Symbol.iterator],s}const t={};return Z3(t,i),Bg(t,i),Q3(t,i),t}function J3(i){switch(wa(i)){case ya:case Vb:case Bh:case Mh:case Bc:case Rh:case Ub:case Hb:case Db:case Fb:case zb:case Oh:case Vc:case $l:case Ih:case Vh:case _a:case Ph:case Bb:case Mb:case Nb:case Lb:return!0;default:return!1}}function Bg(i,e){for(const t in e)Object.hasOwn(e,t)&&(i[t]=e[t])}function Q3(i,e){const t=Object.getOwnPropertySymbols(e);for(let n=0;n<t.length;n++){const s=t[n];Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}}function X3(i,e){const t=e.valueOf().length;for(const n in e)Object.hasOwn(e,n)&&(Number.isNaN(Number(n))||Number(n)>=t)&&(i[n]=e[n])}function Z3(i,e){const t=Object.getPrototypeOf(e);t!==null&&typeof e.constructor=="function"&&Object.setPrototypeOf(i,t)}function Vi(i){if(typeof i!="object"||i==null)return!1;if(Object.getPrototypeOf(i)===null)return!0;if(Object.prototype.toString.call(i)!=="[object Object]"){const t=i[Symbol.toStringTag];return t==null||!Object.getOwnPropertyDescriptor(i,Symbol.toStringTag)?.writable?!1:i.toString()===`[object ${t}]`}let e=i;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(i)===e}function eO(i,e){const t={},n=Object.keys(i);for(let s=0;s<n.length;s++){const o=n[s],a=i[o];t[o]=e(a,o,i)}return t}function tO(i,e=CE){return i==null?{}:eO(i,R3(e))}function nO(i){if(Oc(i))return i;if(Array.isArray(i)||jb(i)||i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer)return i.slice(0);const e=Object.getPrototypeOf(i),t=e.constructor;if(i instanceof Date||i instanceof Map||i instanceof Set)return new t(i);if(i instanceof RegExp){const n=new t(i);return n.lastIndex=i.lastIndex,n}if(i instanceof DataView)return new t(i.buffer.slice(0));if(i instanceof Error){const n=new t(i.message);return n.stack=i.stack,n.name=i.name,n.cause=i.cause,n}if(typeof File<"u"&&i instanceof File)return new t([i],i.name,{type:i.type,lastModified:i.lastModified});if(typeof i=="object"){const n=Object.create(e);return Object.assign(n,i)}return i}function iO(i,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=i;for(let o=0;o<t.length;o++){const a=t[o];s=Nd(s,a,n,new Map)}return s}function Nd(i,e,t,n){if(Oc(i)&&(i=Object(i)),e==null||typeof e!="object")return i;if(n.has(e))return nO(n.get(e));if(n.set(e,i),Array.isArray(e)){e=e.slice();for(let o=0;o<e.length;o++)e[o]=e[o]??void 0}const s=[...Object.keys(e),...Jd(e)];for(let o=0;o<s.length;o++){const a=s[o];if(ac(a))continue;let c=e[a],u=i[a];if(Lp(c)&&(c={...c}),Lp(u)&&(u={...u}),typeof Buffer<"u"&&Buffer.isBuffer(c)&&(c=Cn(c)),Array.isArray(c))if(typeof u=="object"&&u!=null){const m=[],g=Reflect.ownKeys(u);for(let w=0;w<g.length;w++){const _=g[w];m[_]=u[_]}u=m}else u=[];const h=t(u,c,a,i,e,n);h!=null?i[a]=h:Array.isArray(c)||Dp(u)&&Dp(c)?i[a]=Nd(u,c,t,n):u==null&&Vi(c)?i[a]=Nd({},c,t,n):u==null&&qb(c)?i[a]=Cn(c):(u===void 0||c!==void 0)&&(i[a]=c)}return i}function Wb(i,...e){return iO(i,...e,PE)}function Xd(i){return typeof i=="function"}function ao(i){return Dp(i)&&i.nodeType===1&&!Vi(i)}function r1(i,e){if(!Number.isInteger(i)||i<0)throw new Error("n must be a non-negative integer.");let t=0;return(...n)=>{if(++t>=i)return e(...n)}}function Fp(i,e,t){return typeof t!="function"&&(t=()=>{}),IE(i,e,(...n)=>{const s=t(...n);if(s!==void 0)return!!s;if(i instanceof Map&&e instanceof Map||i instanceof Set&&e instanceof Set)return Fp(Array.from(i),Array.from(e),r1(2,t))})}function sO(i){return i.substring(0,1).toUpperCase()+i.substring(1)}function oO(i){return sO(xE(i))}let ee;try{ee={window,document}}catch{ee={window:{},document:{}}}function rO(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const Bo=rO(),le={isMac:OE(Bo),isWindows:aO(Bo),isGecko:lO(Bo),isSafari:cO(Bo),isiOS:uO(Bo),isAndroid:dO(Bo),isBlink:hO(Bo),get isMediaForcedColors(){return fO()}};function OE(i){return i.indexOf("macintosh")>-1}function aO(i){return i.indexOf("windows")>-1}function lO(i){return!!i.match(/gecko\/\d+/)}function cO(i){return i.indexOf(" applewebkit/")>-1&&i.indexOf("chrome")===-1}function uO(i){return!!i.match(/iphone|ipad/i)||OE(i)&&navigator.maxTouchPoints>0}function dO(i){return i.indexOf("android")>-1}function hO(i){return i.indexOf("chrome/")>-1&&i.indexOf("edge/")<0}function fO(){return ee.window.matchMedia?ee.window.matchMedia("(forced-colors: active)").matches:!1}function VE(i,e,t,n){t=t||function(u,h){return u===h};const s=Array.isArray(i)?i:Array.prototype.slice.call(i),o=Array.isArray(e)?e:Array.prototype.slice.call(e),a=mO(s,o,t);return n?pO(a,o.length):gO(o,a)}function mO(i,e,t){const n=a1(i,e,t);if(n===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=l1(i,n),o=l1(e,n),a=a1(s,o,t),c=i.length-a,u=e.length-a;return{firstIndex:n,lastIndexOld:c,lastIndexNew:u}}function a1(i,e,t){for(let n=0;n<Math.max(i.length,e.length);n++)if(i[n]===void 0||e[n]===void 0||!t(i[n],e[n]))return n;return-1}function l1(i,e){return i.slice(e).reverse()}function gO(i,e){const t=[],{firstIndex:n,lastIndexOld:s,lastIndexNew:o}=e;return o-n>0&&t.push({index:n,type:"insert",values:i.slice(n,o)}),s-n>0&&t.push({index:n+(o-n),type:"delete",howMany:s-n}),t}function pO(i,e){const{firstIndex:t,lastIndexOld:n,lastIndexNew:s}=i;if(t===-1)return Array(e).fill("equal");let o=[];return t>0&&(o=o.concat(Array(t).fill("equal"))),s-t>0&&(o=o.concat(Array(s-t).fill("insert"))),n-t>0&&(o=o.concat(Array(n-t).fill("delete"))),s<e&&(o=o.concat(Array(e-s).fill("equal"))),o}function fa(i,e,t){t=t||function(C,T){return C===T};const n=i.length,s=e.length;if(n>200||s>200||n+s>300)return fa.fastDiff(i,e,t,!0);let o,a;if(s<n){const C=i;i=e,e=C,o="delete",a="insert"}else o="insert",a="delete";const c=i.length,u=e.length,h=u-c,m={},g={};function w(C){const T=(g[C-1]!==void 0?g[C-1]:-1)+1,A=g[C+1]!==void 0?g[C+1]:-1,L=T>A?-1:1;m[C+L]&&(m[C]=m[C+L].slice(0)),m[C]||(m[C]=[]),m[C].push(T>A?o:a);let z=Math.max(T,A),j=z-C;for(;j<c&&z<u&&t(i[j],e[z]);)j++,z++,m[C].push("equal");return z}let _=0,v;do{for(v=-_;v<h;v++)g[v]=w(v);for(v=h+_;v>h;v--)g[v]=w(v);g[h]=w(h),_++}while(g[h]!==u);return m[h].slice(1)}fa.fastDiff=VE;function c1(){return function i(){i.called=!0}}class Ts{source;name;path;stop;off;return;constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=c1(),this.off=c1()}}const Qt=new Array(256).fill("").map((i,e)=>("0"+e.toString(16)).slice(-2));function rn(){const[i,e,t,n]=crypto.getRandomValues(new Uint32Array(4));return"e"+Qt[i>>0&255]+Qt[i>>8&255]+Qt[i>>16&255]+Qt[i>>24&255]+Qt[e>>0&255]+Qt[e>>8&255]+Qt[e>>16&255]+Qt[e>>24&255]+Qt[t>>0&255]+Qt[t>>8&255]+Qt[t>>16&255]+Qt[t>>24&255]+Qt[n>>0&255]+Qt[n>>8&255]+Qt[n>>16&255]+Qt[n>>24&255]}const _s={get(i="normal"){return typeof i!="number"?this[i]||this.normal:i},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function BE(i,e){const t=_s.get(e.priority);let n=0,s=i.length;for(;n<s;){const o=n+s>>1;_s.get(i[o].priority)<t?s=o:n=o+1}i.splice(n,0,e)}const bO="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class E extends Error{context;data;constructor(e,t,n,s){super(_O(e,n,s)),this.name="CKEditorError",this.context=t,this.data=n,s&&(this.stack=s.stack)}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,t){throw e.is&&e.is("CKEditorError")?e:new E("unexpected-error",t,void 0,e)}}function Be(i,e){console.warn(...NE(i,e))}function wO(i,e){console.error(...NE(i,e))}function ME(i){return`
Read more: ${bO}#error-${i}`}function _O(i,e,t){const n=new WeakSet,o=e?` ${JSON.stringify(e,(u,h)=>{if(typeof h=="object"&&h!==null){if(n.has(h))return`[object ${h.constructor.name}]`;n.add(h)}return h})}`:"",a=ME(i),c=t?`
Original error: ${t.name}: ${t.message}`:"";return i+o+a+c}function NE(i,e){const t=ME(i);return e?[i,e,t]:[i,t]}const yO="47.5.0",vO=new Date(2026,1,11);if(globalThis.CKEDITOR_VERSION)throw new E("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=yO;const oa=Symbol("listeningTo"),zp=Symbol("emitterId"),cs=Symbol("delegations"),CO=Je(Object);function Je(i){if(!i)return CO;class e extends i{on(n,s,o){this.listenTo(this,n,s,o)}once(n,s,o){let a=!1;const c=(u,...h)=>{a||(a=!0,u.off(),s.call(this,u,...h))};this.listenTo(this,n,c,o)}off(n,s){this.stopListening(this,n,s)}listenTo(n,s,o,a={}){let c,u;this[oa]||(this[oa]={});const h=this[oa];Mg(n)||LE(n);const m=Mg(n);(c=h[m])||(c=h[m]={emitter:n,callbacks:{}}),(u=c.callbacks[s])||(u=c.callbacks[s]=[]),u.push(o),AO(this,n,s,o,a)}stopListening(n,s,o){const a=this[oa];let c=n&&Mg(n);const u=a&&c?a[c]:void 0,h=u&&s?u.callbacks[s]:void 0;if(!(!a||n&&!u||s&&!h))if(o)Ng(this,n,s,o),h.indexOf(o)!==-1&&(h.length===1?delete u.callbacks[s]:Ng(this,n,s,o));else if(h){for(;o=h.pop();)Ng(this,n,s,o);delete u.callbacks[s]}else if(u){for(s in u.callbacks)this.stopListening(n,s);delete a[c]}else{for(c in a)this.stopListening(a[c].emitter);delete this[oa]}}fire(n,...s){try{const o=n instanceof Ts?n:new Ts(this,n),a=o.name;let c=SO(this,a);if(o.path.push(this),c){c=c.slice();for(let h=0;h<c.length;h++){const m=c[h].callback;if(m.call(this,o,...s),o.off.called&&(delete o.off.called,this._removeEventListener(a,m)),o.stop.called)break}}const u=this[cs];if(u){const h=u.get(a),m=u.get("*");h&&u1(h,o,s),m&&u1(m,o,s)}return o.return}catch(o){E.rethrowUnexpectedError(o,this)}}delegate(...n){return{to:(s,o)=>{this[cs]||(this[cs]=new Map),n.forEach(a=>{const c=this[cs].get(a);c?c.set(s,o):this[cs].set(a,new Map([[s,o]]))})}}}stopDelegating(n,s){if(this[cs])if(!n)this[cs].clear();else if(!s)this[cs].delete(n);else{const o=this[cs].get(n);o&&o.delete(s)}}_addEventListener(n,s,o){EO(this,n);const a=Up(this,n),c=_s.get(o.priority),u={callback:s,priority:c};for(const h of a)BE(h,u)}_removeEventListener(n,s){const o=Up(this,n);for(const a of o)for(let c=0;c<a.length;c++)a[c].callback==s&&(a.splice(c,1),c--)}}return e}function kO(i,e){const t=i[oa];return t&&t[e]?t[e].emitter:null}function LE(i,e){i[zp]||(i[zp]=e||rn())}function Mg(i){return i[zp]}function DE(i){return i._events||Object.defineProperty(i,"_events",{value:{}}),i._events}function TO(){return{callbacks:[],childEvents:[]}}function EO(i,e){const t=DE(i);if(t[e])return;let n=e,s=null;const o=[];for(;n!==""&&!t[n];)t[n]=TO(),o.push(t[n]),s&&t[n].childEvents.push(s),s=n,n=n.substr(0,n.lastIndexOf(":"));if(n!==""){for(const a of o)a.callbacks=t[n].callbacks.slice();t[n].childEvents.push(s)}}function Up(i,e){const t=DE(i)[e];if(!t)return[];let n=[t.callbacks];for(let s=0;s<t.childEvents.length;s++){const o=Up(i,t.childEvents[s]);n=n.concat(o)}return n}function SO(i,e){if(!i._events)return null;let t=e;do{const n=i._events[t];if(n&&n.callbacks&&n.callbacks.length)return n.callbacks;const s=t.lastIndexOf(":");t=s>-1?t.substring(0,s):""}while(t);return null}function u1(i,e,t){for(let[n,s]of i){s?typeof s=="function"&&(s=s(e.name)):s=e.name;const o=new Ts(e.source,s);o.path=[...e.path],n.fire(o,...t)}}function AO(i,e,t,n,s){e._addEventListener?e._addEventListener(t,n,s):i._addEventListener.call(e,t,n,s)}function Ng(i,e,t,n){e._removeEventListener?e._removeEventListener(t,n):i._removeEventListener.call(e,t,n)}const Kl=Symbol("observableProperties"),uc=Symbol("boundObservables"),Yl=Symbol("boundProperties"),Mo=Symbol("decoratedMethods"),d1=Symbol("decoratedOriginal"),xO=qe(Je());function qe(i){if(!i)return xO;class e extends i{set(n,s){if(on(n)){Object.keys(n).forEach(a=>{this.set(a,n[a])},this);return}Lg(this);const o=this[Kl];if(n in this&&!o.has(n))throw new E("observable-set-cannot-override",this);Object.defineProperty(this,n,{enumerable:!0,configurable:!0,get(){return o.get(n)},set(a){const c=o.get(n);let u=this.fire(`set:${n}`,n,a,c);u===void 0&&(u=a),(c!==u||!o.has(n))&&(o.set(n,u),this.fire(`change:${n}`,n,u,c))}}),this[n]=s}bind(...n){if(!n.length||!h1(n))throw new E("observable-bind-wrong-properties",this);if(new Set(n).size!==n.length)throw new E("observable-bind-duplicate-properties",this);Lg(this);const s=this[Yl];n.forEach(a=>{if(s.has(a))throw new E("observable-bind-rebind",this)});const o=new Map;return n.forEach(a=>{const c={property:a,to:[]};s.set(a,c),o.set(a,c)}),{to:IO,toMany:PO,_observable:this,_bindProperties:n,_to:[],_bindings:o}}unbind(...n){if(!this[Kl])return;const s=this[Yl],o=this[uc];if(n.length){if(!h1(n))throw new E("observable-unbind-wrong-properties",this);n.forEach(a=>{const c=s.get(a);c&&(c.to.forEach(([u,h])=>{const m=o.get(u),g=m[h];g.delete(c),g.size||delete m[h],Object.keys(m).length||(o.delete(u),this.stopListening(u,"change"))}),s.delete(a))})}else o.forEach((a,c)=>{this.stopListening(c,"change")}),o.clear(),s.clear()}decorate(n){Lg(this);const s=this[n];if(!s)throw new E("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:n});this.on(n,(o,a)=>{o.return=s.apply(this,a)}),this[n]=function(...o){return this.fire(n,o)},this[n][d1]=s,this[Mo]||(this[Mo]=[]),this[Mo].push(n)}stopListening(n,s,o){if(!n&&this[Mo]){for(const a of this[Mo])this[a]=this[a][d1];delete this[Mo]}super.stopListening(n,s,o)}[Kl];[Mo];[Yl];[uc]}return e}function Lg(i){i[Kl]||(Object.defineProperty(i,Kl,{value:new Map}),Object.defineProperty(i,uc,{value:new Map}),Object.defineProperty(i,Yl,{value:new Map}))}function IO(...i){const e=OO(...i),t=Array.from(this._bindings.keys()),n=t.length;if(!e.callback&&e.to.length>1)throw new E("observable-bind-to-no-callback",this);if(n>1&&e.callback)throw new E("observable-bind-to-extra-callback",this);e.to.forEach(s=>{if(s.properties.length&&s.properties.length!==n)throw new E("observable-bind-to-properties-length",this);s.properties.length||(s.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(t[0]).callback=e.callback),MO(this._observable,this._to),BO(this),this._bindProperties.forEach(s=>{FE(this._observable,s)})}function PO(i,e,t){if(this._bindings.size>1)throw new E("observable-bind-to-many-not-one-binding",this);this.to(...RO(i,e),t)}function RO(i,e){const t=i.map(n=>[n,e]);return Array.prototype.concat.apply([],t)}function h1(i){return i.every(e=>typeof e=="string")}function OO(...i){if(!i.length)throw new E("observable-bind-to-parse-error",null);const e={to:[]};let t;return typeof i[i.length-1]=="function"&&(e.callback=i.pop()),i.forEach(n=>{if(typeof n=="string")t.properties.push(n);else if(typeof n=="object")t={observable:n,properties:[]},e.to.push(t);else throw new E("observable-bind-to-parse-error",null)}),e}function VO(i,e,t,n){const s=i[uc],o=s.get(t),a=o||{};a[n]||(a[n]=new Set),a[n].add(e),o||s.set(t,a)}function BO(i){let e;i._bindings.forEach((t,n)=>{i._to.forEach(s=>{e=s.properties[t.callback?0:i._bindProperties.indexOf(n)],t.to.push([s.observable,e]),VO(i._observable,t,s.observable,e)})})}function FE(i,e){const n=i[Yl].get(e);let s;n.callback?s=n.callback.apply(i,n.to.map(o=>o[0][o[1]])):(s=n.to[0],s=s[0][s[1]]),Object.prototype.hasOwnProperty.call(i,e)?i[e]=s:i.set(e,s)}function MO(i,e){e.forEach(t=>{const n=i[uc];let s;n.get(t.observable)||i.listenTo(t.observable,"change",(o,a)=>{s=n.get(t.observable)[a],s&&s.forEach(c=>{FE(i,c.property)})})})}class NO{_replacedElements;constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}}function Hp(i){let e=0;for(const t of i)e++;return e}function Nt(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)if(i[n]!=e[n])return n;return i.length==e.length?"same":i.length<e.length?"prefix":"extension"}function Dn(i){return!!(i&&i[Symbol.iterator])}function fi(i,e,t={},n=[]){const s=t&&t.xmlns,o=s?i.createElementNS(s,e):i.createElement(e);for(const a in t)o.setAttribute(a,t[a]);(i1(n)||!Dn(n))&&(n=[n]);for(let a of n)i1(a)&&(a=i.createTextNode(a)),o.appendChild(a);return o}class zE{_config;constructor(e,t){this._config=Object.create(null),t&&this.define(f1(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,n,s=!1){if(Vi(t)){this._setObjectToTarget(e,t,s);return}const o=t.split(".");t=o.pop();for(const a of o)Vi(e[a])||(e[a]=Object.create(null)),e=e[a];if(Vi(n)){Vi(e[t])||(e[t]=Object.create(null)),e=e[t],this._setObjectToTarget(e,n,s);return}s&&typeof e[t]<"u"||(e[t]=n)}_getFromSource(e,t){const n=t.split(".");t=n.pop();for(const s of n){if(!Vi(e[s])){e=null;break}e=e[s]}return e?f1(e[t]):void 0}_setObjectToTarget(e,t,n){Object.keys(t).forEach(s=>{this._setToTarget(e,s,t[s],n)})}}function f1(i){return Nh(i,LO)}function LO(i){return ao(i)||typeof i=="function"?i:void 0}function lo(i){if(i){if(i.defaultView)return i instanceof i.defaultView.Document;if(i.ownerDocument&&i.ownerDocument.defaultView)return i instanceof i.ownerDocument.defaultView.Node}return!1}function Zd(i){const e=Object.prototype.toString.apply(i);return e=="[object Window]"||e=="[object global]"}const DO=Hn(Je());function Hn(i){if(!i)return DO;class e extends i{listenTo(n,s,o,a={}){if(lo(n)||Zd(n)||n instanceof ee.window.EventTarget){const c={capture:!!a.useCapture,passive:!!a.usePassive},u=this._getProxyEmitter(n,c)||new FO(n,c);this.listenTo(u,s,o,a)}else super.listenTo(n,s,o,a)}stopListening(n,s,o){if(lo(n)||Zd(n)||n instanceof ee.window.EventTarget){const a=this._getAllProxyEmitters(n);for(const c of a)this.stopListening(c,s,o)}else super.stopListening(n,s,o)}_getProxyEmitter(n,s){return kO(this,UE(n,s))}_getAllProxyEmitters(n){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(s=>this._getProxyEmitter(n,s)).filter(s=>!!s)}}return e}class FO extends Je(){_domNode;_options;constructor(e,t){super(),LE(this,UE(e,t)),this._domNode=e,this._options=t}_domListeners;attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;this._domListeners[e]&&(!(t=this._events[e])||!t.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,t,n){this.attach(e),Je().prototype._addEventListener.call(this,e,t,n)}_removeEventListener(e,t){Je().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=n=>{this.fire(e,n)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}}function zO(i){return i["data-ck-expando"]||(i["data-ck-expando"]=rn())}function UE(i,e){let t=zO(i);for(const n of Object.keys(e).sort())e[n]&&(t+="-"+n);return t}function UO(i){const e=[];let t=i;for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}function HO(i){return i instanceof HTMLTextAreaElement?i.value:i.innerHTML}function HE(i){const e=i.ownerDocument.defaultView.getComputedStyle(i);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}function jE(i){if(!i.target)return null;const e=i.target.ownerDocument,t=i.clientX,n=i.clientY;let s=null;return e.caretRangeFromPoint&&e.caretRangeFromPoint(t,n)?s=e.caretRangeFromPoint(t,n):i.rangeParent&&(s=e.createRange(),s.setStart(i.rangeParent,i.rangeOffset),s.collapse(!0)),s}function qE(i){return!i||!i.parentNode||i.offsetParent===ee.document.body?null:i.offsetParent}function ut(i){return Object.prototype.toString.call(i)=="[object Text]"}function Lh(i){return Object.prototype.toString.apply(i)=="[object Range]"}const WE=["top","right","bottom","left","width","height"],jO=new Set(["relative","absolute","fixed","sticky"]);class pe{top;right;bottom;left;width;height;_source;constructor(e){const t=Lh(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),jp(e)||t)if(t){const n=pe.getDomRangeRects(e);ad(this,pe.getBoundingRect(n))}else ad(this,e.getBoundingClientRect());else if(Zd(e)){const{innerWidth:n,innerHeight:s}=e;ad(this,{top:0,right:n,bottom:s,left:0,width:n,height:s})}else ad(this,e)}clone(){return new pe(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};if(t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0)return null;{const n=new pe(t);return n._source=this._source,n}}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(m1(e))return t;let n=e,s=e.parentNode||e.commonAncestorContainer,o;for(;s&&!m1(s);){const a=qO(s)==="visible";if(g1(n)&&(o=n),a||o&&$E(o)==="absolute"&&!g1(s)){n=s,s=s.parentNode;continue}const c=new pe(s),u=t.getIntersection(c);if(u)u.getArea()<t.getArea()&&(t=u);else return null;n=s,s=s.parentNode}return t}isEqual(e){for(const t of WE)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!!(t&&t.isEqual(e))}toAbsoluteRect(){const{scrollX:e,scrollY:t}=ee.window,n=this.clone().moveBy(e,t);if(jp(n._source)){const s=qE(n._source);s&&WO(n,s)}return n}excludeScrollbarsAndBorders(){const e=this._source;let t,n,s;if(Zd(e))t=e.innerWidth-e.document.documentElement.clientWidth,n=e.innerHeight-e.document.documentElement.clientHeight,s=e.getComputedStyle(e.document.documentElement).direction;else{const o=HE(e);t=e.offsetWidth-e.clientWidth-o.left-o.right,n=e.offsetHeight-e.clientHeight-o.top-o.bottom,s=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,s==="ltr"?this.right-=t:this.left+=t,this.height-=n,this.bottom-=n,this}static getDomRangeRects(e){const t=[],n=Array.from(e.getClientRects());if(n.length)for(const s of n){const o=new pe(s);o._source=e,t.push(o)}else{let s=e.startContainer;ut(s)&&(s=s.parentNode);const o=new pe(s.getBoundingClientRect());o.right=o.left,o.width=0,t.push(o)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let n=0;for(const s of e)n++,t.left=Math.min(t.left,s.left),t.top=Math.min(t.top,s.top),t.right=Math.max(t.right,s.right),t.bottom=Math.max(t.bottom,s.bottom);return n==0?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new pe(t))}}function ad(i,e){for(const t of WE)i[t]=e[t]}function m1(i){return jp(i)?i===i.ownerDocument.body:!1}function jp(i){return i!==null&&typeof i=="object"&&i.nodeType===1&&typeof i.getBoundingClientRect=="function"}function $E(i){return i.ownerDocument.defaultView.getComputedStyle(i).position}function qO(i){return i instanceof HTMLElement?i.ownerDocument.defaultView.getComputedStyle(i).overflow:"visible"}function g1(i){return i instanceof HTMLElement&&jO.has($E(i))}function WO(i,e){const t=new pe(e),n=HE(e);let s=0,o=0;s-=t.left,o-=t.top,s+=e.scrollLeft,o+=e.scrollTop,s-=n.left,o-=n.top,i.moveBy(s,o)}class lt{_element;_callback;static _observerInstance=null;static _elementCallbacks=null;constructor(e,t){lt._observerInstance||lt._createObserver(),this._element=e,this._callback=t,lt._addElementCallback(e,t),lt._observerInstance.observe(e)}get element(){return this._element}destroy(){lt._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){lt._elementCallbacks||(lt._elementCallbacks=new Map);let n=lt._elementCallbacks.get(e);n||(n=new Set,lt._elementCallbacks.set(e,n)),n.add(t)}static _deleteElementCallback(e,t){const n=lt._getElementCallbacks(e);n&&(n.delete(t),n.size||(lt._elementCallbacks.delete(e),lt._observerInstance.unobserve(e))),lt._elementCallbacks&&!lt._elementCallbacks.size&&(lt._observerInstance=null,lt._elementCallbacks=null)}static _getElementCallbacks(e){return lt._elementCallbacks?lt._elementCallbacks.get(e):null}static _createObserver(){lt._observerInstance=new ee.window.ResizeObserver(e=>{for(const t of e){const n=lt._getElementCallbacks(t.target);if(n)for(const s of n)s(t)}})}}function p1(i,e){i instanceof HTMLTextAreaElement&&(i.value=e),i.innerHTML=e}function Mc(i){return e=>e+i}function ua(i){let e=0;for(;i.previousSibling;)i=i.previousSibling,e++;return e}function GE(i,e,t){i.insertBefore(t,i.childNodes[e]||null)}function Jl(i){return i&&i.nodeType===Node.COMMENT_NODE}function $O(i){try{ee.document.createAttribute(i)}catch{return!1}return!0}function Es(i){return i?ut(i)?Es(i.parentElement):i.getClientRects?!!i.getClientRects().length:!1:!1}function $b({element:i,target:e,positions:t,limiter:n,fitInViewport:s,viewportOffsetConfig:o}){Xd(e)&&(e=e()),Xd(n)&&(n=n());const a=qE(i),c=KE(o),u=new pe(i),h=b1(e,c);let m;if(!h||!c.getIntersection(h))return null;const g={targetRect:h,elementRect:u,positionedElementAncestor:a,viewportRect:c};if(!n&&!s)m=new YE(t[0],g);else{if(n){const w=b1(n,c);w&&(g.limiterRect=w)}m=GO(t,g)}return m}function b1(i,e){const t=new pe(i).getVisible();return t?t.getIntersection(e):null}function KE(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const e=new pe(ee.window);return e.top+=i.top,e.height-=i.top,e.bottom-=i.bottom,e.height-=i.bottom,e.left+=i.left,e.right-=i.right,e.width-=i.left+i.right,e}function GO(i,e){const{elementRect:t}=e,n=t.getArea(),s=i.map(c=>new YE(c,e)).filter(c=>!!c.name);let o=0,a=null;for(const c of s){const{limiterIntersectionArea:u,viewportIntersectionArea:h}=c;if(u===n)return c;const m=h**2+u**2;m>o&&(o=m,a=c)}return a}class YE{name;config;_positioningFunctionCoordinates;_options;_cachedRect;_cachedAbsoluteRect;constructor(e,t){const n=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!n)return;const{left:s,top:o,name:a,config:c}=n;this.name=a,this.config=c,this._positioningFunctionCoordinates={left:s,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}function w1(i){const e=i.parentNode;e&&e.removeChild(i)}function Ld(){const i=ee.window.visualViewport;if(!i||!(le.isiOS||le.isSafari))return{left:0,top:0};const e=Math.max(Math.round(i.offsetLeft),0),t=Math.max(Math.round(i.offsetTop),0);return{left:e,top:t}}function KO({target:i,viewportOffset:e=0,ancestorOffset:t=0,alignToTop:n,forceScroll:s}){const o=Gb(i);let a=o,c=null;for(e=QO(e);a;){let u;a==o?u=_1(i):u=_1(c),JO({parent:u,getRect:()=>Dg(i,a),alignToTop:n,ancestorOffset:t,forceScroll:s});let h=Dg(i,a);const m=Dg(u,a);if(h.height>m.height){const g=h.getIntersection(m);g&&(h=g)}if(YO({window:a,rect:h,viewportOffset:e,alignToTop:n,forceScroll:s}),a.parent!=a){if(c=a.frameElement,a=a.parent,!c)return}else a=null}}function YO({window:i,rect:e,alignToTop:t,forceScroll:n,viewportOffset:s}){const o=e.clone().moveBy(0,s.bottom),a=e.clone().moveBy(0,-s.top),c=new pe(i).excludeScrollbarsAndBorders(),u=[a,o],h=t&&n,m=u.every(C=>c.contains(C));let{scrollX:g,scrollY:w}=i;const _=g,v=w;h?w-=c.top-e.top+s.top:m||(QE(a,c)?w-=c.top-e.top+s.top:JE(o,c)&&(t?w+=e.top-c.top-s.top:w+=e.bottom-c.bottom+s.bottom)),m||(XE(e,c)?g-=c.left-e.left+s.left:ZE(e,c)&&(g+=e.right-c.right+s.right)),(g!=_||w!==v)&&i.scrollTo(g,w)}function JO({parent:i,getRect:e,alignToTop:t,forceScroll:n,ancestorOffset:s=0,limiterElement:o}){const a=Gb(i),c=t&&n;let u,h,m;const g=o||a.document.body;for(;i!=g;)h=e(),u=new pe(i).excludeScrollbarsAndBorders(),m=u.contains(h),c?i.scrollTop-=u.top-h.top+s:m||(QE(h,u)?i.scrollTop-=u.top-h.top+s:JE(h,u)&&(t?i.scrollTop+=h.top-u.top-s:i.scrollTop+=h.bottom-u.bottom+s)),m||(XE(h,u)?i.scrollLeft-=u.left-h.left+s:ZE(h,u)&&(i.scrollLeft+=h.right-u.right+s)),i=i.parentNode}function JE(i,e){return i.bottom>e.bottom}function QE(i,e){return i.top<e.top}function XE(i,e){return i.left<e.left}function ZE(i,e){return i.right>e.right}function Gb(i){return Lh(i)?i.startContainer.ownerDocument.defaultView:i.ownerDocument.defaultView}function _1(i){if(Lh(i)){let e=i.commonAncestorContainer;return ut(e)&&(e=e.parentNode),e}else return i.parentNode}function Dg(i,e){const t=Gb(i),n=new pe(i);if(t===e)return n;{let s=t;for(;s!=e;){const o=s.frameElement,a=new pe(o).excludeScrollbarsAndBorders();n.moveBy(a.left,a.top),s=s.parent}}return n}function QO(i){return typeof i=="number"?{top:i,bottom:i,left:i,right:i}:i}const XO={ctrl:"",cmd:"",alt:"",shift:""},ZO={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},y1={37:"",38:"",39:"",40:"",9:"",33:"Page Up",34:"Page Down"},ke=sV(),eV=Object.fromEntries(Object.entries(ke).map(([i,e])=>{let t;return e in y1?t=y1[e]:t=i.charAt(0).toUpperCase()+i.slice(1),[e,t]}));function Go(i){let e;if(typeof i=="string"){if(e=ke[i.toLowerCase()],!e)throw new E("keyboard-unknown-key",null,{key:i})}else e=i.keyCode+(i.altKey?ke.alt:0)+(i.ctrlKey?ke.ctrl:0)+(i.shiftKey?ke.shift:0)+(i.metaKey?ke.cmd:0);return e}function Dh(i){return typeof i=="string"&&(i=oV(i)),i.map(e=>typeof e=="string"?nV(e):e).reduce((e,t)=>t+e,0)}function eh(i,e){let t=Dh(i);const n=le.isMac||le.isiOS;return Object.entries(n?XO:ZO).reduce((a,[c,u])=>((t&ke[c])!=0&&(t&=~ke[c],a+=u),a),"")+(t?eV[t]:"")}function tV(i){return i==ke.arrowright||i==ke.arrowleft||i==ke.arrowup||i==ke.arrowdown}function Fh(i,e){const t=e==="ltr";switch(i){case ke.arrowleft:return t?"left":"right";case ke.arrowright:return t?"right":"left";case ke.arrowup:return"up";case ke.arrowdown:return"down"}}function nV(i){if(i.endsWith("!"))return Go(i.slice(0,-1));const e=Go(i);return(le.isMac||le.isiOS)&&e==ke.ctrl?ke.cmd:e}function iV(i,e){const t=Fh(i,e);return t==="down"||t==="right"}function sV(){const i={pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let e=65;e<=90;e++){const t=String.fromCharCode(e);i[t.toLowerCase()]=e}for(let e=48;e<=57;e++)i[e-48]=e;for(let e=112;e<=123;e++)i["f"+(e-111)]=e;return Object.assign(i,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),i}function oV(i){return i.split("+").map(e=>e.trim())}const rV=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig","ur","urd"];function v1(i){return rV.includes(i)?"rtl":"ltr"}function st(i){return Array.isArray(i)?i:[i]}ee.window.CKEDITOR_TRANSLATIONS||(ee.window.CKEDITOR_TRANSLATIONS={});function aV(i,e,t=1,n){if(typeof t!="number")throw new E("translation-service-quantity-not-a-number",null,{quantity:t});const s=n||ee.window.CKEDITOR_TRANSLATIONS,o=uV(s);o===1&&(i=Object.keys(s)[0]);const a=e.id||e.string;if(o===0||!cV(i,a,s))return t!==1?e.plural:e.string;const c=s[i].dictionary,u=s[i].getPluralForm||(g=>g===1?0:1),h=c[a];if(typeof h=="string")return h;const m=Number(u(t));return h[m]}function lV(i){return Array.isArray(i)?i.reduce((e,t)=>Wb(e,t)):i}function cV(i,e,t){return!!t[i]&&!!t[i].dictionary[e]}function uV(i){return Object.keys(i).length}class dV{uiLanguage;uiLanguageDirection;contentLanguage;contentLanguageDirection;t;translations;constructor({uiLanguage:e="en",contentLanguage:t,translations:n}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=v1(this.uiLanguage),this.contentLanguageDirection=v1(this.contentLanguage),this.translations=lV(n),this.t=(s,o)=>this._t(s,o)}_t(e,t=[]){t=st(t),typeof e=="string"&&(e={string:e});const s=!!e.plural?t[0]:1,o=aV(this.uiLanguage,e,s,this.translations);return hV(o,t)}}function hV(i,e){return i.replace(/%(\d+)/g,(t,n)=>n<e.length?e[n]:t)}class Dt extends Je(){_items;_itemMap;_idProperty;_bindToCollection;_bindToExternalToInternalMap;_bindToInternalToExternalMap;_skippedIndexesFromExternal;constructor(e={},t={}){super();const n=Dn(e);if(n||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const s of e)this._items.push(s),this._itemMap.set(this._getItemIdBeforeAdding(s),s)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(t===void 0)t=this._items.length;else if(t>this._items.length||t<0)throw new E("collection-add-item-invalid-index",this);let n=0;for(const s of e){const o=this._getItemIdBeforeAdding(s),a=t+n;this._items.splice(a,0,s),this._itemMap.set(o,s),this.fire("add",s,a),n++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if(typeof e=="string")t=this._itemMap.get(e);else if(typeof e=="number")t=this._items[e];else throw new E("collection-get-invalid-arg",this);return t||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const t=this._idProperty,n=e[t];return n&&this._itemMap.has(n)}}getIndex(e){let t;return typeof e=="string"?t=this._itemMap.get(e):t=e,t?this._items.indexOf(t):-1}remove(e){const[t,n]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:n}),t}map(e,t){return this._items.map(e,t)}forEach(e,t){this._items.forEach(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new E("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:t=>{this._setUpBindToBinding(n=>new t(n))},using:t=>{typeof t=="function"?this._setUpBindToBinding(t):this._setUpBindToBinding(n=>n[t])}}}_setUpBindToBinding(e){const t=this._bindToCollection,n=(s,o,a)=>{const c=t._bindToCollection==this,u=t._bindToInternalToExternalMap.get(o);if(c&&u)this._bindToExternalToInternalMap.set(o,u),this._bindToInternalToExternalMap.set(u,o);else{const h=e(o);if(!h){this._skippedIndexesFromExternal.push(a);return}let m=a;for(const g of this._skippedIndexesFromExternal)a>g&&m--;for(const g of t._skippedIndexesFromExternal)m>=g&&m++;this._bindToExternalToInternalMap.set(o,h),this._bindToInternalToExternalMap.set(h,o),this.add(h,m);for(let g=0;g<t._skippedIndexesFromExternal.length;g++)m<=t._skippedIndexesFromExternal[g]&&t._skippedIndexesFromExternal[g]++}};for(const s of t)n(null,s,t.getIndex(s));this.listenTo(t,"add",n),this.listenTo(t,"remove",(s,o,a)=>{const c=this._bindToExternalToInternalMap.get(o);c&&this.remove(c),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((u,h)=>(a<h&&u.push(h-1),a>h&&u.push(h),u),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let n;if(t in e){if(n=e[t],typeof n!="string")throw new E("collection-add-invalid-id",this);if(this.get(n))throw new E("collection-add-item-already-exists",this)}else e[t]=n=rn();return n}_remove(e){let t,n,s,o=!1;const a=this._idProperty;if(typeof e=="string"?(n=e,s=this._itemMap.get(n),o=!s,s&&(t=this._items.indexOf(s))):typeof e=="number"?(t=e,s=this._items[t],o=!s,s&&(n=s[a])):(s=e,n=s[a],t=this._items.indexOf(s),o=t==-1||!this._itemMap.get(n)),o)throw new E("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(n);const c=this._bindToInternalToExternalMap.get(s);return this._bindToInternalToExternalMap.delete(s),this._bindToExternalToInternalMap.delete(c),this.fire("remove",s,t),[s,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}function Ze(i){const e=i.next();return e.done?null:e.value}class dt extends Hn(qe()){_elements=new Set;_externalViews=new Set;_blurTimeout=null;constructor(){super(),this.set("isFocused",!1),this.set("focusedElement",null)}get elements(){return Array.from(this._elements.values())}get externalViews(){return Array.from(this._externalViews.values())}add(e){if(k1(e))this._addElement(e);else if(C1(e))this._addView(e);else{if(!e.element)throw new E("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element)}}remove(e){k1(e)?this._removeElement(e):C1(e)?this._removeView(e):this._removeElement(e.element)}_addElement(e){if(this._elements.has(e))throw new E("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>{const t=this.externalViews.find(n=>fV(e,n));t?this._focus(t.element):this._focus(e)},{useCapture:!0}),this.listenTo(e,"blur",()=>{this._blur()},{useCapture:!0}),this._elements.add(e)}_removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e)),e===this.focusedElement&&this._blur()}_addView(e){e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",()=>{e.focusTracker.focusedElement?e.element&&this._focus(e.element):this._blur()}),this._externalViews.add(e)}_removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews.delete(e)}destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null}_focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0}_blur(){this.elements.find(n=>n.contains(document.activeElement))||this.externalViews.find(n=>n.focusTracker.isFocused&&!n.focusTracker._blurTimeout)||(this._clearBlurTimeout(),this._blurTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0))}_clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null}}function C1(i){return"focusTracker"in i&&i.focusTracker instanceof dt}function k1(i){return ao(i)}function fV(i,e){return T1(i,e)?!0:!!e.focusTracker.externalViews.find(t=>T1(i,t))}function T1(i,e){return!!e.element&&e.element.contains(document.activeElement)&&i.contains(e.element)}class Ct{_listener;constructor(){this._listener=new(Hn())}listenTo(e){this._listener.listenTo(e,"keydown",(t,n)=>{this._listener.fire("_keydown:"+Go(n),n)})}set(e,t,n={}){const s=Dh(e),o=n.priority;this._listener.listenTo(this._listener,"_keydown:"+s,(a,c)=>{n.filter&&!n.filter(c)||(t(c,()=>{c.preventDefault(),c.stopPropagation(),a.stop()}),a.return=!0)},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+Go(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}}function mV(i){const e=new Map;for(const t in i)e.set(t,i[t]);return e}function Ss(i){return Dn(i)?new Map(i):mV(i)}function E1(i,e,t){const n=i.length,s=e.length;for(let o=n-1;o>=t;o--)i[o+s]=i[o];for(let o=0;o<s;o++)i[t+o]=e[o]}function Kb(i,e){let t;function n(...s){n.cancel(),t=setTimeout(()=>i(...s),e)}return n.cancel=()=>{clearTimeout(t)},n}function Yb(i){try{if(!i.startsWith("ey"))return null;const e=atob(i.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(e)}catch{return null}}function gV(){const i=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;i[e]=t}return i}function pV(i){const e=Array.isArray(i)?i:[i],t=gV();let n=-1;const s=e.map(o=>Array.isArray(o)?o.join(""):String(o)).join("");for(let o=0;o<s.length;o++){const a=s.charCodeAt(o);n=n>>>8^t[(n^a)&255]}return n=(n^-1)>>>0,n.toString(16).padStart(8,"0")}function bV(i){return!!i&&i.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(i)}function wV(i){return!!i&&i.length==1&&/[\ud800-\udbff]/.test(i)}function _V(i){return!!i&&i.length==1&&/[\udc00-\udfff]/.test(i)}function Jb(i,e){return wV(i.charAt(e-1))&&_V(i.charAt(e))}function Qb(i,e){return bV(i.charAt(e))}const yV=vV();function eS(i,e){const t=String(i).matchAll(yV);return Array.from(t).some(n=>n.index<e&&e<n.index+n[0].length)}function vV(){const i=[new RegExp("\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}","u"),new RegExp("\\p{Emoji}\\u{FE0F}?\\u{20E3}","u"),new RegExp("\\p{Emoji}\\u{FE0F}","u"),new RegExp("(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*","u")],e=new RegExp("\\p{Regional_Indicator}{2}","u").source,t="(?:"+i.map(s=>s.source).join("|")+")",n=`${e}|${t}(?:${t})*`;return new RegExp(n,"ug")}function S1(i){if(!i)return null;const e=CV(i);return e?Yb(e):null}function CV(i){const e=i.split(".");return e.length!=3?null:e[1]}function kV(i,e){return(i.removeFeatures||[]).includes(e)}const Sl=new WeakMap;let A1=!1;function tS({view:i,element:e,text:t,isDirectHost:n=!0,keepOnFocus:s=!1}){const o=i.document;Sl.has(o)||(Sl.set(o,new Map),o.registerPostFixer(c=>Fg(Sl.get(o),c)),o.on("change:isComposing",()=>{i.change(c=>Fg(Sl.get(o),c))},{priority:"high"})),e.is("editableElement")&&e.on("change:placeholder",(c,u,h)=>a(h)),e.placeholder?a(e.placeholder):t&&a(t),t&&xV();function a(c){const u={text:c,isDirectHost:n,keepOnFocus:s,hostElement:n?e:null};Sl.get(o).set(e,u),i.change(h=>Fg([[e,u]],h))}}function TV(i,e){return e.hasClass("ck-placeholder")?!1:(i.addClass("ck-placeholder",e),!0)}function nS(i,e){return e.hasClass("ck-placeholder")?(i.removeClass("ck-placeholder",e),!0):!1}function EV(i,e){if(!i.isAttached()||SV(i))return!1;const t=i.document,s=t.selection.anchor;return t.isComposing&&s&&s.parent===i?!1:e||!t.isFocused?!0:!!s&&s.parent!==i}function SV(i){for(const e of i.getChildren())if(!e.is("uiElement"))return!0;return!1}function Fg(i,e){const t=[];let n=!1;for(const[s,o]of i)o.isDirectHost&&(t.push(s),x1(e,s,o)&&(n=!0));for(const[s,o]of i){if(o.isDirectHost)continue;const a=AV(s);a!==o.hostElement&&o.hostElement&&(e.removeAttribute("data-placeholder",o.hostElement),nS(e,o.hostElement),o.hostElement=null,n=!0),a&&(t.includes(a)||(o.hostElement=a,x1(e,s,o)&&(n=!0)))}return n}function x1(i,e,t){const{text:n,isDirectHost:s,hostElement:o}=t;let a=!1;return o.getAttribute("data-placeholder")!==n&&(i.setAttribute("data-placeholder",n,o),a=!0),(s||e.childCount==1)&&EV(o,t.keepOnFocus)?TV(i,o)&&(a=!0):nS(i,o)&&(a=!0),a}function AV(i){if(i.childCount){const e=i.getChild(0);if(e.is("element")&&!e.is("uiElement")&&!e.is("attributeElement"))return e}return null}function xV(){A1||Be("enableViewPlaceholder-deprecated-text-option"),A1=!0}class er{is(){throw new Error("is() method is abstract")}}class tr extends Je(er){document;parent;constructor(e){super(),this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new E("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Nt(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t,n){this.fire(`change:${e}`,t,n),this.parent&&this.parent._fireChange(e,t,n)}toJSON(){const e={path:this.getPath(),type:"Node"};return this!==this.root&&this.root.is("rootElement")&&(e.root=this.root.toJSON()),e}}tr.prototype.is=function(i){return i==="node"||i==="view:node"};class It extends tr{_textData;constructor(e,t){super(e),this._textData=t}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof It?this===e||this.data===e.data:!1}toJSON(){const e=super.toJSON();return e.type="Text",e.data=this.data,e}_clone(){return new It(this.document,this.data)}}It.prototype.is=function(i){return i==="$text"||i==="view:$text"||i==="text"||i==="view:text"||i==="node"||i==="view:node"};class fs extends er{textNode;data;offsetInText;constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.data.length)throw new E("view-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.data.length)throw new E("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const t=[];let n=e.includeSelf?this.textNode:this.parent;for(;n!==null;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}}fs.prototype.is=function(i){return i==="$textProxy"||i==="view:$textProxy"||i==="textProxy"||i==="view:textProxy"};class th{_consumables=new Map;add(e,t){let n;if(e.is("$text")||e.is("documentFragment")){this._consumables.set(e,!0);return}this._consumables.has(e)?n=this._consumables.get(e):(n=new IV(e),this._consumables.set(e,n)),n.add(t?Hl(t):e._getConsumables())}test(e,t){const n=this._consumables.get(e);return n===void 0?null:e.is("$text")||e.is("documentFragment")?n:n.test(Hl(t))}consume(e,t){if(e.is("$text")||e.is("documentFragment"))return this.test(e,t)?(this._consumables.set(e,!1),!0):!1;const n=this._consumables.get(e);return n===void 0?!1:n.consume(Hl(t))}revert(e,t){const n=this._consumables.get(e);n!==void 0&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):n.revert(Hl(t)))}static createFrom(e,t){if(t||(t=new th),e.is("$text"))t.add(e);else if(e.is("element")||e.is("documentFragment")){t.add(e);for(const n of e.getChildren())th.createFrom(n,t)}return t}}class IV{element;_canConsumeName=null;_attributes=new Map;constructor(e){this.element=e}add(e){e.name&&(this._canConsumeName=!0);for(const[t,n]of e.attributes)if(n){let s=this._attributes.get(t);(!s||typeof s=="boolean")&&(s=new Map,this._attributes.set(t,s)),s.set(n,!0)}else{if(t=="style"||t=="class")throw new E("viewconsumable-invalid-attribute",this);this._attributes.set(t,!0)}}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const[t,n]of e.attributes){const s=this._attributes.get(t);if(s===void 0)return null;if(s===!1)return!1;if(s!==!0){if(n){const o=s.get(n);if(o===void 0)return null;if(!o)return!1}else for(const o of s.values())if(!o)return!1}}return!0}consume(e){if(!this.test(e))return!1;e.name&&(this._canConsumeName=!1);for(const[t,n]of e.attributes){const s=this._attributes.get(t);if(typeof s=="boolean")for(const[o]of this.element._getConsumables(t,n).attributes)this._attributes.set(o,!1);else if(n)for(const[,o]of this.element._getConsumables(t,n).attributes)s.set(o,!1);else for(const o of s.keys())s.set(o,!1)}return!0}revert(e){e.name&&(this._canConsumeName=!0);for(const[t,n]of e.attributes){const s=this._attributes.get(t);if(s===!1){this._attributes.set(t,!0);continue}if(!(s===void 0||s===!0))if(n)s.get(n)===!1&&s.set(n,!0);else for(const o of s.keys())s.set(o,!0)}}}function Hl(i){const e=[];return"attributes"in i&&i.attributes&&zg(e,i.attributes),"classes"in i&&i.classes&&zg(e,i.classes,"class"),"styles"in i&&i.styles&&zg(e,i.styles,"style"),{name:i.name||!1,attributes:e}}function zg(i,e,t){if(typeof e=="string"){i.push(t?[t,e]:[e]);return}for(const n of e)Array.isArray(n)?i.push(n):i.push(t?[t,n]:[n])}class Ko{_patterns=[];constructor(...e){this.add(...e)}add(...e){for(let t of e)(typeof t=="string"||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const n of this._patterns){const s=this._isElementMatching(t,n);if(s)return{element:t,pattern:n,match:s}}return null}matchAll(...e){const t=[];for(const n of e)for(const s of this._patterns){const o=this._isElementMatching(n,s);o&&t.push({element:n,pattern:s,match:o})}return t.length>0?t:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],t=e.name;return typeof e!="function"&&t&&!(t instanceof RegExp)?t:null}_isElementMatching(e,t){if(typeof t=="function"){const o=t(e);return!o||typeof o!="object"?o:Hl(o)}const n={};if(t.name&&(n.name=PV(t.name,e.name),!n.name))return null;const s=[];return t.attributes&&!RV(t.attributes,e,s)||t.classes&&!OV(t.classes,e,s)||t.styles&&!VV(t.styles,e,s)?null:(s.length&&(n.attributes=s),n)}}function nh(i,e){return i===!0||i===e||i instanceof RegExp&&!!String(e).match(i)}function PV(i,e){return i instanceof RegExp?!!e.match(i):i===e}function Xb(i,e){if(Array.isArray(i))return i.map(n=>typeof n!="object"||n instanceof RegExp?e?[e,n,!0]:[n,!0]:((n.key===void 0||n.value===void 0)&&Be("matcher-pattern-missing-key-or-value",n),e?[e,n.key,n.value]:[n.key,n.value]));if(typeof i!="object"||i instanceof RegExp)return[e?[e,i,!0]:[i,!0]];const t=[];for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.push(e?[e,n,i[n]]:[n,i[n]]);return t}function RV(i,e,t){let n;return typeof i=="object"&&!(i instanceof RegExp)&&!Array.isArray(i)?(i.style!==void 0&&Be("matcher-pattern-deprecated-attributes-style-key",i),i.class!==void 0&&Be("matcher-pattern-deprecated-attributes-class-key",i)):n=["class","style"],e._collectAttributesMatch(Xb(i),t,n)}function OV(i,e,t){return e._collectAttributesMatch(Xb(i,"class"),t)}function VV(i,e,t){return e._collectAttributesMatch(Xb(i,"style"),t)}class Ql{_styles;_cachedStyleNames=null;_cachedExpandedStyleNames=null;_styleProcessor;constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=MV(e);for(const[n,s]of t)this._styleProcessor.toNormalizedForm(n,s,this._styles);return this}has(e){if(this.isEmpty)return!1;const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);return Array.isArray(n)}set(e,t){if(this._cachedStyleNames=null,this._cachedExpandedStyleNames=null,on(e))for(const[n,s]of Object.entries(e))this._styleProcessor.toNormalizedForm(n,s,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t={};for(const n of st(e)){const s=qp(n),o=ro(this._styles,s);if(o)Dd(t,s,o);else{const a=this.getAsString(n);a!==void 0&&this._styleProcessor.toNormalizedForm(n,a,t)}}Object.keys(t).length&&(iS(this._styles,t),this._cachedStyleNames=null,this._cachedExpandedStyleNames=null)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!on(this._styles[e]))return this._styles[e];const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);if(Array.isArray(n))return n[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?(this._cachedExpandedStyleNames||=this._styleProcessor.getStyleNames(this._styles),this._cachedExpandedStyleNames):(this._cachedStyleNames||=this.getStylesEntries().map(([t])=>t),this._cachedStyleNames)}keys(){return this.getStyleNames()}clear(){this._styles={},this._cachedStyleNames=null,this._cachedExpandedStyleNames=null}isSimilar(e){if(this.size!==e.size)return!1;for(const t of this.getStyleNames())if(!e.has(t)||e.getAsString(t)!==this.getAsString(t))return!1;return!0}getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const n of t)e.push(...this._styleProcessor.getReducedForm(n,this._styles));return e}_clone(){const e=new this.constructor(this._styleProcessor);return e.set(this.getNormalized()),e}_getTokensMatch(e,t){const n=[];for(const s of this.getStyleNames(!0))if(nh(e,s)){if(t===!0){n.push(s);continue}const o=this.getAsString(s);nh(t,o)&&n.push(s)}return n.length?n:void 0}_getConsumables(e){const t=[];if(e){t.push(e);for(const n of this._styleProcessor.getRelatedStyles(e))t.push(n)}else for(const n of this.getStyleNames()){for(const s of this._styleProcessor.getRelatedStyles(n))t.push(s);t.push(n)}return t}_canMergeFrom(e){for(const t of e.getStyleNames())if(this.has(t)&&this.getAsString(t)!==e.getAsString(t))return!1;return!0}_mergeFrom(e){for(const t of e.getStyleNames())this.has(t)||this.set(t,e.getAsString(t))}_isMatching(e){for(const t of e.getStyleNames())if(!this.has(t)||this.getAsString(t)!==e.getAsString(t))return!1;return!0}}class BV{_normalizers;_extractors;_reducers;_consumables;constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,n){if(on(t)){Dd(n,qp(e),t);return}if(this._normalizers.has(e)){const s=this._normalizers.get(e),{path:o,value:a}=s(t);Dd(n,o,a)}else Dd(n,e,t)}getNormalized(e,t){if(!e)return Wb({},t);if(t[e]!==void 0)return t[e];if(this._extractors.has(e)){const n=this._extractors.get(e);if(typeof n=="string")return ro(t,n);const s=n(e,t);if(s)return s}return ro(t,qp(e))}getReducedForm(e,t){const n=this.getNormalized(e,t);return n===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(n):[[e,n]]}getStyleNames(e){const t=new Set;for(const n of this._consumables.keys()){const s=this.getNormalized(n,e);s&&(typeof s!="object"||Object.keys(s).length)&&t.add(n)}for(const n of Object.keys(e))t.add(n);return Array.from(t)}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const n of t)this._mapStyleNames(n,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function MV(i){let e=null,t=0,n=0,s=null;const o=new Map;if(i==="")return o;i.charAt(i.length-1)!=";"&&(i=i+";");for(let a=0;a<i.length;a++){const c=i.charAt(a);if(e===null)switch(c){case":":s||(s=i.substr(t,a-t),n=a+1);break;case'"':case"'":e=c;break;case";":{const u=i.substr(n,a-n);s&&o.set(s.trim(),u.trim()),s=null,t=a+1;break}}else c===e&&(e=null)}return o}function qp(i){return i.replace("-",".")}function Dd(i,e,t){let n=t;on(t)&&(n=Wb({},ro(i,e),t)),AE(i,e,n)}function iS(i,e){for(const t of Object.keys(e))i[t]!==null&&!Array.isArray(i[t])&&typeof i[t]=="object"&&typeof e[t]=="object"?(iS(i[t],e[t]),Object.keys(i[t]).length||delete i[t]):delete i[t]}class Ug{_set=new Set;get isEmpty(){return this._set.size==0}get size(){return this._set.size}has(e){return this._set.has(e)}keys(){return Array.from(this._set.keys())}setTo(e){this.clear();for(const t of e.split(/\s+/))t&&this._set.add(t);return this}set(e){for(const t of st(e))t&&this._set.add(t)}remove(e){for(const t of st(e))this._set.delete(t)}clear(){this._set.clear()}toString(){return Array.from(this._set).join(" ")}isSimilar(e){if(this.size!==e.size)return!1;for(const t of this.keys())if(!e.has(t))return!1;return!0}_clone(){const e=new this.constructor;return e._set=new Set(this._set),e}_getTokensMatch(e){const t=[];if(e===!0){for(const n of this._set.keys())t.push(n);return t}if(typeof e=="string"){for(const n of e.split(/\s+/))if(this._set.has(n))t.push(n);else return;return t}for(const n of this._set.keys())n.match(e)&&t.push(n);return t.length?t:void 0}_getConsumables(e){return e?[e]:this.keys()}_canMergeFrom(){return!0}_mergeFrom(e){for(const t of e._set.keys())this._set.has(t)||this._set.add(t)}_isMatching(e){for(const t of e._set.keys())if(!this._set.has(t))return!1;return!0}}class yi extends tr{name;_unsafeAttributesToRender=[];_attrs;_children;_customProperties=new Map;get _classes(){return this._attrs.get("class")}get _styles(){return this._attrs.get("style")}constructor(e,t,n,s){super(e),this.name=t,this._attrs=this._parseAttributes(n),this._children=[],s&&this._insertChild(0,s)}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes&&(yield"class"),this._styles&&(yield"style");for(const e of this._attrs.keys())e!="class"&&e!="style"&&(yield e)}*getAttributes(){for(const[e,t]of this._attrs.entries())yield[e,String(t)]}getAttribute(e){return this._attrs.has(e)?String(this._attrs.get(e)):void 0}hasAttribute(e,t){return this._attrs.has(e)?t!==void 0?Qr(this.name,e)||Al(this.name,e)?this._attrs.get(e).has(t):this._attrs.get(e)===t:!0:!1}isSimilar(e){if(!(e instanceof yi))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size)return!1;for(const[t,n]of this._attrs){const s=e._attrs.get(t);if(s===void 0)return!1;if(typeof n=="string"||typeof s=="string"){if(s!==n)return!1}else if(!n.isSimilar(s))return!1}return!0}hasClass(...e){for(const t of e)if(!this._classes||!this._classes.has(t))return!1;return!0}getClassNames(){const e=this._classes?this._classes.keys():[],t=e[Symbol.iterator]();return Object.assign(e,{next:t.next.bind(t)})}getStyle(e){return this._styles&&this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles&&this._styles.getNormalized(e)}getStyleNames(e){return this._styles?this._styles.getStyleNames(e):[]}hasStyle(...e){for(const t of e)if(!this._styles||!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Ko(...e);let n=this.parent;for(;n&&!n.is("documentFragment");){if(t.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=this._classes?this._classes.keys().sort().join(","):"",t=this._styles&&String(this._styles),n=Array.from(this._attrs).filter(([s])=>s!="style"&&s!="class").map(s=>`${s[0]}="${s[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(t?` style="${t}"`:"")+(n==""?"":` ${n}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}toJSON(){const e=super.toJSON();if(e.name=this.name,e.type="Element",this._attrs.size&&(e.attributes=Object.fromEntries(this.getAttributes())),this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=[];if(e)for(const s of this.getChildren())t.push(s._clone(e));const n=new this.constructor(this.document,this.name,this._attrs,t);return n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n._unsafeAttributesToRender=this._unsafeAttributesToRender,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this,{index:e});let n=0;const s=NV(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_setAttribute(e,t,n=!0){if(this._fireChange("attributes",this),Qr(this.name,e)||Al(this.name,e)){let s=this._attrs.get(e);s||(s=Qr(this.name,e)?new Ql(this.document.stylesProcessor):new Ug,this._attrs.set(e,s)),n?s.setTo(String(t)):Qr(this.name,e)?Array.isArray(t)?s.set(t[0],t[1]):s.set(t):s.set(typeof t=="string"?t.split(/\s+/):t)}else this._attrs.set(e,String(t))}_removeAttribute(e,t){if(this._fireChange("attributes",this),t!==void 0&&(Qr(this.name,e)||Al(this.name,e))){const n=this._attrs.get(e);return n?(Al(this.name,e)&&typeof t=="string"&&(t=t.split(/\s+/)),n.remove(t),n.isEmpty?this._attrs.delete(e):!1):!1}return this._attrs.delete(e)}_addClass(e){this._setAttribute("class",e,!1)}_removeClass(e){this._removeAttribute("class",e)}_setStyle(e,t){typeof e!="string"?this._setAttribute("style",e,!1):this._setAttribute("style",[e,t],!1)}_removeStyle(e){this._removeAttribute("style",e)}_collectAttributesMatch(e,t,n){for(const[s,o,a]of e){let c=!1,u=!1;for(const[h,m]of this._attrs)if(!(n&&n.includes(h)||!nh(s,h)))if(c=!0,typeof m=="string"){if(nh(o,m))t.push([h]),u=!0;else if(!(s instanceof RegExp))return!1}else{const g=m._getTokensMatch(o,a||!0);if(g){u=!0;for(const w of g)t.push([h,w])}else if(!(s instanceof RegExp))return!1}if(!c||!u)return!1}return!0}_getConsumables(e,t){const n=[];if(e){const s=this._attrs.get(e);if(s!==void 0)if(typeof s=="string")n.push([e]);else for(const o of s._getConsumables(t))n.push([e,o])}else for(const[s,o]of this._attrs)if(typeof o=="string")n.push([s]);else for(const a of o._getConsumables())n.push([s,a]);return{name:!e,attributes:n}}_canMergeAttributesFrom(e){if(this.name!=e.name)return!1;for(const[t,n]of e._attrs){const s=this._attrs.get(t);if(s!==void 0){if(typeof s=="string"||typeof n=="string"){if(s!==n)return!1}else if(!s._canMergeFrom(n))return!1}}return!0}_mergeAttributesFrom(e){this._fireChange("attributes",this);for(const[t,n]of e._attrs){const s=this._attrs.get(t);s===void 0||typeof s=="string"||typeof n=="string"?this._setAttribute(t,n):s._mergeFrom(n)}}_canSubtractAttributesOf(e){if(this.name!=e.name)return!1;for(const[t,n]of e._attrs){const s=this._attrs.get(t);if(s===void 0)return!1;if(typeof s=="string"||typeof n=="string"){if(s!==n)return!1}else if(!s._isMatching(n))return!1}return!0}_subtractAttributesOf(e){this._fireChange("attributes",this);for(const[t,n]of e._attrs){const s=this._attrs.get(t);typeof s=="string"||typeof n=="string"?this._attrs.delete(t):(s.remove(n.keys()),s.isEmpty&&this._attrs.delete(t))}}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}_parseAttributes(e){const t=Ss(e);for(const[n,s]of t)if(s===null)t.delete(n);else if(Qr(this.name,n)){const o=s instanceof Ql?s._clone():new Ql(this.document.stylesProcessor).setTo(String(s));t.set(n,o)}else if(Al(this.name,n)){const o=s instanceof Ug?s._clone():new Ug().setTo(String(s));t.set(n,o)}else typeof s!="string"&&t.set(n,String(s));return t}}yi.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="view:element"):i==="element"||i==="view:element"||i==="node"||i==="view:node"};function NV(i,e){if(typeof e=="string")return[new It(i,e)];Dn(e)||(e=[e]);const t=[];for(const n of e)typeof n=="string"?t.push(new It(i,n)):n instanceof fs?t.push(new It(i,n.data)):t.push(n);return t}function Al(i,e){return e=="class"||i=="a"&&e=="rel"}function Qr(i,e){return e=="style"}class dc extends yi{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=LV}toJSON(){const e=super.toJSON();return e.type="ContainerElement",e}}dc.prototype.is=function(i,e){return e?e===this.name&&(i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function LV(){const i=[...this.getChildren()],e=i[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const t of i)if(!t.is("uiElement"))return null;return this.childCount}class zh extends qe(dc){constructor(e,t,n,s){super(e,t,n,s),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",o=>o&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}toJSON(){const e=super.toJSON();return e.type="EditableElement",e.isReadOnly=this.isReadOnly,e.isFocused=this.isFocused,e}}zh.prototype.is=function(i,e){return e?e===this.name&&(i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};const I1=Symbol("rootName");class sS extends zh{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(I1)}set rootName(e){this._setCustomProperty(I1,e)}toJSON(){return this.rootName}set _name(e){this.name=e}}sS.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};class jo{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new E("view-tree-walker-no-start-position",null);if(e.direction&&e.direction!="forward"&&e.direction!="backward")throw new E("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=Q._createAt(e.startPosition):this._position=Q._createAt(e.boundaries[e.direction=="backward"?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n;do n=this.position,t=this.next();while(!t.done&&e(t.value));t.done||(this._position=n)}jumpTo(e){this._boundaryStartParent&&e.isBefore(this.boundaries.start)?e=this.boundaries.start:this._boundaryEndParent&&e.isAfter(this.boundaries.end)&&(e=this.boundaries.end),this._position=e.clone()}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===n.childCount)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let s;if(n&&n.is("view:$text")){if(e.isAtEnd)return this._position=Q._createAfter(n),this._next();s=n.data[e.offset]}else s=n.getChild(e.offset);if(typeof s=="string"){let o;this.singleCharacters?o=1:o=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-e.offset;const a=new fs(n,e.offset,o);return e.offset+=o,this._position=e,this._formatReturnValue("text",a,t,e,o)}if(s&&s.is("view:element")){if(!this.shallow)e=new Q(s,0);else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,this._formatReturnValue("elementStart",s,t,e,1)}if(s&&s.is("view:$text")){if(this.singleCharacters)return e=new Q(s,0),this._position=e,this._next();let o=s.data.length,a;return s==this._boundaryEndParent?(o=this.boundaries.end.offset,a=new fs(s,0,o),e=Q._createAfter(a)):(a=new fs(s,0,s.data.length),e.offset++),this._position=e,this._formatReturnValue("text",a,t,e,o)}return e=Q._createAfter(n),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,t,e)}_previous(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let s;if(n.is("view:$text")){if(e.isAtStart)return this._position=Q._createBefore(n),this._previous();s=n.data[e.offset-1]}else s=n.getChild(e.offset-1);if(typeof s=="string"){let o;if(this.singleCharacters)o=1;else{const c=n===this._boundaryStartParent?this.boundaries.start.offset:0;o=e.offset-c}e.offset-=o;const a=new fs(n,e.offset,o);return this._position=e,this._formatReturnValue("text",a,t,e,o)}if(s&&s.is("view:element"))return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",s,t,e,1)):(e=new Q(s,s.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",s,t,e));if(s&&s.is("view:$text")){if(this.singleCharacters)return e=new Q(s,s.data.length),this._position=e,this._previous();let o=s.data.length,a;if(s==this._boundaryStartParent){const c=this.boundaries.start.offset;a=new fs(s,c,s.data.length-c),o=a.data.length,e=Q._createBefore(a)}else a=new fs(s,0,s.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",a,t,e,o)}return e=Q._createBefore(n),this._position=e,this._formatReturnValue("elementStart",n,t,e,1)}_formatReturnValue(e,t,n,s,o){return t.is("view:$textProxy")&&(t.offsetInText+t.data.length==t.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(s=Q._createAfter(t.textNode),this._position=s):n=Q._createAfter(t.textNode)),t.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(s=Q._createBefore(t.textNode),this._position=s):n=Q._createBefore(t.textNode))),{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:s,length:o}}}}class Q extends er{parent;offset;constructor(e,t){super(),this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof zh);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const t=Q._createAt(this),n=t.offset+e;return t.offset=n<0?0:n,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new jo(t);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),n.push(e.offset);const s=Nt(t,n);switch(s){case"prefix":return"before";case"extension":return"after";default:return t[s]<n[s]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new jo(e)}clone(){return new Q(this.parent,this.offset)}toJSON(){return{parent:this.parent.toJSON(),offset:this.offset}}static _createAt(e,t){if(e instanceof Q)return new this(e.parent,e.offset);{const n=e;if(t=="end")t=n.is("$text")?n.data.length:n.childCount;else{if(t=="before")return this._createBefore(n);if(t=="after")return this._createAfter(n);if(t!==0&&!t)throw new E("view-createpositionat-offset-required",n)}return new Q(n,t)}}static _createAfter(e){if(e.is("$textProxy"))return new Q(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new E("view-position-after-root",e,{root:e});return new Q(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Q(e.textNode,e.offsetInText);if(!e.parent)throw new E("view-position-before-root",e,{root:e});return new Q(e.parent,e.index)}}Q.prototype.is=function(i){return i==="position"||i==="view:position"};class ge extends er{start;end;constructor(e,t=null){super(),this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new jo({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(ld,{direction:"backward"}),t=this.end.getLastMatchingPosition(ld);return e.parent.is("$text")&&e.isAtStart&&(e=Q._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=Q._createAfter(t.parent)),new ge(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(ld);if(e.isAfter(this.end)||e.isEqual(this.end))return new ge(e,e);let t=this.end.getLastMatchingPosition(ld,{direction:"backward"});const n=e.nodeAfter,s=t.nodeBefore;return n&&n.is("$text")&&(e=new Q(n,0)),s&&s.is("$text")&&(t=new Q(s,s.data.length)),new ge(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new ge(this.start,e.start)),this.containsPosition(e.end)&&t.push(new ge(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new ge(t,n)}return null}getWalker(e={}){return e.boundaries=this,new jo(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new ge(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new jo(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new jo(e);yield t.position;for(const n of t)yield n.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}static _createFromParentsAndOffsets(e,t,n,s){return new this(new Q(e,t),new Q(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Q._createBefore(e),t)}}ge.prototype.is=function(i){return i==="range"||i==="view:range"};function ld(i){return!!(i.item.is("attributeElement")||i.item.is("uiElement"))}class bi extends Je(er){_ranges;_lastRangeBackward;_isFake;_fakeSelectionLabel;constructor(...e){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=Hp(this.getRanges()),n=Hp(e.getRanges());if(t!=n)return!1;if(t==0)return!0;for(let s of this.getRanges()){s=s.getTrimmed();let o=!1;for(let a of e.getRanges())if(a=a.getTrimmed(),s.start.isEqual(a.start)&&s.end.isEqual(a.end)){o=!0;break}if(!o)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]),this._setFakeOptions(s);else if(t instanceof bi||t instanceof Zb)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof ge)this._setRanges([t],s&&s.backward),this._setFakeOptions(s);else if(t instanceof Q)this._setRanges([new ge(t)]),this._setFakeOptions(s);else if(t instanceof tr){const o=!!s&&!!s.backward;let a;if(n===void 0)throw new E("view-selection-setto-required-second-parameter",this);n=="in"?a=ge._createIn(t):n=="on"?a=ge._createOn(t):a=new ge(Q._createAt(t,n)),this._setRanges([a],o),this._setFakeOptions(s)}else if(Dn(t))this._setRanges(t,s&&s.backward),this._setFakeOptions(s);else throw new E("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,t){if(this.anchor===null)throw new E("view-selection-setfocus-no-ranges",this);const n=Q._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.pop(),n.compareWith(s)=="before"?this._addRange(new ge(n,s),!0):this._addRange(new ge(s,n)),this.fire("change")}toJSON(){const e={ranges:Array.from(this.getRanges()).map(t=>t.toJSON())};return this.isBackward&&(e.isBackward=!0),this.isFake&&(e.isFake=!0),e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const n of e)this._addRange(n);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof ge))throw new E("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new E("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new ge(e.start,e.end))}}bi.prototype.is=function(i){return i==="selection"||i==="view:selection"};class Zb extends Je(er){_selection;constructor(...e){super(),this._selection=new bi,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}toJSON(){return this._selection.toJSON()}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,t){this._selection.setFocus(e,t)}}Zb.prototype.is=function(i){return i==="selection"||i=="documentSelection"||i=="view:selection"||i=="view:documentSelection"};class nr extends Ts{startRange;_eventPhase;_currentTarget;constructor(e,t,n){super(e,t),this.startRange=n,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const Hg=Symbol("bubblingEmitter"),jg=Symbol("bubblingCallbacks"),qg=Symbol("bubblingContexts");function DV(i){class e extends i{fire(n,...s){try{const o=n instanceof Ts?n:new Ts(this,n),a=Wg(this),c=R1(this);if(xl(o,"capturing",this),cd(a,"$capture",o,...s))return o.return;const u=o.startRange||this.selection.getFirstRange(),h=u?u.getContainedElement():null,m=h?zV(c,h):!1;let g=h||UV(u);if(xl(o,"atTarget",g),!m){if(cd(a,"$text",o,...s))return o.return;xl(o,"bubbling",g)}for(;g;){if(g.is("element")&&cd(a,g,o,...s))return o.return;g=g.parent,xl(o,"bubbling",g)}return xl(o,"bubbling",this),cd(a,"$document",o,...s),o.return}catch(o){E.rethrowUnexpectedError(o,this)}}_addEventListener(n,s,o){const a=st(o.context||"$document"),c=Wg(this),u=P1(this);for(const m of a)typeof m=="function"&&R1(this).add(m);const h=FV(this,a,s);u.set(s,h),this.listenTo(c,n,h,o)}_removeEventListener(n,s){const o=Wg(this),a=P1(this),c=a.get(s);c&&(a.delete(s),this.stopListening(o,n,c))}}return e}function xl(i,e,t){i instanceof nr&&(i._eventPhase=e,i._currentTarget=t)}function cd(i,e,t,...n){return i.fire(t,{currentTarget:e,eventArgs:n}),!!t.stop.called}function FV(i,e,t){return function(n,s){const{currentTarget:o,eventArgs:a}=s;if(typeof o=="string"){e.includes(o)&&t.call(i,n,...a);return}if(o.is("rootElement")&&e.includes("$root")){t.call(i,n,...a);return}if(e.includes(o.name)){t.call(i,n,...a);return}for(const c of e)if(typeof c=="function"&&c(o)){t.call(i,n,...a);return}}}function Wg(i){return i[Hg]||(i[Hg]=new(Je())),i[Hg]}function P1(i){return i[jg]||(i[jg]=new Map),i[jg]}function R1(i){return i[qg]||(i[qg]=new Set),i[qg]}function zV(i,e){for(const t of i)if(t(e))return!0;return!1}function UV(i){if(!i)return null;const e=i.start.parent,t=i.end.parent,n=e.getPath(),s=t.getPath();return n.length>s.length?e:t}class oS extends DV(qe()){selection;roots;stylesProcessor;_postFixers=new Set;constructor(e){super(),this.selection=new Zb,this.roots=new Dt({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(t=n(e),t)break;while(t)}}const O1=10;class ma extends yi{static DEFAULT_PRIORITY=O1;_priority=O1;_id=null;_clonesGroup=null;constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=HV}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new E("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}toJSON(){const e=super.toJSON();return e.type="AttributeElement",e}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}_canMergeAttributesFrom(e){return this.id!==null||e.id!==null||this.priority!==e.priority?!1:super._canMergeAttributesFrom(e)}_canSubtractAttributesOf(e){return this.id!==null||e.id!==null||this.priority!==e.priority?!1:super._canSubtractAttributesOf(e)}}ma.prototype.is=function(i,e){return e?e===this.name&&(i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"):i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function HV(){if($g(this))return null;let i=this.parent;for(;i&&i.is("attributeElement");){if($g(i)>1)return null;i=i.parent}return!i||$g(i)>1?null:this.childCount}function $g(i){return Array.from(i.getChildren()).filter(e=>!e.is("uiElement")).length}class ew extends yi{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=jV}toJSON(){const e=super.toJSON();return e.type="EmptyElement",e}_insertChild(e,t){if(t&&(t instanceof tr||Array.from(t).length>0))throw new E("view-emptyelement-cannot-add",[this,t]);return 0}}ew.prototype.is=function(i,e){return e?e===this.name&&(i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"):i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function jV(){return null}class Uh extends yi{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=WV}_insertChild(e,t){if(t&&(t instanceof tr||Array.from(t).length>0))throw new E("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const n of this.getAttributeKeys())t.setAttribute(n,this.getAttribute(n));return t}toJSON(){const e=super.toJSON();return e.type="UIElement",e}}Uh.prototype.is=function(i,e){return e?e===this.name&&(i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"):i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function qV(i){i.document.on("arrowKey",(e,t)=>$V(e,t,i.domConverter),{priority:"low"})}function WV(){return null}function $V(i,e,t){if(e.keyCode==ke.arrowright){const n=e.domTarget.ownerDocument.defaultView.getSelection(),s=n.rangeCount==1&&n.getRangeAt(0).collapsed;if(s||e.shiftKey){const o=n.focusNode,a=n.focusOffset,c=t.domPositionToView(o,a);if(c===null)return;let u=!1;const h=c.getLastMatchingPosition(m=>(m.item.is("uiElement")&&(u=!0),!!(m.item.is("uiElement")||m.item.is("attributeElement"))));if(u){const m=t.viewPositionToDom(h);s?n.collapse(m.parent,m.offset):n.extend(m.parent,m.offset)}}}}class tw extends yi{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=GV}toJSON(){const e=super.toJSON();return e.type="RawElement",e}_insertChild(e,t){if(t&&(t instanceof tr||Array.from(t).length>0))throw new E("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}}tw.prototype.is=function(i,e){return e?e===this.name&&(i==="rawElement"||i==="view:rawElement"||i==="element"||i==="view:element"):i==="rawElement"||i==="view:rawElement"||i===this.name||i==="view:"+this.name||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function GV(){return null}class $o extends Je(er){document;_children=[];_customProperties=new Map;constructor(e,t){super(),this.document=e,t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this,{index:e});let n=0;const s=KV(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_fireChange(e,t,n){this.fire(`change:${e}`,t,n)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}$o.prototype.is=function(i){return i==="documentFragment"||i==="view:documentFragment"};function KV(i,e){return typeof e=="string"?[new It(i,e)]:(Dn(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new It(i,t):t instanceof fs?new It(i,t.data):t))}class rS{document;_cloneGroups=new Map;_slotFactory=null;constructor(e){this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new $o(this.document,e)}createText(e){return new It(this.document,e)}createAttributeElement(e,t,n={}){const s=new ma(this.document,e,t);return typeof n.priority=="number"&&(s._priority=n.priority),n.id&&(s._id=n.id),n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createContainerElement(e,t,n={},s={}){let o;XV(n)?s=n:o=n;const a=new dc(this.document,e,t,o);return s.renderUnsafeAttributes&&a._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),a}createEditableElement(e,t,n={}){const s=new zh(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createEmptyElement(e,t,n={}){const s=new ew(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createUIElement(e,t,n){const s=new Uh(this.document,e,t);return n&&(s.render=n),s}createRawElement(e,t,n,s={}){const o=new tw(this.document,e,t);return n&&(o.render=n),s.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),o}setAttribute(e,t,n,s){s!==void 0?s._setAttribute(e,t,n):n._setAttribute(e,t)}removeAttribute(e,t,n){n!==void 0?n._removeAttribute(e,t):t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){Vi(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Q?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new E("view-writer-break-non-container-element",this.document);if(!t.parent)throw new E("view-writer-break-root",this.document);if(e.isAtStart)return Q._createBefore(t);if(!e.isAtEnd){const n=t._clone(!1);this.insert(Q._createAfter(t),n);const s=new ge(e,Q._createAt(t,"end")),o=new Q(n,0);this.move(s,o)}return Q._createAfter(t)}mergeAttributes(e){const t=e.offset,n=e.parent;if(n.is("$text"))return e;if(n.is("attributeElement")&&n.childCount===0){const a=n.parent,c=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Q(a,c))}const s=n.getChild(t-1),o=n.getChild(t);if(!s||!o)return e;if(s.is("$text")&&o.is("$text"))return B1(s,o);if(s.is("attributeElement")&&o.is("attributeElement")&&s.isSimilar(o)){const a=s.childCount;return s._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new Q(s,a))}return e}mergeContainers(e){const t=e.nodeBefore,n=e.nodeAfter;if(!t||!n||!t.is("containerElement")||!n.is("containerElement"))throw new E("view-writer-merge-containers-invalid-position",this.document);const s=t.getChild(t.childCount-1),o=s instanceof It?Q._createAt(s,"end"):Q._createAt(t,"end");return this.move(ge._createIn(n),Q._createAt(t,"end")),this.remove(ge._createOn(n)),o}insert(e,t){t=Dn(t)?[...t]:[t],aS(t,this.document);const n=t.reduce((a,c)=>{const u=a[a.length-1],h=!c.is("uiElement");return!u||u.breakAttributes!=h?a.push({breakAttributes:h,nodes:[c]}):u.nodes.push(c),a},[]);let s=null,o=e;for(const{nodes:a,breakAttributes:c}of n){const u=this._insertNodes(o,a,c);s||(s=u.start),o=u.end}return s?new ge(s,o):new ge(e)}remove(e){const t=e instanceof ge?e:ge._createOn(e);if(Il(t,this.document),t.isCollapsed)return new $o(this.document);const{start:n,end:s}=this._breakAttributesRange(t,!0),o=n.parent,a=s.offset-n.offset,c=o._removeChildren(n.offset,a);for(const h of c)this._removeFromClonedElementsGroup(h);const u=this.mergeAttributes(n);return t.start=u,t.end=u.clone(),new $o(this.document,c)}clear(e,t){Il(e,this.document);const n=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const s of n){const o=s.item;let a;if(o.is("element")&&t.isSimilar(o))a=ge._createOn(o);else if(!s.nextPosition.isAfter(e.start)&&o.is("$textProxy")){const c=o.getAncestors().find(u=>u.is("element")&&t.isSimilar(u));c&&(a=ge._createIn(c))}a&&(a.end.isAfter(e.end)&&(a.end=e.end),a.start.isBefore(e.start)&&(a.start=e.start),this.remove(a))}}move(e,t){let n;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const s=t.parent,o=s.childCount;e=this._breakAttributesRange(e,!0),n=this.remove(e),t.offset+=s.childCount-o}else n=this.remove(e);return this.insert(t,n)}wrap(e,t){if(!(t instanceof ma))throw new E("view-writer-wrap-invalid-attribute",this.document);if(Il(e,this.document),e.isCollapsed){let n=e.start;n.parent.is("element")&&!YV(n.parent)&&(n=n.getLastMatchingPosition(o=>o.item.is("uiElement"))),n=this._wrapPosition(n,t);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(e.start)&&this.setSelection(n),new ge(n)}else return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof ma))throw new E("view-writer-unwrap-invalid-attribute",this.document);if(Il(e,this.document),e.isCollapsed)return e;const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,a=this._unwrapChildren(o,n.offset,s.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new ge(c,u)}rename(e,t){const n=new dc(this.document,e,t.getAttributes());return this.insert(Q._createAfter(t),n),this.move(ge._createIn(t),Q._createAt(n,0)),this.remove(ge._createOn(t)),n}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Q._createAt(e,t)}createPositionAfter(e){return Q._createAfter(e)}createPositionBefore(e){return Q._createBefore(e)}createRange(e,t){return new ge(e,t)}createRangeOn(e){return ge._createOn(e)}createRangeIn(e){return ge._createIn(e)}createSelection(...e){return new bi(...e)}createSlot(e="children"){if(!this._slotFactory)throw new E("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,n){let s;if(n?s=Wp(e):s=e.parent.is("$text")?e.parent.parent:e.parent,!s)throw new E("view-writer-invalid-position-container",this.document);let o;n?o=this._breakAttributes(e,!0):o=e.parent.is("$text")?Gg(e):e;const a=s._insertChild(o.offset,t);for(const m of t)this._addToClonedElementsGroup(m);const c=o.getShiftedBy(a),u=this.mergeAttributes(o);u.isEqual(o)||c.offset--;const h=this.mergeAttributes(c);return new ge(u,h)}_wrapChildren(e,t,n,s){let o=t;const a=[];for(;o<n;){const u=e.getChild(o),h=u.is("$text"),m=u.is("attributeElement");if(m&&u._canMergeAttributesFrom(s))u._mergeAttributesFrom(s),a.push(new Q(e,o));else if(h||!m||JV(s,u)){const g=s._clone();u._remove(),g._appendChild(u),e._insertChild(o,g),this._addToClonedElementsGroup(g),a.push(new Q(e,o))}else this._wrapChildren(u,0,u.childCount,s);o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t)continue;this.mergeAttributes(u).isEqual(u)||(c++,n--)}return ge._createFromParentsAndOffsets(e,t,e,n)}_unwrapChildren(e,t,n,s){let o=t;const a=[];for(;o<n;){const u=e.getChild(o);if(!u.is("attributeElement")){o++;continue}if(u.isSimilar(s)){const h=u.getChildren(),m=u.childCount;u._remove(),e._insertChild(o,h),this._removeFromClonedElementsGroup(u),a.push(new Q(e,o),new Q(e,o+m)),o+=m,n+=m-1;continue}if(u._canSubtractAttributesOf(s)){u._subtractAttributesOf(s),a.push(new Q(e,o),new Q(e,o+1)),o++;continue}this._unwrapChildren(u,0,u.childCount,s),o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t||u.offset==n)continue;this.mergeAttributes(u).isEqual(u)||(c++,n--)}return ge._createFromParentsAndOffsets(e,t,e,n)}_wrapRange(e,t){const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,a=this._wrapChildren(o,n.offset,s.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new ge(c,u)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return V1(e.clone());e.parent.is("$text")&&(e=Gg(e));const n=this.createAttributeElement("_wrapPosition-fake-element");n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,e.parent._insertChild(e.offset,n);const s=new ge(e,e.getShiftedBy(1));this.wrap(s,t);const o=new Q(n.parent,n.index);n._remove();const a=o.nodeBefore,c=o.nodeAfter;return a&&a.is("view:$text")&&c&&c.is("view:$text")?B1(a,c):V1(o)}_breakAttributesRange(e,t=!1){const n=e.start,s=e.end;if(Il(e,this.document),e.isCollapsed){const u=this._breakAttributes(e.start,t);return new ge(u,u)}const o=this._breakAttributes(s,t),a=o.parent.childCount,c=this._breakAttributes(n,t);return o.offset+=o.parent.childCount-a,new ge(c,o)}_breakAttributes(e,t=!1){const n=e.offset,s=e.parent;if(e.parent.is("emptyElement"))throw new E("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new E("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new E("view-writer-cannot-break-raw-element",this.document);if(!t&&s.is("$text")&&$p(s.parent)||$p(s))return e.clone();if(s.is("$text"))return this._breakAttributes(Gg(e),t);const o=s.childCount;if(n==o){const a=new Q(s.parent,s.index+1);return this._breakAttributes(a,t)}else if(n===0){const a=new Q(s.parent,s.index);return this._breakAttributes(a,t)}else{const a=s.index+1,c=s._clone();s.parent._insertChild(a,c),this._addToClonedElementsGroup(c);const u=s.childCount-n,h=s._removeChildren(n,u);c._appendChild(h);const m=new Q(s.parent,a);return this._breakAttributes(m,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const s of e.getChildren())this._addToClonedElementsGroup(s);const t=e.id;if(!t)return;let n=this._cloneGroups.get(t);n||(n=new Set,this._cloneGroups.set(t,n)),n.add(e),e._clonesGroup=n}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const s of e.getChildren())this._removeFromClonedElementsGroup(s);const t=e.id;if(!t)return;const n=this._cloneGroups.get(t);n&&n.delete(e)}}function YV(i){return Array.from(i.getChildren()).some(e=>!e.is("uiElement"))}function Wp(i){let e=i.parent;for(;!$p(e);){if(!e)return;e=e.parent}return e}function JV(i,e){return i.priority<e.priority?!0:i.priority>e.priority?!1:i.getIdentity()<e.getIdentity()}function V1(i){const e=i.nodeBefore;if(e&&e.is("$text"))return new Q(e,e.data.length);const t=i.nodeAfter;return t&&t.is("$text")?new Q(t,0):i}function Gg(i){if(i.offset==i.parent.data.length)return new Q(i.parent.parent,i.parent.index+1);if(i.offset===0)return new Q(i.parent.parent,i.parent.index);const e=i.parent.data.slice(i.offset);return i.parent._data=i.parent.data.slice(0,i.offset),i.parent.parent._insertChild(i.parent.index+1,new It(i.root.document,e)),new Q(i.parent.parent,i.parent.index+1)}function B1(i,e){const t=i.data.length;return i._data+=e.data,e._remove(),new Q(i,t)}const QV=[It,ma,dc,ew,tw,Uh];function aS(i,e){for(const t of i){if(!QV.some(n=>t instanceof n))throw new E("view-writer-insert-invalid-node-type",e);t.is("$text")||aS(t.getChildren(),e)}}function $p(i){return i&&(i.is("containerElement")||i.is("documentFragment"))}function Il(i,e){const t=Wp(i.start),n=Wp(i.end);if(!t||!n||t!==n)throw new E("view-writer-invalid-range-container",e)}function XV(i){return Vi(i)}const lS=i=>i.createTextNode(""),cS=i=>{const e=i.createElement("span");return e.dataset.ckeFiller="true",e.innerText="",e},uS=i=>{const e=i.createElement("br");return e.dataset.ckeFiller="true",e},Ln=7,hc="".repeat(Ln);function nn(i){return typeof i=="string"?i.substr(0,Ln)===hc:ut(i)&&i.data.substr(0,Ln)===hc}function da(i){return i.data.length==Ln&&nn(i)}function M1(i){const e=typeof i=="string"?i:i.data;return nn(i)?e.slice(Ln):e}function ZV(i){i.document.on("arrowKey",eB,{priority:"low"})}function eB(i,e){if(e.keyCode==ke.arrowleft){const t=e.domTarget.ownerDocument.defaultView.getSelection();if(t.rangeCount==1&&t.getRangeAt(0).collapsed){const n=t.getRangeAt(0).startContainer,s=t.getRangeAt(0).startOffset;nn(n)&&s<=Ln&&t.collapse(n,0)}}}class tB extends qe(){domDocuments=new Set;domConverter;markedAttributes=new Set;markedChildren=new Set;markedTexts=new Set;selection;_inlineFiller=null;_fakeSelectionContainer=null;constructor(e,t){super(),this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),le.isBlink&&!le.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()})}markToSync(e,t){if(e==="text")this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if(e==="attributes")this.markedAttributes.add(t);else if(e==="children")this.markedChildren.add(t);else throw new E("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!le.isAndroid)return;let e=null;const t=le.isBlink&&!le.isAndroid?!this.isSelecting:!0;for(const n of this.markedChildren)this._updateChildrenMappings(n);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=Q._createBefore(e.parent)));for(const n of this.markedAttributes)this._updateAttrs(n);for(const n of this.markedChildren)this._updateChildren(n,{inlineFillerPosition:e});for(const n of this.markedTexts)!this.markedChildren.has(n.parent)&&this.domConverter.mapViewToDom(n.parent)&&this._updateText(n,{inlineFillerPosition:e});if(t)if(e){const n=this.domConverter.viewPositionToDom(e),s=n.parent.ownerDocument;nn(n.parent)?this._inlineFiller=n.parent:this._inlineFiller=N1(s,n.parent,n.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.childNodes),s=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(n,s),a=this._findUpdateActions(o,n,s,iB);if(a.indexOf("update")!==-1){const c={equal:0,insert:0,delete:0};for(const u of a)if(u==="update"){const h=c.equal+c.insert,m=c.equal+c.delete,g=e.getChild(h);g&&!g.is("uiElement")&&!g.is("rawElement")&&this._updateElementMappings(g,n[m]),w1(s[h]),c.equal++}else c[u]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Q._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&ut(t.parent)&&nn(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!nn(e))throw new E("view-renderer-filler-was-lost",this);da(e)?e.remove():e.data=e.data.substr(Ln),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(t.root)||!t.is("element")||!nB(t))return!1;const s=e.nodeBefore,o=e.nodeAfter;return!(s instanceof It||o instanceof It||n===t.getFillerOffset()&&(!s||!s.is("element","br"))||le.isAndroid&&(s||o))}_updateText(e,t){const n=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const a=t.inlineFillerPosition;a&&a.parent==e.parent&&a.offset==e.index&&(o=hc+o),this._updateTextNode(n,o)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(t){for(const n of Array.from(t.attributes)){const s=n.name;e.hasAttribute(s)||this.domConverter.removeDomElementAttribute(t,s)}for(const n of e.getAttributeKeys())this.domConverter.setDomElementAttribute(t,n,e.getAttribute(n),e)}}_updateChildren(e,t){const n=this.domConverter.mapViewToDom(e);if(!n)return;if(le.isAndroid){let g=null;for(const w of Array.from(n.childNodes)){if(g&&ut(g)&&ut(w)){n.normalize();break}g=w}}const s=t.inlineFillerPosition,o=n.childNodes,a=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));s&&s.parent===e&&N1(n.ownerDocument,a,s.offset);const c=this._diffNodeLists(o,a),u=this._findUpdateActions(c,o,a,sB);let h=0;const m=new Set;for(const g of u)g==="delete"?(m.add(o[h]),w1(o[h])):(g==="equal"||g==="update")&&h++;h=0;for(const g of u)g==="insert"?(GE(n,h,a[h]),h++):g==="update"?(this._updateTextNode(o[h],a[h].data),h++):g==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(a[h])),h++);for(const g of m)g.parentNode||this.domConverter.unbindDomElement(g)}_diffNodeLists(e,t){return e=aB(e,this._fakeSelectionContainer),fa(e,t,oB.bind(null,this.domConverter))}_findUpdateActions(e,t,n,s){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],a=[],c=[];const u={equal:0,insert:0,delete:0};for(const h of e)h==="insert"?c.push(n[u.equal+u.insert]):h==="delete"?a.push(t[u.equal+u.delete]):(o=o.concat(fa(a,c,s).map(m=>m==="equal"?"update":m)),o.push("equal"),a=[],c=[]),u[h]++;return o.concat(fa(a,c,s).map(h=>h==="equal"?"update":h))}_updateTextNode(e,t){const n=e.data;n!=t&&(le.isAndroid&&this.isComposing&&n.replace(/\u00A0/g," ")==t.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,t))}_updateTextNodeInternal(e,t){const n=VE(e.data,t);for(const s of n)s.type==="insert"?e.insertData(s.index,s.values.join("")):e.deleteData(s.index,s.howMany)}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}}_updateSelection(){if(le.isBlink&&!le.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);if(!this.isFocused||!e){!this.selection.isFake&&this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected&&this._removeFakeSelection();return}this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&le.isAndroid||this._updateDomSelection(e)}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=lB(t));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!n.parentElement||n.parentElement!=e)&&e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||"";const s=t.getSelection(),o=t.createRange();s.removeAllRanges(),o.selectNodeContents(n),s.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),s=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(n.parent,n.offset,s.parent,s.offset),le.isGecko&&rB(s,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!t||t.parentElement!==e||n.anchorNode!==t&&!t.contains(n.anchorNode)?!0:t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const n=e.activeElement,s=this.domConverter.mapDomToView(n);n&&s&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function nB(i){if(i.getAttribute("contenteditable")=="false")return!1;const e=i.findAncestor(t=>t.hasAttribute("contenteditable"));return!e||e.getAttribute("contenteditable")=="true"}function N1(i,e,t){const n=e instanceof Array?e:e.childNodes,s=n[t];if(ut(s))return s.data=hc+s.data,s;{const o=i.createTextNode(hc);return Array.isArray(e)?n.splice(t,0,o):GE(e,t,o),o}}function iB(i,e){return lo(i)&&lo(e)&&!ut(i)&&!ut(e)&&!Jl(i)&&!Jl(e)&&i.tagName.toLowerCase()===e.tagName.toLowerCase()}function sB(i,e){return lo(i)&&lo(e)&&ut(i)&&ut(e)}function oB(i,e,t){return e===t?!0:ut(e)&&ut(t)?e.data===t.data:!!(i.isBlockFiller(e)&&i.isBlockFiller(t))}function rB(i,e){let t=i.parent,n=i.offset;if(ut(t)&&da(t)&&(n=ua(t)+1,t=t.parentNode),t.nodeType!=Node.ELEMENT_NODE||n!=t.childNodes.length-1)return;const s=t.childNodes[n];s&&s.tagName=="BR"&&e.addRange(e.getRangeAt(0))}function aB(i,e){const t=Array.from(i);return t.length==0||!e||t[t.length-1]==e&&t.pop(),t}function lB(i){const e=i.createElement("div");return e.className="ck-fake-selection-container",Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent="",e}const cB=uS(ee.document),uB=lS(ee.document),dB=cS(ee.document),ud="data-ck-unsafe-attribute-",L1="data-ck-unsafe-element";class dS{document;renderingMode;blockFillerMode;preElements;blockElements;inlineObjectElements;unsafeElements;_domDocument;_domToViewMapping=new WeakMap;_viewToDomMapping=new WeakMap;_fakeSelectionMapping=new WeakMap;_rawContentElementMatcher=new Ko;_inlineObjectElementMatcher=new Ko;_elementsWithTemporaryCustomProperties=new Set;constructor(e,{blockFillerMode:t,renderingMode:n="editing"}={}){this.document=e,this.renderingMode=n,this.blockFillerMode=t||(n==="editing"?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?ee.document:ee.document.implementation.createHTMLDocument("")}get domDocument(){return this._domDocument}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new bi(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const n of e.children)this.unbindDomElement(n)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,n){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:n==="img"&&(e==="src"||e==="srcset")||n==="source"&&e==="srcset"?!0:!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,t){if(this.renderingMode==="data"){e.innerHTML=t;return}const n=new DOMParser().parseFromString(t,"text/html"),s=n.createDocumentFragment(),o=n.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);const a=n.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),c=[];let u;for(;u=a.nextNode();)c.push(u);for(const h of c){for(const g of h.getAttributeNames())this.setDomElementAttribute(h,g,h.getAttribute(g));const m=h.tagName.toLowerCase();this._shouldRenameElement(m)&&(U1(m),h.replaceWith(this._createReplacementDomElement(m,h)))}for(;e.firstChild;)e.firstChild.remove();e.append(s)}viewToDom(e,t={}){if(e.is("$text")){const n=this._processDataFromViewText(e);return this._domDocument.createTextNode(n)}else{const n=e;if(this.mapViewToDom(n))if(n.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(n);else return this.mapViewToDom(n);let s;if(n.is("documentFragment"))s=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(s,n);else{if(n.is("uiElement"))return n.name==="$comment"?s=this._domDocument.createComment(n.getCustomProperty("$rawContent")):s=n.render(this._domDocument,this),t.bind&&this.bindElements(s,n),s;this._shouldRenameElement(n.name)?(U1(n.name),s=this._createReplacementDomElement(n.name)):n.hasAttribute("xmlns")?s=this._domDocument.createElementNS(n.getAttribute("xmlns"),n.name):s=this._domDocument.createElement(n.name),n.is("rawElement")&&n.render(s,this),t.bind&&this.bindElements(s,n);for(const o of n.getAttributeKeys())this.setDomElementAttribute(s,o,n.getAttribute(o),n)}if(t.withChildren!==!1)for(const o of this.viewChildrenToDom(n,t))s instanceof HTMLTemplateElement?s.content.appendChild(o):s.appendChild(o);return s}}setDomElementAttribute(e,t,n,s){const o=this.shouldRenderAttribute(t,n,e.tagName.toLowerCase())||s&&s.shouldRenderUnsafeAttribute(t);if(o||Be("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:n}),!$O(t)){Be("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:n});return}e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute(ud+t)&&o&&e.removeAttribute(ud+t),e.setAttribute(o?t:ud+t,n)}removeDomElementAttribute(e,t){t!=L1&&(e.removeAttribute(t),e.removeAttribute(ud+t))}*viewChildrenToDom(e,t={}){const n=e.getFillerOffset&&e.getFillerOffset();let s=0;for(const o of e.getChildren()){n===s&&(yield this._getBlockFiller());const a=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!Ze(o.getAttributes());if(a&&this.renderingMode=="data")if(o.is("rawElement")){const c=this._domDocument.createElement(o.name);o.render(c,this),yield*[...c.childNodes]}else yield*this.viewChildrenToDom(o,t);else a&&Be("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,t);s++}n===s&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),n=this.viewPositionToDom(e.end),s=this._domDocument.createRange();return s.setStart(t.parent,t.offset),s.setEnd(n.parent,n.offset),s}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const n=this.findCorrespondingDomText(t);if(!n)return null;let s=e.offset;return nn(n)&&(s+=Ln),n.data&&s>n.data.length&&(s=n.data.length),{parent:n,offset:s}}else{let n,s,o;if(e.offset===0){if(n=this.mapViewToDom(t),!n)return null;o=n.childNodes[0]}else{const c=e.nodeBefore;if(s=c.is("$text")?this.findCorrespondingDomText(c):this.mapViewToDom(c),!s)return null;n=s.parentNode,o=s.nextSibling}if(ut(o)&&nn(o))return{parent:o,offset:Ln};const a=s?ua(s)+1:0;return{parent:n,offset:a}}}domToView(e,t={}){const n=[],s=this._domToView(e,t,n),o=s.next().value;return!o||(s.next(),this._processDomInlineNodes(null,n,t),this.blockFillerMode=="br"&&F1(o))||o.is("$text")&&o.data.length==0?null:o}*domChildrenToView(e,t={},n=[]){let s=[];e instanceof HTMLTemplateElement?s=[...e.content.childNodes]:s=[...e.childNodes];for(let o=0;o<s.length;o++){const a=s[o],c=this._domToView(a,t,n),u=c.next().value;u!==null&&(this._isBlockViewElement(u)&&this._processDomInlineNodes(e,n,t),this.blockFillerMode=="br"&&F1(u)||(yield u),c.next())}this._processDomInlineNodes(e,n,t)}domSelectionToView(e){if(pB(e))return new bi([]);if(e.rangeCount===1){let s=e.getRangeAt(0).startContainer;ut(s)&&(s=s.parentNode);const o=this.fakeSelectionToView(s);if(o)return o}const t=this.isDomSelectionBackward(e),n=[];for(let s=0;s<e.rangeCount;s++){const o=e.getRangeAt(s),a=this.domRangeToView(o);a&&n.push(a)}return new bi(n,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),n=this.domPositionToView(e.endContainer,e.endOffset);return t&&n?new ge(t,n):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ua(e));const n=this.mapDomToView(e);if(n&&(n.is("uiElement")||n.is("rawElement")))return Q._createBefore(n);if(ut(e)){if(da(e))return this.domPositionToView(e.parentNode,ua(e));const s=this.findCorrespondingViewText(e);let o=t;return s?(nn(e)&&(o-=Ln,o=o<0?0:o),new Q(s,o)):null}else{if(t===0){const s=this.mapDomToView(e);if(s)return new Q(s,0)}else{const s=e.childNodes[t-1];if(ut(s)&&da(s)||s&&this.isBlockFiller(s))return this.domPositionToView(s.parentNode,ua(s));const o=ut(s)?this.findCorrespondingViewText(s):this.mapDomToView(s);if(o&&o.parent)return new Q(o.parent,o.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(da(e))return null;const t=this.getHostViewElement(e);if(t)return t;const n=e.previousSibling;if(n){if(!this.isElement(n))return null;const s=this.mapDomToView(n);if(s){const o=s.nextSibling;return o instanceof It?o:null}}else{const s=this.mapDomToView(e.parentNode);if(s){const o=s.getChild(0);return o instanceof It?o:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(!t||t.ownerDocument.activeElement===t)return;const{scrollX:n,scrollY:s}=ee.window,o=[];D1(t,a=>{const{scrollLeft:c,scrollTop:u}=a;o.push([c,u])}),t.focus({preventScroll:!0}),D1(t,a=>{const[c,u]=o.shift();a.scrollLeft=c,a.scrollTop=u}),ee.window.scrollTo(n,s)}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),n=this.domSelectionToView(t);n&&n.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(cB):z1(e,this.blockElements)?!0:e.isEqualNode(dB)||fB(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const n=t.collapsed;return t.detach(),n}getHostViewElement(e){const t=UO(e);for(t.pop();t.length;){const n=t.pop(),s=this._domToViewMapping.get(n);if(s&&(s.is("uiElement")||s.is("rawElement")))return s}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return lS(this._domDocument);case"markedNbsp":return cS(this._domDocument);case"br":return uS(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(ut(e)&&nn(e)&&t<Ln||this.isElement(e)&&nn(e.childNodes[t]))return!1;const n=this.mapDomToView(e);return!(n&&(n.is("uiElement")||n.is("rawElement")))}*_domToView(e,t,n){if(this.blockFillerMode!="br"&&z1(e,this.blockElements))return null;const s=this.getHostViewElement(e);if(s)return s;if(Jl(e)&&t.skipComments)return null;if(ut(e)){if(da(e))return null;{const o=e.data;if(o==="")return null;const a=new It(this.document,o);return n.push(a),a}}else{let o=this.mapDomToView(e);if(o)return this._isInlineObjectElement(o)&&n.push(o),o;if(this.isDocumentFragment(e))o=new $o(this.document),t.bind&&this.bindDocumentFragments(e,o);else{o=this._createViewElement(e,t),t.bind&&this.bindElements(e,o);const c=e.attributes;if(c)for(let u=c.length,h=0;h<u;h++)o._setAttribute(c[h].name,c[h].value);if(this._isViewElementWithRawContent(o,t))return o._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(o)||n.push(o),o;if(Jl(e))return o._setCustomProperty("$rawContent",e.data),o}yield o;const a=[];if(t.withChildren!==!1)for(const c of this.domChildrenToView(e,t,a))o._appendChild(c);if(this._isInlineObjectElement(o))n.push(o),this._processDomInlineNodes(null,a,t);else for(const c of a)n.push(c)}}_processDomInlineNodes(e,t,n){if(!t.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let s=!1;for(let o=0;o<t.length;o++){const a=t[o];if(!a.is("$text")){s=!1;continue}let c,u=!1;if(this._isPreFormatted(a))c=M1(a.data);else{c=a.data.replace(/[ \n\t\r]{1,}/g," "),u=/[^\S\u00A0]/.test(c.charAt(c.length-1));const h=o>0?t[o-1]:null,m=o+1<t.length?t[o+1]:null,g=!h||h.is("element")&&h.name=="br"||s,w=m?!1:!nn(a.data);n.withChildren!==!1&&(g&&(c=c.replace(/^ /,"")),w&&(c=c.replace(/ $/,""))),c=M1(c),this.blockFillerMode!="br"&&a.parent&&(gB(a.parent,c)?(c="",a.parent.parent&&(a.parent.parent._setCustomProperty("$hasBlockFiller",!0),a.parent._remove())):mB(a.parent,c,this.blockElements)&&(c="",a.parent._setCustomProperty("$hasBlockFiller",!0))),c=c.replace(/ \u00A0/g,"  ");const _=m&&m.is("element")&&m.name!="br",v=m&&m.is("$text")&&m.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(c)||!m||_||v)&&(c=c.replace(/\u00A0$/," ")),(g||h&&h.is("element")&&h.name!="br")&&(c=c.replace(/^\u00A0/," "))}c.length==0&&a.parent?(a._remove(),t.splice(o,1),o--):(a._data=c,s=u)}t.length=0}_processDataFromViewText(e){let t=e.data;if(this._isPreFormatted(e))return t;if(t.charAt(0)==" "){const n=this._getTouchingInlineViewNode(e,!1);(n&&n.is("$textProxy")&&this._nodeEndsWithSpace(n)||!n)&&(t=""+t.substr(1))}if(t.charAt(t.length-1)==" "){const n=this._getTouchingInlineViewNode(e,!0),s=n&&n.is("$textProxy")&&n.data.charAt(0)==" ";(t.charAt(t.length-2)==" "||!n||s)&&(t=t.substr(0,t.length-1)+"")}return t.replace(/ {2}/g," ")}_nodeEndsWithSpace(e){if(this._isPreFormatted(e))return!1;const t=this._processDataFromViewText(e);return t.charAt(t.length-1)==" "}_isPreFormatted(e){if(hB(e,this.preElements))return!0;for(const t of e.getAncestors({parentFirst:!0}))if(!(!t.is("element")||!t.hasStyle("white-space")||t.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(t.getStyle("white-space"));return!1}_getTouchingInlineViewNode(e,t){const n=new jo({startPosition:t?Q._createAfter(e):Q._createBefore(e),direction:t?"forward":"backward"});for(const{item:s}of n){if(s.is("$textProxy"))return s;if(s.is("element")&&s.getCustomProperty("dataPipeline:transparentRendering"))continue;if(s.is("element","br"))return null;if(this._isInlineObjectElement(s))return s;if(s.is("containerElement")||this._isBlockViewElement(s))return null}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,t){if(Jl(e))return new Uh(this.document,"$comment");const n=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new yi(this.document,n)}_isViewElementWithRawContent(e,t){return t.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const n=this._domDocument.createElement("span");if(n.setAttribute(L1,e),t){for(;t.firstChild;)n.appendChild(t.firstChild);for(const s of t.getAttributeNames())n.setAttribute(s,t.getAttribute(s))}return n}}function hB(i,e){return i.getAncestors().some(t=>t.is("element")&&e.includes(t.name))}function D1(i,e){let t=i;for(;t;)e(t),t=t.parentElement}function fB(i,e){return i.isEqualNode(uB)&&hS(i,e)&&i.parentNode.childNodes.length===1}function hS(i,e){const t=i.parentNode;return!!t&&!!t.tagName&&e.includes(t.tagName.toLowerCase())}function mB(i,e,t){return e==""&&i&&i.is("element")&&i.childCount==1&&t.includes(i.name)}function gB(i,e){return e==""&&i&&i.is("element","span")&&i.childCount==1&&i.hasAttribute("data-cke-filler")}function F1(i){return i.is("element","br")&&i.hasAttribute("data-cke-filler")}function z1(i,e){return i.tagName==="BR"&&hS(i,e)&&i.parentNode.childNodes.length===1}function U1(i){i==="script"&&Be("domconverter-unsafe-script-element-detected"),i==="style"&&Be("domconverter-unsafe-style-element-detected")}function pB(i){if(!le.isGecko||!i.rangeCount)return!1;const e=i.getRangeAt(0).startContainer;try{Object.prototype.toString.call(e)}catch{return!0}return!1}class Hi extends Hn(){view;document;_isEnabled=!1;constructor(e){super(),this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}class Yo{view;document;domEvent;domTarget;constructor(e,t,n){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,RE(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Ci extends Hi{useCapture=!1;usePassive=!1;observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(n=>{this.listenTo(e,n,(s,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture,usePassive:this.usePassive})})}stopObserving(e){this.stopListening(e)}fire(e,t,n){this.isEnabled&&this.document.fire(e,new Yo(this.view,t,n))}}class bB extends Ci{domEventType=["keydown","keyup"];onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return Go(this)}};this.fire(e.type,e,t)}}class wB extends Hi{_fireSelectionChangeDoneDebounced;constructor(e){super(e),this._fireSelectionChangeDoneDebounced=Ni(t=>{this.document.fire("selectionChangeDone",t)},200)}observe(){const e=this.document;e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&n.preventDefault()},{context:"$capture"}),e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(n.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,n=new bi(t.getRanges(),{backward:t.isBackward,fake:!1});(e==ke.arrowleft||e==ke.arrowup)&&n.setTo(n.getFirstPosition()),(e==ke.arrowright||e==ke.arrowdown)&&n.setTo(n.getLastPosition());const s={oldSelection:t,newSelection:n,domSelection:null};this.document.fire("selectionChange",s),this._fireSelectionChangeDoneDebounced(s)}}let fS=class extends Hi{domConverter;_config;_domElements;_mutationObserver;constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const t=this.domConverter,n=new Set,s=new Set;for(const a of e){const c=t.mapDomToView(a.target);c&&(c.is("uiElement")||c.is("rawElement")||a.type==="childList"&&!this._isBogusBrMutation(a)&&s.add(c))}for(const a of e){const c=t.mapDomToView(a.target);if(!(c&&(c.is("uiElement")||c.is("rawElement")))&&a.type==="characterData"){const u=t.findCorrespondingViewText(a.target);u&&!s.has(u.parent)?n.add(u):!u&&nn(a.target)&&s.add(t.mapDomToView(a.target.parentNode))}}const o=[];for(const a of n)o.push({type:"text",node:a});for(const a of s){const c=t.mapViewToDom(a),u=Array.from(a.getChildren()),h=Array.from(t.domChildrenToView(c,{withChildren:!1}));Fp(u,h,_B)||o.push({type:"children",node:a})}o.length&&this.document.fire("mutations",{mutations:o})}_isBogusBrMutation(e){let t=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}};function _B(i,e){if(!Array.isArray(i))return i===e?!0:i.is("$text")&&e.is("$text")?i.data===e.data:!1}class ih extends Ci{_renderTimeoutId=null;_isFocusChanging=!1;domEventType=["focus","blur"];constructor(e){super(e),this.useCapture=!0;const t=this.document;t.on("focus",()=>this._handleFocus()),t.on("blur",(n,s)=>this._handleBlur(s)),t.on("beforeinput",()=>{t.isFocused||this._handleFocus()},{priority:"highest"})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._clearTimeout(),super.destroy()}_handleFocus(){this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this._renderTimeoutId=null,this.flush(),this.view.change(()=>{})},50)}_handleBlur(e){const t=this.document.selection.editableElement;(t===null||t===e.target)&&(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change(()=>{}))}_clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null)}}class yB extends Hi{mutationObserver;focusObserver;selection;domConverter;_documents=new WeakSet;_fireSelectionChangeDoneDebounced;_clearInfiniteLoopInterval;_documentIsSelectingInactivityTimeoutDebounced;_loopbackCounter=0;_pendingSelectionChange=new Set;constructor(e){super(e),this.mutationObserver=e.getObserver(fS),this.focusObserver=e.getObserver(ih),this.selection=this.document.selection,this.domConverter=e.domConverter,this._fireSelectionChangeDoneDebounced=Ni(t=>{this.document.fire("selectionChangeDone",t)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Ni(()=>this.document.isSelecting=!1,5e3),this.view.document.on("change:isFocused",(t,n,s)=>{if(s&&this._pendingSelectionChange.size){for(const o of Array.from(this._pendingSelectionChange))this._handleSelectionChange(o);this._pendingSelectionChange.clear()}})}observe(e){const t=e.ownerDocument,n=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},s=()=>{this.document.isSelecting&&(this._handleSelectionChange(t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",n,{priority:"highest"}),this.listenTo(e,"keydown",s,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",s,{priority:"highest",useCapture:!0}),!this._documents.has(t)&&(this.listenTo(t,"mouseup",s,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",()=>{this.document.isComposing&&!le.isAndroid||(this._handleSelectionChange(t),this._documentIsSelectingInactivityTimeoutDebounced())}),this.listenTo(this.view.document,"compositionstart",()=>{this._handleSelectionChange(t)},{priority:"lowest"}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e){if(!this.isEnabled)return;const t=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(t.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(t);if(n.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!this.view.document.isFocused&&!this.view.document.isReadOnly){this._pendingSelectionChange.add(e);return}if(this._pendingSelectionChange.delete(e),!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(t))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(!vB(n))this.view.forceRender();else if(this.selection.isSimilar(n))this.view.forceRender();else{const s={oldSelection:this.selection,newSelection:n,domSelection:t};this.document.fire("selectionChange",s),this._fireSelectionChangeDoneDebounced(s)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}function vB(i){return Array.from(i.getRanges()).flatMap(e=>[e.start.root,e.end.root]).every(e=>e&&e.is("rootElement"))}class CB extends Ci{domEventType=["compositionstart","compositionupdate","compositionend"];constructor(e){super(e);const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0}),t.on("compositionend",()=>{t.isComposing=!1})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}class mS{_files;_native;constructor(e,t={}){this._files=t.cacheFiles?H1(e):null,this._native=e}get files(){return this._files||(this._files=H1(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,n){this._native.setDragImage(e,t,n)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function H1(i){const e=Array.from(i.files||[]),t=Array.from(i.items||[]);return e.length?e:t.filter(n=>n.kind==="file").map(n=>n.getAsFile())}class kB extends Ci{domEventType="beforeinput";onDomEvent(e){const t=e.getTargetRanges(),n=this.view,s=n.document;let o=null,a=null,c=[];if(e.dataTransfer&&(o=new mS(e.dataTransfer)),e.data!==null?a=e.data:o&&(a=o.getData("text/plain")),s.selection.isFake)c=Array.from(s.selection.getRanges()),e.preventDefault();else if(t.length)c=t.map(u=>{let h=n.domConverter.domPositionToView(u.startContainer,u.startOffset);const m=n.domConverter.domPositionToView(u.endContainer,u.endOffset);if(h&&nn(u.startContainer)&&u.startOffset<Ln){e.preventDefault();let g=Ln-u.startOffset;h=h.getLastMatchingPosition(w=>!!(w.item.is("attributeElement")||w.item.is("uiElement")||w.item.is("$textProxy")&&g--),{direction:"backward",singleCharacters:!0})}if(TB(u.endContainer,u.endOffset)&&e.preventDefault(),h)return n.createRange(h,m);if(m)return n.createRange(m)}).filter(u=>!!u);else if(le.isAndroid){const u=e.target.ownerDocument.defaultView.getSelection();c=Array.from(n.domConverter.domSelectionToView(u).getRanges())}if(le.isAndroid&&e.inputType=="insertCompositionText"&&a&&a.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[n.createRange(c[0].end)]});return}if(["insertText","insertReplacementText"].includes(e.inputType)&&a&&a.includes(`
`)){const u=a.split(/\n{1,2}/g);let h=c;e.preventDefault();for(let m=0;m<u.length;m++){const g=u[m];g!=""&&(this.fire(e.type,e,{data:g,dataTransfer:o,targetRanges:h,inputType:e.inputType,isComposing:e.isComposing}),h=[s.selection.getFirstRange()]),m+1<u.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:h}),h=[s.selection.getFirstRange()])}return}this.fire(e.type,e,{data:a,dataTransfer:o,targetRanges:c,inputType:e.inputType,isComposing:e.isComposing})}}function TB(i,e){for(;i.parentNode;){if(ut(i)){if(e!=i.data.length)return!1}else if(e!=i.childNodes.length)return!1;if(e=ua(i)+1,i=i.parentNode,e<i.childNodes.length&&nn(i.childNodes[e]))return!0}return!1}class EB extends Hi{constructor(e){super(e),this.document.on("keydown",(t,n)=>{if(this.isEnabled&&tV(n.keyCode)){const s=new nr(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(s,n),s.stop.called&&t.stop()}})}observe(){}stopObserving(){}}class SB extends Hi{constructor(e){super(e);const t=this.document;t.on("keydown",(n,s)=>{if(!this.isEnabled||s.keyCode!=ke.tab||s.ctrlKey)return;const o=new nr(t,"tab",t.selection.getFirstRange());t.fire(o,s),o.stop.called&&n.stop()})}observe(){}stopObserving(){}}class AB extends qe(){document;domConverter;domRoots=new Map;_renderer;_initialDomRootAttributes=new WeakMap;_observers=new Map;_writer;_ongoingChange=!1;_postFixersInProgress=!1;_renderingDisabled=!1;_hasChangedSinceTheLastRendering=!1;constructor(e){super(),this.document=new oS(e),this.domConverter=new dS(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new tB(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new rS(this.document),this.addObserver(fS),this.addObserver(ih),this.addObserver(yB),this.addObserver(bB),this.addObserver(wB),this.addObserver(CB),this.addObserver(EB),this.addObserver(kB),this.addObserver(SB),ZV(this),qV(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),le.isiOS&&this.listenTo(this.document,"blur",(t,n)=>{this.domConverter.mapDomToView(n.domEvent.relatedTarget)||this.domConverter._clearDomSelection()}),this.listenTo(this.document,"mutations",(t,{mutations:n})=>{n.forEach(s=>this._renderer.markToSync(s.type,s.node))},{priority:"low"}),this.listenTo(this.document,"mutations",()=>{this.forceRender()},{priority:"lowest"})}attachDomRoot(e,t="main"){const n=this.document.getRoot(t);n._name=e.tagName.toLowerCase();const s={};for(const{name:a,value:c}of Array.from(e.attributes))s[a]=c,a==="class"?this._writer.addClass(c.split(" "),n):n.hasAttribute(a)||this._writer.setAttribute(a,c,n);this._initialDomRootAttributes.set(e,s);const o=()=>{this._writer.setAttribute("contenteditable",(!n.isReadOnly).toString(),n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",(a,c)=>this._renderer.markToSync("children",c)),n.on("change:attributes",(a,c)=>this._renderer.markToSync("attributes",c)),n.on("change:text",(a,c)=>this._renderer.markToSync("text",c)),n.on("change:isReadOnly",()=>this.change(o)),n.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const a of this._observers.values())a.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:s})=>t.removeAttribute(s));const n=this._initialDomRootAttributes.get(t);for(const s in n)t.setAttribute(s,n[s]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const s of this._observers.values())s.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[n,s]of this.domRoots)t.observe(s,n);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:n=20,ancestorOffset:s=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const a=Cn({alignToTop:e,forceScroll:t,viewportOffset:n,ancestorOffset:s});typeof n=="number"&&(n={top:n,bottom:n,left:n,right:n});const c={target:this.domConverter.viewRangeToDom(o),viewportOffset:n,ancestorOffset:s,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",c,a),KO(c)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new E("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){E.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(ih).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Q._createAt(e,t)}createPositionAfter(e){return Q._createAfter(e)}createPositionBefore(e){return Q._createBefore(e)}createRange(e,t){return new ge(e,t)}createRangeOn(e){return ge._createOn(e)}createRangeIn(e){return ge._createIn(e)}createSelection(...e){return new bi(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}class ho{is(){throw new Error("is() method is abstract")}}class pi extends ho{textNode;data;offsetInText;constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new E("model-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.offsetSize)throw new E("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}pi.prototype.is=function(i){return i==="$textProxy"||i==="model:$textProxy"||i==="textProxy"||i==="model:textProxy"};class bs{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;_visitedParent;constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new E("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if(t!="forward"&&t!="backward")throw new E("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=K._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n,s,o;do s=this.position,o=this._visitedParent,{done:t,value:n}=this.next();while(!t&&e(n));t||(this._position=s,this._visitedParent=o)}jumpTo(e){this._boundaryStartParent&&e.isBefore(this.boundaries.start)?e=this.boundaries.start:this._boundaryEndParent&&e.isAfter(this.boundaries.end)&&(e=this.boundaries.end),this._position=e.clone(),this._visitedParent=e.parent}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===n.maxOffset)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const s=Xl(t,n),o=s||gS(t,n,s);if(o&&o.is("model:element")){if(!this.shallow)t.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,No("elementStart",o,e,t,1)}if(o&&o.is("model:$text")){let a;if(this.singleCharacters)a=1;else{let h=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<h&&(h=this.boundaries.end.offset),a=h-t.offset}const c=t.offset-o.startOffset,u=new pi(o,c,a);return t.offset+=a,this._position=t,No("text",u,e,t,a)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():No("elementEnd",n,e,t)}_previous(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const s=t.parent,o=Xl(t,s),a=o||pS(t,s,o);if(a&&a.is("model:element"))return t.offset--,this.shallow?(this._position=t,No("elementStart",a,e,t,1)):(t.path.push(a.maxOffset),this._position=t,this._visitedParent=a,this.ignoreElementEnd?this._previous():No("elementEnd",a,e,t));if(a&&a.is("model:$text")){let c;if(this.singleCharacters)c=1;else{let m=a.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>m&&(m=this.boundaries.start.offset),c=t.offset-m}const u=t.offset-a.startOffset,h=new pi(a,u-c,c);return t.offset-=c,this._position=t,No("text",h,e,t,c)}return t.path.pop(),this._position=t,this._visitedParent=n.parent,No("elementStart",n,e,t,1)}}function No(i,e,t,n,s){return{done:!1,value:{type:i,item:e,previousPosition:t,nextPosition:n,length:s}}}class K extends ho{root;path;stickiness;constructor(e,t,n="toNone"){if(super(),!e.is("element")&&!e.is("documentFragment"))throw new E("model-position-root-invalid",e);if(!Array.isArray(t)||t.length===0)throw new E("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChildAtOffset(this.path[t]),!e)throw new E("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new E("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Xl(this,this.parent)}get nodeAfter(){const e=this.parent;return gS(this,e,Xl(this,e))}get nodeBefore(){const e=this.parent;return pS(this,e,Xl(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}isValid(){if(this.offset<0)return!1;let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChildAtOffset(this.path[t]),!e)return!1;return this.offset<=e.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=Nt(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new bs(t);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=Nt(this.path,e.path),n=typeof t=="string"?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,n)}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}getShiftedBy(e){const t=this.clone(),n=t.offset+e;return t.offset=n<0?0:n,t}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const t=Math.min(this.path.length,e.path.length);for(let n=0;n<t;n++){const s=this.path[n]-e.path[n];if(s<-1||s>1)return!1;if(s===1)return j1(e,this,n);if(s===-1)return j1(this,e,n)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?Gp(this.path,t):Gp(e.path,t)}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),n=e.getParentPath();return Nt(t,n)=="same"}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=K._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,n=t.containsPosition(this)||t.start.isEqual(this);let s;return n?(s=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(s=s._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?s=K._createAt(e.deletionPosition):s=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),s}_getTransformedByDeletion(e,t){const n=K._createAt(this);if(this.root!=e.root)return n;if(Nt(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;n.offset-=t}}else if(Nt(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;if(e.offset<=this.path[s]){if(e.offset+t>this.path[s])return null;n.path[s]-=t}}return n}_getTransformedByInsertion(e,t){const n=K._createAt(this);if(this.root!=e.root)return n;if(Nt(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(n.offset+=t);else if(Nt(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;e.offset<=this.path[s]&&(n.path[s]+=t)}return n}_getTransformedByMove(e,t,n){if(t=t._getTransformedByDeletion(e,n),e.isEqual(t))return K._createAt(this);const s=this._getTransformedByDeletion(e,n);return s===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(n).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,t):s._getTransformedByInsertion(t,n)}_getCombined(e,t){const n=e.path.length-1,s=K._createAt(t);return s.stickiness=this.stickiness,s.offset=s.offset+this.path[n]-e.offset,s.path=[...s.path,...this.path.slice(n+1)],s}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,n="toNone"){if(e.is("model:position"))return new K(e.root,e.path,e.stickiness);{const s=e;if(t=="end")t=s.maxOffset;else{if(t=="before")return this._createBefore(s,n);if(t=="after")return this._createAfter(s,n);if(t!==0&&!t)throw new E("model-createpositionat-offset-required",[this,e])}if(!s.is("element")&&!s.is("documentFragment"))throw new E("model-position-parent-incorrect",[this,e]);const o=s.getPath();return o.push(t),new this(s.root,o,n)}}static _createAfter(e,t){if(!e.parent)throw new E("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new E("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if(e.root==="$graveyard"){const n=new K(t.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!t.getRoot(e.root))throw new E("model-position-fromjson-no-root",t,{rootName:e.root});return new K(t.getRoot(e.root),e.path,e.stickiness)}}K.prototype.is=function(i){return i==="position"||i==="model:position"};function Xl(i,e){const t=e.getChildAtOffset(i.offset);return t&&t.is("$text")&&t.startOffset<i.offset?t:null}function gS(i,e,t){return t!==null?null:e.getChildAtOffset(i.offset)}function pS(i,e,t){return t!==null?null:e.getChild(e.offsetToIndex(i.offset)-1)}function j1(i,e,t){return!(t+1===i.path.length||!Gp(e.path,t+1)||!xB(i,t+1))}function Gp(i,e){for(;e<i.length;){if(i[e]!==0)return!1;e++}return!0}function xB(i,e){let t=i.parent,n=i.path.length-1,s=0;for(;n>=e;){if(i.path[n]+s!==t.maxOffset)return!1;s=1,n--,t=t.parent}return!0}class F extends ho{start;end;constructor(e,t){super(),this.start=K._createAt(e),this.end=t?K._createAt(t):K._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new bs({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return Nt(e,t)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}containsItem(e){const t=K._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new F(this.start,e.start)),this.containsPosition(e.end)&&t.push(new F(e.end,this.end))):t.push(new F(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new F(t,n)}return null}getJoined(e,t=!1){let n=this.isIntersecting(e);if(n||(this.start.isBefore(e.start)?n=t?this.end.isTouching(e.start):this.end.isEqual(e.start):n=t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!n)return null;let s=this.start,o=this.end;return e.start.isBefore(s)&&(s=e.start),e.end.isAfter(o)&&(o=e.end),new F(s,o)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,n=K._createAt(this.start);let s=n.parent;for(;n.path.length>t+1;){const o=s.maxOffset-n.offset;o!==0&&e.push(new F(n,n.getShiftedBy(o))),n.path=n.path.slice(0,-1),n.offset++,s=s.parent}for(;n.path.length<=this.end.path.length;){const o=this.end.path[n.path.length-1],a=o-n.offset;a!==0&&e.push(new F(n,n.getShiftedBy(a))),n.offset=o,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new bs(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new bs(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new bs(e);yield t.position;for(const n of t)yield n.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new F(this.start,this.end)]}getTransformedByOperations(e){const t=[new F(this.start,this.end)];for(const n of e)for(let s=0;s<t.length;s++){const o=t[s].getTransformedByOperation(n);t.splice(s,1,...o),s+=o.length-1}for(let n=0;n<t.length;n++){const s=t[n];for(let o=n+1;o<t.length;o++){const a=t[o];(s.containsRange(a)||a.containsRange(s)||s.isEqual(a))&&t.splice(o,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const n=e.sourcePosition,s=e.howMany,o=e.targetPosition;return this._getTransformedByMove(n,o,s,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),t.root!=n.root&&(n=this.end.getShiftedBy(-1)),new F(t,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new F(this.start);let t=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return t.root!=n.root&&(n=this.end.getShiftedBy(-1)),t.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(t=K._createAt(n),t.offset=0):(e.deletionPosition.isEqual(t)||(n=e.deletionPosition),t=e.targetPosition),new F(t,n)):new F(t,n)}_getTransformedByInsertion(e,t,n=!1){if(n&&this.containsPosition(e))return[new F(this.start,e),new F(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const s=new F(this.start,this.end);return s.start=s.start._getTransformedByInsertion(e,t),s.end=s.end._getTransformedByInsertion(e,t),[s]}}_getTransformedByMove(e,t,n,s=!1){if(this.isCollapsed){const g=this.start._getTransformedByMove(e,t,n);return[new F(g)]}const o=F._createFromPositionAndShift(e,n),a=t._getTransformedByDeletion(e,n);if(this.containsPosition(t)&&!s&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const g=this.start._getTransformedByMove(e,t,n),w=this.end._getTransformedByMove(e,t,n);return[new F(g,w)]}let c;const u=this.getDifference(o);let h=null;const m=this.getIntersection(o);if(u.length==1?h=new F(u[0].start._getTransformedByDeletion(e,n),u[0].end._getTransformedByDeletion(e,n)):u.length==2&&(h=new F(this.start,this.end._getTransformedByDeletion(e,n))),h?c=h._getTransformedByInsertion(a,n,m!==null||s):c=[],m){const g=new F(m.start._getCombined(o.start,a),m.end._getCombined(o.start,a));c.length==2?c.splice(1,0,g):c.push(g)}return c}_getTransformedByDeletion(e,t){let n=this.start._getTransformedByDeletion(e,t),s=this.end._getTransformedByDeletion(e,t);return n==null&&s==null?null:(n==null&&(n=e),s==null&&(s=e),new F(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return new this(K._createAt(e,0),K._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(K._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new E("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const t=e[0];e.sort((o,a)=>o.start.isAfter(a.start)?1:-1);const n=e.indexOf(t),s=new this(t.start,t.end);for(let o=n-1;o>=0&&e[o].end.isEqual(s.start);o--)s.start=K._createAt(e[o].start);for(let o=n+1;o<e.length&&e[o].start.isEqual(s.end);o++)s.end=K._createAt(e[o].end);return s}static fromJSON(e,t){return new this(K.fromJSON(e.start,t),K.fromJSON(e.end,t))}}F.prototype.is=function(i){return i==="range"||i==="model:range"};class bS extends Je(){_modelToViewMapping=new WeakMap;_viewToModelMapping=new WeakMap;_viewToModelLengthCallbacks=new Map;_markerNameToElements=new Map;_elementToMarkerNames=new Map;_deferredBindingRemovals=new Map;_unboundMarkerNames=new Set;_cache=new IB;constructor(){super(),this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const n=this._modelToViewMapping.get(t.modelPosition.parent);if(!n)throw new E("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(n,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const n=this.findMappedViewAncestor(t.viewPosition),s=this._viewToModelMapping.get(n),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,n);t.modelPosition=K._createAt(s,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const n=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const s of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(s);t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e)&&this._cache.stopTracking(e),this._modelToViewMapping.get(n)==e&&this._modelToViewMapping.delete(n))}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)&&this._cache.stopTracking(t)}bindElementToMarker(e,t){const n=this._markerNameToElements.get(t)||new Set;n.add(e);const s=this._elementToMarkerNames.get(e)||new Set;s.add(t),this._markerNameToElements.set(t,n),this._elementToMarkerNames.set(e,s)}unbindElementFromMarkerName(e,t){const n=this._markerNameToElements.get(t);n&&(n.delete(e),n.size==0&&this._markerNameToElements.delete(t));const s=this._elementToMarkerNames.get(e);s&&(s.delete(t),s.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new F(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new ge(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const n={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const n=new Set;for(const s of t)if(s.is("attributeElement"))for(const o of s.getElementsWithSameId())n.add(o);else n.add(s);return n}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,n){if(n!=e){const o=this._toModelOffset(e.parent,e.index,n),a=this._toModelOffset(e,t,e);return o+a}if(e.is("$text"))return t;let s=0;for(let o=0;o<t;o++)s+=this.getModelLength(e.getChild(o));return s}getModelLength(e){const t=[e];let n=0;for(;t.length>0;){const s=t.pop(),o=s.name&&this._viewToModelLengthCallbacks.size>0&&this._viewToModelLengthCallbacks.get(s.name);if(o)n+=o(s);else if(this._viewToModelMapping.has(s))n+=1;else if(s.is("$text"))n+=s.data.length;else{if(s.is("uiElement"))continue;for(const a of s.getChildren())t.push(a)}}return n}findPositionIn(e,t){if(t===0)return this._moveViewPositionToTextNode(new Q(e,0));if(this._viewToModelLengthCallbacks.size==0&&this._viewToModelMapping.has(e)){const s=this._cache.getClosest(e,t);return this._findPositionStartingFrom(s.viewPosition,s.modelOffset,t,e,!0)}else return this._findPositionStartingFrom(new Q(e,0),0,t,e,!1)}_findPositionStartingFrom(e,t,n,s,o){let a=e.parent,c=e.offset;if(a.is("$text"))return new Q(a,n-t);let u,h=t,m=0;for(;h<n;){if(u=a.getChild(c),!u){if(a==s)throw new E("mapping-model-offset-not-found",this,{modelOffset:n,viewContainer:s});c=a.parent.getChildIndex(a)+1,a=a.parent,o&&this._cache.save(a,c,s,h);continue}o?m=this._getModelLengthAndCache(u,s,h):m=this.getModelLength(u),h+=m,c++}let g=new Q(a,c);if(o)for(;g.isAtEnd&&g.parent!==s&&g.parent.parent;){const w=g.parent.parent,_=w.getChildIndex(g.parent)+1;this._cache.save(w,_,s,h),g=new Q(w,_)}return h==n?this._moveViewPositionToTextNode(g):this._findPositionStartingFrom(new Q(u,0),h-m,n,s,o)}_getModelLengthAndCache(e,t,n){let s=0;if(this._viewToModelMapping.has(e))s=1;else if(e.is("$text"))s=e.data.length;else if(!e.is("uiElement"))for(const o of e.getChildren())s+=this._getModelLengthAndCache(o,t,n+s);return this._cache.save(e.parent,e.index+1,t,n+s),s}_moveViewPositionToTextNode(e){const t=e.nodeBefore,n=e.nodeAfter;return t&&t.is("view:$text")?new Q(t,t.data.length):n&&n.is("view:$text")?new Q(n,0):e}}class IB extends Je(){_cachedMapping=new WeakMap;_nodeToCacheListIndex=new WeakMap;_invalidateOnChildrenChangeCallback=(e,t,n)=>{this._clearCacheInsideParent(t,n.index)};_invalidateOnTextChangeCallback=(e,t)=>{this._clearCacheAfter(t)};save(e,t,n,s){const o=this._cachedMapping.get(n),a=o.cacheMap.get(s);if(a){const m=e.getChild(t-1),g=a.viewPosition.nodeBefore?this._nodeToCacheListIndex.get(a.viewPosition.nodeBefore):0;this._nodeToCacheListIndex.set(m,g);return}const u={viewPosition:new Q(e,t),modelOffset:s};o.maxModelOffset=s>o.maxModelOffset?s:o.maxModelOffset,o.cacheMap.set(s,u);let h=o.cacheList.length-1;for(;h>=0&&o.cacheList[h].modelOffset>s;)h--;if(o.cacheList.splice(h+1,0,u),t>0){const m=e.getChild(t-1);this._nodeToCacheListIndex.set(m,h+1)}}getClosest(e,t){const n=this._cachedMapping.get(e);let s;if(n)if(t>n.maxModelOffset)s=n.cacheList[n.cacheList.length-1];else{const o=n.cacheMap.get(t);o?s=o:s=this._findInCacheList(n.cacheList,t)}else s=this.startTracking(e);return{modelOffset:s.modelOffset,viewPosition:s.viewPosition.clone()}}startTracking(e){const n={viewPosition:new Q(e,0),modelOffset:0},s={maxModelOffset:0,cacheList:[n],cacheMap:new Map([[0,n]])};return this._cachedMapping.set(e,s),e.on("change:children",this._invalidateOnChildrenChangeCallback),e.on("change:text",this._invalidateOnTextChangeCallback),n}stopTracking(e){e.off("change:children",this._invalidateOnChildrenChangeCallback),e.off("change:text",this._invalidateOnTextChangeCallback),this._cachedMapping.delete(e)}_clearCacheInsideParent(e,t){if(t==0)this._cachedMapping.has(e)?this._clearCacheAll(e):this._clearCacheInsideParent(e.parent,e.index);else{const n=e.getChild(t-1);this._clearCacheAfter(n)}}_clearCacheAll(e){const t=this._cachedMapping.get(e);t.maxModelOffset>0&&(t.maxModelOffset=0,t.cacheList.length=1,t.cacheMap.clear(),t.cacheMap.set(0,t.cacheList[0]))}_clearCacheAfter(e){const t=this._nodeToCacheListIndex.get(e);if(t===void 0){const s=e.parent;this._cachedMapping.has(s)||this._clearCacheInsideParent(s.parent,s.index);return}let n=e.parent;for(;!this._cachedMapping.has(n);)n=n.parent;this._clearCacheFromCacheIndex(n,t)}_clearCacheFromCacheIndex(e,t){t===0&&(t=1);const n=this._cachedMapping.get(e),s=n.cacheList[t-1];if(!s)return;n.maxModelOffset=s.modelOffset;const o=n.cacheList.splice(t);for(const a of o){n.cacheMap.delete(a.modelOffset);const c=a.viewPosition.nodeBefore;this._nodeToCacheListIndex.delete(c)}}_findInCacheList(e,t){let n=0,s=e.length-1,o=s-n>>1,a=e[o];for(;n<s;)a.modelOffset<t?n=o+1:s=o-1,o=n+(s-n>>1),a=e[o];return a.modelOffset<=t?a:e[o-1]}}class PB{_consumable=new Map;_textProxyRegistry=new Map;add(e,t){t=dd(t),e instanceof pi&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=dd(t),e instanceof pi&&(e=this._getSymbolForTextProxy(e)),this.test(e,t)?(this._consumable.get(e).set(t,!1),!0):!1}test(e,t){t=dd(t),e instanceof pi&&(e=this._getSymbolForTextProxy(e));const n=this._consumable.get(e);if(n===void 0)return null;const s=n.get(t);return s===void 0?null:s}revert(e,t){t=dd(t),e instanceof pi&&(e=this._getSymbolForTextProxy(e));const n=this.test(e,t);return n===!1?(this._consumable.get(e).set(t,!0),!0):n===!0?!1:null}verifyAllConsumed(e){const t=[];for(const[n,s]of this._consumable)for(const[o,a]of s){const c=o.split(":")[0];a&&e==c&&t.push({event:o,item:n.name||n.description})}if(t.length)throw new E("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const n=this._textProxyRegistry.get(e.startOffset);if(n){const s=n.get(e.endOffset);s&&(t=s.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,n=e.endOffset,s=e.parent,o=Symbol("$textProxy:"+e.data);let a,c;return a=this._textProxyRegistry.get(t),a||(a=new Map,this._textProxyRegistry.set(t,a)),c=a.get(n),c||(c=new Map,a.set(n,c)),c.set(s,o),o}}function dd(i){const e=i.split(":");return e[0]=="insert"?e[0]:e[0]=="addMarker"||e[0]=="removeMarker"?i:e.length>1?e[0]+":"+e[1]:e[0]}class wS extends Je(){_conversionApi;_firedEventsMap;constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,n){const s=e.getRefreshedItems(),o=this._createConversionApi(n,s);for(const c of e.getMarkersToRemove())this._convertMarkerRemove(c.name,c.range,o);const a=this._reduceChanges(e.getChanges(),s);for(const c of a)c.type==="insert"?this._convertInsert(F._createFromPositionAndShift(c.position,c.length),o):c.type==="reinsert"?this._convertReinsert(F._createFromPositionAndShift(c.position,c.length),o):c.type==="remove"?this._convertRemove(c.position,c.length,c.name,o):this._convertAttribute(c.range,c.attributeKey,c.attributeOldValue,c.attributeNewValue,o);o.mapper.flushDeferredBindings();for(const c of o.mapper.flushUnboundMarkerNames()){const u=t.get(c).getRange();this._convertMarkerRemove(c,u,o),this._convertMarkerAdd(c,u,o)}for(const c of e.getMarkersToAdd())this._convertMarkerAdd(c.name,c.range,o);o.consumable.verifyAllConsumed("insert")}convert(e,t,n,s={}){const o=this._createConversionApi(n,void 0,s);this._convertInsert(e,o);for(const[a,c]of t)this._convertMarkerAdd(a,c,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,t,n){const s=this._createConversionApi(n);this.fire("cleanSelection",{selection:e},s);const o=e.getFirstPosition().root;if(!s.mapper.toViewElement(o))return;const a=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(s.consumable,e,a),this.fire("selection",{selection:e},s),!!e.isCollapsed){for(const c of a)if(s.consumable.test(e,"addMarker:"+c.name)){const u=c.getRange();if(!RB(e.getFirstPosition(),c,s.mapper))continue;const h={item:e,markerName:c.name,markerRange:u};this.fire(`addMarker:${c.name}`,h,s)}for(const c of e.getAttributeKeys())if(s.consumable.test(e,"attribute:"+c)){const u={item:e,range:e.getFirstRange(),attributeKey:c,attributeOldValue:null,attributeNewValue:e.getAttribute(c)};this.fire(`attribute:${c}:$text`,u,s)}}}_convertInsert(e,t,n={}){n.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);for(const s of e.getWalker({shallow:!0}))this._testAndFire("insert",q1(s),t)}_convertRemove(e,t,n,s){this.fire(`remove:${n}`,{position:e,length:t},s)}_convertAttribute(e,t,n,s,o){this._addConsumablesForRange(o.consumable,e,`attribute:${t}`);for(const a of e){const c={item:a.item,range:F._createFromPositionAndShift(a.previousPosition,a.length),attributeKey:t,attributeOldValue:n,attributeNewValue:s};this._testAndFire(`attribute:${t}`,c,o)}}_convertReinsert(e,t){const n=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,n);for(const s of n.map(q1))this.fire(`remove:${s.item.is("element")?s.item.name:"$text"}`,{position:s.range.start,length:s.item.offsetSize,reconversion:!0},t),this._testAndFire("insert",{...s,reconversion:!0},t)}_convertMarkerAdd(e,t,n){if(t.root.rootName=="$graveyard")return;const s=`addMarker:${e}`;if(n.consumable.add(t,s),this.fire(s,{markerName:e,markerRange:t},n),!!n.consumable.consume(t,s)){this._addConsumablesForRange(n.consumable,t,s);for(const o of t.getItems()){if(!n.consumable.test(o,s))continue;const a={item:o,range:F._createOn(o),markerName:e,markerRange:t};this.fire(s,a,n)}}}_convertMarkerRemove(e,t,n){t.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},n)}_reduceChanges(e,t){const n={changes:e,refreshedItems:t};return this.fire("reduceChanges",n),n.changes}_addConsumablesForInsert(e,t){for(const n of t){const s=n.item;if(e.test(s,"insert")===null){e.add(s,"insert");for(const o of s.getAttributeKeys())e.add(s,"attribute:"+o)}}return e}_addConsumablesForRange(e,t,n){for(const s of t.getItems())e.add(s,n);return e}_addConsumablesForSelection(e,t,n){e.add(t,"selection");for(const s of n)e.add(t,"addMarker:"+s.name);for(const s of t.getAttributeKeys())e.add(t,"attribute:"+s);return e}_testAndFire(e,t,n){const s=OB(e,t),o=t.item.is("$textProxy")?n.consumable._getSymbolForTextProxy(t.item):t.item,a=this._firedEventsMap.get(n),c=a.get(o);if(!c)a.set(o,new Set([s]));else if(!c.has(s))c.add(s);else return;this.fire(s,t,n)}_testAndFireAddAttributes(e,t){const n={item:e,range:F._createOn(e)};for(const s of n.item.getAttributeKeys())n.attributeKey=s,n.attributeOldValue=null,n.attributeNewValue=n.item.getAttribute(s),this._testAndFire(`attribute:${s}`,n,t)}_createConversionApi(e,t=new Set,n={}){const s={...this._conversionApi,consumable:new PB,writer:e,options:n,convertItem:o=>this._convertInsert(F._createOn(o),s),convertChildren:o=>this._convertInsert(F._createIn(o),s,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,s),canReuseView:o=>!t.has(s.mapper.toModelElement(o))};return this._firedEventsMap.set(s,new Map),s}}function RB(i,e,t){const n=e.getRange(),s=Array.from(i.getAncestors());return s.shift(),s.reverse(),!s.some(a=>{if(n.containsItem(a))return!!t.toViewElement(a).getCustomProperty("addHighlight")})}function OB(i,e){const t=e.item.is("element")?e.item.name:"$text";return`${i}:${t}`}function q1(i){return{item:i.item,range:F._createFromPositionAndShift(i.previousPosition,i.length)}}class ir extends ho{parent=null;_attrs;_index=null;_startOffset=null;constructor(e){super(),this._attrs=Ss(e)}get document(){return null}get index(){return this._index}get startOffset(){return this._startOffset}get offsetSize(){return 1}get endOffset(){return this.startOffset===null?null:this.startOffset+this.offsetSize}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Nt(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((t,n)=>(t[n[0]]=n[1],t),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Ss(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}ir.prototype.is=function(i){return i==="node"||i==="model:node"};class Bn extends Je(ho){_lastRangeBackward=!1;_attrs=new Map;_ranges=[];constructor(...e){super(),e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new F(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?new F(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?new F(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]);else if(t instanceof Bn)this._setRanges(t.getRanges(),t.isBackward);else if(t&&typeof t.getRanges=="function")this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof F)this._setRanges([t],!!s&&!!s.backward);else if(t instanceof K)this._setRanges([new F(t)]);else if(t instanceof ir){const o=!!s&&!!s.backward;let a;if(n=="in")a=F._createIn(t);else if(n=="on")a=F._createOn(t);else if(n!==void 0)a=new F(K._createAt(t,n));else throw new E("model-selection-setto-required-second-parameter",[this,t]);this._setRanges([a],o)}else if(Dn(t))this._setRanges(t,s&&!!s.backward);else throw new E("model-selection-setto-not-selectable",[this,t])}_setRanges(e,t=!1){const n=Array.from(e),s=n.some(o=>{if(!(o instanceof F))throw new E("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(a=>!a.isEqual(o))});n.length===this._ranges.length&&!s||(this._replaceAllRanges(n),this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0}))}setFocus(e,t){if(this.anchor===null)throw new E("model-selection-setfocus-no-ranges",[this,e]);const n=K._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.length&&this._popRange(),n.compareWith(s)=="before"?(this._pushRange(new F(n,s)),this._lastRangeBackward=!0):(this._pushRange(new F(s,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const n=W1(t.start,e);BB(n,t)&&(yield n);const s=t.getWalker();for(const a of s){const c=a.item;a.type=="elementEnd"&&VB(c,e,t)?yield c:a.type=="elementStart"&&c.is("model:element")&&c.root.document.model.schema.isBlock(c)&&s.jumpTo(K._createAt(c,"end"))}const o=W1(t.end,e);MB(o,t)&&(yield o)}}containsEntireContent(e=this.anchor.root){const t=K._createAt(e,0),n=K._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}toJSON(){const e={ranges:Array.from(this.getRanges()).map(n=>n.toJSON())},t=Object.fromEntries(this.getAttributes());return Object.keys(t).length&&(e.attributes=t),this.isBackward&&(e.isBackward=!0),e}_pushRange(e){this._checkRange(e),this._ranges.push(new F(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new E("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_replaceAllRanges(e){this._removeAllRanges();for(const t of e)this._pushRange(t)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}Bn.prototype.is=function(i){return i==="selection"||i==="model:selection"};function _S(i,e){return e.has(i)?!1:(e.add(i),i.root.document.model.schema.isBlock(i)&&!!i.parent)}function VB(i,e,t){return _S(i,e)&&nw(i,t)}function W1(i,e){const n=i.parent.root.document.model.schema,s=i.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const a=s.find(c=>o?!1:(o=n.isLimit(c),!o&&_S(c,e)));return s.forEach(c=>e.add(c)),a}function nw(i,e){const t=NB(i);return t?!e.containsRange(F._createOn(t),!0):!0}function BB(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.start.isTouching(K._createAt(i,i.maxOffset))?!1:nw(i,e):!1}function MB(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.end.isTouching(K._createAt(i,0))?!1:nw(i,e):!1}function NB(i){const e=i.root.document.model.schema;let t=i.parent;for(;t;){if(e.isBlock(t))return t;t=t.parent}}class wn extends Je(F){constructor(e,t){super(e,t),LB.call(this)}detach(){this.stopListening()}toRange(){return new F(this.start,this.end)}static fromRange(e){return new wn(e.start,e.end)}}wn.prototype.is=function(i){return i==="liveRange"||i==="model:liveRange"||i=="range"||i==="model:range"};function LB(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&DB.call(this,t)},{priority:"low"})}function DB(i){const e=this.getTransformedByOperation(i),t=F._createFromRanges(e),n=!t.isEqual(this),s=FB(this,i);let o=null;if(n){t.root.rootName=="$graveyard"&&(i.type=="remove"?o=i.sourcePosition:o=i.deletionPosition);const a=this.toRange();this.start=t.start,this.end=t.end,this.fire("change:range",a,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function FB(i,e){switch(e.type){case"insert":return i.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return i.containsPosition(e.sourcePosition)||i.start.isEqual(e.sourcePosition)||i.containsPosition(e.targetPosition);case"split":return i.containsPosition(e.splitPosition)||i.containsPosition(e.insertionPosition)}return!1}class et extends ir{_data;constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new et(this.data,this.getAttributes())}static fromJSON(e){return new et(e.data,e.attributes)}}et.prototype.is=function(i){return i==="$text"||i==="model:$text"||i==="text"||i==="model:text"||i==="node"||i==="model:node"};const fc="selection:";class kn extends Je(ho){_selection;constructor(e){super(),this._selection=new zB(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}toJSON(){return this._selection.toJSON()}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return fc+e}static _isStoreAttributeKey(e){return e.startsWith(fc)}}kn.prototype.is=function(i){return i==="selection"||i=="model:selection"||i=="documentSelection"||i=="model:documentSelection"};class zB extends Bn{markers=new Dt({idProperty:"name"});_model;_document;_attributePriority=new Map;_selectionRestorePosition=null;_hasChangedRange=!1;_overriddenGravityRegister=new Set;_observedMarkers=new Set;constructor(e){super(),this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(t,n)=>{const s=n[0];!s.isDocumentOperation||s.type=="marker"||s.type=="rename"||s.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(t,n,s,o)=>{this._updateMarker(n,o)}),this.listenTo(this._document,"change",(t,n)=>{UB(this._model,n)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const n=[e];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=rn();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new E("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}toJSON(){const e=super.toJSON();return this.markers.length&&(e.markers=this.markers.map(t=>t.toJSON())),e}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new E("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=wn.fromRange(e);return t.on("change:range",(n,s,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const a=this._ranges.indexOf(t);this._ranges.splice(a,1),t.detach()}}),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const s of this._model.markers){const o=s.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const a=s.getRange();for(const c of this.getRanges())a.containsRange(c,!c.isCollapsed)&&e.push(s)}const n=Array.from(this.markers);for(const s of e)this.markers.has(s)||(this.markers.add(s),t=!0);for(const s of Array.from(this.markers))e.includes(s)||(this.markers.remove(s),t=!0);t&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateMarker(e,t){const n=e.name.split(":",1)[0];if(!this._observedMarkers.has(n))return;let s=!1;const o=Array.from(this.markers),a=this.markers.has(e);if(!t)a&&(this.markers.remove(e),s=!0);else{let c=!1;for(const u of this.getRanges())if(t.containsRange(u,!u.isCollapsed)){c=!0;break}c&&!a?(this.markers.add(e),s=!0):!c&&a&&(this.markers.remove(e),s=!0)}s&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=Ss(this._getSurroundingAttributes()),n=Ss(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,a]of this._attributePriority)a=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const s=[];for(const[o,a]of this.getAttributes())(!n.has(o)||n.get(o)!==a)&&s.push(o);for(const[o]of n)this.hasAttribute(o)||s.push(o);s.length>0&&this.fire("change:attribute",{attributeKeys:s,directChange:!1})}_setAttribute(e,t,n=!0){const s=n?"normal":"low";return s=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===t?!1:(this._attrs.set(e,t),this._attributePriority.set(e,s),!0)}_removeAttribute(e,t=!0){const n=t?"normal":"low";return n=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,n),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const t=new Set;for(const[n,s]of this.getAttributes())e.get(n)!==s&&this._removeAttribute(n,!1);for(const[n,s]of e)this._setAttribute(n,s,!1)&&t.add(n);return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())t.startsWith(fc)&&(yield[t.substr(fc.length),e.getAttribute(t)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if(e.root.rootName=="$graveyard")return null;let n=null;if(this.isCollapsed){const s=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=Pl(s,t)),n||(n=Pl(o,t)),!this.isGravityOverridden&&!n){let a=s;for(;a&&!n;)a=a.previousSibling,n=Pl(a,t)}if(!n){let a=o;for(;a&&!n;)a=a.nextSibling,n=Pl(a,t)}n||(n=this.getStoredAttributes())}else{const s=this.getFirstRange();for(const o of s){if(o.item.is("element")&&t.isObject(o.item)){n=Pl(o.item,t);break}if(o.type=="text"){n=o.item.getAttributes();break}}}return n}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Pl(i,e){if(!i)return null;if(i instanceof pi||i instanceof et)return i.getAttributes();if(!e.isInline(i))return null;if(!e.isObject(i))return[];const t=[];for(const[n,s]of i.getAttributes())e.checkAttribute("$text",n)&&e.getAttributeProperties(n).copyFromObject!==!1&&t.push([n,s]);return t}function UB(i,e){const t=i.document.differ;for(const n of t.getChanges()){if(n.type!="insert")continue;const s=n.position.parent;n.length===s.maxOffset&&i.enqueueChange(e,a=>{const c=Array.from(s.getAttributeKeys()).filter(u=>u.startsWith(fc));for(const u of c)a.removeAttribute(u,s)})}}class Zl{_nodes=[];_offsetToNode=[];constructor(e){e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._offsetToNode.length}getNode(e){return this._nodes[e]||null}getNodeAtOffset(e){return this._offsetToNode[e]||null}getNodeIndex(e){return e.index}getNodeStartOffset(e){return e.startOffset}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new E("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){if(e==this._offsetToNode.length)return this._nodes.length;const t=this._offsetToNode[e];if(!t)throw new E("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.getNodeIndex(t)}_insertNodes(e,t){const n=[];for(const o of t){if(!(o instanceof ir))throw new E("model-nodelist-insertnodes-not-node",this);n.push(o)}let s=this.indexToOffset(e);E1(this._nodes,n,e),E1(this._offsetToNode,HB(n),s);for(let o=e;o<this._nodes.length;o++)this._nodes[o]._index=o,this._nodes[o]._startOffset=s,s+=this._nodes[o].offsetSize}_removeNodes(e,t=1){if(t==0)return[];let n=this.indexToOffset(e);const s=this._nodes.splice(e,t),o=s[s.length-1],a=o.startOffset+o.offsetSize-n;this._offsetToNode.splice(n,a);for(const c of s)c._index=null,c._startOffset=null;for(let c=e;c<this._nodes.length;c++)this._nodes[c]._index=c,this._nodes[c]._startOffset=n,n+=this._nodes[c].offsetSize;return s}_removeNodesArray(e){if(e.length==0)return;for(const n of e)n._index=null,n._startOffset=null;this._nodes=this._nodes.filter(n=>n.index!==null),this._offsetToNode=this._offsetToNode.filter(n=>n.index!==null);let t=0;for(let n=0;n<this._nodes.length;n++)this._nodes[n]._index=n,this._nodes[n]._startOffset=t,t+=this._nodes[n].offsetSize}toJSON(){return this._nodes.map(e=>e.toJSON())}}function HB(i){const e=[];let t=0;for(const n of i)for(let s=0;s<n.offsetSize;s++)e[t++]=n;return e}class Xe extends ir{name;_children=new Zl;constructor(e,t,n){super(t),this.name=e,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const n of e)t=t.getChildAtOffset(n);return t}findAncestor(e,t={}){let n=t.includeSelf?this:this.parent;for(;n;){if(n.name===e)return n;n=n.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?qB(this._children):void 0;return new Xe(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=jB(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const t of e)t.parent=null}static fromJSON(e){let t;if(e.children){t=[];for(const n of e.children)n.name?t.push(Xe.fromJSON(n)):t.push(et.fromJSON(n))}return new Xe(e.name,e.attributes,t)}}Xe.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="model:element"):i==="element"||i==="model:element"||i==="node"||i==="model:node"};function jB(i){if(typeof i=="string")return[new et(i)];Dn(i)||(i=[i]);const e=[];for(const t of i)typeof t=="string"?e.push(new et(t)):t instanceof pi?e.push(new et(t.data,t.getAttributes())):e.push(t);return e}function qB(i){const e=[];for(const t of i)e.push(t._clone(!0));return e}class yS{_dispatchers;constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}class WB extends yS{elementToElement(e){return this.add(c4(e))}elementToStructure(e){return this.add(u4(e))}attributeToElement(e){return this.add(d4(e))}attributeToAttribute(e){return this.add(h4(e))}markerToElement(e){return this.add(f4(e))}markerToHighlight(e){return this.add(g4(e))}markerToData(e){return this.add(m4(e))}}function vS(){return(i,e,t)=>{if(!t.consumable.consume(e.item,i.name))return;const n=t.writer,s=t.mapper.toViewPosition(e.range.start),o=n.createText(e.item.data);n.insert(s,o)}}function CS(){return(i,e,t)=>{t.convertAttributes(e.item),!e.reconversion&&e.item.is("element")&&!e.item.isEmpty&&t.convertChildren(e.item)}}function $B(){return(i,e,t)=>{if(e.reconversion)return;const n=t.mapper.toViewPosition(e.position),s=e.position.getShiftedBy(e.length),o=t.mapper.toViewPosition(s,{isPhantom:!0}),a=t.writer.createRange(n,o);TS(a.getTrimmed(),t)}}function kS(i,e){const t=i.createAttributeElement("span",e.attributes);return e.classes&&t._addClass(e.classes),typeof e.priority=="number"&&(t._priority=e.priority),t._id=e.id,t}function GB(){return(i,e,t)=>{const n=e.selection;if(n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=[];for(const o of n.getRanges())s.push(t.mapper.toViewRange(o));t.writer.setSelection(s,{backward:n.isBackward})}}function KB(){return(i,e,t)=>{const n=e.selection;if(!n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=t.writer,o=n.getFirstPosition(),a=t.mapper.toViewPosition(o),c=s.breakAttributes(a);s.setSelection(c)}}function YB(){return(i,e,t)=>{const n=t.writer,s=n.document.selection;for(const o of s.getRanges())o.isCollapsed&&o.end.parent.isAttached()&&t.writer.mergeAttributes(o.start);n.setSelection(null)}}function JB(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const a=n.writer,c=a.document.selection;if(t.item instanceof Bn||t.item instanceof kn)a.wrap(c.getFirstRange(),o);else{let u=n.mapper.toViewRange(t.range);t.attributeOldValue!==null&&s&&(u=a.unwrap(u,s)),t.attributeNewValue!==null&&o&&a.wrap(u,o)}}}function QB(i,e=C4){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=i(n.item,s,n);if(!o)return;e(n.item,s.consumable);const a=n.reconversion&&ES(n.item,s)||s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,o),s.writer.insert(a,o),s.convertAttributes(n.item),PS(o,n.item.getChildren(),s,{reconversion:n.reconversion})}}function XB(i,e){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=new Map;s.writer._registerSlotFactory(w4(n.item,o,s));const a=i(n.item,s,n);if(s.writer._clearSlotFactory(),!a)return;_4(n.item,o,s),e(n.item,s.consumable);const c=n.reconversion&&ES(n.item,s)||s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,a),s.writer.insert(c,a),s.convertAttributes(n.item),y4(a,o,s,{reconversion:n.reconversion})}}function ZB(i){return(e,t,n)=>{t.isOpening=!0;const s=i(t,n);t.isOpening=!1;const o=i(t,n);if(!s||!o)return;const a=t.markerRange;if(a.isCollapsed&&!n.consumable.consume(a,e.name))return;for(const h of a)if(!n.consumable.consume(h.item,e.name))return;const c=n.mapper,u=n.writer;u.insert(c.toViewPosition(a.start),s),n.mapper.bindElementToMarker(s,t.markerName),a.isCollapsed||(u.insert(c.toViewPosition(a.end),o),n.mapper.bindElementToMarker(o,t.markerName)),e.stop()}}function TS(i,e){const t=e.writer.remove(i);for(const n of e.writer.createRangeIn(t).getItems())e.mapper.unbindViewElement(n,{defer:!0});return i.start}function ES(i,e){const t=e.mapper.toViewElement(i);return t&&TS(e.writer.createRangeOn(t),e)}function e4(){return(i,e,t)=>{const n=t.mapper.markerNameToElements(e.markerName);if(n){for(const s of n)t.mapper.unbindElementFromMarkerName(s,e.markerName),t.writer.clear(t.writer.createRangeOn(s),s);t.writer.clearClonedElementsGroup(e.markerName),i.stop()}}}function t4(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=t.markerRange;n.consumable.consume(o,e.name)&&($1(o,!1,n,t,s),$1(o,!0,n,t,s),e.stop())}}function $1(i,e,t,n,s){const o=e?i.start:i.end,a=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,c=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(a||c){let h,m;e&&a||!e&&!c?(h=a,m=!0):(h=c,m=!1);const g=t.mapper.toViewElement(h);if(g){n4(g,e,m,t,n,s);return}}const u=t.mapper.toViewPosition(o);i4(u,e,t,n,s)}function n4(i,e,t,n,s,o){const a=`data-${o.group}-${e?"start":"end"}-${t?"before":"after"}`,c=i.hasAttribute(a)?i.getAttribute(a).split(","):[];c.unshift(o.name),n.writer.setAttribute(a,c.join(","),i),n.mapper.bindElementToMarker(i,s.markerName)}function i4(i,e,t,n,s){const o=`${s.group}-${e?"start":"end"}`,a=s.name?{name:s.name}:null,c=t.writer.createUIElement(o,a);t.writer.insert(i,c),t.mapper.bindElementToMarker(c,n.markerName)}function s4(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=n.mapper.markerNameToElements(t.markerName);if(!o)return;for(const c of o)n.mapper.unbindElementFromMarkerName(c,t.markerName),c.is("containerElement")?(a(`data-${s.group}-start-before`,c),a(`data-${s.group}-start-after`,c),a(`data-${s.group}-end-before`,c),a(`data-${s.group}-end-after`,c)):n.writer.clear(n.writer.createRangeOn(c),c);n.writer.clearClonedElementsGroup(t.markerName),e.stop();function a(c,u){if(u.hasAttribute(c)){const h=new Set(u.getAttribute(c).split(","));h.delete(s.name),h.size==0?n.writer.removeAttribute(c,u):n.writer.setAttribute(c,Array.from(h).join(","),u)}}}}function o4(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const a=n.mapper.toViewElement(t.item),c=n.writer;if(!a)throw new E("conversion-attribute-to-attribute-on-text",n.dispatcher,t);if(t.attributeOldValue!==null&&s){let u=s.value;s.key=="style"&&(typeof s.value=="string"?u=new Ql(c.document.stylesProcessor).setTo(s.value).getStylesEntries().map(([h])=>h):u=Object.keys(s.value)),c.removeAttribute(s.key,u,a)}if(t.attributeNewValue!==null&&o){let u=o.value;o.key=="style"&&typeof o.value=="string"&&(u=Object.fromEntries(new Ql(c.document.stylesProcessor).setTo(o.value).getStylesEntries())),c.setAttribute(o.key,u,!1,a)}}}function r4(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof Bn||t.item instanceof kn)&&!t.item.is("$textProxy"))return;const s=iw(i,t,n);if(!s||!n.consumable.consume(t.item,e.name))return;const o=n.writer,a=kS(o,s),c=o.document.selection;if(t.item instanceof Bn||t.item instanceof kn)o.wrap(c.getFirstRange(),a);else{const u=n.mapper.toViewRange(t.range),h=o.wrap(u,a);for(const m of h.getItems())if(m.is("attributeElement")&&m.isSimilar(a)){n.mapper.bindElementToMarker(m,t.markerName);break}}}}function a4(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof Xe))return;const s=iw(i,t,n);if(!s||!n.consumable.test(t.item,e.name))return;const o=n.mapper.toViewElement(t.item);if(o&&o.getCustomProperty("addHighlight")){n.consumable.consume(t.item,e.name);for(const c of F._createIn(t.item))n.consumable.consume(c.item,e.name);o.getCustomProperty("addHighlight")(o,s,n.writer),n.mapper.bindElementToMarker(o,t.markerName)}}}function l4(i){return(e,t,n)=>{if(t.markerRange.isCollapsed)return;const s=iw(i,t,n);if(!s)return;const o=kS(n.writer,s),a=n.mapper.markerNameToElements(t.markerName);if(a){for(const c of a)n.mapper.unbindElementFromMarkerName(c,t.markerName),c.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(c),o):c.getCustomProperty("removeHighlight")(c,s.id,n.writer);n.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function c4(i){const e=SS(i.model),t=mc(i.view,"container");return e.attributes.length&&(e.children=!0),n=>{n.on(`insert:${e.name}`,QB(t,IS(e)),{priority:i.converterPriority||"normal"}),(e.children||e.attributes.length)&&n.on("reduceChanges",xS(e),{priority:"low"})}}function u4(i){const e=SS(i.model),t=mc(i.view,"container");return e.children=!0,n=>{if(n._conversionApi.schema.checkChild(e.name,"$text"))throw new E("conversion-element-to-structure-disallowed-text",n,{elementName:e.name});n.on(`insert:${e.name}`,XB(t,IS(e)),{priority:i.converterPriority||"normal"}),n.on("reduceChanges",xS(e),{priority:"low"})}}function d4(i){i=Cn(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=mc(i.view[s],"attribute");else i.view=mc(i.view,"attribute");const n=AS(i);return s=>{s.on(t,JB(n),{priority:i.converterPriority||"normal"})}}function h4(i){i=Cn(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=G1(i.view[s]);else i.view=G1(i.view);const n=AS(i);return s=>{s.on(t,o4(n),{priority:i.converterPriority||"normal"})}}function f4(i){const e=mc(i.view,"ui");return t=>{t.on(`addMarker:${i.model}`,ZB(e),{priority:i.converterPriority||"normal"}),t.on(`removeMarker:${i.model}`,e4(),{priority:i.converterPriority||"normal"})}}function m4(i){i=Cn(i);const e=i.model;let t=i.view;return t||(t=n=>({group:e,name:n.substr(i.model.length+1)})),n=>{n.on(`addMarker:${e}`,t4(t),{priority:i.converterPriority||"normal"}),n.on(`removeMarker:${e}`,s4(t),{priority:i.converterPriority||"normal"})}}function g4(i){return e=>{e.on(`addMarker:${i.model}`,r4(i.view),{priority:i.converterPriority||"normal"}),e.on(`addMarker:${i.model}`,a4(i.view),{priority:i.converterPriority||"normal"}),e.on(`removeMarker:${i.model}`,l4(i.view),{priority:i.converterPriority||"normal"})}}function SS(i){return typeof i=="string"&&(i={name:i}),{name:i.name,attributes:i.attributes?st(i.attributes):[],children:!!i.children}}function mc(i,e){return typeof i=="function"?i:(t,n)=>p4(i,n,e)}function p4(i,e,t){typeof i=="string"&&(i={name:i});let n;const s=e.writer,o=Object.assign({},i.attributes);if(t=="container")n=s.createContainerElement(i.name,o);else if(t=="attribute"){const a={priority:i.priority||ma.DEFAULT_PRIORITY};n=s.createAttributeElement(i.name,o,a)}else n=s.createUIElement(i.name,o);if(i.styles){const a=Object.keys(i.styles);for(const c of a)s.setStyle(c,i.styles[c],n)}if(i.classes){const a=i.classes;if(typeof a=="string")s.addClass(a,n);else for(const c of a)s.addClass(c,n)}return n}function AS(i){return i.model.values?(e,t,n)=>{const s=i.view[e];return s?s(e,t,n):null}:i.view}function G1(i){return typeof i=="string"?e=>({key:i,value:e}):typeof i=="object"?i.value?()=>i:e=>({key:i.key,value:e}):i}function iw(i,e,t){const n=typeof i=="function"?i(e,t):{...i};return n?(n.priority||(n.priority=10),n.id||(n.id=e.markerName),n):null}function b4(i){return(e,t)=>{if(!e.is("element",i.name))return!1;if(t.type=="attribute"){if(i.attributes.includes(t.attributeKey))return!0}else{if(i.children)return!0}return!1}}function xS(i){const e=b4(i);return(t,n)=>{const s=[];n.reconvertedElements||(n.reconvertedElements=new Set);for(const o of n.changes){const a=o.type=="attribute"?o.range.start.nodeAfter:o.position.parent;if(!a||!e(a,o)||o.type=="reinsert"){s.push(o);continue}if(o.type=="insert"&&o.action=="rename"&&n.refreshedItems.add(o.position.nodeAfter),!n.reconvertedElements.has(a)){n.reconvertedElements.add(a);const c=K._createBefore(a);let u=s.length;for(let h=s.length-1;h>=0;h--){const m=s[h],w=(m.type=="attribute"?m.range.start:m.position).compareWith(c);if(w=="before"||m.type=="remove"&&w=="same")break;u=h}s.splice(u,0,{type:"reinsert",name:a.name,position:c,length:1})}}n.changes=s}}function IS(i){return(e,t,n={})=>{const s=["insert"];for(const o of i.attributes)e.hasAttribute(o)&&s.push(`attribute:${o}`);return s.every(o=>t.test(e,o))?(n.preflight||s.forEach(o=>t.consume(e,o)),!0):!1}}function w4(i,e,t){return(n,s)=>{const o=n.createContainerElement("$slot");let a=null;if(s==="children")a=Array.from(i.getChildren());else if(typeof s=="function")a=Array.from(i.getChildren()).filter(c=>s(c));else throw new E("conversion-slot-mode-unknown",t.dispatcher,{modeOrFilter:s});return e.set(o,a),o}}function _4(i,e,t){const n=Array.from(e.values()).flat(),s=new Set(n);if(s.size!=n.length)throw new E("conversion-slot-filter-overlap",t.dispatcher,{element:i});if(s.size!=i.childCount)throw new E("conversion-slot-filter-incomplete",t.dispatcher,{element:i})}function y4(i,e,t,n){t.mapper.on("modelToViewPosition",a,{priority:"highest"});let s=null,o=null;for([s,o]of e)PS(i,o,t,n),t.writer.setCustomProperty("$structureSlotParent",!0,s.parent),t.writer.move(t.writer.createRangeIn(s),t.writer.createPositionBefore(s)),t.writer.remove(s);t.mapper.off("modelToViewPosition",a);function a(c,u){const h=u.modelPosition.nodeAfter,m=o.indexOf(h);m<0||(u.viewPosition=u.mapper.findPositionIn(s,m))}}function PS(i,e,t,n){for(const s of e)v4(i.root,s,t,n)||t.convertItem(s)}function v4(i,e,t,n){const{writer:s,mapper:o}=t;if(!n.reconversion)return!1;const a=o.toViewElement(e);return!a||a.root==i||!t.canReuseView(a)?!1:(s.move(s.createRangeOn(a),o.toViewPosition(K._createBefore(e))),!0)}function C4(i,e,{preflight:t}={}){return t?e.test(i,"insert"):e.consume(i,"insert")}function RS(i){const{schema:e,document:t}=i.model;for(const n of t.getRoots())if(n.isEmpty&&!e.checkChild(n,"$text")&&e.checkChild(n,"paragraph"))return i.insertElement("paragraph",n),!0;return!1}function OS(i,e,t){const n=t.createContext(i);return!(!t.checkChild(n,"paragraph")||!t.checkChild(n.push("paragraph"),e))}function VS(i,e){const t=e.createElement("paragraph");return e.insert(t,i),e.createPositionAt(t,0)}class k4 extends yS{elementToElement(e){return this.add(BS(e))}elementToAttribute(e){return this.add(S4(e))}attributeToAttribute(e){return this.add(A4(e))}elementToMarker(e){return this.add(x4(e))}dataToMarker(e){return this.add(I4(e))}}function K1(){return(i,e,t)=>{if(!e.modelRange&&t.consumable.consume(e.viewItem,{name:!0})){const{modelRange:n,modelCursor:s}=t.convertChildren(e.viewItem,e.modelCursor);e.modelRange=n,e.modelCursor=s}}}function T4(){return(i,e,{schema:t,consumable:n,writer:s})=>{let o=e.modelCursor;if(!n.test(e.viewItem))return;if(!t.checkChild(o,"$text")){if(!OS(o,"$text",t)||e.viewItem.data.trim().length==0)return;o=VS(o,s)}n.consume(e.viewItem);const a=s.createText(e.viewItem.data);s.insert(a,o),e.modelRange=s.createRange(o,o.getShiftedBy(a.offsetSize)),e.modelCursor=e.modelRange.end}}function E4(i,e){return(t,n)=>{const s=n.newSelection,o=[];for(const c of s.getRanges())o.push(e.toModelRange(c));const a=i.createSelection(o,{backward:s.isBackward});a.isEqual(i.document.selection)||i.change(c=>{c.setSelection(a)})}}function BS(i){i=Cn(i);const e=Kp(i),t=sw(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"normal"})}}function S4(i){i=Cn(i),MS(i);const e=NS(i,!1),t=sw(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"low"})}}function A4(i){i=Cn(i);let e=null;(typeof i.view=="string"||i.view.key)&&(e=O4(i)),MS(i,e);const t=NS(i,!0);return n=>{n.on("element",t,{priority:i.converterPriority||"low"})}}function x4(i){const e=M4(i.model);return BS({...i,model:e})}function I4(i){i=Cn(i),i.model||(i.model=s=>s?i.view+":"+s:i.view);const e={view:i.view,model:i.model},t=Kp(Y1(e,"start")),n=Kp(Y1(e,"end"));return s=>{s.on(`element:${i.view}-start`,t,{priority:i.converterPriority||"normal"}),s.on(`element:${i.view}-end`,n,{priority:i.converterPriority||"normal"});const o=_s.low,a=_s.highest,c=_s.get(i.converterPriority)/a;s.on("element",P4(e),{priority:o+c})}}function P4(i){return(e,t,n)=>{const s=`data-${i.view}`;if(!n.consumable.test(t.viewItem,{attributes:s+"-end-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-end-before"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-before"}))return;t.modelRange||Object.assign(t,n.convertChildren(t.viewItem,t.modelCursor)),n.consumable.consume(t.viewItem,{attributes:s+"-end-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-end-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-start-before").split(","));function o(a,c){for(const u of c){const h=i.model(u,n),m=n.writer.createElement("$marker",{"data-name":h});n.writer.insert(m,a),t.modelCursor.isEqual(a)?t.modelCursor=t.modelCursor.getShiftedBy(1):t.modelCursor=t.modelCursor._getTransformedByInsertion(a,1),t.modelRange=t.modelRange._getTransformedByInsertion(a,1)[0]}}}}function sw(i){return typeof i=="string"?i:typeof i=="object"&&typeof i.name=="string"?i.name:null}function Kp(i){const e=new Ko(i.view);return(t,n,s)=>{const o=e.match(n.viewItem);if(!o)return;const a=o.match;if(a.name=!0,!s.consumable.test(n.viewItem,a))return;const c=R4(i.model,n.viewItem,s);c&&s.safeInsert(c,n.modelCursor)&&(s.consumable.consume(n.viewItem,a),s.convertChildren(n.viewItem,c),s.updateConversionResult(c,n))}}function R4(i,e,t){return i instanceof Function?i(e,t):t.writer.createElement(i)}function O4(i){typeof i.view=="string"&&(i.view={key:i.view});const e=i.view.key,t=typeof i.view.value>"u"?/[\s\S]*/:i.view.value;let n;return e=="class"||e=="style"?n={[e=="class"?"classes":"styles"]:t}:n={attributes:{[e]:t}},i.view.name&&(n.name=i.view.name),i.view=n,e}function MS(i,e=null){const t=e===null?!0:o=>o.getAttribute(e),n=typeof i.model!="object"?i.model:i.model.key,s=typeof i.model!="object"||typeof i.model.value>"u"?t:i.model.value;i.model={key:n,value:s}}function NS(i,e){const t=new Ko(i.view);return(n,s,o)=>{if(!s.modelRange&&e)return;const a=t.match(s.viewItem);if(!a||(V4(i.view,s.viewItem)?a.match.name=!0:delete a.match.name,!o.consumable.test(s.viewItem,a.match)))return;const c=i.model.key,u=typeof i.model.value=="function"?i.model.value(s.viewItem,o,s):i.model.value;if(u==null)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor)),B4(s.modelRange,{key:c,value:u},e,o)&&(o.consumable.test(s.viewItem,{name:!0})&&(a.match.name=!0),o.consumable.consume(s.viewItem,a.match))}}function V4(i,e){const t=typeof i=="function"?i(e):i;return typeof t=="object"&&!sw(t)?!1:!t.classes&&!t.attributes&&!t.styles}function B4(i,e,t,n){let s=!1;for(const o of Array.from(i.getItems({shallow:t})))n.schema.checkAttribute(o,e.key)&&(s=!0,!o.hasAttribute(e.key)&&n.writer.setAttribute(e.key,e.value,o));return s}function M4(i){return(e,t)=>{const n=typeof i=="string"?i:i(e,t);return t.writer.createElement("$marker",{"data-name":n})}}function Y1(i,e){const t=(n,s)=>{const o=n.getAttribute("name"),a=i.model(o,s);return s.writer.createElement("$marker",{"data-name":a})};return{view:`${i.view}-${e}`,model:t}}class N4 extends qe(){model;view;mapper;downcastDispatcher;constructor(e,t){super(),this.model=e,this.view=new AB(t),this.mapper=new bS,this.downcastDispatcher=new wS({mapper:this.mapper,schema:e.schema});const n=this.model.document,s=n.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(n,"change",()=>{this.view.change(a=>{this.downcastDispatcher.convertChanges(n.differ,o,a),this.downcastDispatcher.convertSelection(s,o,a)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",E4(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",vS(),{priority:"lowest"}),this.downcastDispatcher.on("insert",CS(),{priority:"lowest"}),this.downcastDispatcher.on("remove",$B(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",YB()),this.downcastDispatcher.on("selection",GB(),{priority:"low"}),this.downcastDispatcher.on("selection",KB(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(a=>{if(a.rootName=="$graveyard")return null;const c=new sS(this.view.document,a.name);return c.rootName=a.rootName,this.mapper.bindElements(a,c),c})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t=typeof e=="string"?e:e.name,n=this.model.markers.get(t);if(!n)throw new E("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(()=>{this.model.markers._refresh(n)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}class L4 extends qe(){_sourceDefinitions={};_attributeProperties=Object.create(null);_customChildChecks=new Map;_customAttributeChecks=new Map;_genericCheckSymbol=Symbol("$generic");_compiledDefinitions;constructor(){super(),this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new ys(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new ys(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new E("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new E("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return typeof e=="string"?t=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?t="$text":t=e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!!(t&&t.isBlock)}isLimit(e){const t=this.getDefinition(e);return t?!!(t.isLimit||t.isObject):!1}isObject(e){const t=this.getDefinition(e);return t?!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent):!1}isInline(e){const t=this.getDefinition(e);return!!(t&&t.isInline)}isSelectable(e){const t=this.getDefinition(e);return t?!!(t.isSelectable||t.isObject):!1}isContent(e){const t=this.getDefinition(e);return t?!!(t.isContent||t.isObject):!1}checkChild(e,t){return t?this._checkContextMatch(e,t):!1}checkAttribute(e,t){const n=this.getDefinition(e.last);if(!n)return!1;const s=this._evaluateAttributeChecks(e,t);return s!==void 0?s:n.allowAttributes.includes(t)}checkMerge(e,t){if(e instanceof K){const n=e.nodeBefore,s=e.nodeAfter;if(!(n instanceof Xe))throw new E("schema-check-merge-no-element-before",this);if(!(s instanceof Xe))throw new E("schema-check-merge-no-element-after",this);return this.checkMerge(n,s)}if(this.isLimit(e)||this.isLimit(t))return!1;for(const n of t.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e,t){const n=t!==void 0?t:this._genericCheckSymbol,s=this._customChildChecks.get(n)||[];s.push(e),this._customChildChecks.set(n,s)}addAttributeCheck(e,t){const n=t!==void 0?t:this._genericCheckSymbol,s=this._customAttributeChecks.get(n)||[];s.push(e),this._customAttributeChecks.set(n,s)}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null)}getLimitElement(e){let t;for(e instanceof K?t=e.parent:t=(e instanceof F?[e]:Array.from(e.getRanges())).reduce((s,o)=>{const a=o.getCommonAncestor();return s?s.getCommonAncestor(a,{includeSelf:!0}):a},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const s=[...e.getFirstPosition().getAncestors(),new et("",e.getAttributes())];return this.checkAttribute(s,t)}else{const n=e.getRanges();for(const s of n)for(const o of s)if(this.checkAttribute(o.item,t))return!0}return!1}*getValidRanges(e,t,n={}){e=Z4(e);for(const s of e)yield*this._getValidRangesForRange(s,t,n)}getNearestSelectionRange(e,t="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new F(e);let n,s;const o=e.getAncestors().reverse().find(a=>this.isLimit(a))||e.root;(t=="both"||t=="backward")&&(n=new bs({boundaries:F._createIn(o),startPosition:e,direction:"backward"})),(t=="both"||t=="forward")&&(s=new bs({boundaries:F._createIn(o),startPosition:e}));for(const a of X4(n,s)){const c=a.walker==n?"elementEnd":"elementStart",u=a.value;if(u.type==c&&this.isObject(u.item))return F._createOn(u.item);if(this.checkChild(u.nextPosition,"$text"))return new F(u.nextPosition)}return null}findAllowedParent(e,t){let n=e.parent;for(;n;){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}setAllowedAttributes(e,t,n){const s=n.model;for(const[o,a]of Object.entries(t))s.schema.checkAttribute(e,o)&&n.setAttribute(o,a,e)}removeDisallowedAttributes(e,t){for(const n of e)if(n.is("$text"))J1(this,n,t);else{const o=F._createIn(n).getPositions();for(const a of o){const c=a.nodeBefore||a.parent;J1(this,c,t)}}}getAttributesWithProperty(e,t,n){const s={};for(const[o,a]of e.getAttributes()){const c=this.getAttributeProperties(o);c[t]!==void 0&&(n===void 0||n===c[t])&&(s[o]=a)}return s}createContext(e){return new ys(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,n=Object.keys(t);for(const o of n)e[o]=D4(t[o],o);const s=Object.values(e);for(const o of s)F4(e,o),z4(e,o),U4(e,o),H4(e,o);for(const o of s)j4(e,o);for(const o of s)q4(e,o);for(const o of s)W4(e,o);for(const o of s)G4(e,o);for(const o of s)K4(e,o);this._compiledDefinitions=$4(e)}_checkContextMatch(e,t){const n=e.last;let s=this._evaluateChildChecks(e,t);if(s=s!==void 0?s:t.allowIn.includes(n.name),!s)return!1;const o=this.getDefinition(n),a=e.trimLast();return o?a.length==0?!0:this._checkContextMatch(a,o):!1}_evaluateChildChecks(e,t){const n=this._customChildChecks.get(this._genericCheckSymbol)||[],s=this._customChildChecks.get(t.name)||[];for(const o of[...n,...s]){const a=o(e,t);if(a!==void 0)return a}}_evaluateAttributeChecks(e,t){const n=this._customAttributeChecks.get(this._genericCheckSymbol)||[],s=this._customAttributeChecks.get(t)||[];for(const o of[...n,...s]){const a=o(e,t);if(a!==void 0)return a}}*_getValidRangesForRange(e,t,n){let s=e.start,o=e.start;for(const a of e.getItems({shallow:!0})){if(a.is("element"))if(n.includeEmptyRanges&&a.isEmpty){const c=this.createContext(a);this.checkChild(c,"$text")&&this.checkAttribute(c.push("$text"),t)&&(yield F._createIn(a))}else yield*this._getValidRangesForRange(F._createIn(a),t,n);this.checkAttribute(a,t)||(s.isEqual(o)||(yield new F(s,o)),s=K._createAfter(a)),o=K._createAfter(a)}s.isEqual(o)||(yield new F(s,o))}findOptimalInsertionRange(e,t){const n=e.getSelectedElement();if(n&&this.isObject(n)&&!this.isInline(n))return t=="before"||t=="after"?new F(K._createAt(n,t)):F._createOn(n);const s=Ze(e.getSelectedBlocks());if(!s)return new F(e.focus);if(s.isEmpty)return new F(K._createAt(s,0));const o=K._createAfter(s);return e.focus.isTouching(o)?new F(o):new F(K._createBefore(s))}}class ys{_items;constructor(e){if(e instanceof ys)return e;let t;typeof e=="string"?t=[e]:Array.isArray(e)?t=e:t=e.getAncestors({includeSelf:!0}),this._items=t.map(Q4)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new ys([e]);return t._items=[...this._items,...t._items],t}trimLast(){const e=new ys([]);return e._items=this._items.slice(0,-1),e}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function D4(i,e){const t={name:e,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return Y4(i,t),xi(i,t,"allowIn"),xi(i,t,"allowChildren"),xi(i,t,"disallowIn"),xi(i,t,"disallowChildren"),xi(i,t,"allowContentOf"),xi(i,t,"allowWhere"),xi(i,t,"allowAttributes"),xi(i,t,"disallowAttributes"),xi(i,t,"allowAttributesOf"),xi(i,t,"inheritTypesFrom"),J4(i,t),t}function F4(i,e){for(const t of e.allowIn){const n=i[t];n?n.allowChildren.add(e.name):e.allowIn.delete(t)}}function z4(i,e){for(const t of e.allowChildren){const n=i[t];n?n.allowIn.add(e.name):e.allowChildren.delete(t)}}function U4(i,e){for(const t of e.disallowIn){const n=i[t];n?n.disallowChildren.add(e.name):e.disallowIn.delete(t)}}function H4(i,e){for(const t of e.disallowChildren){const n=i[t];n?n.disallowIn.add(e.name):e.disallowChildren.delete(t)}}function j4(i,e){for(const t of e.disallowChildren)e.allowChildren.delete(t);for(const t of e.disallowIn)e.allowIn.delete(t);for(const t of e.disallowAttributes)e.allowAttributes.delete(t)}function q4(i,e){for(const t of e.allowContentOf){const n=i[t];n&&(n.disallowChildren.forEach(s=>{e.allowChildren.has(s)||(e.disallowChildren.add(s),i[s].disallowIn.add(e.name))}),n.allowChildren.forEach(s=>{e.disallowChildren.has(s)||(e.allowChildren.add(s),i[s].allowIn.add(e.name))}))}}function W4(i,e){for(const t of e.allowWhere){const n=i[t];n&&(n.disallowIn.forEach(s=>{e.allowIn.has(s)||(e.disallowIn.add(s),i[s].disallowChildren.add(e.name))}),n.allowIn.forEach(s=>{e.disallowIn.has(s)||(e.allowIn.add(s),i[s].allowChildren.add(e.name))}))}}function $4(i){const e={};for(const t of Object.values(i))e[t.name]={name:t.name,isBlock:!!t.isBlock,isContent:!!t.isContent,isInline:!!t.isInline,isLimit:!!t.isLimit,isObject:!!t.isObject,isSelectable:!!t.isSelectable,allowIn:Array.from(t.allowIn).filter(n=>!!i[n]),allowChildren:Array.from(t.allowChildren).filter(n=>!!i[n]),allowAttributes:Array.from(t.allowAttributes)};return e}function G4(i,e){for(const t of e.allowAttributesOf){const n=i[t];if(!n)return;n.allowAttributes.forEach(s=>{e.disallowAttributes.has(s)||e.allowAttributes.add(s)})}}function K4(i,e){for(const t of e.inheritTypesFrom){const n=i[t];if(n){const s=Object.keys(n).filter(o=>o.startsWith("is"));for(const o of s)o in e||(e[o]=n[o])}}}function Y4(i,e){for(const t of i){const n=Object.keys(t).filter(s=>s.startsWith("is"));for(const s of n)e[s]=!!t[s]}}function xi(i,e,t){for(const n of i){let s=n[t];typeof s=="string"&&(s=[s]),Array.isArray(s)&&s.forEach(o=>e[t].add(o))}}function J4(i,e){for(const t of i){const n=t.inheritAllFrom;n&&(e.allowContentOf.add(n),e.allowWhere.add(n),e.allowAttributesOf.add(n),e.inheritTypesFrom.add(n))}}function Q4(i){return typeof i=="string"||i.is("documentFragment")?{name:typeof i=="string"?i:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:i.is("element")?i.name:"$text",*getAttributeKeys(){yield*i.getAttributeKeys()},getAttribute(e){return i.getAttribute(e)}}}function*X4(i,e){let t=!1;for(;!t;){if(t=!0,i){const n=i.next();n.done||(t=!1,yield{walker:i,value:n.value})}if(e){const n=e.next();n.done||(t=!1,yield{walker:e,value:n.value})}}}function*Z4(i){for(const e of i)yield*e.getMinimalFlatRanges()}function J1(i,e,t){for(const n of e.getAttributeKeys())i.checkAttribute(e,n)||t.removeAttribute(n,e)}class eM extends Je(){conversionApi;_splitParts=new Map;_cursorParents=new Map;_modelCursor=null;_emptyElementsToKeep=new Set;constructor(e){super(),this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(t,n)=>this._convertItem(t,n),convertChildren:(t,n)=>this._convertChildren(t,n),safeInsert:(t,n)=>this._safeInsert(t,n),updateConversionResult:(t,n)=>this._updateConversionResult(t,n),splitToAllowedParent:(t,n)=>this._splitToAllowedParent(t,n),getSplitParts:t=>this._getSplitParts(t),keepEmptyElement:t=>this._keepEmptyElement(t)}}convert(e,t,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=nM(n,t),this.conversionApi.writer=t,this.conversionApi.consumable=th.createFrom(e),this.conversionApi.store={};const{modelRange:s}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(s){this._removeEmptyElements();const a=this._modelCursor.parent,c=a._removeChildren(0,a.childCount);o._insertChild(0,c),o.markers=tM(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const n={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,n,this.conversionApi):e.is("$text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof F))throw new E("view-conversion-dispatcher-incorrect-result",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,t){let n=t.is("position")?t:K._createAt(t,0);const s=new F(n);for(const o of Array.from(e.getChildren())){const a=this._convertItem(o,n);a.modelRange instanceof F&&(s.end=a.modelRange.end,n=a.modelCursor)}return{modelRange:s,modelCursor:n}}_safeInsert(e,t){const n=this._splitToAllowedParent(e,t);return n?(this.conversionApi.writer.insert(e,n.position),!0):!1}_updateConversionResult(e,t){const n=this._getSplitParts(e),s=this.conversionApi.writer;t.modelRange||(t.modelRange=s.createRange(s.createPositionBefore(e),s.createPositionAfter(n[n.length-1])));const o=this._cursorParents.get(e);o?t.modelCursor=s.createPositionAt(o,0):t.modelCursor=t.modelRange.end}_splitToAllowedParent(e,t){const{schema:n,writer:s}=this.conversionApi;let o=n.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return OS(t,e,n)?{position:VS(t,s)}:null;const a=this.conversionApi.writer.split(t,o),c=[];for(const h of a.range.getWalker())if(h.type=="elementEnd")c.push(h.item);else{const m=c.pop(),g=h.item;this._registerSplitPair(m,g)}const u=a.range.end.parent;return this._cursorParents.set(e,u),{position:a.position,cursorParent:u}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(t,n),n.push(t)}_getSplitParts(e){let t;return this._splitParts.has(e)?t=this._splitParts.get(e):t=[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){const e=new Map;for(const t of this._splitParts.keys())if(t.isEmpty&&!this._emptyElementsToKeep.has(t)){const n=e.get(t.parent)||[];n.push(t),this._splitParts.delete(t),e.set(t.parent,n)}for(const[t,n]of e)t._removeChildrenArray(n);e.size&&this._removeEmptyElements()}}function tM(i,e){const t=new Set,n=new Map,s=F._createIn(i).getItems();for(const o of s)o.is("element","$marker")&&t.add(o);for(const o of t){const a=o.getAttribute("data-name"),c=e.createPositionBefore(o);n.has(a)?n.get(a).end=c.clone():n.set(a,new F(c.clone())),e.remove(o)}return n}function nM(i,e){let t;for(const n of new ys(i)){const s={};for(const a of n.getAttributeKeys())s[a]=n.getAttribute(a);const o=e.createElement(n.name,s);t&&e.insert(o,t),t=K._createAt(o,0)}return t}class iM{getHtml(e){const n=ee.document.implementation.createHTMLDocument("").createElement("div");return n.appendChild(e),n.innerHTML}}class sM{domParser;domConverter;htmlWriter;skipComments=!0;constructor(e){this.domParser=new DOMParser,this.domConverter=new dS(e,{renderingMode:"data"}),this.htmlWriter=new iM}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4))||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),n=t.createDocumentFragment(),s=t.body.childNodes;for(;s.length>0;)n.appendChild(s[0]);return n}}class oM extends Je(){model;mapper;downcastDispatcher;upcastDispatcher;viewDocument;stylesProcessor;htmlProcessor;processor;_viewWriter;constructor(e,t){super(),this.model=e,this.mapper=new bS,this.downcastDispatcher=new wS({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",vS(),{priority:"lowest"}),this.downcastDispatcher.on("insert",CS(),{priority:"lowest"}),this.upcastDispatcher=new eM({schema:e.schema}),this.viewDocument=new oS(t),this.stylesProcessor=t,this.htmlProcessor=new sM(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new rS(this.viewDocument),this.upcastDispatcher.on("text",T4(),{priority:"lowest"}),this.upcastDispatcher.on("element",K1(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",K1(),{priority:"lowest"}),qe().prototype.decorate.call(this,"init"),qe().prototype.decorate.call(this,"set"),qe().prototype.decorate.call(this,"get"),qe().prototype.decorate.call(this,"toView"),qe().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},RS)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:n="empty"}=e;if(!this._checkIfRootsExists([t]))throw new E("datacontroller-get-non-existent-root",this);const s=this.model.document.getRoot(t);return s.isAttached()||Be("datacontroller-get-detached-root",this),n==="empty"&&!this.model.hasContent(s,{ignoreWhitespaces:!0})?"":this.stringify(s,e)}stringify(e,t={}){const n=this.toView(e,t);return this.processor.toData(n)}toView(e,t={}){const n=this.viewDocument,s=this._viewWriter;this.mapper.clearBindings();const o=F._createIn(e),a=new $o(n);this.mapper.bindElements(e,a);const c=e.is("documentFragment")?e.markers:rM(e);return this.downcastDispatcher.convert(o,c,s,t),a}init(e){if(this.model.document.version)throw new E("datacontroller-init-document-not-empty",this);let t={};if(typeof e=="string"?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new E("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},n=>{for(const s of Object.keys(t)){const o=this.model.document.getRoot(s);n.insert(this.parse(t[s],o),o,0)}}),Promise.resolve()}set(e,t={}){let n={};if(typeof e=="string"?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new E("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},s=>{s.setSelection(null),s.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(n)){const a=this.model.document.getRoot(o);s.remove(s.createRangeIn(a)),s.insert(this.parse(n[o],a),a,0)}})}parse(e,t="$root"){const n=this.processor.toView(e);return this.toModel(n,t)}toModel(e,t="$root"){return this.model.change(n=>this.upcastDispatcher.convert(e,n,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}}function rM(i){const e=[],t=i.root.document;if(!t)return new Map;const n=F._createIn(i);for(const s of t.model.markers){const o=s.getRange(),a=o.isCollapsed,c=o.start.isEqual(n.start)||o.end.isEqual(n.end);if(a&&c)e.push([s.name,o]);else{const u=n.getIntersection(o);u&&e.push([s.name,u])}}return e.sort(([s,o],[a,c])=>{if(o.end.compareWith(c.start)!=="after")return 1;if(o.start.compareWith(c.end)!=="before")return-1;switch(o.start.compareWith(c.start)){case"before":return 1;case"after":return-1;default:switch(o.end.compareWith(c.end)){case"before":return 1;case"after":return-1;default:return a.localeCompare(s)}}}),new Map(e)}class aM{_helpers=new Map;_downcast;_upcast;constructor(e,t){this._downcast=st(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=st(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const n=this._downcast.includes(t);if(!this._upcast.includes(t)&&!n)throw new E("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:n})}for(e){if(!this._helpers.has(e))throw new E("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:n}of Kg(e))this.for("upcast").elementToElement({model:t,view:n,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:n}of Kg(e))this.for("upcast").elementToAttribute({view:n,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:n}of Kg(e))this.for("upcast").attributeToAttribute({view:n,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:n}){if(this._helpers.has(e))throw new E("conversion-group-exists",this);const s=n?new WB(t):new k4(t);this._helpers.set(e,s)}}function*Kg(i){if(i.model.values)for(const e of i.model.values){const t={key:i.model.key,value:e},n=i.view[e],s=i.upcastAlso?i.upcastAlso[e]:void 0;yield*Q1(t,n,s)}else yield*Q1(i.model,i.view,i.upcastAlso)}function*Q1(i,e,t){if(yield{model:i,view:e},t)for(const n of st(t))yield{model:i,view:n}}class Fn{baseVersion;isDocumentOperation;batch;constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}}function ow(i,e){const t=DS(e),n=t.reduce((a,c)=>a+c.offsetSize,0),s=i.parent;bc(i);const o=i.index;return s._insertChild(o,t),pc(s,o+t.length),pc(s,o),new F(i,i.getShiftedBy(n))}function LS(i){if(!i.isFlat)throw new E("operation-utils-remove-range-not-flat",this);const e=i.start.parent;bc(i.start),bc(i.end);const t=e._removeChildren(i.start.index,i.end.index-i.start.index);return pc(e,i.start.index),t}function gc(i,e){if(!i.isFlat)throw new E("operation-utils-move-range-not-flat",this);const t=LS(i);return e=e._getTransformedByDeletion(i.start,i.end.offset-i.start.offset),ow(e,t)}function lM(i,e,t){bc(i.start),bc(i.end);for(const n of i.getItems({shallow:!0})){const s=n.is("$textProxy")?n.textNode:n;t!==null?s._setAttribute(e,t):s._removeAttribute(e),pc(s.parent,s.index)}pc(i.end.parent,i.end.index)}function DS(i){const e=[];function t(n){if(typeof n=="string")e.push(new et(n));else if(n instanceof pi)e.push(new et(n.data,n.getAttributes()));else if(n instanceof ir)e.push(n);else if(Dn(n))for(const s of n)t(s)}t(i);for(let n=1;n<e.length;n++){const s=e[n],o=e[n-1];s instanceof et&&o instanceof et&&FS(s,o)&&(e.splice(n-1,2,new et(o.data+s.data,o.getAttributes())),n--)}return e}function pc(i,e){const t=i.getChild(e-1),n=i.getChild(e);if(t&&n&&t.is("$text")&&n.is("$text")&&FS(t,n)){const s=new et(t.data+n.data,t.getAttributes());i._removeChildren(e-1,2),i._insertChild(e-1,s)}}function bc(i){const e=i.textNode,t=i.parent;if(e){const n=i.offset-e.startOffset,s=e.index;t._removeChildren(s,1);const o=new et(e.data.substr(0,n),e.getAttributes()),a=new et(e.data.substr(n),e.getAttributes());t._insertChild(s,[o,a])}}function FS(i,e){const t=i.getAttributes(),n=e.getAttributes();for(const s of t){if(s[1]!==e.getAttribute(s[0]))return!1;n.next()}return n.next().done}class Fe extends Fn{sourcePosition;howMany;targetPosition;constructor(e,t,n,s){super(s),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName==this.sourcePosition.root.rootName?"move":this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[F._createFromPositionAndShift(this.sourcePosition,this.howMany),F._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new Fe(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new Fe(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,n=this.sourcePosition.offset,s=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new E("move-operation-nodes-do-not-exist",this);if(e===t&&n<s&&s<n+this.howMany)throw new E("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&Nt(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const o=this.sourcePosition.path.length-1;if(this.targetPosition.path[o]>=n&&this.targetPosition.path[o]<n+this.howMany)throw new E("move-operation-node-into-itself",this)}}_execute(){gc(F._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const n=K.fromJSON(e.sourcePosition,t),s=K.fromJSON(e.targetPosition,t);return new this(n,e.howMany,s,e.baseVersion)}}class Lt extends Fn{position;nodes;shouldReceiveAttributes;constructor(e,t,n){super(n),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Zl(DS(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new Zl([...this.nodes].map(n=>n._clone(!0))),t=new Lt(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new K(e,[0]);return new Fe(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new E("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Zl([...e].map(t=>t._clone(!0))),ow(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const n=[];for(const o of e.nodes)o.name?n.push(Xe.fromJSON(o)):n.push(et.fromJSON(o));const s=new Lt(K.fromJSON(e.position,t),n,e.baseVersion);return s.shouldReceiveAttributes=e.shouldReceiveAttributes,s}}class Ye extends Fn{splitPosition;howMany;insertionPosition;graveyardPosition;constructor(e,t,n,s,o){super(o),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=n,this.graveyardPosition=s?s.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new K(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new F(this.splitPosition,e)}get affectedSelectable(){const e=[F._createFromPositionAndShift(this.splitPosition,0),F._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(F._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new Ye(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new K(e,[0]);return new gt(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new E("split-operation-position-invalid",this);if(e.parent){if(this.howMany!==Number.NEGATIVE_INFINITY&&this.howMany!=e.maxOffset-this.splitPosition.offset)throw new E("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new E("split-operation-graveyard-position-invalid",this)}else throw new E("split-operation-split-in-root",this);this.howMany=this.splitPosition.parent.maxOffset-this.splitPosition.offset}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)gc(F._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const n=e._clone();ow(this.insertionPosition,n)}const t=new F(K._createAt(e,this.splitPosition.offset),K._createAt(e,e.maxOffset));gc(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new K(e.root,t,"toPrevious")}static fromJSON(e,t){const n=K.fromJSON(e.splitPosition,t),s=K.fromJSON(e.insertionPosition,t),o=e.graveyardPosition?K.fromJSON(e.graveyardPosition,t):null;return new this(n,e.howMany,s,o,e.baseVersion)}}class gt extends Fn{sourcePosition;howMany;targetPosition;graveyardPosition;constructor(e,t,n,s,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=s.clone()}get type(){return"merge"}get deletionPosition(){return new K(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new F(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[F._createOn(e),F._createFromPositionAndShift(this.targetPosition,0),F._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new gt(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),n=new K(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new Ye(e,this.howMany,n,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(e.parent)if(t.parent){if(this.howMany!==Number.NEGATIVE_INFINITY&&this.howMany!=e.maxOffset)throw new E("merge-operation-how-many-invalid",this)}else throw new E("merge-operation-target-position-invalid",this);else throw new E("merge-operation-source-position-invalid",this);this.howMany=this.sourcePosition.parent.maxOffset}_execute(){const e=this.sourcePosition.parent,t=F._createIn(e);gc(t,this.targetPosition),gc(F._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const n=K.fromJSON(e.sourcePosition,t),s=K.fromJSON(e.targetPosition,t),o=K.fromJSON(e.graveyardPosition,t);return new this(n,e.howMany,s,o,e.baseVersion)}}class sn extends Fn{name;oldRange;newRange;affectsData;_markers;constructor(e,t,n,s,o,a){super(a),this.name=e,this.oldRange=t?t.clone():null,this.newRange=n?n.clone():null,this.affectsData=o,this._markers=s}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new sn(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new sn(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new sn(e.name,e.oldRange?F.fromJSON(e.oldRange,t):null,e.newRange?F.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}class yt extends Fn{range;key;oldValue;newValue;constructor(e,t,n,s,o){super(o),this.range=e.clone(),this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new yt(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new yt(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new E("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!o1(e.getAttribute(this.key),this.oldValue))throw new E("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new E("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){o1(this.oldValue,this.newValue)||lM(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new yt(F.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Vt extends Fn{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new Vt(this.baseVersion)}getReversed(){return new Vt(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}class _n extends Fn{position;oldName;newName;constructor(e,t,n,s){super(s),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=n}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new _n(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new _n(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Xe){if(this.oldName!==""&&e.name!==this.oldName)throw new E("rename-operation-wrong-name",this)}else throw new E("rename-operation-wrong-position",this);this.oldName=e.name}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new _n(K.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}class vs extends Fn{root;key;oldValue;newValue;constructor(e,t,n,s,o){super(o),this.root=e,this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new vs(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new vs(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new E("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new E("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new E("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new E("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new vs(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Mi extends Fn{rootName;elementName;isAdd;_document;constructor(e,t,n,s,o){if(super(o),this.rootName=e,this.elementName=t,this.isAdd=n,this._document=s,!this._document.getRoot(this.rootName)){const a=this._document.createRoot(this.elementName,this.rootName);a._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Mi(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Mi(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,t){return new Mi(e.rootName,e.elementName,e.isAdd,t,e.baseVersion)}}const ai={};ai[yt.className]=yt;ai[Lt.className]=Lt;ai[sn.className]=sn;ai[Fe.className]=Fe;ai[Vt.className]=Vt;ai[Fn.className]=Fn;ai[_n.className]=_n;ai[vs.className]=vs;ai[Mi.className]=Mi;ai[Ye.className]=Ye;ai[gt.className]=gt;class cM{static fromJSON(e,t){return ai[e.__className].fromJSON(e,t)}}const Yp=new Map;function Me(i,e,t){let n=Yp.get(i);n||(n=new Map,Yp.set(i,n)),n.set(e,t)}function uM(i,e){const t=Yp.get(i);return t&&t.has(e)?t.get(e):dM}function dM(i){return[i]}function X1(i,e,t={}){const n=uM(i.constructor,e.constructor);try{return i=i.clone(),n(i,e,t)}catch(s){throw s}}function hM(i,e,t){i=i.slice(),e=e.slice();const n=new fM(t.document,t.useRelations,t.forceWeakRemove);n.setOriginalOperations(i),n.setOriginalOperations(e);const s=n.originalOperations;if(i.length==0||e.length==0)return{operationsA:i,operationsB:e,originalOperations:s};const o=new WeakMap;for(const u of i)o.set(u,0);const a={nextBaseVersionA:i[i.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:i.length,originalOperationsBCount:e.length};let c=0;for(;c<i.length;){const u=i[c],h=o.get(u);if(h==e.length){c++;continue}const m=e[h],g=X1(u,m,n.getContext(u,m,!0)),w=X1(m,u,n.getContext(m,u,!1));n.updateRelation(u,m),n.setOriginalOperations(g,u),n.setOriginalOperations(w,m);for(const _ of g)o.set(_,h+w.length);i.splice(c,1,...g),e.splice(h,1,...w)}return eC(i),eC(e),Z1(i,a.nextBaseVersionB),Z1(e,a.nextBaseVersionA),{operationsA:i,operationsB:e,originalOperations:s}}class fM{originalOperations;_history;_useRelations;_forceWeakRemove;_relations;constructor(e,t,n=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(e,t=null){const n=t?this.originalOperations.get(t):null;for(const s of e)this.originalOperations.set(s,n||s)}updateRelation(e,t){if(e instanceof Fe)t instanceof gt?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)?this._setRelation(e,t,"moveTargetAfter"):e.howMany>1&&e.sourcePosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"firstToMoveMerged"):e.howMany>1&&e.sourcePosition.getShiftedBy(e.howMany-1).isEqual(t.deletionPosition)&&this._setRelation(e,t,"lastToMoveMerged"):t instanceof Fe&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof Ye){if(t instanceof gt)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof Fe)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const n=F._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const s=n.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-n.start.offset;this._setRelation(e,t,{howMany:s,offset:o})}}}else if(e instanceof gt)t instanceof gt?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof Ye?e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource"):t instanceof Fe&&t.howMany>0&&(e.sourcePosition.isEqual(t.sourcePosition.getShiftedBy(t.howMany))&&this._setRelation(e,t,"mergeSourceAffected"),e.targetPosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeTargetWasBefore"));else if(e instanceof sn){const n=e.newRange;if(!n)return;if(t instanceof gt){const s=n.start.isEqual(t.targetPosition),o=n.start.isEqual(t.deletionPosition),a=n.end.isEqual(t.deletionPosition),c=n.end.isEqual(t.sourcePosition);(s||o||a||c)&&this._setRelation(e,t,{wasInLeftElement:s,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:a,wasInRightElement:c})}}}getContext(e,t,n){return{aIsStrong:n,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const n=this.originalOperations.get(t),s=this._history.getUndoneOperation(n);if(!s)return null;const o=this.originalOperations.get(e),a=this._relations.get(o);return a&&a.get(s)||null}_setRelation(e,t,n){const s=this.originalOperations.get(e),o=this.originalOperations.get(t);let a=this._relations.get(s);a||(a=new Map,this._relations.set(s,a)),a.set(o,n)}}function Z1(i,e){for(const t of i)t.baseVersion=e++}function eC(i){const e=new Map;for(let t=0;t<i.length;t++){const n=i[t];n instanceof sn&&(n.baseVersion!==-1?e.set(n.name,{op:n,ranges:n.newRange?[n.newRange]:[]}):(n.newRange&&e.get(n.name).ranges.push(n.newRange),i.splice(t,1),t--))}for(const{op:t,ranges:n}of e.values())n.length?t.newRange=F._createFromRanges(n):t.newRange=null}Me(yt,yt,(i,e,t)=>{if(i.key===e.key&&i.range.start.hasSameParentAs(e.range.start)){const n=i.range.getDifference(e.range).map(o=>new yt(o,i.key,i.oldValue,i.newValue,0)),s=i.range.getIntersection(e.range);return s&&t.aIsStrong&&n.push(new yt(s,e.key,e.newValue,i.newValue,0)),n.length==0?[new Vt(0)]:n}else return[i]});Me(yt,Lt,(i,e)=>{if(i.range.start.hasSameParentAs(e.position)&&i.range.containsPosition(e.position)){const n=i.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(s=>new yt(s,i.key,i.oldValue,i.newValue,i.baseVersion));if(e.shouldReceiveAttributes){const s=zS(e,i.key,i.oldValue);s&&n.unshift(s)}return n}return i.range=i.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[i]});function zS(i,e,t){const s=i.nodes.getNode(0).getAttribute(e);if(s==t)return null;const o=new F(i.position,i.position.getShiftedBy(i.howMany));return new yt(o,e,s,t,0)}Me(yt,gt,(i,e)=>{const t=[];i.range.start.hasSameParentAs(e.deletionPosition)&&(i.range.containsPosition(e.deletionPosition)||i.range.start.isEqual(e.deletionPosition))&&t.push(F._createFromPositionAndShift(e.graveyardPosition,1));const n=i.range._getTransformedByMergeOperation(e);return n.isCollapsed||t.push(n),t.map(s=>new yt(s,i.key,i.oldValue,i.newValue,i.baseVersion))});Me(yt,Fe,(i,e)=>mM(i.range,e).map(n=>new yt(n,i.key,i.oldValue,i.newValue,i.baseVersion)));function mM(i,e){const t=F._createFromPositionAndShift(e.sourcePosition,e.howMany);let n=null,s=[];t.containsRange(i,!0)?n=i:i.start.hasSameParentAs(t.start)?(s=i.getDifference(t),n=i.getIntersection(t)):s=[i];const o=[];for(let a of s){a=a._getTransformedByDeletion(e.sourcePosition,e.howMany);const c=e.getMovedRangeStart(),u=a.start.hasSameParentAs(c),h=a._getTransformedByInsertion(c,e.howMany,u);o.push(...h)}return n&&o.push(n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),o}Me(yt,Ye,(i,e)=>{if(i.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||i.range.end.offset++,[i];if(i.range.start.hasSameParentAs(e.splitPosition)&&i.range.containsPosition(e.splitPosition)){const t=i.clone();return t.range=new F(e.moveTargetPosition.clone(),i.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),i.range.end=e.splitPosition.clone(),i.range.end.stickiness="toPrevious",[i,t]}return i.range=i.range._getTransformedBySplitOperation(e),[i]});Me(Lt,yt,(i,e)=>{const t=[i];if(i.shouldReceiveAttributes&&i.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(i.position)){const n=zS(i,e.key,e.newValue);n&&t.push(n)}return t});Me(Lt,Lt,(i,e,t)=>i.position.isEqual(e.position)&&t.aIsStrong?[i]:(i.position=i.position._getTransformedByInsertOperation(e),[i]));Me(Lt,Fe,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i]));Me(Lt,Ye,(i,e)=>(i.position=i.position._getTransformedBySplitOperation(e),[i]));Me(Lt,gt,(i,e)=>(i.position=i.position._getTransformedByMergeOperation(e),[i]));Me(sn,Lt,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByInsertOperation(e)[0]),i.newRange&&(i.newRange=i.newRange._getTransformedByInsertOperation(e)[0]),[i]));Me(sn,sn,(i,e,t)=>{if(i.name==e.name)if(t.aIsStrong)i.oldRange=e.newRange?e.newRange.clone():null;else return[new Vt(0)];return[i]});Me(sn,gt,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByMergeOperation(e)),i.newRange&&(i.newRange=i.newRange._getTransformedByMergeOperation(e)),[i]));Me(sn,Fe,(i,e)=>{const t=[i];if(i.oldRange&&(i.oldRange=F._createFromRanges(i.oldRange._getTransformedByMoveOperation(e))),i.newRange){const n=i.newRange._getTransformedByMoveOperation(e);i.newRange=n[0];for(let s=1;s<n.length;s++){const o=i.clone();o.oldRange=null,o.newRange=n[s],o.baseVersion=-1,t.push(o)}}return t});Me(sn,Ye,(i,e,t)=>{if(i.oldRange&&(i.oldRange=i.oldRange._getTransformedBySplitOperation(e)),i.newRange){if(t.abRelation){const n=i.newRange._getTransformedBySplitOperation(e);return i.newRange.start.isEqual(e.splitPosition)?t.abRelation.wasStartBeforeMergedElement?i.newRange.start=K._createAt(e.insertionPosition):t.abRelation.wasInLeftElement?i.newRange.start=K._createAt(i.newRange.start):i.newRange.start=K._createAt(e.moveTargetPosition):i.newRange.start=n.start,i.newRange.end.isEqual(e.splitPosition)?i.newRange.end.isEqual(e.splitPosition)&&t.abRelation.wasEndBeforeMergedElement?i.newRange.end=K._createAt(e.insertionPosition):t.abRelation.wasInRightElement?i.newRange.end=K._createAt(e.moveTargetPosition):i.newRange.end=K._createAt(i.newRange.end):i.newRange.end=n.end,[i]}i.newRange=i.newRange._getTransformedBySplitOperation(e)}return[i]});Me(gt,Lt,(i,e)=>(i.sourcePosition.hasSameParentAs(e.position)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByInsertOperation(e),i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e),[i]));Me(gt,gt,(i,e,t)=>{if(i.sourcePosition.isEqual(e.sourcePosition)&&i.targetPosition.isEqual(e.targetPosition))if(t.bWasUndone){const n=e.graveyardPosition.path.slice();return n.push(0),i.sourcePosition=new K(e.graveyardPosition.root,n),i.howMany=0,[i]}else return[new Vt(0)];if(i.sourcePosition.isEqual(e.sourcePosition)&&!i.targetPosition.isEqual(e.targetPosition)&&!t.bWasUndone&&t.abRelation!="splitAtSource"){const n=i.targetPosition.root.rootName=="$graveyard",s=e.targetPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const u=e.targetPosition._getTransformedByMergeOperation(e),h=i.targetPosition._getTransformedByMergeOperation(e);return[new Fe(u,i.howMany,h,0)]}else return[new Vt(0)]}return i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByMergeOperation(e),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),(!i.graveyardPosition.isEqual(e.graveyardPosition)||!t.aIsStrong)&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]});Me(gt,Fe,(i,e,t)=>{const n=F._createFromPositionAndShift(e.sourcePosition,e.howMany);return e.type=="remove"&&!t.bWasUndone&&i.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.sourcePosition)?[new Vt(0)]:(e.sourcePosition.getShiftedBy(e.howMany).isEqual(i.sourcePosition)?i.sourcePosition.stickiness="toNone":e.targetPosition.isEqual(i.sourcePosition)&&t.abRelation=="mergeSourceAffected"?i.sourcePosition.stickiness="toNext":e.sourcePosition.isEqual(i.targetPosition)?(i.targetPosition.stickiness="toNone",i.howMany-=e.howMany):e.targetPosition.isEqual(i.targetPosition)&&t.abRelation=="mergeTargetWasBefore"?(i.targetPosition.stickiness="toPrevious",i.howMany+=e.howMany):(i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition.hasSameParentAs(e.sourcePosition)&&(i.howMany-=e.howMany)),i.sourcePosition=i.sourcePosition._getTransformedByMoveOperation(e),i.targetPosition=i.targetPosition._getTransformedByMoveOperation(e),i.sourcePosition.stickiness="toPrevious",i.targetPosition.stickiness="toNext",i.graveyardPosition.isEqual(e.targetPosition)||(i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)),[i])});Me(gt,Ye,(i,e,t)=>{if(e.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),i.deletionPosition.isEqual(e.graveyardPosition)&&(i.howMany=e.howMany)),i.targetPosition.isEqual(e.splitPosition)&&(e.graveyardPosition&&i.deletionPosition.isEqual(e.graveyardPosition)||t.abRelation=="mergeTargetNotMoved"))return i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),[i];if(i.sourcePosition.isEqual(e.splitPosition)){if(t.abRelation=="mergeSourceNotMoved")return i.howMany=0,i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i];if(t.abRelation=="mergeSameElement"||i.sourcePosition.offset>0)return i.sourcePosition=e.moveTargetPosition.clone(),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]}return i.sourcePosition.hasSameParentAs(e.splitPosition)&&(i.howMany=e.splitPosition.offset),i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]});Me(Fe,Lt,(i,e)=>{const n=F._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByInsertOperation(e,!1)[0];return i.sourcePosition=n.start,i.howMany=n.end.offset-n.start.offset,i.targetPosition.isEqual(e.position)||(i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e)),[i]});Me(Fe,Fe,(i,e,t)=>{const n=F._createFromPositionAndShift(i.sourcePosition,i.howMany),s=F._createFromPositionAndShift(e.sourcePosition,e.howMany);let o=t.aIsStrong,a=!t.aIsStrong;t.abRelation=="insertBefore"||t.baRelation=="insertAfter"?a=!0:(t.abRelation=="insertAfter"||t.baRelation=="insertBefore")&&(a=!1);let c;if(i.targetPosition.isEqual(e.targetPosition)&&a?c=i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):c=i.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),tC(i,e)&&tC(e,i))return[e.getReversed()];if(n.containsPosition(e.targetPosition)&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),ha([n],c);if(s.containsPosition(i.targetPosition)&&s.containsRange(n,!0))return n.start=n.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),n.end=n.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),ha([n],c);const m=Nt(i.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if(m=="prefix"||m=="extension")return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),ha([n],c);i.type=="remove"&&e.type!="remove"&&!t.aWasUndone&&!t.forceWeakRemove?o=!0:i.type!="remove"&&e.type=="remove"&&!t.bWasUndone&&!t.forceWeakRemove&&(o=!1);const g=[],w=n.getDifference(s);for(const v of w){v.start=v.start._getTransformedByDeletion(e.sourcePosition,e.howMany),v.end=v.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const C=Nt(v.start.getParentPath(),e.getMovedRangeStart().getParentPath())=="same",T=v._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,C);g.push(...T)}const _=n.getIntersection(s);return _!==null&&o&&(_.start=_.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),_.end=_.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),g.length===0?g.push(_):g.length==1?s.start.isBefore(n.start)||s.start.isEqual(n.start)?g.unshift(_):g.push(_):g.splice(1,0,_)),g.length===0?[new Vt(i.baseVersion)]:ha(g,c)});Me(Fe,Ye,(i,e,t)=>{let n=i.targetPosition.clone();if((!i.targetPosition.isEqual(e.insertionPosition)||!e.graveyardPosition||t.abRelation=="moveTargetAfter")&&(n=i.targetPosition._getTransformedBySplitOperation(e)),i.sourcePosition.isEqual(e.insertionPosition)&&t.abRelation=="firstToMoveMerged")return i.howMany++,i.targetPosition=n,[i];const s=F._createFromPositionAndShift(i.sourcePosition,i.howMany);if(s.end.isEqual(e.insertionPosition))return(!e.graveyardPosition||t.abRelation=="lastToMoveMerged")&&i.howMany++,i.targetPosition=n,[i];if(s.start.hasSameParentAs(e.splitPosition)&&s.containsPosition(e.splitPosition)){let c=new F(e.splitPosition,s.end);c=c._getTransformedBySplitOperation(e);const u=[new F(s.start,e.splitPosition),c];return ha(u,n)}i.targetPosition.isEqual(e.splitPosition)&&t.abRelation=="insertAtSource"&&(n=e.moveTargetPosition),i.targetPosition.isEqual(e.insertionPosition)&&t.abRelation=="insertBetween"&&(n=i.targetPosition);const a=[s._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const c=s.start.isEqual(e.graveyardPosition)||s.containsPosition(e.graveyardPosition);i.howMany>1&&c&&!t.aWasUndone&&a.push(F._createFromPositionAndShift(e.insertionPosition,1))}return ha(a,n)});Me(Fe,gt,(i,e,t)=>{const n=F._createFromPositionAndShift(i.sourcePosition,i.howMany);if(e.deletionPosition.hasSameParentAs(i.sourcePosition)&&n.containsPosition(e.sourcePosition)){if(i.type=="remove"&&!t.forceWeakRemove){if(!t.aWasUndone){const a=[];let c=e.graveyardPosition.clone(),u=e.targetPosition._getTransformedByMergeOperation(e);const h=i.targetPosition.getTransformedByOperation(e);i.howMany>1&&(a.push(new Fe(i.sourcePosition,i.howMany-1,h,0)),c=c._getTransformedByMove(i.sourcePosition,h,i.howMany-1),u=u._getTransformedByMove(i.sourcePosition,h,i.howMany-1));const m=e.deletionPosition._getCombined(i.sourcePosition,h),g=new Fe(c,1,m,0),w=g.getMovedRangeStart().path.slice();w.push(0);const _=new K(g.targetPosition.root,w);u=u._getTransformedByMove(c,m,1);const v=new Fe(u,e.howMany,_,0);return a.push(g),a.push(v),a}}else if(i.howMany==1)return t.bWasUndone?(i.sourcePosition=e.graveyardPosition.clone(),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]):[new Vt(0)]}const o=F._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByMergeOperation(e);return i.sourcePosition=o.start,i.howMany=o.end.offset-o.start.offset,i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]});Me(_n,Lt,(i,e)=>(i.position=i.position._getTransformedByInsertOperation(e),[i]));Me(_n,gt,(i,e)=>i.position.isEqual(e.deletionPosition)?(i.position=e.graveyardPosition.clone(),i.position.stickiness="toNext",[i]):(i.position=i.position._getTransformedByMergeOperation(e),[i]));Me(_n,Fe,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i]));Me(_n,_n,(i,e,t)=>{if(i.position.isEqual(e.position))if(t.aIsStrong)i.oldName=e.newName;else return[new Vt(0)];return[i]});Me(_n,Ye,(i,e)=>{const t=i.position.path,n=e.splitPosition.getParentPath();if(Nt(t,n)=="same"&&!e.graveyardPosition){const s=new _n(i.position.getShiftedBy(1),i.oldName,i.newName,0);return[i,s]}return i.position=i.position._getTransformedBySplitOperation(e),[i]});Me(vs,vs,(i,e,t)=>{if(i.root===e.root&&i.key===e.key)if(t.aIsStrong)i.oldValue=e.newValue;else return[new Vt(0)];return[i]});Me(Mi,Mi,(i,e)=>i.rootName===e.rootName&&i.isAdd===e.isAdd?[new Vt(0)]:[i]);Me(Ye,Lt,(i,e)=>(i.splitPosition.hasSameParentAs(e.position)&&i.splitPosition.offset<e.position.offset&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByInsertOperation(e),i.insertionPosition=i.insertionPosition._getTransformedByInsertOperation(e),[i]));Me(Ye,gt,(i,e,t)=>{if(!i.graveyardPosition&&!t.bWasUndone&&i.splitPosition.hasSameParentAs(e.sourcePosition)){const n=e.graveyardPosition.path.slice();n.push(0);const s=new K(e.graveyardPosition.root,n),o=Ye.getInsertionPosition(new K(e.graveyardPosition.root,n)),a=new Ye(s,0,o,null,0);return i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),i.graveyardPosition=a.insertionPosition.clone(),i.graveyardPosition.stickiness="toNext",[a,i]}return i.splitPosition.hasSameParentAs(e.deletionPosition)&&!i.splitPosition.isAfter(e.deletionPosition)&&i.howMany--,i.splitPosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]});Me(Ye,Fe,(i,e,t)=>{const n=F._createFromPositionAndShift(e.sourcePosition,e.howMany);if(i.graveyardPosition){const o=n.start.isEqual(i.graveyardPosition)||n.containsPosition(i.graveyardPosition);if(!t.bWasUndone&&o){const a=i.splitPosition._getTransformedByMoveOperation(e),c=i.graveyardPosition._getTransformedByMoveOperation(e),u=c.path.slice();u.push(0);const h=new K(c.root,u);return[new Fe(a,i.howMany,h,0)]}i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)}const s=i.splitPosition.isEqual(e.targetPosition);if(s&&(t.baRelation=="insertAtSource"||t.abRelation=="splitBefore"))return i.howMany+=e.howMany,i.splitPosition=i.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),[i];if(s&&t.abRelation&&t.abRelation.howMany){const{howMany:o,offset:a}=t.abRelation;return i.howMany+=o,i.splitPosition=i.splitPosition.getShiftedBy(a),[i]}if(i.splitPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.splitPosition)){const o=e.howMany-(i.splitPosition.offset-e.sourcePosition.offset);return i.howMany-=o,i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany),i.splitPosition=e.sourcePosition.clone(),i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),[i]}return e.sourcePosition.isEqual(e.targetPosition)||(i.splitPosition.hasSameParentAs(e.sourcePosition)&&i.splitPosition.offset<=e.sourcePosition.offset&&(i.howMany-=e.howMany),i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany)),i.splitPosition.stickiness="toNone",i.splitPosition=i.splitPosition._getTransformedByMoveOperation(e),i.splitPosition.stickiness="toNext",i.graveyardPosition?i.insertionPosition=i.insertionPosition._getTransformedByMoveOperation(e):i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),[i]});Me(Ye,Ye,(i,e,t)=>{if(i.splitPosition.isEqual(e.splitPosition)){if(!i.graveyardPosition&&!e.graveyardPosition)return[new Vt(0)];if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition))return[new Vt(0)];if(t.abRelation=="splitBefore")return i.howMany=0,i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e),[i]}if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition)){const n=i.splitPosition.root.rootName=="$graveyard",s=e.splitPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const u=[];return e.howMany&&u.push(new Fe(e.moveTargetPosition,e.howMany,e.splitPosition,0)),i.howMany&&u.push(new Fe(i.splitPosition,i.howMany,i.moveTargetPosition,0)),u}else return[new Vt(0)]}if(i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e)),i.splitPosition.isEqual(e.insertionPosition)&&t.abRelation=="splitBefore")return i.howMany++,[i];if(e.splitPosition.isEqual(i.insertionPosition)&&t.baRelation=="splitBefore"){const n=e.insertionPosition.path.slice();n.push(0);const s=new K(e.insertionPosition.root,n),o=new Fe(i.insertionPosition,1,s,0);return[i,o]}return i.splitPosition.hasSameParentAs(e.splitPosition)&&i.splitPosition.offset<e.splitPosition.offset&&(i.howMany-=e.howMany),i.splitPosition=i.splitPosition._getTransformedBySplitOperation(e),i.insertionPosition=Ye.getInsertionPosition(i.splitPosition),[i]});function tC(i,e){return i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)===null}function ha(i,e){const t=[];for(let n=0;n<i.length;n++){const s=i[n],o=new Fe(s.start,s.end.offset-s.start.offset,e,0);t.push(o);for(let a=n+1;a<i.length;a++)i[a]=i[a]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];e=e._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return t}class wt extends Je(K){constructor(e,t,n="toNone"){if(super(e,t,n),!this.root.is("rootElement"))throw new E("model-liveposition-root-not-rootelement",e);gM.call(this)}detach(){this.stopListening()}toPosition(){return new K(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}wt.prototype.is=function(i){return i==="livePosition"||i==="model:livePosition"||i=="position"||i==="model:position"};function gM(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&pM.call(this,t)},{priority:"low"})}function pM(i){const e=this.getTransformedByOperation(i);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}class Xr{operations;isUndoable;isLocal;isUndo;isTyping;constructor(e={}){typeof e=="string"&&(e=e==="transparent"?{isUndoable:!1}:{},Be("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:n=!0,isUndo:s=!1,isTyping:o=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=n,this.isUndo=s,this.isTyping=o}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.isDocumentOperation&&(e.batch=this,this.operations.push(e)),e}}class sh{static _statesPriority=[void 0,"refresh","rename","move"];_markerCollection;_changesInElement=new Map;_elementsSnapshots=new Map;_elementChildrenSnapshots=new Map;_elementState=new Map;_changedMarkers=new Map;_changedRoots=new Map;_changeCount=0;_cachedChanges=null;_cachedChangesWithGraveyard=null;_refreshedItems=new Set;constructor(e){this._markerCollection=e}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(e){const t=e;switch(t.type){case"insert":{if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const n of t.range.getItems({shallow:!0}))this._isInInsertedElement(n.parent)||this._markAttribute(n);break}case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const n=this._isInInsertedElement(t.sourcePosition.parent),s=this._isInInsertedElement(t.targetPosition.parent);n||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),s||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);const o=F._createFromPositionAndShift(t.sourcePosition,t.howMany);for(const a of o.getItems({shallow:!0}))this._setElementState(a,"move");break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const n=F._createFromPositionAndShift(t.position,1);for(const s of this._markerCollection.getMarkersIntersectingRange(n)){const o=s.getData();this.bufferMarkerChange(s.name,o,o)}this._setElementState(t.position.nodeAfter,"rename");break}case"split":{const n=t.splitPosition.parent;if(!this._isInInsertedElement(n)){this._markRemove(n,t.splitPosition.offset,t.howMany);const s=F._createFromPositionAndShift(t.splitPosition,t.howMany);for(const o of s.getItems({shallow:!0}))this._setElementState(o,"move")}this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&(this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1),this._setElementState(t.graveyardPosition.nodeAfter,"move"));break}case"merge":{const n=t.sourcePosition.parent;this._isInInsertedElement(n.parent)||this._markRemove(n.parent,n.startOffset,1);const s=t.graveyardPosition.parent;this._markInsert(s,t.graveyardPosition.offset,1),this._setElementState(n,"move");const o=t.targetPosition.parent;if(!this._isInInsertedElement(o)){this._markInsert(o,t.targetPosition.offset,n.maxOffset);const a=F._createFromPositionAndShift(t.sourcePosition,t.howMany);for(const c of a.getItems({shallow:!0}))this._setElementState(c,"move")}break}case"detachRoot":case"addRoot":{const n=t.affectedSelectable;if(!n._isLoaded||n.isAttached()==t.isAdd)return;this._bufferRootStateChange(t.rootName,t.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!t.root._isLoaded)return;const n=t.root.rootName;this._bufferRootAttributeChange(n,t.key,t.oldValue,t.newValue);break}}this._cachedChanges=null}bufferMarkerChange(e,t,n){t.range&&t.range.root.is("rootElement")&&!t.range.root._isLoaded&&(t.range=null),n.range&&n.range.root.is("rootElement")&&!n.range.root._isLoaded&&(n.range=null);let s=this._changedMarkers.get(e);s?s.newMarkerData=n:(s={newMarkerData:n,oldMarkerData:t},this._changedMarkers.set(e,s)),s.oldMarkerData.range==null&&n.range==null&&this._changedMarkers.delete(e)}getMarkersToRemove(){const e=[];for(const[t,n]of this._changedMarkers)n.oldMarkerData.range!=null&&e.push({name:t,range:n.oldMarkerData.range});return e}getMarkersToAdd(){const e=[];for(const[t,n]of this._changedMarkers)n.newMarkerData.range!=null&&e.push({name:t,range:n.newMarkerData.range});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(([e,t])=>({name:e,data:{oldRange:t.oldMarkerData.range,newRange:t.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:e,oldMarkerData:t}of this._changedMarkers.values()){if(e.affectsData!==t.affectsData)return!0;if(e.affectsData){const n=e.range&&!t.range,s=!e.range&&t.range,o=e.range&&t.range&&!e.range.isEqual(t.range);if(n||s||o)return!0}}return!1}getChanges(e={}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const n of this._changesInElement.keys()){const s=this._changesInElement.get(n).sort((m,g)=>m.offset===g.offset?m.type!=g.type?m.type=="remove"?-1:1:0:m.offset<g.offset?-1:1),o=this._elementChildrenSnapshots.get(n),a=iC(n.getChildren()),c=bM(o.length,s);let u=0,h=0;for(const m of c)if(m==="i"){const g=this._getDiffActionForNode(a[u].node,"insert"),w=this._elementsSnapshots.get(a[u].node),_=this._getInsertDiff(n,u,g,a[u],w);t.push(_),u++}else if(m==="r"){const g=this._getDiffActionForNode(o[h].node,"remove"),w=this._getRemoveDiff(n,u,g,o[h]);t.push(w),h++}else if(m==="a"){const g=o[h].attributes,w=a[u].attributes;let _;if(a[u].name=="$text")_=new F(K._createAt(n,u),K._createAt(n,u+1));else{const C=n.offsetToIndex(u);_=new F(K._createAt(n,u),K._createAt(n.getChild(C),0))}const v=this._getAttributesDiff(_,g,w);t.push(...v),u++,h++}else u++,h++}t.sort((n,s)=>n.position.root!=s.position.root?n.position.root.rootName<s.position.root.rootName?-1:1:n.position.isEqual(s.position)?n.changeCount-s.changeCount:n.position.isBefore(s.position)?-1:1);for(let n=1,s=0;n<t.length;n++){const o=t[s],a=t[n],c=o.type=="remove"&&a.type=="remove"&&o.name=="$text"&&a.name=="$text"&&o.position.isEqual(a.position),u=o.type=="insert"&&a.type=="insert"&&o.name=="$text"&&a.name=="$text"&&o.position.parent==a.position.parent&&o.position.offset+o.length==a.position.offset,h=o.type=="attribute"&&a.type=="attribute"&&o.position.parent==a.position.parent&&o.range.isFlat&&a.range.isFlat&&o.position.offset+o.length==a.position.offset&&o.attributeKey==a.attributeKey&&o.attributeOldValue==a.attributeOldValue&&o.attributeNewValue==a.attributeNewValue;c||u||h?(o.length++,h&&(o.range.end=o.range.end.getShiftedBy(1)),t[n]=null):s=n}t=t.filter(n=>n);for(const n of t)delete n.changeCount,n.type=="attribute"&&(delete n.position,delete n.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t,this._cachedChanges=t.filter(wM),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(e=>{const t={...e};return t.state!==void 0&&delete t.attributes,t})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e),this._setElementState(e,"refresh");const t=F._createOn(e);for(const n of this._markerCollection.getMarkersIntersectingRange(t)){const s=n.getData();this.bufferMarkerChange(n.name,s,s)}this._cachedChanges=null}_bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);for(const t of e.getAttributeKeys())this._bufferRootAttributeChange(e.rootName,t,null,e.getAttribute(t));for(const t of this._markerCollection)if(t.getRange().root==e){const n=t.getData();this.bufferMarkerChange(t.name,{...n,range:null},n)}}}_bufferRootStateChange(e,t){if(!this._changedRoots.has(e)){this._changedRoots.set(e,{name:e,state:t?"attached":"detached"});return}const n=this._changedRoots.get(e);n.state!==void 0?(delete n.state,n.attributes===void 0&&this._changedRoots.delete(e)):n.state=t?"attached":"detached"}_bufferRootAttributeChange(e,t,n,s){const o=this._changedRoots.get(e)||{name:e},a=o.attributes||{};if(a[t]){const c=a[t];s===c.oldValue?delete a[t]:c.newValue=s}else a[t]={oldValue:n,newValue:s};Object.entries(a).length===0?(delete o.attributes,o.state===void 0&&this._changedRoots.delete(e)):(o.attributes=a,this._changedRoots.set(e,o))}_markInsert(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"insert",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s)}_markRemove(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"remove",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s),this._removeAllNestedChanges(e,t,n)}_markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshots(e);const n=this._getChangesForElement(e);this._handleChange(t,n),n.push(t);for(let s=0;s<n.length;s++)n[s].howMany<1&&(n.splice(s,1),s--)}_setElementState(e,t){if(!e.is("element"))return;const n=sh._statesPriority.indexOf(this._elementState.get(e));sh._statesPriority.indexOf(t)>n&&this._elementState.set(e,t)}_getDiffActionForNode(e,t){if(!e.is("element")||!this._elementsSnapshots.has(e))return t;const n=this._elementState.get(e);return!n||n=="move"?t:n}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshots(e){if(this._elementChildrenSnapshots.has(e))return;const t=iC(e.getChildren());this._elementChildrenSnapshots.set(e,t);for(const n of t)this._elementsSnapshots.set(n.node,n)}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const n of t){const s=e.offset+e.howMany,o=n.offset+n.howMany;if(e.type=="insert"&&(n.type=="insert"&&(e.offset<=n.offset?n.offset+=e.howMany:e.offset<o&&(n.howMany+=e.nodesToHandle,e.nodesToHandle=0)),n.type=="remove"&&e.offset<n.offset&&(n.offset+=e.howMany),n.type=="attribute")){if(e.offset<=n.offset)n.offset+=e.howMany;else if(e.offset<o){const a=n.howMany;n.howMany=e.offset-n.offset,t.unshift({type:"attribute",offset:s,howMany:a-n.howMany,count:this._changeCount++})}}if(e.type=="remove"){if(n.type=="insert"){if(s<=n.offset)n.offset-=e.howMany;else if(s<=o)if(e.offset<n.offset){const a=s-n.offset;n.offset=e.offset,n.howMany-=a,e.nodesToHandle-=a}else n.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=n.offset)e.nodesToHandle-=n.howMany,n.howMany=0;else if(e.offset<o){const a=o-e.offset;n.howMany-=a,e.nodesToHandle-=a}}if(n.type=="remove"&&(s<=n.offset?n.offset-=e.howMany:e.offset<n.offset&&(e.nodesToHandle+=n.howMany,n.howMany=0)),n.type=="attribute"){if(s<=n.offset)n.offset-=e.howMany;else if(e.offset<n.offset){const a=s-n.offset;n.offset=e.offset,n.howMany-=a}else if(e.offset<o)if(s<=o){const a=n.howMany;n.howMany=e.offset-n.offset;const c=a-n.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:c,count:this._changeCount++})}else n.howMany-=o-e.offset}}if(e.type=="attribute"){if(n.type=="insert")if(e.offset<n.offset&&s>n.offset){if(s>o){const a={type:"attribute",offset:o,howMany:s-o,count:this._changeCount++};this._handleChange(a,t),t.push(a)}e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=n.offset&&e.offset<o&&(s>o?(e.nodesToHandle=s-o,e.offset=o):e.nodesToHandle=0);if(n.type=="remove"&&e.offset<n.offset&&s>n.offset){const a={type:"attribute",offset:n.offset,howMany:s-n.offset,count:this._changeCount++};this._handleChange(a,t),t.push(a),e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}n.type=="attribute"&&(e.offset>=n.offset&&s<=o?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=n.offset&&s>=o&&(n.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,n,s,o){const a={type:"insert",position:K._createAt(e,t),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++,action:n};return n!="insert"&&o&&(a.before={name:o.name,attributes:new Map(o.attributes)}),a}_getRemoveDiff(e,t,n,s){return{type:"remove",action:n,position:K._createAt(e,t),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,n){const s=[];n=new Map(n);for(const[o,a]of t){const c=n.has(o)?n.get(o):null;c!==a&&s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:a,attributeNewValue:c,changeCount:this._changeCount++}),n.delete(o)}for(const[o,a]of n)s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:a,changeCount:this._changeCount++});return s}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const n=this._changesInElement.get(t),s=e.startOffset;if(n){for(const o of n)if(o.type=="insert"&&s>=o.offset&&s<o.offset+o.howMany)return!0}return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,n){const s=new F(K._createAt(e,t),K._createAt(e,t+n));for(const o of s.getItems({shallow:!0}))o.is("element")&&(this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}}function nC(i){return{node:i,name:i.is("$text")?"$text":i.name,attributes:new Map(i.getAttributes())}}function iC(i){const e=[];for(const t of i)if(t.is("$text"))for(let n=0;n<t.data.length;++n)e.push(nC(t));else e.push(nC(t));return e}function bM(i,e){const t=[];let n=0,s=0;for(const o of e){if(o.offset>n){for(let a=0;a<o.offset-n;a++)t.push("e");s+=o.offset-n}if(o.type=="insert"){for(let a=0;a<o.howMany;a++)t.push("i");n=o.offset+o.howMany}else if(o.type=="remove"){for(let a=0;a<o.howMany;a++)t.push("r");n=o.offset,s+=o.howMany}else{if(o.howMany>1500)for(let a=0;a<o.howMany;a++)t.push("a");else t.push(..."a".repeat(o.howMany).split(""));n=o.offset+o.howMany,s+=o.howMany}}if(s<i)for(let o=0;o<i-s-n;o++)t.push("e");return t}function wM(i){const e="position"in i&&i.position.root.rootName=="$graveyard",t="range"in i&&i.range.root.rootName=="$graveyard";return!e&&!t}class _M{_operations=[];_undoPairs=new Map;_undoneOperations=new Set;_baseVersionToOperationIndex=new Map;_version=0;_gaps=new Map;get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new E("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const n=this._operations[0];e===void 0&&(e=n.baseVersion);let s=t-1;for(const[c,u]of this._gaps)e>c&&e<u&&(e=u),s>c&&s<u&&(s=c-1);if(s<n.baseVersion||e>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(e);o===void 0&&(o=0);let a=this._baseVersionToOperationIndex.get(s);return a===void 0&&(a=this._operations.length-1),this._operations.slice(o,a+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(t!==void 0)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}class oh extends Xe{rootName;_document;_isAttached=!0;_isLoaded=!0;constructor(e,t,n="main"){super(t),this._document=e,this.rootName=n}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}oh.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"):i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"||i==="node"||i==="model:node"};const sC="$graveyard";class yM extends Je(){model;history;selection;roots;differ;isReadOnly;_postFixers;_hasSelectionChangedFromTheLastChangeBlock;constructor(e){super(),this.model=e,this.history=new _M,this.selection=new kn(this),this.roots=new Dt({idProperty:"rootName"}),this.differ=new sh(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",sC),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.differ.bufferOperation(s)},{priority:"high"}),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.history.addOperation(s)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(t,n,s,o,a)=>{const c={...n.getData(),range:o};this.differ.bufferMarkerChange(n.name,a,c),s===null&&n.on("change",(u,h)=>{const m=n.getData();this.differ.bufferMarkerChange(n.name,{...m,range:h},m)})}),this.registerPostFixer(t=>{let n=!1;for(const s of this.roots)!s.isAttached()&&!s.isEmpty&&(t.remove(t.createRangeIn(s)),n=!0);for(const s of this.model.markers)s.getRange().root.isAttached()||(t.removeMarker(s),n=!0);return n})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(sC)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new E("model-document-createroot-name-exists",this,{name:t});const n=new oh(this,e,t);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(t=>t.rootName)}getRoots(e=!1){return this.roots.filter(t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=Y3(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,n=t.schema,s=t.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(s)||t.createRange(s)}_validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&oC(e.start)&&oC(e.end)}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(this.selection.refresh(),t=n(e),t)break;while(t)}}function oC(i){const e=i.textNode;if(e){const t=e.data,n=i.offset-e.startOffset;return!Jb(t,n)&&!Qb(t,n)}return!0}class vM extends Je(){_markers=new Map;[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof ra?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,n=!1,s=!1){const o=e instanceof ra?e.name:e;if(o.includes(","))throw new E("markercollection-incorrect-marker-name",this);const a=this._markers.get(o);if(a){const h=a.getData(),m=a.getRange();let g=!1;return m.isEqual(t)||(a._attachLiveRange(wn.fromRange(t)),g=!0),n!=a.managedUsingOperations&&(a._managedUsingOperations=n,g=!0),typeof s=="boolean"&&s!=a.affectsData&&(a._affectsData=s,g=!0),g&&this.fire(`update:${o}`,a,m,t,h),a}const c=wn.fromRange(t),u=new ra(o,c,n,s);return this._markers.set(o,u),this.fire(`update:${o}`,u,null,t,{...u.getData(),range:null}),u}_remove(e){const t=e instanceof ra?e.name:e,n=this._markers.get(t);return n?(this._markers.delete(t),this.fire(`update:${t}`,n,n.getRange(),null,n.getData()),this._destroyMarker(n),!0):!1}_refresh(e){const t=e instanceof ra?e.name:e,n=this._markers.get(t);if(!n)throw new E("markercollection-refresh-marker-not-exists",this);const s=n.getRange();this.fire(`update:${t}`,n,s,s,n.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)t.getRange().getIntersection(e)!==null&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class ra extends Je(ho){name;_managedUsingOperations;_affectsData;_liveRange;constructor(e,t,n,s){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=n,this._affectsData=s}get managedUsingOperations(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new E("marker-destroyed",this);return this._liveRange.toRange()}toJSON(){return{name:this.name,range:this._liveRange?.toJSON(),usingOperations:this._managedUsingOperations,affectsData:this._affectsData}}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}ra.prototype.is=function(i){return i==="marker"||i==="model:marker"};class CM extends Fn{sourcePosition;howMany;constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new E("detach-operation-on-document-node",this)}_execute(){LS(F._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Ri extends ho{markers=new Map;_children=new Zl;constructor(e){super(),e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const n of e)t=t.getChildAtOffset(n);return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const n of e)n.name?t.push(Xe.fromJSON(n)):t.push(et.fromJSON(n));return new Ri(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=kM(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const t of e)t.parent=null}}Ri.prototype.is=function(i){return i==="documentFragment"||i==="model:documentFragment"};function kM(i){return typeof i=="string"?[new et(i)]:(Dn(i)||(i=[i]),Array.from(i).map(e=>typeof e=="string"?new et(e):e instanceof pi?new et(e.data,e.getAttributes()):e))}class TM{model;batch;constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new et(e,t)}createElement(e,t){return new Xe(e,t)}createDocumentFragment(){return new Ri}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,n=0){if(this._assertWriterUsedCorrectly(),e instanceof et&&e.data=="")return;const s=K._createAt(t,n);if(e.parent)if(lC(e.root,s.root)){this.move(F._createOn(e),s);return}else{if(e.root.document)throw new E("model-writer-insert-forbidden-move",this);this.remove(e)}const o=s.root.document?s.root.document.version:null,a=e instanceof Ri?e._removeChildren(0,e.childCount):e,c=new Lt(s,a,o);if(e instanceof et&&(c.shouldReceiveAttributes=!0),this.batch.addOperation(c),this.model.applyOperation(c),e instanceof Ri)for(const[u,h]of e.markers){const m=K._createAt(h.root,0),w={range:new F(h.start._getCombined(m,s),h.end._getCombined(m,s)),usingOperation:!0,affectsData:!0};this.model.markers.has(u)?this.updateMarker(u,w):this.addMarker(u,w)}}insertText(e,t,n,s){t instanceof Ri||t instanceof Xe||t instanceof K?this.insert(this.createText(e),t,n):this.insert(this.createText(e,t),n,s)}insertElement(e,t,n,s){t instanceof Ri||t instanceof Xe||t instanceof K?this.insert(this.createElement(e),t,n):this.insert(this.createElement(e,t),n,s)}append(e,t){this.insert(e,t,"end")}appendText(e,t,n){t instanceof Ri||t instanceof Xe?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),n,"end")}appendElement(e,t,n){t instanceof Ri||t instanceof Xe?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),n,"end")}setAttribute(e,t,n){if(this._assertWriterUsedCorrectly(),n instanceof F){const s=n.getMinimalFlatRanges();for(const o of s)rC(this,e,t,o)}else aC(this,e,t,n)}setAttributes(e,t){for(const[n,s]of Ss(e))this.setAttribute(n,s,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof F){const n=t.getMinimalFlatRanges();for(const s of n)rC(this,e,null,s)}else aC(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=n=>{for(const s of n.getAttributeKeys())this.removeAttribute(s,n)};if(!(e instanceof F))t(e);else for(const n of e.getItems())t(n)}move(e,t,n){if(this._assertWriterUsedCorrectly(),!(e instanceof F))throw new E("writer-move-invalid-range",this);if(!e.isFlat)throw new E("writer-move-range-not-flat",this);const s=K._createAt(t,n);if(s.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!lC(e.root,s.root))throw new E("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,a=new Fe(e.start,e.end.offset-e.start.offset,s,o);this.batch.addOperation(a),this.model.applyOperation(a)}remove(e){this._assertWriterUsedCorrectly();const n=(e instanceof F?e:F._createOn(e)).getMinimalFlatRanges().reverse();for(const s of n)this._addOperationForAffectedMarkers("move",s),EM(s.start,s.end.offset-s.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,n=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Xe))throw new E("writer-merge-no-element-before",this);if(!(n instanceof Xe))throw new E("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,n){return this.model.createPositionFromPath(e,t,n)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,n=e.nodeAfter;this.move(F._createIn(n),K._createAt(t,"end")),this.remove(n)}_merge(e){const t=K._createAt(e.nodeBefore,"end"),n=K._createAt(e.nodeAfter,0),s=e.root.document.graveyard,o=new K(s,[0]),a=e.root.document.version,c=new gt(n,e.nodeAfter.maxOffset,t,o,a);this.batch.addOperation(c),this.model.applyOperation(c)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Xe))throw new E("writer-rename-not-element-instance",this);const n=e.root.document?e.root.document.version:null,s=new _n(K._createBefore(e),e.name,t,n);this.batch.addOperation(s),this.model.applyOperation(s)}split(e,t){this._assertWriterUsedCorrectly();let n=e.parent;if(!n.parent)throw new E("writer-split-element-no-parent",this);if(t||(t=n.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new E("writer-split-invalid-limit-element",this);let s,o;do{const a=n.root.document?n.root.document.version:null,c=n.maxOffset-e.offset,u=Ye.getInsertionPosition(e),h=new Ye(e,c,u,null,a);this.batch.addOperation(h),this.model.applyOperation(h),!s&&!o&&(s=n,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),n=e.parent}while(n!==t);return{position:e,range:new F(K._createAt(s,"end"),K._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new E("writer-wrap-range-not-flat",this);const n=t instanceof Xe?t:new Xe(t);if(n.childCount>0)throw new E("writer-wrap-element-not-empty",this);if(n.parent!==null)throw new E("writer-wrap-element-attached",this);this.insert(n,e.start);const s=new F(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(s,K._createAt(n,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new E("writer-unwrap-element-no-parent",this);this.move(F._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||typeof t.usingOperation!="boolean")throw new E("writer-addmarker-no-usingoperation",this);const n=t.usingOperation,s=t.range,o=t.affectsData===void 0?!1:t.affectsData;if(this.model.markers.has(e))throw new E("writer-addmarker-marker-exists",this);if(!s)throw new E("writer-addmarker-no-range",this);return n?(Rl(this,e,null,s,o),this.model.markers.get(e)):this.model.markers._set(e,s,n,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const n=typeof e=="string"?e:e.name,s=this.model.markers.get(n);if(!s)throw new E("writer-updatemarker-marker-not-exists",this);if(!t){Be("writer-updatemarker-reconvert-using-editingcontroller",{markerName:n}),this.model.markers._refresh(s);return}const o=typeof t.usingOperation=="boolean",a=typeof t.affectsData=="boolean",c=a?t.affectsData:s.affectsData;if(!o&&!t.range&&!a)throw new E("writer-updatemarker-wrong-options",this);const u=s.getRange(),h=t.range?t.range:u;if(o&&t.usingOperation!==s.managedUsingOperations){t.usingOperation?Rl(this,n,null,h,c):(Rl(this,n,u,null,c),this.model.markers._set(n,h,void 0,c));return}s.managedUsingOperations?Rl(this,n,u,h,c):this.model.markers._set(n,h,void 0,c)}removeMarker(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?e:e.name;if(!this.model.markers.has(t))throw new E("writer-removemarker-no-marker",this);const n=this.model.markers.get(t);if(!n.managedUsingOperations){this.model.markers._remove(t);return}const s=n.getRange();Rl(this,t,s,null,n.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const n=this.model.document.getRoot(e);if(n&&n.isAttached())throw new E("writer-addroot-root-exists",this);const s=this.model.document,o=new Mi(e,t,!0,s,s.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new E("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===t&&this.removeMarker(o);for(const o of t.getAttributeKeys())this.removeAttribute(o,t);this.remove(this.createRangeIn(t));const n=this.model.document,s=new Mi(t.rootName,t.name,!1,n,n.version);this.batch.addOperation(s),this.model.applyOperation(s)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,t);else for(const[n,s]of Ss(e))this._setSelectionAttribute(n,s)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const s=kn._getStoreAttributeKey(e);this.setAttribute(s,t,n.anchor.parent)}n._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const n=kn._getStoreAttributeKey(e);this.removeAttribute(n,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new E("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const s=n.getRange();let o=!1;if(e==="move"){const a=t;o=a.containsPosition(s.start)||a.start.isEqual(s.start)||a.containsPosition(s.end)||a.end.isEqual(s.end)}else{const a=t,c=a.nodeBefore,u=a.nodeAfter,h=s.start.parent==c&&s.start.isAtEnd,m=s.end.parent==u&&s.end.offset==0,g=s.end.nodeAfter==u,w=s.start.nodeAfter==u;o=h||m||g||w}o&&this.updateMarker(n.name,{range:s})}}}function rC(i,e,t,n){const s=i.model,o=s.document;let a=n.start,c,u,h;for(const g of n.getWalker({shallow:!0}))h=g.item.getAttribute(e),c&&u!=h&&(u!=t&&m(),a=c),c=g.nextPosition,u=h;c instanceof K&&c!=a&&u!=t&&m();function m(){const g=new F(a,c),w=g.root.document?o.version:null,_=new yt(g,e,u,t,w);i.batch.addOperation(_),s.applyOperation(_)}}function aC(i,e,t,n){const s=i.model,o=s.document,a=n.getAttribute(e);let c,u;if(a!=t){if(n.root===n){const m=n.document?o.version:null;u=new vs(n,e,a,t,m)}else{c=new F(K._createBefore(n),i.createPositionAfter(n));const m=c.root.document?o.version:null;u=new yt(c,e,a,t,m)}i.batch.addOperation(u),s.applyOperation(u)}}function Rl(i,e,t,n,s){const o=i.model,a=o.document,c=new sn(e,t,n,o.markers,!!s,a.version);i.batch.addOperation(c),o.applyOperation(c)}function EM(i,e,t,n){let s;if(i.root.document){const o=n.document,a=new K(o.graveyard,[0]);s=new Fe(i,e,a,o.version)}else s=new CM(i,e);t.addOperation(s),n.applyOperation(s)}function lC(i,e){return i===e||i instanceof oh&&e instanceof oh}function SM(i){i.document.registerPostFixer(e=>AM(e,i))}function AM(i,e){const t=e.document.selection,n=e.schema,s=[];let o=!1;for(const a of t.getRanges()){const c=rw(a,n);c&&!c.isEqual(a)?(s.push(c),o=!0):s.push(a)}return o&&i.setSelection(RM(s),{backward:t.isBackward}),!1}function rw(i,e){return i.isCollapsed?xM(i,e):IM(i,e)}function xM(i,e){const t=i.start,n=e.getNearestSelectionRange(t);if(!n){const o=t.getAncestors().reverse().find(a=>e.isObject(a));return o?F._createOn(o):null}if(!n.isCollapsed)return n;const s=n.start;return t.isEqual(s)?null:new F(s)}function IM(i,e){const{start:t,end:n}=i,s=e.checkChild(t,"$text"),o=e.checkChild(n,"$text"),a=e.getLimitElement(t),c=e.getLimitElement(n);if(a===c){if(s&&o)return null;if(PM(t,n,e)){const g=t.nodeAfter&&e.isSelectable(t.nodeAfter)?null:e.getNearestSelectionRange(t,"forward"),_=n.nodeBefore&&e.isSelectable(n.nodeBefore)?null:e.getNearestSelectionRange(n,"backward"),v=g?g.start:t,C=_?_.end:n;return new F(v,C)}}const u=a&&!a.is("rootElement"),h=c&&!c.is("rootElement");if(u||h){const m=t.nodeAfter&&n.nodeBefore&&t.nodeAfter.parent===n.nodeBefore.parent,g=u&&(!m||!uC(t.nodeAfter,e)),w=h&&(!m||!uC(n.nodeBefore,e));let _=t,v=n;return g&&(_=K._createBefore(cC(a,e))),w&&(v=K._createAfter(cC(c,e))),new F(_,v)}return null}function cC(i,e){let t=i,n=t;for(;e.isLimit(n)&&n.parent;)t=n,n=n.parent;return t}function PM(i,e,t){const n=i.nodeAfter&&!t.isLimit(i.nodeAfter)||t.checkChild(i,"$text"),s=e.nodeBefore&&!t.isLimit(e.nodeBefore)||t.checkChild(e,"$text");return n||s}function RM(i){const e=[...i],t=new Set;let n=1;for(;n<e.length;){const o=e[n],a=e.slice(0,n);for(const[c,u]of a.entries())if(!t.has(c)){if(o.isEqual(u))t.add(c);else if(o.isIntersecting(u)){t.add(c),t.add(n);const h=o.getJoined(u);e.push(h)}}n++}return e.filter((o,a)=>!t.has(a))}function uC(i,e){return i&&e.isSelectable(i)}function OM(i,e,t={}){if(e.isCollapsed)return;const n=e.getFirstRange();if(n.root.rootName=="$graveyard")return;const s=i.schema;i.change(o=>{if(!t.doNotResetEntireContent&&UM(s,e)){zM(o,e);return}const a={};if(!t.doNotAutoparagraph){const h=e.getSelectedElement();h&&Object.assign(a,s.getAttributesWithProperty(h,"copyOnReplace",!0))}let c,u;t.doNotFixSelection?(c=wt.fromPosition(n.start,"toPrevious"),u=wt.fromPosition(n.end,"toNext")):[c,u]=VM(n),c.isTouching(u)||o.remove(o.createRange(c,u)),t.leaveUnmerged||(MM(o,c,u),s.removeDisallowedAttributes(c.parent.getChildren(),o)),qS(o,e,c),!t.doNotAutoparagraph&&DM(s,c)&&jS(o,c,e,a),c.detach(),u.detach()})}function VM(i){const e=i.root.document.model,t=i.start;let n=i.end;if(e.hasContent(i,{ignoreMarkers:!0})){const s=BM(n);if(s&&n.isTouching(e.createPositionAt(s,0))){const o=e.createSelection(i);e.modifySelection(o,{direction:"backward"});const a=o.getLastPosition(),c=e.createRange(a,n);e.hasContent(c,{ignoreMarkers:!0})||(n=a)}}return[wt.fromPosition(t,"toPrevious"),wt.fromPosition(n,"toNext")]}function BM(i){const e=i.parent,t=e.root.document.model.schema,n=e.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of n){if(t.isLimit(s))return null;if(t.isBlock(s))return s}}function MM(i,e,t){const n=i.model;if(!aw(i.model.schema,e,t))return;const[s,o]=LM(e,t);!s||!o||(!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(o,{ignoreMarkers:!0})?HS(i,e,t,s.parent):US(i,e,t,s.parent))}function US(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(o,e),i.merge(e);t.parent.isEmpty;){const a=t.parent;t=i.createPositionBefore(a),i.remove(a)}aw(i.model.schema,e,t)&&US(i,e,t,n)}}function HS(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(s,t);e.parent.isEmpty;){const a=e.parent;e=i.createPositionBefore(a),i.remove(a)}t=i.createPositionBefore(o),NM(i,t),aw(i.model.schema,e,t)&&HS(i,e,t,n)}}function NM(i,e){const t=e.nodeBefore,n=e.nodeAfter;t.name!=n.name&&i.rename(t,n.name),i.clearAttributes(t),i.setAttributes(Object.fromEntries(n.getAttributes()),t),i.merge(e)}function aw(i,e,t){const n=e.parent,s=t.parent;return n==s||i.isLimit(n)||i.isLimit(s)?!1:FM(e,t,i)}function LM(i,e){const t=i.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]&&t[s]==n[s];)s++;return[t[s],n[s]]}function DM(i,e){const t=i.checkChild(e,"$text"),n=i.checkChild(e,"paragraph");return!t&&n}function FM(i,e,t){const n=new F(i,e);for(const s of n.getWalker())if(t.isLimit(s.item))return!1;return!0}function jS(i,e,t,n={}){const s=i.createElement("paragraph");i.model.schema.setAllowedAttributes(s,n,i),i.insert(s,e),qS(i,t,i.createPositionAt(s,0))}function zM(i,e){const t=i.model.schema.getLimitElement(e);i.remove(i.createRangeIn(t)),jS(i,i.createPositionAt(t,0),e)}function UM(i,e){const t=i.getLimitElement(e);if(!e.containsEntireContent(t))return!1;const n=e.getFirstRange();return n.start.parent==n.end.parent?!1:i.checkChild(t,"paragraph")}function qS(i,e,t){e instanceof kn?i.setSelection(t):e.setTo(t)}function HM(i,e){return i.change(t=>{const n=t.createDocumentFragment(),s=e.getFirstRange();if(!s||s.isCollapsed)return n;const o=s.start.root,a=s.start.getCommonPath(s.end),c=o.getNodeByPath(a);let u;s.start.parent==s.end.parent?u=s:u=t.createRange(t.createPositionAt(c,s.start.path[a.length]),t.createPositionAt(c,s.end.path[a.length]+1));const h=u.end.offset-u.start.offset;for(const m of u.getItems({shallow:!0}))m.is("$textProxy")?t.appendText(m.data,m.getAttributes(),n):t.append(t.cloneElement(m,!0),n);if(u!=s){const m=s._getTransformedByMove(u.start,t.createPositionAt(n,0),h)[0],g=t.createRange(t.createPositionAt(n,0),m.start),w=t.createRange(m.end,t.createPositionAt(n,"end"));dC(w,t),dC(g,t)}return n})}function dC(i,e){const t=[];Array.from(i.getItems({direction:"backward"})).map(n=>e.createRangeOn(n)).filter(n=>(n.start.isAfter(i.start)||n.start.isEqual(i.start))&&(n.end.isBefore(i.end)||n.end.isEqual(i.end))).forEach(n=>{t.push(n.start.parent),e.remove(n)}),t.forEach(n=>{let s=n;for(;s.parent&&s.isEmpty;){const o=e.createRangeOn(s);s=s.parent,e.remove(o)}})}function jM(i,e,t){return i.change(n=>{const s=t||i.document.selection;s.isCollapsed||i.deleteContent(s,{doNotAutoparagraph:!0});const o=new qM(i,n,s.anchor),a=[];let c;if(e.is("documentFragment")){if(e.markers.size){const m=[];for(const[g,w]of e.markers){const{start:_,end:v}=w,C=_.isEqual(v);m.push({position:_,name:g,isCollapsed:C},{position:v,name:g,isCollapsed:C})}m.sort(({position:g},{position:w})=>g.isBefore(w)?1:-1);for(const{position:g,name:w,isCollapsed:_}of m){let v=null,C=null;const T=g.parent===e&&g.isAtStart,A=g.parent===e&&g.isAtEnd;!T&&!A?(v=n.createElement("$marker"),n.insert(v,g)):_&&(C=T?"start":"end"),a.push({name:w,element:v,collapsed:C})}}c=e.getChildren()}else c=[e];o.handleNodes(c);let u=o.getSelectionRange();if(e.is("documentFragment")&&a.length){const m=u?wn.fromRange(u):null,g={};for(let w=a.length-1;w>=0;w--){const{name:_,element:v,collapsed:C}=a[w],T=!g[_];if(T&&(g[_]=[]),v){const A=n.createPositionAt(v,"before");g[_].push(A),n.remove(v)}else{const A=o.getAffectedRange();if(!A){C&&g[_].push(o.position);continue}C?g[_].push(A[C]):g[_].push(T?A.start:A.end)}}for(const[w,[_,v]]of Object.entries(g))_&&v&&_.root===v.root&&_.root.document&&!n.model.markers.has(w)&&n.addMarker(w,{usingOperation:!0,affectsData:!0,range:new F(_,v)});m&&(u=m.toRange(),m.detach())}u&&(s instanceof kn?n.setSelection(u):s.setTo(u));const h=o.getAffectedRange()||i.createRange(s.anchor);return o.destroy(),h})}class qM{model;writer;position;canMergeWith;schema;_documentFragment;_documentFragmentPosition;_firstNode=null;_lastNode=null;_lastAutoParagraph=null;_filterAttributesAndChildrenOf=[];_affectedStart=null;_affectedEnd=null;_nodeToSelect=null;constructor(e,t,n){this.model=e,this.writer=t,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))t.offsetSize>0&&this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesAndChildrenOf,this.writer),this.model._config?.get("experimentalFlags.modelInsertContentDeepSchemaVerification")&&this._removeDisallowedChildren(this._filterAttributesAndChildrenOf),this._filterAttributesAndChildrenOf=[]}_removeDisallowedChildren(e){const t=Array.from(e);for(const n of t){if(!n.is("element"))continue;const s=[],o=[],a=this.writer.createRangeIn(n).getWalker({ignoreElementEnd:!0});for(const{item:c}of a){const u=c.parent;this.schema.checkChild(u,c)||(c.is("element")&&!this.schema.isObject(c)?(o.push(c),t.push(u)):s.push(c),a.jumpTo(this.writer.createPositionAfter(c)))}for(const c of o)this.writer.unwrap(c);for(const c of s)this.writer.remove(c)}}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),n=this.writer.createPositionAfter(e);if(n.isAfter(t)){this._lastNode=e;if(this.position.parent!=e||!this.position.isAtEnd)throw new E("insertcontent-invalid-insertion-position",this);this.position=n,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?F._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new F(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(!this._checkAndSplitToAllowedPosition(e)){this.schema.isObject(e)||this._handleDisallowedNode(e);return}e=this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=wt.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleDisallowedNode(e){e.is("element")&&this.handleNodes(e.getChildren())}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new E("insertcontent-wrong-position",this,{node:e,position:this.position});return this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),e.parent||(e=this._documentFragmentPosition.nodeBefore),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesAndChildrenOf.push(e),e}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=wt.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=wt.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Xe)||!this._canMergeLeft(e))return;const t=wt._createBefore(e);t.stickiness="toNext";const n=wt.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=wt._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=wt._createAt(t.nodeBefore,"end","toNext")),this.position=n.toPosition(),n.detach(),this._filterAttributesAndChildrenOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Xe)||!this._canMergeRight(e))return;const t=wt._createAfter(e);t.stickiness="toNext";if(!this.position.isEqual(t))throw new E("insertcontent-invalid-insertion-position",this);this.position=K._createAt(t.nodeBefore,"end");const n=wt.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=wt._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=wt._createAt(t.nodeBefore,0,"toPrevious")),this.position=n.toPosition(),n.detach(),this._filterAttributesAndChildrenOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Xe&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Xe&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_insertAutoParagraph(){this._insertPartialFragment();const e=this.writer.createElement("paragraph");this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0)}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const n=this.position.parent;this.position=this.writer.createPositionBefore(n),n.isEmpty&&n.parent===t&&this.writer.remove(n)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const n=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=n,this.canMergeWith.add(this.position.nodeAfter)}return this.schema.checkChild(this.position.parent,e)||this._insertAutoParagraph(),!0}_getAllowedIn(e,t){const n=this.schema.createContext(e);return this.schema.checkChild(n,t)||this.schema.checkChild(n,"paragraph")&&this.schema.checkChild(n.push("paragraph"),t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}function WM(i,e,t,n={}){if(!i.schema.isObject(e))throw new E("insertobject-element-not-an-object",i,{object:e});const s=t||i.document.selection;let o=s;n.findOptimalPosition&&i.schema.isBlock(e)&&(o=i.createSelection(i.schema.findOptimalInsertionRange(s,n.findOptimalPosition)));const a=Ze(s.getSelectedBlocks()),c={};return a&&Object.assign(c,i.schema.getAttributesWithProperty(a,"copyOnReplace",!0)),i.change(u=>{o.isCollapsed||i.deleteContent(o,{doNotAutoparagraph:!0});let h=e;const m=o.anchor.parent,g=i.schema.createContext(m);!i.schema.checkChild(g,e)&&i.schema.checkChild(g,"paragraph")&&i.schema.checkChild(g.push("paragraph"),e)&&(h=u.createElement("paragraph"),u.insert(e,h)),i.schema.setAllowedAttributes(h,c,u);const w=i.insertContent(h,o);return w.isCollapsed||n.setSelection&&$M(u,e,n.setSelection,c),w})}function $M(i,e,t,n){const s=i.model;if(t=="on"){i.setSelection(e,"on");return}if(t!="after")throw new E("insertobject-invalid-place-parameter-value",s);let o=e.nextSibling;if(s.schema.isInline(e)){i.setSelection(e,"after");return}!(o&&s.schema.checkChild(o,"$text"))&&s.schema.checkChild(e.parent,"paragraph")&&(o=i.createElement("paragraph"),s.schema.setAllowedAttributes(o,n,i),s.insertContent(o,i.createPositionAfter(e))),o&&i.setSelection(o,0)}const GM=' ,.?!:;"-()';function KM(i,e,t={}){const n=i.schema,s=t.direction!="backward",o=t.unit?t.unit:"character",a=!!t.treatEmojiAsSingleUnit,c=e.focus,u=new bs({boundaries:XM(c,s),singleCharacters:!0,direction:s?"forward":"backward"}),h={walker:u,schema:n,isForward:s,unit:o,treatEmojiAsSingleUnit:a};let m;for(;m=u.next();){if(m.done)return;const g=YM(h,m.value);if(g){e instanceof kn?i.change(w=>{w.setSelectionFocus(g)}):e.setFocus(g);return}}}function YM(i,e){const{isForward:t,walker:n,unit:s,schema:o,treatEmojiAsSingleUnit:a}=i,{type:c,item:u,nextPosition:h}=e;if(c=="text")return i.unit==="word"?QM(n,t):JM(n,s,a);if(c==(t?"elementStart":"elementEnd")){if(o.isSelectable(u))return K._createAt(u,t?"after":"before");if(o.checkChild(h,"$text"))return h}else{if(o.isLimit(u)){n.skip(()=>!0);return}if(o.checkChild(h,"$text"))return h}}function JM(i,e,t){const n=i.position.textNode;if(n){const s=n.data;let o=i.position.offset-n.startOffset;for(;Jb(s,o)||e=="character"&&Qb(s,o)||t&&eS(s,o);)i.next(),o=i.position.offset-n.startOffset}return i.position}function QM(i,e){let t=i.position.textNode;for(t||(t=e?i.position.nodeAfter:i.position.nodeBefore);t&&t.is("$text");){const n=i.position.offset-t.startOffset;if(e7(t,n,e))t=e?i.position.nodeAfter:i.position.nodeBefore;else{if(ZM(t.data,n,e))break;i.next()}}return i.position}function XM(i,e){const t=i.root,n=K._createAt(t,e?"end":0);return e?new F(i,n):new F(n,i)}function ZM(i,e,t){const n=e+(t?0:-1);return GM.includes(i.charAt(n))}function e7(i,e,t){return e===(t?i.offsetSize:0)}class t7 extends qe(){markers;document;schema;_config;_pendingChanges;_currentWriter;constructor(e){super(),this.markers=new vM,this.document=new yM(this),this.schema=new L4,this._config=e,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(t=>this.decorate(t)),this.on("applyOperation",(t,n)=>{n[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(()=>!0,"$marker"),SM(this),this.document.registerPostFixer(RS),this.on("insertContent",(t,[n,s])=>{t.return=jM(this,n,s)}),this.on("insertObject",(t,[n,s,o])=>{t.return=WM(this,n,s,o)}),this.on("canEditAt",t=>{const n=!this.document.isReadOnly;t.return=n,n||t.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Xr,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){E.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{e?typeof e=="function"?(t=e,e=new Xr):e instanceof Xr||(e=new Xr(e)):e=new Xr,this._pendingChanges.push({batch:e,callback:t}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(n){E.rethrowUnexpectedError(n,this)}}applyOperation(e){e._execute()}insertContent(e,t,n,...s){const o=Yg(t,n);return this.fire("insertContent",[e,o,n,...s])}insertObject(e,t,n,s,...o){const a=Yg(t,n);return this.fire("insertObject",[e,a,s,s,...o])}deleteContent(e,t){OM(this,e,t)}modifySelection(e,t){KM(this,e,t)}getSelectedContent(e){return HM(this,e)}hasContent(e,t={}){const n=e instanceof F?e:F._createIn(e);if(n.isCollapsed)return!1;const{ignoreWhitespaces:s=!1,ignoreMarkers:o=!1}=t;if(!o){for(const a of this.markers.getMarkersIntersectingRange(n))if(a.affectsData)return!0}for(const a of n.getItems())if(this.schema.isContent(a))if(a.is("$textProxy"))if(s){if(a.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const t=Yg(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,n){return new K(e,t,n)}createPositionAt(e,t){return K._createAt(e,t)}createPositionAfter(e){return K._createAfter(e)}createPositionBefore(e){return K._createBefore(e)}createRange(e,t){return new F(e,t)}createRangeIn(e){return F._createIn(e)}createRangeOn(e){return F._createOn(e)}createSelection(...e){return new Bn(...e)}createBatch(e){return new Xr(e)}createOperationFromJSON(e){return cM.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new TM(this,t);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}}function Yg(i,e){if(i)return i instanceof Bn||i instanceof kn?i:i instanceof ir?e||e===0?new Bn(i,e):i.is("rootElement")?new Bn(i,"in"):new Bn(i,"on"):new Bn(i)}class n7 extends Ci{domEventType="click";onDomEvent(e){this.fire(e.type,e)}}class lw extends Ci{domEventType=["mousedown","mouseup","mouseover","mouseout"];onDomEvent(e){this.fire(e.type,e)}}class i7 extends Ci{domEventType=["touchstart","touchend","touchmove"];onDomEvent(e){this.fire(e.type,e)}}class WS extends Ci{domEventType=["pointerdown","pointerup","pointermove"];onDomEvent(e){this.fire(e.type,e)}}class Hh{document;constructor(e){this.document=e}createDocumentFragment(e){return new $o(this.document,e)}createElement(e,t,n){return new yi(this.document,e,t,n)}createText(e){return new It(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,n){return n._insertChild(e,t)}removeChildren(e,t,n){return n._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const n=e.parent;if(n){const s=n.getChildIndex(e);return this.removeChildren(s,1,n),this.insertChild(s,t,n),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const n=t.getChildIndex(e);this.remove(e),this.insertChild(n,e.getChildren(),t)}}rename(e,t){const n=new yi(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,n)?n:null}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){Vi(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return Q._createAt(e,t)}createPositionAfter(e){return Q._createAfter(e)}createPositionBefore(e){return Q._createBefore(e)}createRange(e,t){return new ge(e,t)}createRangeOn(e){return ge._createOn(e)}createRangeIn(e){return ge._createIn(e)}createSelection(...e){return new bi(...e)}}const s7=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,o7=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,r7=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,a7=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,l7=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,c7=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,u7=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function $S(i){return i.startsWith("#")?s7.test(i):i.startsWith("rgb")?o7.test(i)||r7.test(i):i.startsWith("hsl")?a7.test(i)||l7.test(i):u7.has(i.toLowerCase())}const d7=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function h7(i){return d7.includes(i)}const f7=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function jh(i){return f7.test(i)}const m7=/^[+-]?[0-9]*([.][0-9]+)?%$/;function GS(i){return m7.test(i)}const g7=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function p7(i){return g7.includes(i)}const b7=["center","top","bottom","left","right"];function w7(i){return b7.includes(i)}const _7=["fixed","scroll","local"];function y7(i){return _7.includes(i)}const v7=/^url\(/;function C7(i){return v7.test(i)}function ec(i=""){if(i==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const e=cw(i),t=e[0],n=e[2]||t,s=e[1]||t,o=e[3]||s;return{top:t,bottom:n,right:s,left:o}}function tc(i){return e=>{const{top:t,right:n,bottom:s,left:o}=e,a=[];return[t,n,o,s].every(c=>!!c)?a.push([i,k7(e)]):(t&&a.push([i+"-top",t]),n&&a.push([i+"-right",n]),s&&a.push([i+"-bottom",s]),o&&a.push([i+"-left",o])),a}}function k7({top:i,right:e,bottom:t,left:n}){const s=[];return n!==e?s.push(i,e,t,n):t!==i?s.push(i,e,t):e!==i?s.push(i,e):s.push(i),s.join(" ")}function KS(i){return e=>({path:i,value:ec(e)})}function cw(i){const e=i.trim().slice(0,1500).matchAll(c7);return Array.from(e).map(t=>t[0])}function uw(i){i.setNormalizer("background",T7()),i.setNormalizer("background-color",E7()),i.setReducer("background",S7()),i.setStyleRelation("background",["background-color"])}function T7(){return i=>{const e={},t=cw(i);for(const n of t)p7(n)?(e.repeat=e.repeat||[],e.repeat.push(n)):w7(n)?(e.position=e.position||[],e.position.push(n)):y7(n)?e.attachment=n:$S(n)?e.color=n:C7(n)&&(e.image=n);return{path:"background",value:e}}}function E7(){return i=>({path:"background.color",value:i})}function S7(){return i=>{const e=[];return e.push(["background-color",i.color]),e}}function YS(i){i.setNormalizer("border",A7()),i.setNormalizer("border-top",hd("top")),i.setNormalizer("border-right",hd("right")),i.setNormalizer("border-bottom",hd("bottom")),i.setNormalizer("border-left",hd("left")),i.setNormalizer("border-color",Jg("color")),i.setNormalizer("border-width",Jg("width")),i.setNormalizer("border-style",Jg("style")),i.setNormalizer("border-top-color",ei("color","top")),i.setNormalizer("border-top-style",ei("style","top")),i.setNormalizer("border-top-width",ei("width","top")),i.setNormalizer("border-right-color",ei("color","right")),i.setNormalizer("border-right-style",ei("style","right")),i.setNormalizer("border-right-width",ei("width","right")),i.setNormalizer("border-bottom-color",ei("color","bottom")),i.setNormalizer("border-bottom-style",ei("style","bottom")),i.setNormalizer("border-bottom-width",ei("width","bottom")),i.setNormalizer("border-left-color",ei("color","left")),i.setNormalizer("border-left-style",ei("style","left")),i.setNormalizer("border-left-width",ei("width","left")),i.setExtractor("border-top",fd("top")),i.setExtractor("border-right",fd("right")),i.setExtractor("border-bottom",fd("bottom")),i.setExtractor("border-left",fd("left")),i.setExtractor("border-top-color","border.color.top"),i.setExtractor("border-right-color","border.color.right"),i.setExtractor("border-bottom-color","border.color.bottom"),i.setExtractor("border-left-color","border.color.left"),i.setExtractor("border-top-width","border.width.top"),i.setExtractor("border-right-width","border.width.right"),i.setExtractor("border-bottom-width","border.width.bottom"),i.setExtractor("border-left-width","border.width.left"),i.setExtractor("border-top-style","border.style.top"),i.setExtractor("border-right-style","border.style.right"),i.setExtractor("border-bottom-style","border.style.bottom"),i.setExtractor("border-left-style","border.style.left"),i.setReducer("border-color",tc("border-color")),i.setReducer("border-style",tc("border-style")),i.setReducer("border-width",tc("border-width")),i.setReducer("border-top",md("top")),i.setReducer("border-right",md("right")),i.setReducer("border-bottom",md("bottom")),i.setReducer("border-left",md("left")),i.setReducer("border",I7()),i.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),i.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),i.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),i.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),i.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),i.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function A7(){return i=>{const{color:e,style:t,width:n}=JS(i);return{path:"border",value:{color:ec(e),style:ec(t),width:ec(n)}}}}function hd(i){return e=>{const{color:t,style:n,width:s}=JS(e),o={};return t!==void 0&&(o.color={[i]:t}),n!==void 0&&(o.style={[i]:n}),s!==void 0&&(o.width={[i]:s}),{path:"border",value:o}}}function Jg(i){return e=>({path:"border",value:x7(e,i)})}function x7(i,e){return{[e]:ec(i)}}function ei(i,e){return t=>({path:"border",value:{[i]:{[e]:t}}})}function fd(i){return(e,t)=>{if(t.border)return jl(t.border,i)}}function jl(i,e){const t={};return i.width&&i.width[e]&&(t.width=i.width[e]),i.style&&i.style[e]&&(t.style=i.style[e]),i.color&&i.color[e]&&(t.color=i.color[e]),t}function JS(i){const e={},t=cw(i);for(const n of t)jh(n)||/thin|medium|thick/.test(n)?e.width=n:h7(n)?e.style=n:e.color=n;return e}function I7(){return e=>{const t=jl(e,"top"),n=jl(e,"right"),s=jl(e,"bottom"),o=jl(e,"left"),a=[t,n,s,o],c={width:i(a,"width"),style:i(a,"style"),color:i(a,"color")},u=aa(c,"all");return u.length?u:[...Object.entries(c).reduce((m,[g,w])=>(w&&(m.push([`border-${g}`,w]),a.forEach(_=>delete _[g])),m),[]),...aa(t,"top"),...aa(n,"right"),...aa(s,"bottom"),...aa(o,"left")]};function i(e,t){return e.map(n=>n[t]).reduce((n,s)=>n==s?n:null)}}function md(i){return e=>aa(e,i)}function aa(i,e){const t=[];if(i&&i.width&&t.push("width"),i&&i.style&&t.push("style"),i&&i.color&&t.push("color"),t.length==3){const n=t.map(s=>i[s]).join(" ");return[e=="all"?["border",n]:[`border-${e}`,n]]}return e=="all"?[]:t.map(n=>[`border-${e}-${n}`,i[n]])}function QS(i){i.setNormalizer("margin",KS("margin")),i.setNormalizer("margin-top",e=>({path:"margin.top",value:e})),i.setNormalizer("margin-right",e=>({path:"margin.right",value:e})),i.setNormalizer("margin-bottom",e=>({path:"margin.bottom",value:e})),i.setNormalizer("margin-left",e=>({path:"margin.left",value:e})),i.setReducer("margin",tc("margin")),i.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}function P7(i){i.setNormalizer("padding",KS("padding")),i.setNormalizer("padding-top",e=>({path:"padding.top",value:e})),i.setNormalizer("padding-right",e=>({path:"padding.right",value:e})),i.setNormalizer("padding-bottom",e=>({path:"padding.bottom",value:e})),i.setNormalizer("padding-left",e=>({path:"padding.left",value:e})),i.setReducer("padding",tc("padding")),i.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}class XS{crashes=[];state="initializing";_crashNumberLimit;_now=Date.now;_minimumNonErrorTimePeriod;_boundErrorHandler;_listeners;constructor(e){if(this.crashes=[],this._crashNumberLimit=typeof e.crashNumberLimit=="number"?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof e.minimumNonErrorTimePeriod=="number"?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const n="error"in t?t.error:t.reason;n instanceof Error&&this._handleError(n,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(n=>n!==t)}_fire(e,...t){const n=this._listeners[e]||[];for(const s of n)s.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&e.context!==void 0&&e.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const e=this.crashes[this.crashes.length-1].date,t=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(e-t)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}function Jp(i,e=new Set){const t=[i],n=new Set;let s=0;for(;t.length>s;){const o=t[s++];if(!(n.has(o)||!R7(o)||e.has(o)))if(n.add(o),Symbol.iterator in o)try{for(const a of o)t.push(a)}catch{}else for(const a in o)a!=="defaultValue"&&t.push(o[a])}return n}function R7(i){const e=Object.prototype.toString.call(i),t=typeof i;return!(t==="number"||t==="boolean"||t==="string"||t==="symbol"||t==="function"||e==="[object Date]"||e==="[object RegExp]"||e==="[object Module]"||i===void 0||i===null||i._watchdogExcluded||i instanceof EventTarget||i instanceof Event)}function ZS(i,e,t=new Set){if(i===e&&O7(i))return!0;const n=Jp(i,t),s=Jp(e,t);for(const o of n)if(s.has(o))return!0;return!1}function O7(i){return typeof i=="object"&&i!==null}class eA extends XS{_editor=null;_lifecyclePromise=null;_throttledSave;_data;_lastDocumentVersion;_elementOrData;_initUsingData=!0;_editables={};_config;_excludedProps;constructor(e,t={}){super(t),this._throttledSave=cc(this._save.bind(this),typeof t.saveInterval=="number"?t.saveInterval:5e3),e&&(this._creator=(n,s)=>e.create(n,s)),this._destructor=n=>n.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},t=[],n=this._config.rootsAttributes||{},s={};for(const[a,c]of Object.entries(this._data.roots))c.isLoaded?(e[a]="",s[a]=n[a]||{}):t.push(a);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:s,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(V7),this._initUsingData?this.create(e,o,o.context):ao(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,n){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(t)||{},this._config.context=n,this._creator(e,this._config))).then(s=>{this._editor=s,s.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=s.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter(c=>c.isAttached()&&c.rootName!="$graveyard"),{plugins:n}=e,s=n.has("CommentsRepository")&&n.get("CommentsRepository"),o=n.has("TrackChanges")&&n.get("TrackChanges"),a={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(c=>{a.roots[c.rootName]={content:JSON.stringify(Array.from(c.getChildren())),attributes:JSON.stringify(Array.from(c.getAttributes())),isLoaded:c._isLoaded}});for(const c of e.model.markers)c._affectsData&&(a.markers[c.name]={rangeJSON:c.getRange().toJSON(),usingOperation:c._managedUsingOperations,affectsData:c._affectsData});return s&&(a.commentThreads=JSON.stringify(s.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(a.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),a}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(t);n&&(e[t]=n)}return e}_isErrorComingFromThisItem(e){return ZS(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return Nh(e,(t,n)=>{if(ao(t)||n==="context")return t})}}class V7{editor;_data;constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},t=>{this._restoreCollaborationData(),this._restoreEditorData(t)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,t){if("name"in t){const n=e.createElement(t.name,t.attributes);if(t.children)for(const s of t.children)n._appendChild(this._createNode(e,s));return n}else return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach(([n,{content:s,attributes:o}])=>{const a=JSON.parse(s),c=JSON.parse(o),u=t.model.document.getRoot(n);for(const[h,m]of c)e.setAttribute(h,m,u);for(const h of a){const m=this._createNode(e,h);e.insert(m,u,"end")}}),Object.entries(this._data.markers).forEach(([n,s])=>{const{document:o}=t.model,{rangeJSON:{start:a,end:c},...u}=s,h=o.getRoot(a.root),m=e.createPositionFromPath(h,a.path,a.stickiness),g=e.createPositionFromPath(h,c.path,c.stickiness),w=e.createRange(m,g);e.addMarker(n,{range:w,...u})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);if(this.editor.plugins.has("CommentsRepository")){const n=this.editor.plugins.get("CommentsRepository");for(const s of n.getCommentThreads())n._removeCommentThread({threadId:s.id});e.forEach(s=>{const o=this.editor.config.get("collaboration.channelId");this.editor.plugins.get("CommentsRepository").addCommentThread({channelId:o,...s})})}if(this.editor.plugins.has("TrackChangesEditing")){const n=this.editor.plugins.get("TrackChangesEditing");for(const s of n.getSuggestions())n._removeSuggestion(s);t.forEach(s=>{n.addSuggestionData(s)})}}}const nc=Symbol("MainQueueId");class B7 extends XS{_watchdogs=new Map;_watchdogConfig;_context=null;_contextProps=new Set;_actionQueues=new M7;_contextConfig;_item;constructor(e,t={}){super(t),this._watchdogConfig=t,this._creator=n=>e.create(n),this._destructor=n=>n.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(nc,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=hC(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let s;if(this._watchdogs.has(n.id))throw new Error(`Item with the given id is already added: '${n.id}'.`);if(n.type==="editor")return s=new eA(null,this._watchdogConfig),s.setCreator(n.creator),s._setExcludedProperties(this._contextProps),n.destructor&&s.setDestructor(n.destructor),this._watchdogs.set(n.id,s),s.on("error",(o,{error:a,causesRestart:c})=>{this._fire("itemError",{itemId:n.id,error:a}),c&&this._actionQueues.enqueue(n.id,()=>new Promise(u=>{const h=()=>{s.off("restart",h),this._fire("itemRestart",{itemId:n.id}),u()};s.on("restart",h)}))}),s.create(n.sourceElementOrData,n.config,this._context);throw new Error(`Not supported item type: '${n.type}'.`)})))}remove(e){const t=hC(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n,()=>{const s=this._getWatchdog(n);return this._watchdogs.delete(n),s.destroy()})))}destroy(){return this._actionQueues.enqueue(nc,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(nc,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=Jp(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return ZS(this._context,e.context)}}class M7{_onEmptyCallbacks=[];_queues=new Map;_activeActions=0;onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const n=e===nc;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const o=(n?Promise.all(this._queues.values()):Promise.all([this._queues.get(nc),this._queues.get(e)])).then(t),a=o.catch(()=>{});return this._queues.set(e,a),o.finally(()=>{this._activeActions--,this._queues.get(e)===a&&this._activeActions===0&&this._onEmptyCallbacks.forEach(c=>c())})}}function hC(i){return Array.isArray(i)?i:[i]}class N extends qe(){editor;_disableStack=new Set;constructor(e){super(),this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",fC,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",fC),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}function fC(i){i.return=!1,i.stop()}class me extends qe(){editor;_isEnabledBasedOnSelection;_affectsData;_disableStack;static get _throwErrorWhenUsedAsAPlugin(){return!0}constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",t=>{if(!this.affectsData)return;const n=e.model.document.selection,o=!(n.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(n);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(t.return=!1,t.stop())},{priority:"highest"}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",mC,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",mC),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function mC(i){i.return=!1,i.stop()}class gC extends me{_childCommandsDefinitions=[];refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return!!t&&t.execute(e)}registerChildCommand(e,t={}){BE(this._childCommandsDefinitions,{command:e,priority:t.priority||"normal"}),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){const e=this._childCommandsDefinitions.find(({command:t})=>t.isEnabled);return e&&e.command}}class N7{_commands;constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const n=this.get(e);if(!n)throw new E("commandcollection-command-not-found",this,{commandName:e});return n.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}class tA extends Je(){_context;_plugins=new Map;_availablePlugins;_contextPlugins;constructor(e,t=[],n=[]){super(),this._context=e,this._availablePlugins=new Map;for(const s of t)s.pluginName&&this._availablePlugins.set(s.pluginName,s);this._contextPlugins=new Map;for(const[s,o]of n)this._contextPlugins.set(s,o),this._contextPlugins.set(o,s),s.pluginName&&this._availablePlugins.set(s.pluginName,s)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let n=e;throw typeof e=="function"&&(n=e.pluginName||e.name),new E("plugincollection-plugin-not-loaded",this._context,{plugin:n})}return t}has(e){return this._plugins.has(e)}async init(e,t=[],n=[]){const s=this,o=this._context;_(e),C(e);const a=e.filter(M=>!g(M,t)),c=[...v(a)];ne(c,n);const u=j(c);return await Z(u,"init"),await Z(u,"afterInit"),u;function h(M){return typeof M=="function"}function m(M){return h(M)&&!!M.isContextPlugin}function g(M,J){return J.some(Y=>Y===M||w(M)===Y||w(Y)===M)}function w(M){return h(M)?M.pluginName||M.name:M}function _(M,J=new Set){M.forEach(Y=>{h(Y)&&(J.has(Y)||(J.add(Y),Y.pluginName&&!s._availablePlugins.has(Y.pluginName)&&s._availablePlugins.set(Y.pluginName,Y),Y.requires&&_(Y.requires,J)))})}function v(M,J=new Set){return M.map(Y=>h(Y)?Y:s._availablePlugins.get(Y)).reduce((Y,ie)=>J.has(ie)?Y:(J.add(ie),ie.requires&&(C(ie.requires,ie),v(ie.requires,J).forEach(Ee=>Y.add(Ee))),Y.add(ie)),new Set)}function C(M,J=null){M.map(Y=>h(Y)?Y:s._availablePlugins.get(Y)||Y).forEach(Y=>{T(Y),A(Y,J),L(Y,J),z(Y,J)})}function T(M){if(typeof M=="function"&&M._throwErrorWhenUsedAsAPlugin)throw new E("plugincollection-plugin-invalid-constructor",o,{name:M.name})}function A(M,J){if(!h(M))throw J?new E("plugincollection-soft-required",o,{missingPlugin:M,requiredBy:w(J)}):new E("plugincollection-plugin-not-found",o,{plugin:M})}function L(M,J){if(m(J)&&!m(M))throw new E("plugincollection-context-required",o,{plugin:w(M),requiredBy:w(J)})}function z(M,J){if(J&&g(M,t))throw new E("plugincollection-required",o,{plugin:w(M),requiredBy:w(J)})}function j(M){return M.map(J=>{let Y=s._contextPlugins.get(J);return Y=Y||new J(o),s._add(J,Y),Y})}function Z(M,J){return M.reduce((Y,ie)=>!ie[J]||s._contextPlugins.has(ie)?Y:Y.then(ie[J].bind(ie)),Promise.resolve())}function ne(M,J){for(const Y of J){if(typeof Y!="function")throw new E("plugincollection-replace-plugin-invalid-type",null,{pluginItem:Y});const ie=Y.pluginName;if(!ie)throw new E("plugincollection-replace-plugin-missing-name",null,{pluginItem:Y});if(Y.requires&&Y.requires.length)throw new E("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:ie});const Ee=s._availablePlugins.get(ie);if(!Ee)throw new E("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:ie});const Ve=M.indexOf(Ee);if(Ve===-1){if(s._contextPlugins.has(Ee))return;throw new E("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:ie})}if(Ee.requires&&Ee.requires.length)throw new E("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:ie});M.splice(Ve,1,Y),s._availablePlugins.set(ie,Y)}}}destroy(){const e=[];for(const[,t]of this)typeof t.destroy=="function"&&!this._contextPlugins.has(t)&&e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new E("plugincollection-plugin-name-conflict",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,t)}}}class pC{config;plugins;locale;t;editors;static defaultConfig;static builtinPlugins;_contextOwner=null;constructor(e){const{translations:t,...n}=e||{};this.config=new zE(n,this.constructor.defaultConfig);const s=this.constructor.builtinPlugins;this.config.define("plugins",s),this.plugins=new tA(this,s);const o=this.config.get("language")||{};this.locale=new dV({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new Dt}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const n of e.concat(t)){if(typeof n!="function")throw new E("context-initplugins-constructor-only",null,{Plugin:n});if(n.isContextPlugin!==!0)throw new E("context-initplugins-invalid-plugin",null,{Plugin:n})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new E("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const n=new this(e);t(n.initPlugins().then(()=>n))})}static get _throwErrorWhenUsedAsAPlugin(){return!0}}class nA extends qe(){context;constructor(e){super(),this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}class L7 extends Ct{editor;constructor(e){super(),this.editor=e}set(e,t,n={}){if(typeof t=="string"){const s=t;t=(o,a)=>{this.editor.execute(s),a()}}super.set(e,t,n)}}const Qg="contentEditing",bC="common";class D7{keystrokeInfos=new Map;_editor;constructor(e){this._editor=e;const t=e.config.get("menuBar.isVisible"),n=e.locale.t;this.addKeystrokeInfoCategory({id:Qg,label:n("Content editing keystrokes"),description:n("These keyboard shortcuts allow for quick access to content editing features.")});const s=[{label:n("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:n("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:n("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:n("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:n("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:n("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&s.push({label:n("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:n("User interface and content navigation keystrokes"),description:n("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:s}]})}addKeystrokeInfoCategory({id:e,label:t,description:n,groups:s}){this.keystrokeInfos.set(e,{id:e,label:t,description:n,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:e,id:bC}),s&&s.forEach(o=>{this.addKeystrokeInfoGroup({categoryId:e,...o})})}addKeystrokeInfoGroup({categoryId:e=Qg,id:t,label:n,keystrokes:s}){const o=this.keystrokeInfos.get(e);if(!o)throw new E("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});o.groups.set(t,{id:t,label:n,keystrokes:s||[]})}addKeystrokeInfos({categoryId:e=Qg,groupId:t=bC,keystrokes:n}){if(!this.keystrokeInfos.has(e))throw new E("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:n});const s=this.keystrokeInfos.get(e);if(!s.groups.has(t))throw new E("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:n});s.groups.get(t).keystrokes.push(...n)}}function F7(i){return{sessionId:q7(),pageSessionId:W7(),hostname:window.location.hostname,version:globalThis.CKEDITOR_VERSION,type:z7(i),plugins:U7(i.plugins),distribution:H7(),env:j7(),integration:Object.create(null),menuBar:{isVisible:!!i.config.get("menuBar.isVisible")},language:{ui:i.locale.uiLanguage,content:i.locale.contentLanguage},toolbar:{main:Xg(i.config.get("toolbar")),block:Xg(i.config.get("blockToolbar")),balloon:Xg(i.config.get("balloonToolbar"))}}}function z7(i){return Object.getPrototypeOf(i).constructor.editorName}function U7(i){return Array.from(i).filter(([e])=>!!e.pluginName).map(([e])=>{const{pluginName:t,isContextPlugin:n,isOfficialPlugin:s,isPremiumPlugin:o}=e;return{isContext:!!n,isOfficial:!!s,isPremium:!!o,name:t}})}function Xg(i){if(!i)return;const e=Array.isArray(i)?{items:i}:i,t=o(e.items||[]);return{isMultiline:t.includes("-"),shouldNotGroupWhenFull:!!e.shouldNotGroupWhenFull,items:s(t)};function s(a){return a.filter(c=>c!=="|"&&c!=="-")}function o(a){return a.flatMap(c=>typeof c=="string"?[c]:o(c.items))}}function H7(){return{channel:window[Symbol.for("cke distribution")]||"sh"}}function j7(){let i="unknown",e="unknown";return le.isMac?i="mac":le.isWindows?i="windows":le.isiOS?i="ios":le.isAndroid&&(i="android"),le.isGecko?e="gecko":le.isBlink?e="blink":le.isSafari&&(e="safari"),{os:i,browser:e}}function q7(){return localStorage.getItem("__ckeditor-session-id")||localStorage.setItem("__ckeditor-session-id",rn()),localStorage.getItem("__ckeditor-session-id")}function W7(){return ee.window.CKEDITOR_PAGE_SESSION_ID=ee.window.CKEDITOR_PAGE_SESSION_ID||rn(),ee.window.CKEDITOR_PAGE_SESSION_ID}class $7 extends qe(){static get editorName(){return"Editor"}accessibility;commands;config;conversion;data;editing;locale;model;plugins;keystrokes;t;static defaultConfig;static builtinPlugins;_context;_readOnlyLocks;static get _throwErrorWhenUsedAsAPlugin(){return!0}constructor(e={}){if(super(),typeof e!="object"||Array.isArray(e))throw new E("editor-config-invalid-type");if("sanitizeHtml"in e)throw new E("editor-config-sanitizehtml-not-supported");const t=this.constructor,{translations:n,...s}=t.defaultConfig||{},{translations:o=n,...a}=e,c=e.language||s.language;this._context=e.context||new pC({language:c,translations:o}),this._context._addEditor(this,!e.context);const u=Array.from(t.builtinPlugins||[]);this.config=new zE(a,s),this.config.define("plugins",u),this.config.define(this._context._getEditorConfig()),m(this.config),this.plugins=new tA(this,u,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new N7,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new t7(this.config),this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const h=new BV;this.data=new oM(this.model,h),this.editing=new N4(this.model,h),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new aM([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new L7(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new D7(this),g(this);function m(w){let _=w.get("licenseKey");if(!_&&window.CKEDITOR_GLOBAL_LICENSE_KEY&&(_=window.CKEDITOR_GLOBAL_LICENSE_KEY,w.set("licenseKey",_)),!_)throw new E("license-key-missing")}function g(w){const _=w.config.get("licenseKey"),v=window[Symbol.for("cke distribution")]||"sh";function C(M,J){w.enableReadOnlyMode(Symbol("invalidLicense")),w._showLicenseError(M,J)}function T(M){return["exp","jti","vc"].every(Y=>Y in M)}function A(M){return Object.getOwnPropertyNames(M).sort().filter(ie=>ie!="vc"&&M[ie]!=null).map(ie=>M[ie])}function L(M){const{hostname:J}=new URL(window.location.href);if(M.includes(J))return!0;const Y=J.split(".");return M.filter(ie=>ie.includes("*")).map(ie=>ie.split(".")).filter(ie=>ie.length<=Y.length).map(ie=>Array(Y.length-ie.length).fill(ie[0]==="*"?"*":"").concat(ie)).some(ie=>Y.every((Ee,Ve)=>ie[Ve]===Ee||ie[Ve]==="*"))}function z(M){const J=M[0].toUpperCase()+M.slice(1),Y=M==="evaluation"?"an":"a";console.info(`%cCKEditor 5 ${J} License`,"color: #ffffff; background: #743CCD; font-size: 14px; padding: 4px 8px; border-radius: 4px;"),console.warn(` You are using ${Y} ${M} license of CKEditor 5${M==="trial"?" which is for evaluation purposes only":""}. For production usage, please obtain a production license at https://portal.ckeditor.com/`)}if(_=="GPL"){v=="cloud"&&C("distributionChannel");return}const j=S1(_);if(!j){C("invalid");return}if(!T(j)){C("invalid");return}if(j.distributionChannel&&!st(j.distributionChannel).includes(v)){C("distributionChannel");return}if(pV(A(j))!=j.vc.toLowerCase()){C("invalid");return}if(new Date(j.exp*1e3)<vO){C("expired");return}const ne=j.licensedHosts;if(ne&&ne.length>0&&!L(ne)){C("domainLimit");return}if(["evaluation","trial"].includes(j.licenseType)&&j.exp*1e3<Date.now()){C("expired");return}if(["development","evaluation","trial"].includes(j.licenseType)){const{licenseType:M}=j;window.CKEDITOR_WARNING_SUPPRESSIONS=window.CKEDITOR_WARNING_SUPPRESSIONS||{},window.CKEDITOR_WARNING_SUPPRESSIONS[M]||(z(M),window.CKEDITOR_WARNING_SUPPRESSIONS[M]=!0)}if(["evaluation","trial"].includes(j.licenseType)){const M=j.licenseType,J=setTimeout(()=>{C(`${M}Limit`)},6e5);w.on("destroy",()=>{clearTimeout(J)})}j.usageEndpoint&&w.once("ready",()=>{const M={requestId:rn(),requestTime:Math.round(Date.now()/1e3),license:_,editor:G7(w)};w._sendUsageRequest(j.usageEndpoint,M).then(J=>{const{status:Y,message:ie}=J;ie&&console.warn(ie),Y!="ok"&&C("usageLimit")},()=>{wO("license-key-validation-endpoint-not-reachable",{url:j.usageEndpoint})})},{priority:"high"})}}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new E("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new E("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new E("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,t=e.get("plugins"),n=e.get("removePlugins")||[],s=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(s),n,o).then(c=>(a(this),c));function a(c){const u=c.config.get("licenseKey");if(u==="GPL")return;const h=S1(u);if(!h)return;const m=[...c.plugins].map(([g])=>g).find(g=>!g.pluginName||!g.licenseFeatureCode?!1:kV(h,g.licenseFeatureCode));m&&(c.enableReadOnlyMode(Symbol("invalidLicense")),c._showLicenseError("pluginNotAllowed",m.pluginName))}}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(t=>this.once("ready",t))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(n){E.rethrowUnexpectedError(n,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}static Context=pC;static EditorWatchdog=eA;static ContextWatchdog=B7;_showLicenseError(e,t){setTimeout(()=>{if(e=="invalid")throw new E("invalid-license-key");if(e=="expired")throw new E("license-key-expired");if(e=="domainLimit")throw new E("license-key-domain-limit");if(e=="pluginNotAllowed"){const n=t.replace(/(Editing|UI)$/,""),s=this.plugins.has(n);throw new E("license-key-plugin-not-allowed",null,{pluginName:s?n:t})}if(e=="featureNotAllowed")throw new E("license-key-feature-not-allowed",null,{featureName:t});if(e=="evaluationLimit")throw new E("license-key-evaluation-limit");if(e=="trialLimit")throw new E("license-key-trial-limit");if(e=="developmentLimit")throw new E("license-key-development-limit");if(e=="usageLimit")throw new E("license-key-usage-limit");if(e=="distributionChannel")throw new E("license-key-invalid-distribution-channel")},0),this._showLicenseError=()=>{}}async _sendUsageRequest(e,t){const n=new Headers({"Content-Type":"application/json"}),s=await fetch(new URL(e),{method:"POST",headers:n,body:JSON.stringify(t)});if(!s.ok)throw new Error(`HTTP Response: ${s.status}`);return s.json()}}function G7(i){const e=F7(i);function t(n,s){if(ro(e,n)!==void 0)throw new E("editor-usage-data-path-already-set",{path:n});AE(e,n,s)}return i.fire("collectUsageData",{setUsageData:t}),e}function K7(i){if(!Xd(i.updateSourceElement))throw new E("attachtoform-missing-elementapi-interface",i);const e=i.sourceElement;if(Y7(e)&&e.form){let t;const n=e.form,s=()=>i.updateSourceElement();Xd(n.submit)&&(t=n.submit,n.submit=()=>{s(),t.apply(n)}),n.addEventListener("submit",s),i.on("destroy",()=>{n.removeEventListener("submit",s),t&&(n.submit=t)})}}function Y7(i){return!!i&&i.tagName.toLowerCase()==="textarea"}function J7(i){class e extends i{sourceElement;updateSourceElement(n){if(!this.sourceElement)throw new E("editor-missing-sourceelement",this);const s=this.config.get("updateSourceElementOnDestroy"),o=this.sourceElement instanceof HTMLTextAreaElement;if(!s&&!o){p1(this.sourceElement,"");return}const a=typeof n=="string"?n:this.data.get();p1(this.sourceElement,a)}}return e}class wC extends nA{_actions;static get pluginName(){return"PendingActions"}static get isOfficialPlugin(){return!0}init(){this.set("hasAny",!1),this._actions=new Dt({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new E("pendingactions-add-invalid-message",this);const t=new(qe());return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}class Q7 extends qe(){total;_reader;_data;constructor(){super();const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=t=>{this.loaded=t.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise((n,s)=>{t.onload=()=>{const o=t.result;this._data=o,n(o)},t.onerror=()=>{s("error")},t.onabort=()=>{s("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}}class qo extends N{loaders=new Dt;_loadersMap=new Map;_pendingAction=null;static get pluginName(){return"FileRepository"}static get isOfficialPlugin(){return!0}static get requires(){return[wC]}init(){this.loaders.on("change",()=>this._updatePendingAction()),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,t)=>t?e/t*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return Be("filerepository-no-upload-adapter"),null;const t=new _C(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then(n=>{this._loadersMap.set(n,t)}).catch(()=>{}),t.on("change:uploaded",()=>{let n=0;for(const s of this.loaders)n+=s.uploaded;this.uploaded=n}),t.on("change:uploadTotal",()=>{let n=0;for(const s of this.loaders)s.uploadTotal&&(n+=s.uploadTotal);this.uploadTotal=n}),t}destroyLoader(e){const t=e instanceof _C?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach((n,s)=>{n===t&&this._loadersMap.delete(s)})}_updatePendingAction(){const e=this.editor.plugins.get(wC);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,n=s=>`${t("Upload in progress")} ${parseInt(s)}%.`;this._pendingAction=e.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else e.remove(this._pendingAction),this._pendingAction=null}}class _C extends qe(){id;_filePromiseWrapper;_adapter;_reader;constructor(e,t){super(),this.id=rn(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new Q7,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(n,s)=>s?n/s*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new E("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>{if(this.status!=="reading")throw this.status;return this.status="idle",e}).catch(e=>{throw e==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:e)})}upload(){if(this.status!="idle")throw new E("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{throw this.status==="aborted"?"aborted":(this.status="error",e)})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?e=="reading"?this._reader.abort():e=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise((n,s)=>{t.rejecter=s,t.isFulfilled=!1,e.then(o=>{t.isFulfilled=!0,n(o)}).catch(o=>{t.isFulfilled=!0,s(o)})}),t}}var yC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103z"/><path d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17m0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10" clip-rule="evenodd"/></svg>',X7='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.75.75 0 0 1-.511.187.75.75 0 0 1-.511-.187M4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5z"/></svg>',iA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75m0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75"/></svg>',sA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75"/></svg>',dw='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75"/></svg>',Z7='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.75 11.875a.75.75 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.75.75 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.75.75 0 0 1-.508.184.75.75 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75"/></svg>',oA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75m0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75m0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75m0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75"/></svg>',eN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.75.75 0 0 1 .511-.187.75.75 0 0 1 .511.187M15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5z"/></svg>',rA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.187 17H5.773q-.956 0-1.364-.415-.41-.416-.409-1.323V4.738q0-.926.419-1.332.418-.405 1.354-.406h4.68q1.035 0 1.793.124.76.124 1.36.478.512.296.906.75a3.26 3.26 0 0 1 .808 2.162q0 2.102-2.167 3.075 2.846.879 2.847 3.421a3.76 3.76 0 0 1-2.296 3.504 6 6 0 0 1-1.517.377q-.857.11-2 .11zm-.217-6.217H7v4.087h3.069q2.965 0 2.965-2.072 0-1.061-.768-1.537-.768-.478-2.296-.478M7 5.13v3.619h2.606q1.093 0 1.69-.2a1.6 1.6 0 0 0 .91-.765q.247-.4.247-.897 0-1.06-.778-1.409-.778-.348-2.375-.348z"/></svg>',tN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75m-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75m6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75m-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75"/></svg>',qh='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414z"/></svg>',nN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2"/><path fill-opacity=".6" d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492z"/></svg>',Wh='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.972 16.615a1 1 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a1 1 0 0 1-.745.292"/></svg>',vC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174m2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207M16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zM5.009 15l.003 1H3v-1zm2.188-2-1.471 1H5v-1zM10 11v.095L8.668 12H7v-1zm4-2v1H7V9zm0-2v1H7V7zm-4-2v1H5V5zM6 3v1H3V3z"/></svg>',iN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1m-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1"/></svg>',sN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 9 9 0 0 1-.372.008m-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414M9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415m4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415"/></svg>',oN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0" class="ck-icon__fill"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',rN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7zM0 7h1v2H0zm15 0h1v2h-1zm-8 8h2v1H7z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>',aN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m-7 6.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',$h='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136z"/></svg>',Qp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',lN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m8.38 9.262H7.62L10 5.506zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453z"/></svg>',cN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M12.4 10.3 10 4.5l-2.4 5.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2"/></svg>',CC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973zm-2.754 2.5L8.038 4.785 5.261 11.5zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663z"/></svg>',kC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.816 11.5 7.038 4.785 4.261 11.5zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825q0-.063.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782q.003.065.003.135z"/></svg>',uN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 9h16v2H2z"/></svg>',dN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1zM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1zm-5.655 6a2.13 2.13 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7"/></svg>',hN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a3 3 0 0 1-.414-.287 3 3 0 0 1-1.055-2.03 3 3 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.13 2.13 0 0 0-1.875-.978"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.8.8 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.8.8 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79"/></svg>',fN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822zM14 5V2l3.3 3zm-3.692 12.5q.093.157.213.303L11.52 19H8v-.876a2.24 2.24 0 0 0 1.82-.624zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',TC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75M2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5M1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',mN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m9.586 14.633.021.004q-.054.502.393.962.123.125.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15q.711-.106 1.005-.334.235-.182.404-.597l2.416-9.55a1.05 1.05 0 0 0-.281-.823 1.1 1.1 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195q-.564.084-.823.296-.323.263-.623.79z"/></svg>',gN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.8.8 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.7.7 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294zm5.494-5.335a.8.8 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.8.8 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955m-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184"/></svg>',pN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.798 1.59 3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z" class="ck-icon__fill"/><path d="m2.556 16.727.234-.348q-.445-.226-.498-.426-.054-.206.115-.837.14-.375.169-.595a4.5 4.5 0 0 0 0-.725q-.313-.931-.284-1.26.03-.327.475-.862l6.77-9.414q.808-1.365 3.199.18 2.39 1.549 1.784 2.686l-5.877 10.36q-.237.618-.526.782-.29.163-1.232.21-.543.196-.738.318t-.526.47q-.44.397-.632.397-.143 0-.524-.226l-.31.41zm-.279.415 1.575 1.103-.392.515H1.19zm8.1-13.656-4.953 6.9L8.75 12.57l4.247-7.574q.263-.375-1.092-1.192-1.354-.819-1.528-.32zM8.244 18.5 9.59 17h9.406v1.5z"/></svg>',bN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 42"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098s-4.538-.083-4.538-1.678 2.032-3.43 4.538-4.098c.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556L49 17zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.99 1.99 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17m29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155zM20.6 21.375v1.616h1.616v-1.616zm0 3.231v1.616h1.616v-1.616zm0 3.231v1.616h1.616v-1.616zm0 3.231v1.616h1.616v-1.616zm0 3.231v1.616h1.616v-1.616zm0 3.231v1.616h1.616V37.53zm24.233-16.155v1.616h1.615v-1.616zm0 3.231v1.616h1.615v-1.616zm0 3.231v1.616h1.615v-1.616zm0 3.231v1.616h1.615v-1.616zm0 3.231v1.616h1.615v-1.616zm0 3.231v1.616h1.615V37.53zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35z"/></svg>',wN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 20"><path d="M1.587 1.5c-.612 0-.601-.029-.601.551v14.84c0 .59-.01.559.591.559h18.846c.602 0 .591.03.591-.56V2.052c0-.58.01-.55-.591-.55H1.587Zm.701.971h1.003v1H2.288zm16.448 0h1.003v1h-1.003zm-14.24 1h13.008v12H4.467zm-2.208 1h1.003v1H2.288zm16.448 0h1.003v1h-1.003zm-16.448 2h1.003v1H2.288zm16.448 0h1.003v1h-1.003zm-16.448 2h1.003v1H2.288zm16.448 0h1.003v1h-1.003zm-16.448 2h1.003v1H2.288zm16.448 0h1.003v1h-1.003zm-16.448 2h1.003l-.029 1h-.974zm16.448 0h1.003v1h-1.003zm-16.448 2h.974v1h-.974zm16.448 0h1.003v1h-1.003z"/><path d="M8.374 6.648a.4.4 0 0 1 .395-.4.4.4 0 0 1 .2.049l5.148 2.824a.4.4 0 0 1 0 .7l-5.148 2.824a.403.403 0 0 1-.595-.35z"/></svg>',aA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382z"/></svg>',_N='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75M3.5 3v5H2V3.7H1v-1h2.5zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001q-.073.607-.333.988-.263.381-1.244 1.312H4.3v1h-4zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75"/></svg>',rh='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm0 12h16v1.5H2z" opacity=".5"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H6.5V12h6.997z"/></svg>',yN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm0 12h16v1.5H2z" opacity=".5"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1m-1.505.5H3.504V12h12.991z"/></svg>',hw='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z" opacity=".5"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H3.5V12h6.997z"/></svg>',ah='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z" opacity=".5"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H9.5V12h6.997z"/></svg>',lA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z" opacity=".5"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H3.5V12h6.997z"/></svg>',cA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm0 12h16v1.5H2z" opacity=".5"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H3.5V12h6.997z"/></svg>',uA='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3h16v1.5H2zm0 12h16v1.5H2z" opacity=".5"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1m-1.506.5H9.5V12h6.997z"/></svg>',vN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95zm.55 3.5v-2h2v2zm0 9.3v2h2v-2zm15-11.3v2h2v-2zM8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046zm11.421-9.101a.6.6 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.6.6 0 0 1 .206-.138.6.6 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243"/></svg>',CN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zM1 15.5v1H0v-1zm19 0v1h-1v-1zm-19-2v1H0v-1zm19 0v1h-1v-1zm-19-2v1H0v-1zm19 0v1h-1v-1zm-19-2v1H0v-1zm19 0v1h-1v-1zm-19-2v1H0v-1zm19 0v1h-1v-1zm-19-2v1H0v-1zm19 0v1h-1v-1zm0-2v1h-1v-1zm-19 0v1H0v-1zM14.5 2v1h-1V2zm2 0v1h-1V2zm2 0v1h-1V2zm-8 0v1h-1V2zm-2 0v1h-1V2zm-2 0v1h-1V2zm-2 0v1h-1V2zm8 0v1h-1V2zm-10 0v1h-1V2z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2m0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.49.49 0 0 1-.476-.5V4c0-.276.213-.5.476-.5z"/></svg>',kN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 16.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zM1 15v1H0v-1zm19 0v1h-1v-1zM1 13v1H0v-1zm19 0v1h-1v-1zM1 11v1H0v-1zm19 0v1h-1v-1zM1 9v1H0V9zm19 0v1h-1V9zM1 7v1H0V7zm19 0v1h-1V7zM1 5v1H0V5zm19 0v1h-1V5zm0-2v1h-1V3zM1 3v1H0V3zm13.5-1.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm-8 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm8 0v1h-1v-1zm-10 0v1h-1v-1z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2M13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7z"/></svg>',TN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 16.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zM1 15v1H0v-1zm19 0v1h-1v-1zM1 13v1H0v-1zm19 0v1h-1v-1zM1 11v1H0v-1zm19 0v1h-1v-1zM1 9v1H0V9zm19 0v1h-1V9zM1 7v1H0V7zm19 0v1h-1V7zM1 5v1H0V5zm19 0v1h-1V5zm0-2v1h-1V3zM1 3v1H0V3zm13.5-1.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm-8 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm8 0v1h-1v-1zm-10 0v1h-1v-1z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2M10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9z"/></svg>',EN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 16.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zM1 15v1H0v-1zm19 0v1h-1v-1zM1 13v1H0v-1zm19 0v1h-1v-1zM1 11v1H0v-1zm19 0v1h-1v-1zM1 9v1H0V9zm19 0v1h-1V9zM1 7v1H0V7zm19 0v1h-1V7zM1 5v1H0V5zm19 0v1h-1V5zm0-2v1h-1V3zM1 3v1H0V3zm13.5-1.5v1h-1v-1zm2 0v1h-1v-1zm2 0v1h-1v-1zm-8 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm-2 0v1h-1v-1zm8 0v1h-1v-1zm-10 0v1h-1v-1z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2M7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11z"/></svg>',EC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75M2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5m1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',SN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5M5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"/></svg>',AN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m7.3 17.37-.061.088a1.52 1.52 0 0 1-.934.535l-4.178.663-.806-4.153a1.5 1.5 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346zM6.07 16.512l-3.276-2.295.53 2.73zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328M8 18.5 9.375 17H19v1.5z"/></svg>',xN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.126 2.268 2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568z" class="ck-icon__fill"/><path d="m4.5 18.088-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97q.249-.348.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005zm-.634.166-1.976.516-.026-1.918zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349M8.245 18.5 9.59 17h9.406v1.5z"/></svg>',IN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4"/></svg>',PN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1"/></svg>',Ta='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',RN=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`,ON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003z"/></svg>',SC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.75.75 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.8.8 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032z"/></svg>',VN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M8.69 14.915q.08.078.36.093a.366.366 0 0 1 .345.485l-.003.01a.74.74 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.68.68 0 0 1 .644-.458q.295-.018.386-.093a.3.3 0 0 0 .072-.11L9.592 4.5H6.269q-.538-.026-.75.09-.213.117-.442.563c-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486q.002-.426-.167-.54-.168-.114-.766-.091h-3.28l-2.68 10.257q-.009.111.038.158M3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1m11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',BN='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',MN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75m18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75m-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2z"/></svg>',NN=`<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.734 6.375H1.75a.75.75 0 0 1 0-1.5h1.984a2.626 2.626 0 0 1 5.032 0h9.48a.75.75 0 0 1 0 1.5h-9.48a2.626 2.626 0 0 1-5.032 0Zm1.141-.75a1.375 1.375 0 1 1 2.75 0 1.375 1.375 0 0 1-2.75 0ZM16.263 14.625h1.983a.75.75 0 0 1 0 1.5h-1.983a2.626 2.626 0 0 1-5.033 0H1.75a.75.75 0 0 1 0-1.5h9.48a2.626 2.626 0 0 1 5.033 0Zm-1.142.75a1.375 1.375 0 1 1-2.75 0 1.375 1.375 0 0 1 2.75 0Z"/></svg>
`,LN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6M6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>',DN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53zm8.147 7.829h2.549q.38 0 .58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393q-.158.162-.48.162h-3.594q-.367 0-.572-.197a.62.62 0 0 1-.205-.463q0-.171.132-.453a1.6 1.6 0 0 1 .288-.444q.65-.654 1.172-1.122t.747-.615q.401-.275.667-.553t.405-.57.139-.57a1.01 1.01 0 0 0-.554-.917 1.2 1.2 0 0 0-.56-.133q-.639 0-1.005.546a2.3 2.3 0 0 0-.164.39 1.6 1.6 0 0 1-.258.488q-.144.17-.423.17a.56.56 0 0 1-.405-.156.57.57 0 0 1-.161-.427q0-.327.151-.683.152-.357.452-.646c.3-.289.454-.349.762-.467a3 3 0 0 1 1.081-.178q.747 0 1.274.228a1.92 1.92 0 0 1 1.004 1.032 1.98 1.98 0 0 1-.156 1.794q-.3.48-.613.754-.312.273-1.048.857-.735.584-1.008.906a3 3 0 0 0-.24.309z"/></svg>',FN='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="m7.184 10.353 3.818-3.819a.8.8 0 0 1 1.132 1.132l-3.82 3.818 3.82 3.818a.802.802 0 0 1-.873 1.306.8.8 0 0 1-.26-.174l-3.817-3.82-3.818 3.82a.8.8 0 0 1-1.305-.26.8.8 0 0 1 .173-.872l3.82-3.818-3.82-3.818a.8.8 0 0 1 1.132-1.132l3.818 3.82M15.68 6.88h2.549q.38 0 .58.153a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393q-.158.162-.48.162h-3.594q-.367 0-.572-.197A.62.62 0 0 1 14 7.34q0-.171.132-.453a1.6 1.6 0 0 1 .288-.444q.65-.654 1.172-1.122t.747-.615q.401-.275.667-.553.266-.277.405-.57.14-.291.139-.57a1.01 1.01 0 0 0-.554-.917 1.2 1.2 0 0 0-.56-.133q-.639 0-1.005.546a2.3 2.3 0 0 0-.164.39 1.6 1.6 0 0 1-.258.488q-.144.17-.423.17a.56.56 0 0 1-.405-.156.57.57 0 0 1-.161-.427q0-.327.151-.683.152-.357.452-.646t.762-.467A3 3 0 0 1 16.466 1q.747 0 1.274.228c.456.2.816.57 1.004 1.032a1.99 1.99 0 0 1-.156 1.794q-.3.48-.613.754-.312.273-1.048.857-.735.583-1.008.906-.131.146-.24.309z"/></svg>',zN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5zM2 12h5V8H2zm10-4H8v4h4zM2 2v5h5V2zm0 16h5v-5H2zM13 7h5V2h-5zM8 2v5h4V2z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43zM13 6a1 1 0 0 1 1 1v3.172a2 2 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.98 1.98 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm-1 2H8v4h4z"/></svg>',UN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1M2 2v16h16V2z" opacity=".6"/><path d="M18 7v1H2V7zm0 5v1H2v-1z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1m-2 1H8v4h4zm0 6H8v4h4zm0 6H8v4h4z"/></svg>',HN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1M2 2v16h16V2z" opacity=".6"/><path d="M7 2h1v16H7zm5 0h1v7h-1zm6 5v1H2V7zM8 12v1H2v-1z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1m1 2v9h10V9z"/></svg>',jN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2zm4 6H8v4h4z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2 2 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2z"/></svg>',qN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1M2 2v16h16V2z" opacity=".6"/><path d="M7 2h1v16H7zm5 0h1v16h-1z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1m1 2v4h4V8zm6 0v4h4V8zm6 0v4h4V8z"/></svg>',AC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M3 5.5v3h4v-3zm0 4v3h4v-3zm0 4v3h4v-3zm5 3h4v-3H8zm5 0h4v-3h-4zm4-4v-3h-4v3zm0-4v-3h-4v3zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5zm-6.5-4v-3H8v3zm0-4v-3H8v3z"/></svg>',WN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1zm10.453 2.61a1.89 1.89 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.9 1.9 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598M7.463 8.163a.6.6 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.63.63 0 0 0-.417-.185m6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.62.62 0 0 0-.42-.165M.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.91.91 0 0 0-.912-.912zM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516zm4.947 0h1.801v4.3h2.7v1.4h-4.5zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9zm-8.517 1.457-.614 2.059h1.262z"/></svg>',$N='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.816 11.5 7.038 4.785 4.261 11.5zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254z"/></svg>',fw='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',GN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m2.315 14.705 2.224-2.24a.69.69 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.7.7 0 0 1-.112.089.65.65 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75M2.329 5.745l2.21-2.226a.69.69 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.7.7 0 0 1-.496.196.64.64 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75"/></svg>',KN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8s3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4"/></svg>',xC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.75.75 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.8.8 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032z"/></svg>',YN='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.8.8 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.7.7 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294zm5.494-5.335a.8.8 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.8.8 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955m-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184m4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06z"/></svg>';const Xp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};for(const i in Xp)Object.freeze(Xp[i]);const Jo=Object.freeze(Xp);var IC={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function PC(i){var e,t=[],n=1,s;if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(i=String(i).toLowerCase(),Jo[i])t=Jo[i].slice(),s="rgb";else if(i==="transparent")n=0,s="rgb",t=[0,0,0];else if(i[0]==="#"){var o=i.slice(1),a=o.length,c=a<=4;n=1,c?(t=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],a===4&&(n=parseInt(o[3]+o[3],16)/255)):(t=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],a===8&&(n=parseInt(o[6]+o[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),s="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(i)){var u=e[1];s=u.replace(/a$/,"");var h=s==="cmyk"?4:s==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=t.shift()),t=t.map(function(m,g){if(m[m.length-1]==="%")return m=parseFloat(m)/100,g===3?m:s==="rgb"?m*255:s[0]==="h"||s[0]==="l"&&!g?m*100:s==="lab"?m*125:s==="lch"?g<2?m*150:m*360:s[0]==="o"&&!g?m:s==="oklab"?m*.4:s==="oklch"?g<2?m*.4:m*360:m;if(s[g]==="h"||g===2&&s[s.length-1]==="h"){if(IC[m]!==void 0)return IC[m];if(m.endsWith("deg"))return parseFloat(m);if(m.endsWith("turn"))return parseFloat(m)*360;if(m.endsWith("grad"))return parseFloat(m)*360/400;if(m.endsWith("rad"))return parseFloat(m)*180/Math.PI}return m==="none"?0:parseFloat(m)}),n=t.length>h?t.pop():1}else/[0-9](?:\s|\/|,)/.test(i)&&(t=i.match(/([0-9]+)/g).map(function(m){return parseFloat(m)}),s=i.match(/([a-z])/ig)?.join("")?.toLowerCase()||"rgb");return{space:s,values:t,alpha:n}}const dA={};for(const i of Object.keys(Jo))dA[Jo[i]]=i;const se={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},Cs=(6/29)**3;function ga(i){const e=i>.0031308?1.055*i**.4166666666666667-.055:i*12.92;return Math.min(Math.max(0,e),1)}function pa(i){return i>.04045?((i+.055)/1.055)**2.4:i/12.92}for(const i of Object.keys(se)){if(!("channels"in se[i]))throw new Error("missing channels property: "+i);if(!("labels"in se[i]))throw new Error("missing channel labels property: "+i);if(se[i].labels.length!==se[i].channels)throw new Error("channel and label counts mismatch: "+i);const{channels:e,labels:t}=se[i];delete se[i].channels,delete se[i].labels,Object.defineProperty(se[i],"channels",{value:e}),Object.defineProperty(se[i],"labels",{value:t})}se.rgb.hsl=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.min(e,t,n),o=Math.max(e,t,n),a=o-s;let c,u;switch(o){case s:{c=0;break}case e:{c=(t-n)/a;break}case t:{c=2+(n-e)/a;break}case n:{c=4+(e-t)/a;break}}c=Math.min(c*60,360),c<0&&(c+=360);const h=(s+o)/2;return o===s?u=0:h<=.5?u=a/(o+s):u=a/(2-o-s),[c,u*100,h*100]};se.rgb.hsv=function(i){let e,t,n,s,o;const a=i[0]/255,c=i[1]/255,u=i[2]/255,h=Math.max(a,c,u),m=h-Math.min(a,c,u),g=function(w){return(h-w)/6/m+1/2};if(m===0)s=0,o=0;else{switch(o=m/h,e=g(a),t=g(c),n=g(u),h){case a:{s=n-t;break}case c:{s=1/3+e-n;break}case u:{s=2/3+t-e;break}}s<0?s+=1:s>1&&(s-=1)}return[s*360,o*100,h*100]};se.rgb.hwb=function(i){const e=i[0],t=i[1];let n=i[2];const s=se.rgb.hsl(i)[0],o=1/255*Math.min(e,Math.min(t,n));return n=1-1/255*Math.max(e,Math.max(t,n)),[s,o*100,n*100]};se.rgb.oklab=function(i){const e=pa(i[0]/255),t=pa(i[1]/255),n=pa(i[2]/255),s=Math.cbrt(.4122214708*e+.5363325363*t+.0514459929*n),o=Math.cbrt(.2119034982*e+.6806995451*t+.1073969566*n),a=Math.cbrt(.0883024619*e+.2817188376*t+.6299787005*n),c=.2104542553*s+.793617785*o-.0040720468*a,u=1.9779984951*s-2.428592205*o+.4505937099*a,h=.0259040371*s+.7827717662*o-.808675766*a;return[c*100,u*100,h*100]};se.rgb.cmyk=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.min(1-e,1-t,1-n),o=(1-e-s)/(1-s)||0,a=(1-t-s)/(1-s)||0,c=(1-n-s)/(1-s)||0;return[o*100,a*100,c*100,s*100]};function JN(i,e){return(i[0]-e[0])**2+(i[1]-e[1])**2+(i[2]-e[2])**2}se.rgb.keyword=function(i){const e=dA[i];if(e)return e;let t=Number.POSITIVE_INFINITY,n;for(const s of Object.keys(Jo)){const o=Jo[s],a=JN(i,o);a<t&&(t=a,n=s)}return n};se.keyword.rgb=function(i){return Jo[i]};se.rgb.xyz=function(i){const e=pa(i[0]/255),t=pa(i[1]/255),n=pa(i[2]/255),s=e*.4124564+t*.3575761+n*.1804375,o=e*.2126729+t*.7151522+n*.072175,a=e*.0193339+t*.119192+n*.9503041;return[s*100,o*100,a*100]};se.rgb.lab=function(i){const e=se.rgb.xyz(i);let t=e[0],n=e[1],s=e[2];t/=95.047,n/=100,s/=108.883,t=t>Cs?t**(1/3):7.787*t+16/116,n=n>Cs?n**(1/3):7.787*n+16/116,s=s>Cs?s**(1/3):7.787*s+16/116;const o=116*n-16,a=500*(t-n),c=200*(n-s);return[o,a,c]};se.hsl.rgb=function(i){const e=i[0]/360,t=i[1]/100,n=i[2]/100;let s,o;if(t===0)return o=n*255,[o,o,o];const a=n<.5?n*(1+t):n+t-n*t,c=2*n-a,u=[0,0,0];for(let h=0;h<3;h++)s=e+1/3*-(h-1),s<0&&s++,s>1&&s--,6*s<1?o=c+(a-c)*6*s:2*s<1?o=a:3*s<2?o=c+(a-c)*(2/3-s)*6:o=c,u[h]=o*255;return u};se.hsl.hsv=function(i){const e=i[0];let t=i[1]/100,n=i[2]/100,s=t;const o=Math.max(n,.01);n*=2,t*=n<=1?n:2-n,s*=o<=1?o:2-o;const a=(n+t)/2,c=n===0?2*s/(o+s):2*t/(n+t);return[e,c*100,a*100]};se.hsv.rgb=function(i){const e=i[0]/60,t=i[1]/100;let n=i[2]/100;const s=Math.floor(e)%6,o=e-Math.floor(e),a=255*n*(1-t),c=255*n*(1-t*o),u=255*n*(1-t*(1-o));switch(n*=255,s){case 0:return[n,u,a];case 1:return[c,n,a];case 2:return[a,n,u];case 3:return[a,c,n];case 4:return[u,a,n];case 5:return[n,a,c]}};se.hsv.hsl=function(i){const e=i[0],t=i[1]/100,n=i[2]/100,s=Math.max(n,.01);let o,a;a=(2-t)*n;const c=(2-t)*s;return o=t*s,o/=c<=1?c:2-c,o=o||0,a/=2,[e,o*100,a*100]};se.hwb.rgb=function(i){const e=i[0]/360;let t=i[1]/100,n=i[2]/100;const s=t+n;let o;s>1&&(t/=s,n/=s);const a=Math.floor(6*e),c=1-n;o=6*e-a,(a&1)!==0&&(o=1-o);const u=t+o*(c-t);let h,m,g;switch(a){default:case 6:case 0:{h=c,m=u,g=t;break}case 1:{h=u,m=c,g=t;break}case 2:{h=t,m=c,g=u;break}case 3:{h=t,m=u,g=c;break}case 4:{h=u,m=t,g=c;break}case 5:{h=c,m=t,g=u;break}}return[h*255,m*255,g*255]};se.cmyk.rgb=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100,s=i[3]/100,o=1-Math.min(1,e*(1-s)+s),a=1-Math.min(1,t*(1-s)+s),c=1-Math.min(1,n*(1-s)+s);return[o*255,a*255,c*255]};se.xyz.rgb=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100;let s,o,a;return s=e*3.2404542+t*-1.5371385+n*-.4985314,o=e*-.969266+t*1.8760108+n*.041556,a=e*.0556434+t*-.2040259+n*1.0572252,s=ga(s),o=ga(o),a=ga(a),[s*255,o*255,a*255]};se.xyz.lab=function(i){let e=i[0],t=i[1],n=i[2];e/=95.047,t/=100,n/=108.883,e=e>Cs?e**(1/3):7.787*e+16/116,t=t>Cs?t**(1/3):7.787*t+16/116,n=n>Cs?n**(1/3):7.787*n+16/116;const s=116*t-16,o=500*(e-t),a=200*(t-n);return[s,o,a]};se.xyz.oklab=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100,s=Math.cbrt(.8189330101*e+.3618667424*t-.1288597137*n),o=Math.cbrt(.0329845436*e+.9293118715*t+.0361456387*n),a=Math.cbrt(.0482003018*e+.2643662691*t+.633851707*n),c=.2104542553*s+.793617785*o-.0040720468*a,u=1.9779984951*s-2.428592205*o+.4505937099*a,h=.0259040371*s+.7827717662*o-.808675766*a;return[c*100,u*100,h*100]};se.oklab.oklch=function(i){return se.lab.lch(i)};se.oklab.xyz=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100,s=(.999999998*e+.396337792*t+.215803758*n)**3,o=(1.000000008*e-.105561342*t-.063854175*n)**3,a=(1.000000055*e-.089484182*t-1.291485538*n)**3,c=1.227013851*s-.55779998*o+.281256149*a,u=-.040580178*s+1.11225687*o-.071676679*a,h=-.076381285*s-.421481978*o+1.58616322*a;return[c*100,u*100,h*100]};se.oklab.rgb=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100,s=(e+.3963377774*t+.2158037573*n)**3,o=(e-.1055613458*t-.0638541728*n)**3,a=(e-.0894841775*t-1.291485548*n)**3,c=ga(4.0767416621*s-3.3077115913*o+.2309699292*a),u=ga(-1.2684380046*s+2.6097574011*o-.3413193965*a),h=ga(-.0041960863*s-.7034186147*o+1.707614701*a);return[c*255,u*255,h*255]};se.oklch.oklab=function(i){return se.lch.lab(i)};se.lab.xyz=function(i){const e=i[0],t=i[1],n=i[2];let s,o,a;o=(e+16)/116,s=t/500+o,a=o-n/200;const c=o**3,u=s**3,h=a**3;return o=c>Cs?c:(o-16/116)/7.787,s=u>Cs?u:(s-16/116)/7.787,a=h>Cs?h:(a-16/116)/7.787,s*=95.047,o*=100,a*=108.883,[s,o,a]};se.lab.lch=function(i){const e=i[0],t=i[1],n=i[2];let s;s=Math.atan2(n,t)*360/2/Math.PI,s<0&&(s+=360);const a=Math.sqrt(t*t+n*n);return[e,a,s]};se.lch.lab=function(i){const e=i[0],t=i[1],s=i[2]/360*2*Math.PI,o=t*Math.cos(s),a=t*Math.sin(s);return[e,o,a]};se.rgb.ansi16=function(i,e=null){const[t,n,s]=i;let o=e===null?se.rgb.hsv(i)[2]:e;if(o=Math.round(o/50),o===0)return 30;let a=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return o===2&&(a+=60),a};se.hsv.ansi16=function(i){return se.rgb.ansi16(se.hsv.rgb(i),i[2])};se.rgb.ansi256=function(i){const e=i[0],t=i[1],n=i[2];return e>>4===t>>4&&t>>4===n>>4?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)};se.ansi16.rgb=function(i){i=i[0];let e=i%10;if(e===0||e===7)return i>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const t=(Math.trunc(i>50)+1)*.5,n=(e&1)*t*255,s=(e>>1&1)*t*255,o=(e>>2&1)*t*255;return[n,s,o]};se.ansi256.rgb=function(i){if(i=i[0],i>=232){const o=(i-232)*10+8;return[o,o,o]}i-=16;let e;const t=Math.floor(i/36)/5*255,n=Math.floor((e=i%36)/6)/5*255,s=e%6/5*255;return[t,n,s]};se.rgb.hex=function(i){const t=(((Math.round(i[0])&255)<<16)+((Math.round(i[1])&255)<<8)+(Math.round(i[2])&255)).toString(16).toUpperCase();return"000000".slice(t.length)+t};se.hex.rgb=function(i){const e=i.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!e)return[0,0,0];let t=e[0];e[0].length===3&&(t=[...t].map(c=>c+c).join(""));const n=Number.parseInt(t,16),s=n>>16&255,o=n>>8&255,a=n&255;return[s,o,a]};se.rgb.hcg=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.max(Math.max(e,t),n),o=Math.min(Math.min(e,t),n),a=s-o;let c;const u=a<1?o/(1-a):0;return a<=0?c=0:s===e?c=(t-n)/a%6:s===t?c=2+(n-e)/a:c=4+(e-t)/a,c/=6,c%=1,[c*360,a*100,u*100]};se.hsl.hcg=function(i){const e=i[1]/100,t=i[2]/100,n=t<.5?2*e*t:2*e*(1-t);let s=0;return n<1&&(s=(t-.5*n)/(1-n)),[i[0],n*100,s*100]};se.hsv.hcg=function(i){const e=i[1]/100,t=i[2]/100,n=e*t;let s=0;return n<1&&(s=(t-n)/(1-n)),[i[0],n*100,s*100]};se.hcg.rgb=function(i){const e=i[0]/360,t=i[1]/100,n=i[2]/100;if(t===0)return[n*255,n*255,n*255];const s=[0,0,0],o=e%1*6,a=o%1,c=1-a;let u=0;switch(Math.floor(o)){case 0:{s[0]=1,s[1]=a,s[2]=0;break}case 1:{s[0]=c,s[1]=1,s[2]=0;break}case 2:{s[0]=0,s[1]=1,s[2]=a;break}case 3:{s[0]=0,s[1]=c,s[2]=1;break}case 4:{s[0]=a,s[1]=0,s[2]=1;break}default:s[0]=1,s[1]=0,s[2]=c}return u=(1-t)*n,[(t*s[0]+u)*255,(t*s[1]+u)*255,(t*s[2]+u)*255]};se.hcg.hsv=function(i){const e=i[1]/100,t=i[2]/100,n=e+t*(1-e);let s=0;return n>0&&(s=e/n),[i[0],s*100,n*100]};se.hcg.hsl=function(i){const e=i[1]/100,n=i[2]/100*(1-e)+.5*e;let s=0;return n>0&&n<.5?s=e/(2*n):n>=.5&&n<1&&(s=e/(2*(1-n))),[i[0],s*100,n*100]};se.hcg.hwb=function(i){const e=i[1]/100,t=i[2]/100,n=e+t*(1-e);return[i[0],(n-e)*100,(1-n)*100]};se.hwb.hcg=function(i){const e=i[1]/100,n=1-i[2]/100,s=n-e;let o=0;return s<1&&(o=(n-s)/(1-s)),[i[0],s*100,o*100]};se.apple.rgb=function(i){return[i[0]/65535*255,i[1]/65535*255,i[2]/65535*255]};se.rgb.apple=function(i){return[i[0]/255*65535,i[1]/255*65535,i[2]/255*65535]};se.gray.rgb=function(i){return[i[0]/100*255,i[0]/100*255,i[0]/100*255]};se.gray.hsl=function(i){return[0,0,i[0]]};se.gray.hsv=se.gray.hsl;se.gray.hwb=function(i){return[0,100,i[0]]};se.gray.cmyk=function(i){return[0,0,0,i[0]]};se.gray.lab=function(i){return[i[0],0,0]};se.gray.hex=function(i){const e=Math.round(i[0]/100*255)&255,n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".slice(n.length)+n};se.rgb.gray=function(i){return[(i[0]+i[1]+i[2])/3/255*100]};function QN(){const i={},e=Object.keys(se);for(let{length:t}=e,n=0;n<t;n++)i[e[n]]={distance:-1,parent:null};return i}function XN(i){const e=QN(),t=[i];for(e[i].distance=0;t.length>0;){const n=t.pop(),s=Object.keys(se[n]);for(let{length:o}=s,a=0;a<o;a++){const c=s[a],u=e[c];u.distance===-1&&(u.distance=e[n].distance+1,u.parent=n,t.unshift(c))}}return e}function ZN(i,e){return function(t){return e(i(t))}}function e6(i,e){const t=[e[i].parent,i];let n=se[e[i].parent][i],s=e[i].parent;for(;e[s].parent;)t.unshift(e[s].parent),n=ZN(se[e[s].parent][s],n),s=e[s].parent;return n.conversion=t,n}function t6(i){const e=XN(i),t={},n=Object.keys(e);for(let{length:s}=n,o=0;o<s;o++){const a=n[o];e[a].parent!==null&&(t[a]=e6(a,e))}return t}const Uo={},n6=Object.keys(se);function i6(i){const e=function(...t){const n=t[0];return n==null?n:(n.length>1&&(t=n),i(t))};return"conversion"in i&&(e.conversion=i.conversion),e}function s6(i){const e=function(...t){const n=t[0];if(n==null)return n;n.length>1&&(t=n);const s=i(t);if(typeof s=="object")for(let{length:o}=s,a=0;a<o;a++)s[a]=Math.round(s[a]);return s};return"conversion"in i&&(e.conversion=i.conversion),e}for(const i of n6){Uo[i]={},Object.defineProperty(Uo[i],"channels",{value:se[i].channels}),Object.defineProperty(Uo[i],"labels",{value:se[i].labels});const e=t6(i),t=Object.keys(e);for(const n of t){const s=e[n];Uo[i][n]=s6(s),Uo[i][n].raw=i6(s)}}const wc=(i,e=0,t=1)=>i>t?t:i<e?e:i,Wt=(i,e=0,t=Math.pow(10,e))=>Math.round(t*i)/t,o6=i=>u6(Zp(i)),Zp=i=>(i[0]==="#"&&(i=i.substring(1)),i.length<6?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Wt(parseInt(i[3]+i[3],16)/255,2):1}:{r:parseInt(i.substring(0,2),16),g:parseInt(i.substring(2,4),16),b:parseInt(i.substring(4,6),16),a:i.length===8?Wt(parseInt(i.substring(6,8),16)/255,2):1}),r6=i=>c6(l6(i)),a6=({h:i,s:e,v:t,a:n})=>{const s=(200-e)*t/100;return{h:Wt(i),s:Wt(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:Wt(s/2),a:Wt(n,2)}},eb=i=>{const{h:e,s:t,l:n}=a6(i);return`hsl(${e}, ${t}%, ${n}%)`},l6=({h:i,s:e,v:t,a:n})=>{i=i/360*6,e=e/100,t=t/100;const s=Math.floor(i),o=t*(1-e),a=t*(1-(i-s)*e),c=t*(1-(1-i+s)*e),u=s%6;return{r:Wt([t,a,o,o,c,t][u]*255),g:Wt([c,t,t,a,o,o][u]*255),b:Wt([o,o,c,t,t,a][u]*255),a:Wt(n,2)}},gd=i=>{const e=i.toString(16);return e.length<2?"0"+e:e},c6=({r:i,g:e,b:t,a:n})=>{const s=n<1?gd(Wt(n*255)):"";return"#"+gd(i)+gd(e)+gd(t)+s},u6=({r:i,g:e,b:t,a:n})=>{const s=Math.max(i,e,t),o=s-Math.min(i,e,t),a=o?s===i?(e-t)/o:s===e?2+(t-i)/o:4+(i-e)/o:0;return{h:Wt(60*(a<0?a+6:a)),s:Wt(s?o/s*100:0),v:Wt(s/255*100),a:n}},hA=(i,e)=>{if(i===e)return!0;for(const t in i)if(i[t]!==e[t])return!1;return!0},d6=(i,e)=>i.toLowerCase()===e.toLowerCase()?!0:hA(Zp(i),Zp(e)),RC={},fA=i=>{let e=RC[i];return e||(e=document.createElement("template"),e.innerHTML=i,RC[i]=e),e},mw=(i,e,t)=>{i.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:t}))};let ba=!1;const tb=i=>"touches"in i,h6=i=>ba&&!tb(i)?!1:(ba||(ba=tb(i)),!0),OC=(i,e)=>{const t=tb(e)?e.touches[0]:e,n=i.el.getBoundingClientRect();mw(i.el,"move",i.getMove({x:wc((t.pageX-(n.left+window.pageXOffset))/n.width),y:wc((t.pageY-(n.top+window.pageYOffset))/n.height)}))},f6=(i,e)=>{const t=e.keyCode;t>40||i.xy&&t<37||t<33||(e.preventDefault(),mw(i.el,"move",i.getMove({x:t===39?.01:t===37?-.01:t===34?.05:t===33?-.05:t===35?1:t===36?-1:0,y:t===40?.01:t===38?-.01:0},!0)))};class mA{constructor(e,t,n,s){const o=fA(`<div role="slider" tabindex="0" part="${t}" ${n}><div part="${t}-pointer"></div></div>`);e.appendChild(o.content.cloneNode(!0));const a=e.querySelector(`[part=${t}]`);a.addEventListener("mousedown",this),a.addEventListener("touchstart",this),a.addEventListener("keydown",this),this.el=a,this.xy=s,this.nodes=[a.firstChild,a]}set dragging(e){const t=e?document.addEventListener:document.removeEventListener;t(ba?"touchmove":"mousemove",this),t(ba?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!h6(e)||!ba&&e.button!=0)return;this.el.focus(),OC(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),OC(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":f6(this,e);break}}style(e){e.forEach((t,n)=>{for(const s in t)this.nodes[n].style.setProperty(s,t[s])})}}class m6 extends mA{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:eb({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Wt(e)}`)}getMove(e,t){return{h:t?wc(this.h+e.x*360,0,360):360*e.x}}}class g6 extends mA{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:eb(e)},{"background-color":eb({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Wt(e.s)}%, Brightness ${Wt(e.v)}%`)}getMove(e,t){return{s:t?wc(this.hsva.s+e.x*100,0,100):e.x*100,v:t?wc(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}}const p6=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',b6="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",w6="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",pd=Symbol("same"),Zg=Symbol("color"),VC=Symbol("hsva"),ep=Symbol("update"),BC=Symbol("parts"),MC=Symbol("css"),NC=Symbol("sliders");class _6 extends HTMLElement{static get observedAttributes(){return["color"]}get[MC](){return[p6,b6,w6]}get[NC](){return[g6,m6]}get color(){return this[Zg]}set color(e){if(!this[pd](e)){const t=this.colorModel.toHsva(e);this[ep](t),this[Zg]=e}}constructor(){super();const e=fA(`<style>${this[MC].join("")}</style>`),t=this.attachShadow({mode:"open"});t.appendChild(e.content.cloneNode(!0)),t.addEventListener("move",this),this[BC]=this[NC].map(n=>new n(t))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,t,n){const s=this.colorModel.fromAttr(n);this[pd](s)||(this.color=s)}handleEvent(e){const t=this[VC],n={...t,...e.detail};this[ep](n);let s;!hA(n,t)&&!this[pd](s=this.colorModel.fromHsva(n))&&(this[Zg]=s,mw(this,"color-changed",{value:s}))}[pd](e){return this.color&&this.colorModel.equal(e,this.color)}[ep](e){this[VC]=e,this[BC].forEach(t=>t.update(e))}}const y6={defaultColor:"#000",toHsva:o6,fromHsva:({h:i,s:e,v:t})=>r6({h:i,s:e,v:t,a:1}),equal:d6,fromAttr:i=>i};class v6 extends _6{get colorModel(){return y6}}class Gt extends Dt{_parentElement;constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(t,n,s)=>{this._renderViewIntoCollectionParent(n,s)}),this.on("remove",(t,n)=>{n.element&&this._parentElement&&n.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...e){if(!e.length||!C6(e))throw new E("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const n of this)for(const s of e)n.delegate(s).to(t);this.on("add",(n,s)=>{for(const o of e)s.delegate(o).to(t)}),this.on("remove",(n,s)=>{for(const o of e)s.stopDelegating(o,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}}function C6(i){return i.every(e=>typeof e=="string")}const k6="http://www.w3.org/1999/xhtml";class yn extends Je(){ns;tag;text;attributes;children;eventListeners;_isRendered;_revertData;constructor(e){super(),Object.assign(this,DC(LC(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=UC(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new E("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(t){if(t.children)for(const n of t.children)lh(n)?yield n:gw(n)&&(yield*e(n))}yield*e(this)}static bind(e,t){return{to(n,s){return new T6({eventNameOrFunction:n,attribute:n,observable:e,emitter:t,callback:s})},if(n,s,o){return new gA({observable:e,emitter:t,attribute:n,valueIfTrue:s,callback:o})}}}static extend(e,t){if(e._isRendered)throw new E("template-extend-render",[this,e]);_A(e,DC(LC(t)))}_renderNode(e){let t;if(e.node?t=this.tag&&this.text:t=this.tag?this.text:!this.text,t)throw new E("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||k6,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),Fd(this.text)?this._bindToObservable({schema:this.text,updater:S6(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,n=e.revertData;for(const s in this.attributes){const o=t.getAttribute(s),a=this.attributes[s];n&&(n.attributes[s]=o);const c=zC(a)?a[0].ns:null;if(Fd(a)){const u=zC(a)?a[0].value:a;n&&HC(s)&&u.unshift(o),this._bindToObservable({schema:u,updater:A6(t,s,c),data:e})}else if(s=="style"&&typeof a[0]!="string")this._renderStyleAttribute(a[0],e);else{n&&o&&HC(s)&&a.unshift(o);const u=a.map(h=>h&&(h.value||h)).reduce((h,m)=>h.concat(m),[]).reduce(wA,"");va(u)||t.setAttributeNS(c,s,u)}}}_renderStyleAttribute(e,t){const n=t.node;for(const s in e){const o=e[s];Fd(o)?this._bindToObservable({schema:[o],updater:x6(n,s),data:t}):nb(s)?n.style.setProperty(s,o):n.style[s]=o}}_renderElementChildren(e){const t=e.node,n=e.intoFragment?document.createDocumentFragment():t,s=e.isApplying;let o=0;for(const a of this.children)if(pw(a)){if(!s){a.setParent(t);for(const c of a)n.appendChild(c.element)}}else if(lh(a))s||(a.isRendered||a.render(),n.appendChild(a.element));else if(lo(a))n.appendChild(a);else if(s){const c=e.revertData,u=UC();c.children.push(u),a._renderNode({intoFragment:!1,node:n.childNodes[o++],isApplying:!0,revertData:u})}else n.appendChild(a.render());e.intoFragment&&t.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const n=this.eventListeners[t].map(s=>{const[o,a]=t.split("@");return s.activateDomEventListener(o,a,e)});e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:t,data:n}){const s=n.revertData;pA(e,t,n);const o=e.filter(a=>!va(a)).filter(a=>a.observable).map(a=>a.activateAttributeListener(e,t,n));s&&s.bindings.push(o)}_revertTemplateFromNode(e,t){for(const s of t.bindings)for(const o of s)o();if(t.text){e.textContent=t.text;return}const n=e;for(const s in t.attributes){const o=t.attributes[s];o===null?n.removeAttribute(s):n.setAttribute(s,o)}for(let s=0;s<t.children.length;++s)this._revertTemplateFromNode(n.childNodes[s],t.children[s])}}class Nc{attribute;observable;emitter;callback;constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,n){const s=()=>pA(e,t,n);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,s),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,s)}}}class T6 extends Nc{eventNameOrFunction;constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,n){const s=(o,a)=>{(!t||a.target.matches(t))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(a):this.observable.fire(this.eventNameOrFunction,a))};return this.emitter.listenTo(n.node,e,s),()=>{this.emitter.stopListening(n.node,e,s)}}}class gA extends Nc{valueIfTrue;constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const t=super.getValue(e);return va(t)?!1:this.valueIfTrue||!0}}function Fd(i){return i?(i.value&&(i=i.value),Array.isArray(i)?i.some(Fd):i instanceof Nc):!1}function nb(i){return/^--[a-zA-Z_-][\w-]*$/.test(i)}function E6(i,e){return i.map(t=>t instanceof Nc?t.getValue(e):t)}function pA(i,e,{node:t}){const n=E6(i,t);let s;i.length==1&&i[0]instanceof gA?s=n[0]:s=n.reduce(wA,""),va(s)?e.remove():e.set(s)}function S6(i){return{set(e){i.textContent=e},remove(){i.textContent=""}}}function A6(i,e,t){return{set(n){i.setAttributeNS(t,e,n)},remove(){i.removeAttributeNS(t,e)}}}function x6(i,e){return{set(t){nb(e)?i.style.setProperty(e,t):i.style[e]=t},remove(){nb(e)?i.style.removeProperty(e):i.style[e]=null}}}function LC(i){return Nh(i,t=>{if(t&&(t instanceof Nc||gw(t)||lh(t)||pw(t)))return t})}function DC(i){if(typeof i=="string"?i=R6(i):i.text&&O6(i),i.on&&(i.eventListeners=P6(i.on),delete i.on),!i.text){i.attributes&&I6(i.attributes);const e=[];if(i.children)if(pw(i.children))e.push(i.children);else for(const t of i.children)gw(t)||lh(t)||lo(t)?e.push(t):e.push(new yn(t));i.children=e}return i}function I6(i){for(const e in i)i[e].value&&(i[e].value=st(i[e].value)),bA(i,e)}function P6(i){for(const e in i)bA(i,e);return i}function R6(i){return{text:[i]}}function O6(i){i.text=st(i.text)}function bA(i,e){i[e]=st(i[e])}function wA(i,e){return va(e)?i:va(i)?e:`${i} ${e}`}function FC(i,e){for(const t in e)i[t]?i[t].push(...e[t]):i[t]=e[t]}function _A(i,e){if(e.attributes&&(i.attributes||(i.attributes={}),FC(i.attributes,e.attributes)),e.eventListeners&&(i.eventListeners||(i.eventListeners={}),FC(i.eventListeners,e.eventListeners)),e.text&&i.text.push(...e.text),e.children&&e.children.length){if(i.children.length!=e.children.length)throw new E("ui-template-extend-children-mismatch",i);let t=0;for(const n of e.children)_A(i.children[t++],n)}}function va(i){return!i&&i!==0}function lh(i){return i instanceof oe}function gw(i){return i instanceof yn}function pw(i){return i instanceof Gt}function zC(i){return on(i[0])&&i[0].ns}function UC(){return{children:[],bindings:[],attributes:{}}}function HC(i){return i=="class"||i=="style"}class oe extends Hn(qe()){element;isRendered;locale;t;template;_viewCollections;_unboundChildren;_bindTemplate;constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Dt,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,n)=>{n.locale=e,n.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=yn.bind(this,this)}createCollection(e){const t=new Gt(e);return this._viewCollections.add(t),t}registerChild(e){Dn(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){Dn(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new yn(e)}extendTemplate(e){yn.extend(this.template,e)}render(){if(this.isRendered)throw new E("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}const jC={POLITE:"polite",ASSERTIVE:"assertive"};class V6{editor;view;constructor(e){this.editor=e,e.once("ready",()=>{for(const t of Object.values(jC))this.announce("",t)})}announce(e,t=jC.POLITE){const n=this.editor;if(!n.ui.view)return;this.view||(this.view=new B6(n.locale),n.ui.view.body.add(this.view));const{politeness:s,isUnsafeHTML:o}=typeof t=="string"?{politeness:t}:t;let a=this.view.regionViews.find(c=>c.politeness===s);a||(a=new M6(n,s),this.view.regionViews.add(a)),a.announce({announcement:e,isUnsafeHTML:o})}}class B6 extends oe{regionViews;constructor(e){super(e),this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class M6 extends oe{politeness;_domConverter;_pruneAnnouncementsInterval;constructor(e,t){super(e.locale),this.setTemplate({tag:"div",attributes:{"aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=t,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:t}){if(!e.trim().length)return;const n=document.createElement("li");t?this._domConverter.setContentOf(n,e):n.innerText=e,this._listElement.appendChild(n)}get _listElement(){return this.element.querySelector("ul")}}function sr({emitter:i,activator:e,callback:t,contextElements:n,listenerOptions:s}){i.listenTo(document,"mousedown",(o,a)=>{if(!e())return;const c=typeof a.composedPath=="function"?a.composedPath():[],u=typeof n=="function"?n():n;for(const h of u)if(h.contains(a.target)||c.includes(h))return;t()},s)}function _c(i){class e extends i{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...n){super(...n),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.template&&this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return e}function N6(i){class e extends i{_onDragBound=this._onDrag.bind(this);_onDragEndBound=this._onDragEnd.bind(this);_lastDraggingCoordinates={x:0,y:0};constructor(...n){super(...n),this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(ee.document,"mouseup",this._onDragEndBound),this.listenTo(ee.document,"touchend",this._onDragEndBound),this.listenTo(ee.document,"mousemove",this._onDragBound),this.listenTo(ee.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(ee.document,"mouseup",this._onDragEndBound),this.stopListening(ee.document,"touchend",this._onDragEndBound),this.stopListening(ee.document,"mousemove",this._onDragBound),this.stopListening(ee.document,"touchmove",this._onDragBound)}_onDragStart(n,s){if(!this._isHandleElementPressed(s))return;this._attachDragListeners();let o=0,a=0;s instanceof MouseEvent?(o=s.clientX,a=s.clientY):(o=s.touches[0].clientX,a=s.touches[0].clientY),this._lastDraggingCoordinates={x:o,y:a},this.isDragging=!0}_onDrag(n,s){if(!this.isDragging){this._detachDragListeners();return}let o=0,a=0;s instanceof MouseEvent?(o=s.clientX,a=s.clientY):(o=s.touches[0].clientX,a=s.touches[0].clientY),s.preventDefault(),this.fire("drag",{deltaX:Math.round(o-this._lastDraggingCoordinates.x),deltaY:Math.round(a-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:o,y:a}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(n){return this.dragHandleElement?this.dragHandleElement===n.target||n.target instanceof HTMLElement&&this.dragHandleElement.contains(n.target):!1}}return e}function or({view:i}){i.listenTo(i.element,"submit",(e,t)=>{t.preventDefault(),i.fire("submit")},{useCapture:!0})}function yA({keystrokeHandler:i,focusTracker:e,gridItems:t,numberOfColumns:n,uiLanguageDirection:s}){const o=typeof n=="number"?()=>n:n;i.set("arrowright",a((h,m)=>s==="rtl"?u(h,m.length):c(h,m.length))),i.set("arrowleft",a((h,m)=>s==="rtl"?c(h,m.length):u(h,m.length))),i.set("arrowup",a((h,m)=>{let g=h-o();return g<0&&(g=h+o()*Math.floor(m.length/o()),g>m.length-1&&(g-=o())),g})),i.set("arrowdown",a((h,m)=>{let g=h+o();return g>m.length-1&&(g=h%o()),g}));function a(h){return m=>{const g=t.find(v=>v.element===e.focusedElement),w=t.getIndex(g),_=h(w,t);t.get(_).focus(),m.stopPropagation(),m.preventDefault()}}function c(h,m){return h===m-1?0:h+1}function u(h,m){return h===0?m-1:h-1}}class ii extends oe{id;constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${rn()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}class L6 extends oe{constructor(e,t){super(e);const n=e.t,s=new ii;s.text=n("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":s.id,role:"document",tabindex:-1},children:[fi(document,"p",{},n("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(t.values())),s]})}focus(){this.element.focus()}_createCategories(e){return e.map(t=>{const n=[fi(document,"h3",{},t.label),...Array.from(t.groups.values()).map(s=>this._createGroup(s)).flat()];return t.description&&n.splice(1,0,fi(document,"p",{},t.description)),fi(document,"section",{},n)})}_createGroup(e){const t=e.keystrokes.sort((s,o)=>s.label.localeCompare(o.label)).map(s=>this._createGroupRow(s)).flat(),n=[fi(document,"dl",{},t)];return e.label&&n.unshift(fi(document,"h4",{},e.label)),n}_createGroupRow(e){const t=this.locale.t,n=fi(document,"dt"),s=fi(document,"dd"),o=F6(e.keystroke),a=[];for(const c of o)a.push(c.map(D6).join(""));return n.innerHTML=e.label,s.innerHTML=a.join(", ")+(e.mayRequireFn&&le.isMac?` ${t("(may require <kbd>Fn</kbd>)")}`:""),[n,s]}}function D6(i){return eh(i).split("+").map(e=>`<kbd>${e}</kbd>`).join("+")}function F6(i){return typeof i=="string"?[[i]]:typeof i[0]=="string"?[i]:i}class ki extends oe{static presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",e.if("isVisible","ck-hidden",t=>!t),"ck-reset_all-excluded",e.if("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox"),"aria-hidden":!0}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg");if(!t)throw new E("ui-iconview-invalid-svg",this);const n=t.getAttribute("viewBox");n&&(this.viewBox=n);for(const{name:s,value:o}of Array.from(t.attributes))ki.presentationalAttributeNames.includes(s)&&this.element.setAttribute(s,o);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}class vA extends oe{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}}class ue extends oe{children;labelView;iconView;keystrokeView;_focusDelayed=null;constructor(e,t=new vA){super(e);const n=this.bindTemplate,s=rn();this.set("_ariaPressed",!1),this.set("_ariaChecked",!1),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${s}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(t),this.iconView=new ki,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.iconView.bind("content").to(this,"icon"),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",n.to("class"),n.if("isEnabled","ck-disabled",a=>!a),n.if("isVisible","ck-hidden",a=>!a),n.to("isOn",a=>a?"ck-on":"ck-off"),n.if("withText","ck-button_with-text"),n.if("withKeystroke","ck-button_with-keystroke")],role:n.to("role"),type:n.to("type",a=>a||"button"),tabindex:n.to("tabindex"),"aria-checked":n.to("_ariaChecked"),"aria-pressed":n.to("_ariaPressed"),"aria-label":n.to("ariaLabel"),"aria-labelledby":n.to("ariaLabelledBy"),"aria-disabled":n.if("isEnabled",!0,a=>!a),"data-cke-tooltip-text":n.to("_tooltipString"),"data-cke-tooltip-position":n.to("tooltipPosition")},children:this.children,on:{click:n.to(a=>{this.isEnabled?this.fire("execute"):a.preventDefault()})}};this.bind("_ariaPressed").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||qC(u)?!1:String(!!a)),this.bind("_ariaChecked").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||!qC(u)?!1:String(!!a)),le.isSafari&&(this._focusDelayed||(this._focusDelayed=Kb(()=>this.focus(),0)),o.on.mousedown=n.to(()=>{this._focusDelayed()}),o.on.mouseup=n.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&this.children.add(this.iconView),this.on("change:icon",(e,t,n,s)=>{n&&!s?this.children.add(this.iconView,0):!n&&s&&this.children.remove(this.iconView)}),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new oe;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>eh(t))}]}),e}_getTooltipString(e,t,n){return e?typeof e=="string"?e:(n&&(n=eh(n)),e instanceof Function?e(t,n):`${t}${n?` (${n})`:""}`):""}}function qC(i){switch(i){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1}}class fo extends oe{children;iconView;constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",n.to("class")]},children:this.children}),t.icon&&(this.iconView=new ki,this.iconView.content=t.icon,this.children.add(this.iconView));const s=new oe(e);s.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:n.to("label")}]}),this.children.add(s)}}class an extends Je(){focusables;focusTracker;keystrokeHandler;actions;constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let n=e.actions[t];typeof n=="string"&&(n=[n]);for(const s of n)e.keystrokeHandler.set(s,(o,a)=>{this[t](),a()},e.keystrokeHandlerOptions)}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(tp)||null}get last(){return this.focusables.filter(tp).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((t,n)=>{const s=t.element===this.focusTracker.focusedElement;return s&&(e=n),s}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}chain(e){const t=()=>this.current===null?null:this.focusables.get(this.current);this.listenTo(e,"forwardCycle",n=>{const s=t();this.focusNext(),s!==t()&&n.stop()},{priority:"low"}),this.listenTo(e,"backwardCycle",n=>{const s=t();this.focusPrevious(),s!==t()&&n.stop()},{priority:"low"})}unchain(e){this.stopListening(e)}_focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t)}_getDomFocusableItem(e){const t=this.focusables.length;if(!t)return null;const n=this.current;if(n===null)return this[e===1?"first":"last"];let s=this.focusables.get(n),o=(n+t+e)%t;do{const a=this.focusables.get(o);if(tp(a)){s=a;break}o=(o+t+e)%t}while(o!==n);return s}}function tp(i){return Lc(i)&&Es(i.element)}function Lc(i){return"focus"in i&&typeof i.focus=="function"}function z6(i){return Lc(i)&&"focusCycler"in i&&i.focusCycler instanceof an}class U6 extends oe{children;keystrokes;focusCycler;_focusTracker;_focusables;constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new Ct,this._focusTracker=new dt,this._focusables=new Gt,this.focusCycler=new an({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const t of e){const n=new ue(this.locale);let s;n.on("execute",()=>t.onExecute()),t.onCreate&&t.onCreate(n);for(s in t)s!="onExecute"&&s!="onCreate"&&n.set(s,t[s]);this.children.add(n)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}class H6 extends oe{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}const di={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},WC=Mc("px");class yc extends N6(oe){parts;headerView;closeButtonView;actionsView;static defaultOffset=15;contentView;keystrokes;focusTracker;wasMoved=!1;_getCurrentDomRoot;_getViewportOffset;_focusables;_focusCycler;constructor(e,{getCurrentDomRoot:t,getViewportOffset:n,keystrokeHandlerOptions:s}){super(e);const o=this.bindTemplate,a=e.t;this.set("className",""),this.set("ariaLabel",a("Editor dialog")),this.set("isModal",!1),this.set("position",di.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=t,this._getViewportOffset=n,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new Ct,this.focusTracker=new dt,this._focusables=new Gt,this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"},keystrokeHandlerOptions:s}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",o.if("isModal","ck-dialog-overlay__transparent",c=>!c),o.if("_isVisible","ck-hidden",c=>!c)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",o.if("isModal","ck-dialog_modal"),o.to("className")],role:"dialog","aria-label":o.to("ariaLabel"),style:{top:o.to("_top",c=>WC(c)),left:o.to("_left",c=>WC(c)),visibility:o.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,t)=>{e.defaultPrevented||(this.fire("close",{source:"escKeyPress"}),t())}),this.on("drag",(e,{deltaX:t,deltaY:n})=>{this.wasMoved=!0,this.moveBy(t,n)}),this.listenTo(ee.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(ee.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,t,n)=>{n&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView&&!this.isModal?this.headerView.element:null}setupParts({icon:e,title:t,hasCloseButton:n=!0,content:s,actionButtons:o}){t&&(this.headerView=new fo(this.locale,{icon:e}),n&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=t,this.ariaLabel=t,this.parts.add(this.headerView,0)),s&&(s instanceof oe&&(s=[s]),this.contentView=new H6(this.locale),this.contentView.children.addMany(s),this.parts.add(this.contentView)),o&&(this.actionsView=new U6(this.locale),this.actionsView.setButtons(o),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,t){const n=this._getViewportRect(),s=this._getDialogRect();e+s.width>n.right&&(e=n.right-s.width),e<n.left&&(e=n.left),t<n.top&&(t=n.top),this._moveTo(e,t)}_moveTo(e,t){this._left=e,this._top=t}moveBy(e,t){this.moveTo(this._left+e,this._top+t)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let t=this.position,n;this._getCurrentDomRoot()?n=this._getVisibleDomRootRect(e):t=di.SCREEN_CENTER;const s=yc.defaultOffset,o=this._getDialogRect();if(this.position!=null){if(typeof this.position=="function"){const a=this.position(o,n);if(a==null){this._moveOffScreen();return}this._moveTo(a.left,a.top);return}switch(t){case di.EDITOR_TOP_SIDE:{if(n){const a=this.locale.contentLanguageDirection==="ltr"?n.right-o.width-s:n.left+s;this.moveTo(a,n.top+s)}else this._moveOffScreen();break}case di.EDITOR_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),Math.round(n.top+n.height/2-o.height/2)):this._moveOffScreen();break}case di.SCREEN_CENTER:{this.moveTo(Math.round((e.width-o.width)/2),Math.round((e.height-o.height)/2));break}case di.EDITOR_TOP_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top+s):this._moveOffScreen();break}case di.EDITOR_BOTTOM_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom-o.height-s):this._moveOffScreen();break}case di.EDITOR_ABOVE_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top-o.height-s):this._moveOffScreen();break}case di.EDITOR_BELOW_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom+s):this._moveOffScreen();break}}}}_getVisibleDomRootRect(e){let t=new pe(this._getCurrentDomRoot()).getVisible();if(t){if(t=e.getIntersection(t),!t)return null}else return null;return t}_getDialogRect(){return new pe(this.element.firstElementChild)}_getViewportRect(){const e=new pe(ee.window);return this.isModal?e:KE(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const t of this.contentView.children)Lc(t)&&e.push(t);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element),z6(t)&&this._focusCycler.chain(t.focusCycler)})}_createCloseButton(){const e=new ue(this.locale),t=this.locale.t;return e.set({label:t("Close"),tooltip:!0,icon:qh}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}}class mi extends N{view;static _visibleDialogPlugin;_onHide;static get pluginName(){return"Dialog"}static get isOfficialPlugin(){return!0}constructor(e){super(e);const t=e.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set({id:null,isOpen:!1}),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:t("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}destroy(){super.destroy(),mi._visibleDialogPlugin===this&&this._unlockBodyScroll()}_initShowHideListeners(){this.on("show",(e,t)=>{this._show(t)}),this.on("show",(e,t)=>{t.onShow&&t.onShow(this)},{priority:"low"}),this.on("hide",()=>{mi._visibleDialogPlugin&&mi._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const e=this.editor;e.keystrokes.set("Ctrl+F6",(t,n)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?e.editing.view.focus():this.view.focus(),n())})}_initMultiRootIntegration(){const e=this.editor.model;e.document.on("change:data",()=>{if(!this.view)return;const t=e.document.differ.getChangedRoots();for(const n of t)n.state&&this.view.updatePosition()})}show(e){this.hide(),this.fire(`show:${e.id}`,e)}_show({id:e,icon:t,title:n,hasCloseButton:s=!0,content:o,actionButtons:a,className:c,isModal:u,position:h,onHide:m,keystrokeHandlerOptions:g}){const w=this.editor;this.view=new yc(w.locale,{getCurrentDomRoot:()=>w.editing.view.getDomRoot(w.model.document.selection.anchor.root.rootName),getViewportOffset:()=>w.ui.viewportOffset,keystrokeHandlerOptions:g});const _=this.view;_.on("close",()=>{this.hide()}),w.ui.view.body.add(_),w.keystrokes.listenTo(_.element),h||(h=u?di.SCREEN_CENTER:di.EDITOR_CENTER),u&&this._lockBodyScroll(),_.set({position:h,_isVisible:!0,className:c,isModal:u}),_.setupParts({icon:t,title:n,hasCloseButton:s,content:o,actionButtons:a}),this.id=e,m&&(this._onHide=m),this.isOpen=!0,mi._visibleDialogPlugin=this}hide(){mi._visibleDialogPlugin&&mi._visibleDialogPlugin.fire(`hide:${mi._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const e=this.editor,t=this.view;t.isModal&&this._unlockBodyScroll(),t.contentView&&t.contentView.reset(),e.ui.view.body.remove(t),e.ui.focusTracker.remove(t.element),e.keystrokes.stopListening(t.element),t.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,mi._visibleDialogPlugin=null}_lockBodyScroll(){document.documentElement.classList.add("ck-dialog-scroll-locked")}_unlockBodyScroll(){document.documentElement.classList.remove("ck-dialog-scroll-locked")}}class Ea extends ue{_checkIconHolderView=new j6;constructor(e,t=new vA){super(e,t),this.set({hasCheckSpace:!1,_hasCheck:this.isToggleable});const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-list-item-button",n.if("isToggleable","ck-list-item-button_toggleable")]}}),this.bind("_hasCheck").to(this,"hasCheckSpace",this,"isToggleable",(s,o)=>s||o)}render(){super.render(),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount()}_watchCheckIconHolderMount(){this._checkIconHolderView.bind("isOn").to(this,"isOn",e=>this.isToggleable&&e),this.on("change:_hasCheck",(e,t,n)=>{const{children:s,_checkIconHolderView:o}=this;n?s.add(o,0):s.remove(o)})}}class j6 extends oe{children;_checkIconView=this._createCheckIconView();constructor(){super();const e=this.bindTemplate;this.children=this.createCollection(),this.set("isOn",!1),this.setTemplate({tag:"span",children:this.children,attributes:{class:["ck","ck-list-item-button__check-holder",e.to("isOn",t=>t?"ck-on":"ck-off")]}})}render(){super.render(),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount()}_watchCheckIconMount(){this.on("change:isOn",(e,t,n)=>{const{children:s,_checkIconView:o}=this;n&&!s.has(o)?s.add(o):!n&&s.has(o)&&s.remove(o)})}_createCheckIconView(){const e=new ki;return e.content=Wh,e.extendTemplate({attributes:{class:"ck-list-item-button__check-icon"}}),e}}class tt extends Ea{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}class q6 extends N{contentView=null;static get requires(){return[mi]}static get pluginName(){return"AccessibilityHelp"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const n=this._createButton(ue);return n.set({tooltip:!0,withText:!1,label:t("Accessibility help")}),n}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const n=this._createButton(tt);return n.label=t("Accessibility"),n}),e.keystrokes.set("Alt+0",(n,s)=>{this._toggleDialog(),s()}),this._setupRootLabels()}_createButton(e){const t=this.editor,n=t.plugins.get("Dialog"),s=t.locale,o=new e(s);return o.set({keystroke:"Alt+0",icon:yC,isToggleable:!0}),o.on("execute",()=>this._toggleDialog()),o.bind("isOn").to(n,"id",a=>a==="accessibilityHelp"),o}_setupRootLabels(){const e=this.editor,t=e.editing.view,n=e.t;e.ui.on("ready",()=>{t.change(o=>{for(const a of t.document.roots)s(o,a)}),e.on("addRoot",(o,a)=>{const c=e.editing.view.document.getRoot(a.rootName);t.change(u=>s(u,c))},{priority:"low"})});function s(o,a){const u=[a.getAttribute("aria-label"),n("Press %0 for help.",[eh("Alt+0")])].filter(h=>h).join(". ");o.setAttribute("aria-label",u,a)}}_toggleDialog(){const e=this.editor,t=e.plugins.get("Dialog"),n=e.locale.t;this.contentView||(this.contentView=new L6(e.locale,e.accessibility.keystrokeInfos)),t.id==="accessibilityHelp"?t.hide():t.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:n("Accessibility help"),icon:yC,hasCloseButton:!0,content:this.contentView})}}class hi extends Gt{locale;_bodyCollectionContainer;static _bodyWrapper;constructor(e,t=[]){super(t),this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new yn({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render(),(!hi._bodyWrapper||!hi._bodyWrapper.isConnected)&&(hi._bodyWrapper=fi(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(hi._bodyWrapper)),hi._bodyWrapper.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove(),hi._bodyWrapper&&!hi._bodyWrapper.childElementCount&&(hi._bodyWrapper.remove(),delete hi._bodyWrapper)}}const $C=Mc("px"),W6={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};class xt extends oe{content;_pinWhenIsVisibleCallback;_resizeObserver;constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this._resizeObserver=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",n=>`ck-balloon-panel_${n}`),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",$C),left:t.to("left",$C)}},children:this.content})}destroy(){this.hide(),super.destroy()}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){const t=zd(e.target);if(t&&!Es(t))return!1;this.show();const n=xt.defaultPositions,s=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:ee.document.body,fitInViewport:!0},e),o=xt._getOptimalPosition(s)||W6,a=parseInt(o.left),c=parseInt(o.top),u=o.name,h=o.config||{},{withArrow:m=!0}=h;return this.top=c,this.left=a,this.position=u,this.withArrow=m,!0}pin(e){this.unpin(),this._startPinning(e)&&(this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback))}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){if(!this.attachTo(e))return!1;let t=zd(e.target);const n=e.limiter?zd(e.limiter):ee.document.body;if(this.listenTo(ee.document,"scroll",(s,o)=>{const a=o.target,c=t&&a.contains(t),u=n&&a.contains(n);(c||u||!t||!n)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(ee.window,"resize",()=>{this.attachTo(e)}),!this._resizeObserver&&(t&&ut(t)&&(t=t.parentElement),t)){const s=()=>{Es(t)||this.unpin()};this._resizeObserver=new lt(t,s)}return!0}_stopPinning(){this.stopListening(ee.document,"scroll"),this.stopListening(ee.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null)}static generatePositions(e={}){const{sideOffset:t=xt.arrowSideOffset,heightOffset:n=xt.arrowHeightOffset,stickyVerticalOffset:s=xt.stickyVerticalOffset,config:o}=e;return{northWestArrowSouthWest:(u,h)=>({top:a(u,h),left:u.left-t,name:"arrow_sw",...o&&{config:o}}),northWestArrowSouthMiddleWest:(u,h)=>({top:a(u,h),left:u.left-h.width*.25-t,name:"arrow_smw",...o&&{config:o}}),northWestArrowSouth:(u,h)=>({top:a(u,h),left:u.left-h.width/2,name:"arrow_s",...o&&{config:o}}),northWestArrowSouthMiddleEast:(u,h)=>({top:a(u,h),left:u.left-h.width*.75+t,name:"arrow_sme",...o&&{config:o}}),northWestArrowSouthEast:(u,h)=>({top:a(u,h),left:u.left-h.width+t,name:"arrow_se",...o&&{config:o}}),northArrowSouthWest:(u,h)=>({top:a(u,h),left:u.left+u.width/2-t,name:"arrow_sw",...o&&{config:o}}),northArrowSouthMiddleWest:(u,h)=>({top:a(u,h),left:u.left+u.width/2-h.width*.25-t,name:"arrow_smw",...o&&{config:o}}),northArrowSouth:(u,h)=>({top:a(u,h),left:u.left+u.width/2-h.width/2,name:"arrow_s",...o&&{config:o}}),northArrowSouthMiddleEast:(u,h)=>({top:a(u,h),left:u.left+u.width/2-h.width*.75+t,name:"arrow_sme",...o&&{config:o}}),northArrowSouthEast:(u,h)=>({top:a(u,h),left:u.left+u.width/2-h.width+t,name:"arrow_se",...o&&{config:o}}),northEastArrowSouthWest:(u,h)=>({top:a(u,h),left:u.right-t,name:"arrow_sw",...o&&{config:o}}),northEastArrowSouthMiddleWest:(u,h)=>({top:a(u,h),left:u.right-h.width*.25-t,name:"arrow_smw",...o&&{config:o}}),northEastArrowSouth:(u,h)=>({top:a(u,h),left:u.right-h.width/2,name:"arrow_s",...o&&{config:o}}),northEastArrowSouthMiddleEast:(u,h)=>({top:a(u,h),left:u.right-h.width*.75+t,name:"arrow_sme",...o&&{config:o}}),northEastArrowSouthEast:(u,h)=>({top:a(u,h),left:u.right-h.width+t,name:"arrow_se",...o&&{config:o}}),southWestArrowNorthWest:u=>({top:c(u),left:u.left-t,name:"arrow_nw",...o&&{config:o}}),southWestArrowNorthMiddleWest:(u,h)=>({top:c(u),left:u.left-h.width*.25-t,name:"arrow_nmw",...o&&{config:o}}),southWestArrowNorth:(u,h)=>({top:c(u),left:u.left-h.width/2,name:"arrow_n",...o&&{config:o}}),southWestArrowNorthMiddleEast:(u,h)=>({top:c(u),left:u.left-h.width*.75+t,name:"arrow_nme",...o&&{config:o}}),southWestArrowNorthEast:(u,h)=>({top:c(u),left:u.left-h.width+t,name:"arrow_ne",...o&&{config:o}}),southArrowNorthWest:u=>({top:c(u),left:u.left+u.width/2-t,name:"arrow_nw",...o&&{config:o}}),southArrowNorthMiddleWest:(u,h)=>({top:c(u),left:u.left+u.width/2-h.width*.25-t,name:"arrow_nmw",...o&&{config:o}}),southArrowNorth:(u,h)=>({top:c(u),left:u.left+u.width/2-h.width/2,name:"arrow_n",...o&&{config:o}}),southArrowNorthMiddleEast:(u,h)=>({top:c(u),left:u.left+u.width/2-h.width*.75+t,name:"arrow_nme",...o&&{config:o}}),southArrowNorthEast:(u,h)=>({top:c(u),left:u.left+u.width/2-h.width+t,name:"arrow_ne",...o&&{config:o}}),southEastArrowNorthWest:u=>({top:c(u),left:u.right-t,name:"arrow_nw",...o&&{config:o}}),southEastArrowNorthMiddleWest:(u,h)=>({top:c(u),left:u.right-h.width*.25-t,name:"arrow_nmw",...o&&{config:o}}),southEastArrowNorth:(u,h)=>({top:c(u),left:u.right-h.width/2,name:"arrow_n",...o&&{config:o}}),southEastArrowNorthMiddleEast:(u,h)=>({top:c(u),left:u.right-h.width*.75+t,name:"arrow_nme",...o&&{config:o}}),southEastArrowNorthEast:(u,h)=>({top:c(u),left:u.right-h.width+t,name:"arrow_ne",...o&&{config:o}}),westArrowEast:(u,h)=>({top:u.top+u.height/2-h.height/2,left:u.left-h.width-n,name:"arrow_e",...o&&{config:o}}),eastArrowWest:(u,h)=>({top:u.top+u.height/2-h.height/2,left:u.right+n,name:"arrow_w",...o&&{config:o}}),viewportStickyNorth:(u,h,m)=>{const g=new pe(ee.document.body).getIntersection(m.getVisible());if(!g)return null;const w=g.getVisible();return!u.getIntersection(w)||!(w.top-u.top-s<h.height&&w.bottom-u.bottom<h.height)?null:{top:w.top+s,left:u.left+u.width/2-h.width/2,name:"arrowless",config:{withArrow:!1,...o}}}};function a(u,h){return u.top-h.height-n}function c(u){return u.bottom+n}}static arrowSideOffset=25;static arrowHeightOffset=10;static stickyVerticalOffset=20;static _getOptimalPosition=$b;static defaultPositions=xt.generatePositions()}function zd(i){return ao(i)?i:Lh(i)?i.commonAncestorContainer:typeof i=="function"?zd(i()):null}const $6=50,G6=350;class CA extends Hn(){editor;_balloonView=null;_showBalloonThrottled=cc(()=>this._showBalloon(),50,{leading:!0});_lastFocusedEditableElement=null;_balloonClass;constructor(e,t={}){super(),this.editor=e,this._balloonClass=t.balloonClass,e.on("ready",()=>this._handleEditorReady())}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor;this._isEnabled()&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(t,n,s)=>{this._updateLastFocusedEditableElement(),s?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(t,n,s)=>{this._updateLastFocusedEditableElement(),s&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_getNormalizedConfig(){return{side:this.editor.locale.contentLanguageDirection==="ltr"?"right":"left",position:"border",verticalOffset:0,horizontalOffset:5}}_showBalloon(){const e=this._getBalloonAttachOptions();e&&(this._balloonView||(this._balloonView=this._createBalloonView()),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_createBalloonView(){const e=this.editor,t=new xt,n=this._createBadgeContent();return t.content.add(n),this._balloonClass&&(t.class=this._balloonClass),e.ui.view.body.add(t),t}_getBalloonAttachOptions(){if(!this._lastFocusedEditableElement)return null;const e=this._getNormalizedConfig(),t=e.side==="right"?K6(this._lastFocusedEditableElement,e):Y6(this._lastFocusedEditableElement,e);return{target:this._lastFocusedEditableElement,positions:[t]}}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,n=e.ui.focusTracker.focusedElement;if(!t||!n){this._lastFocusedEditableElement=null;return}const s=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));s.includes(n)?this._lastFocusedEditableElement=n:this._lastFocusedEditableElement=s[0]}}function K6(i,e){return kA(i,e,(t,n)=>t.left+t.width-n.width-e.horizontalOffset)}function Y6(i,e){return kA(i,e,t=>t.left+e.horizontalOffset)}function kA(i,e,t){return(n,s)=>{const o=new pe(i);if(o.width<G6||o.height<$6)return null;let a;e.position==="inside"?a=o.bottom-s.height:a=o.bottom-s.height/2,a-=e.verticalOffset;const c=t(o,s),h=n.clone().moveTo(c,a).getIntersection(s.clone().moveTo(c,a)).getVisible();return!h||h.getArea()<s.getArea()?null:{top:a,left:c,name:`position_${e.position}-side_${e.side}`,config:{withArrow:!1}}}}const J6="Powered by";class Q6 extends CA{constructor(e){super(e,{balloonClass:"ck-powered-by-balloon"})}_isEnabled(){const e=this.editor;if(e.config.get("ui.poweredBy.forceVisible"))return!0;const n=e.config.get("licenseKey");if(n=="GPL")return!0;const s=Yb(n.split(".")[1]);return s?!s.whiteLabel:!0}_createBadgeContent(){return new X6(this.editor.locale,this._getNormalizedConfig().label)}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},n=t.position||e.position,s=n==="inside"?5:e.verticalOffset;return{position:n,side:t.side||e.side,label:t.label===void 0?J6:t.label,verticalOffset:t.verticalOffset!==void 0?t.verticalOffset:s,horizontalOffset:t.horizontalOffset!==void 0?t.horizontalOffset:e.horizontalOffset,forceVisible:!!t.forceVisible}}}class X6 extends oe{constructor(e,t){super(e);const n=new ki,s=this.bindTemplate;n.set({content:RN,isColorInherited:!1}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],n],on:{dragstart:s.to(o=>o.preventDefault())}}]})}}class Gh extends ue{toggleSwitchView;constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new oe;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}class GC extends TA(ue){}class Z6 extends TA(Ea){}function TA(i){class e extends i{_fileInputView;constructor(...n){super(...n),this._fileInputView=new eL(this.locale),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}return e}class eL extends oe{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element?.files?.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}class tL extends oe{buttonView;children;constructor(e,t){super(e);const n=this.bindTemplate;this.set("isCollapsed",!1),this.set("label",""),this.buttonView=this._createButtonView(),this.children=this.createCollection(),this.set("_collapsibleAriaLabelUid",void 0),t&&this.children.addMany(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-collapsible",n.if("isCollapsed","ck-collapsible_collapsed")]},children:[this.buttonView,{tag:"div",attributes:{class:["ck","ck-collapsible__children"],role:"region",hidden:n.if("isCollapsed","hidden"),"aria-labelledby":n.to("_collapsibleAriaLabelUid")},children:this.children}]})}render(){super.render(),this._collapsibleAriaLabelUid=this.buttonView.labelView.element.id}focus(){this.buttonView.focus()}_createButtonView(){const e=new ue(this.locale),t=e.bindTemplate;return e.set({withText:!0,icon:$h}),e.extendTemplate({attributes:{"aria-expanded":t.to("isOn",n=>String(n))}}),e.bind("label").to(this),e.bind("isOn").to(this,"isCollapsed",n=>!n),e.on("execute",()=>{this.isCollapsed=!this.isCollapsed}),e}}function vc(i,e){const t=i.t,n={Black:t("Black"),"Dim grey":t("Dim grey"),Grey:t("Grey"),"Light grey":t("Light grey"),White:t("White"),Red:t("Red"),Orange:t("Orange"),Yellow:t("Yellow"),"Light green":t("Light green"),Green:t("Green"),Aquamarine:t("Aquamarine"),Turquoise:t("Turquoise"),"Light blue":t("Light blue"),Blue:t("Blue"),Purple:t("Purple")};return e.map(s=>{const o=n[s.label];return o&&o!=s.label&&(s.label=o),s})}function Cc(i){return i.map(nL).filter(e=>!!e)}function nL(i){return typeof i=="string"?{model:i,label:i,hasBorder:!1,view:{name:"span",styles:{color:i}}}:{model:i.color,label:i.label||i.color,hasBorder:i.hasBorder===void 0?!1:i.hasBorder,view:{name:"span",styles:{color:`${i.color}`}}}}class EA extends ue{constructor(e){super(e);const t=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=oN,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color",n=>le.isMediaForcedColors?null:n)},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}class KC extends oe{columns;items;focusTracker;keystrokes;constructor(e,t){super(e);const n=t&&t.colorDefinitions?t.colorDefinitions:[];this.columns=t?.columns||5;const s={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new dt,this.keystrokes=new Ct,this.items.on("add",(o,a)=>{a.isOn=a.color===this.selectedColor}),n.forEach(o=>{const a=new EA;a.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),a.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(a)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:s}}),this.on("change:selectedColor",(o,a,c)=>{for(const u of this.items)u.isOn=u.color===c})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),yA({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale?.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}function SA(i,e){if(!i)return"";const t=AA(i);if(!t)return"";if(t.space===e)return i;if(!rL(t))return"";const s=Uo[t.space][e];if(!s)return"";const o=s(t.space==="hex"?t.hexValue:t.values);return oL(o,e)}function iL(i){if(!i)return"";const e=AA(i);return e?e.space==="hex"?e.hexValue:SA(i,"hex"):"#000"}function sL(i,e){customElements.get(i)===void 0&&customElements.define(i,e)}function oL(i,e){switch(e){case"hex":return`#${i}`;case"rgb":return`rgb(${i[0]}, ${i[1]}, ${i[2]})`;case"hsl":return`hsl(${i[0]}, ${i[1]}%, ${i[2]}%)`;case"hwb":return`hwb(${i[0]}, ${i[1]}, ${i[2]})`;case"lab":return`lab(${i[0]}% ${i[1]} ${i[2]})`;case"lch":return`lch(${i[0]}% ${i[1]} ${i[2]})`;default:return""}}function AA(i){if(i.startsWith("#")){const t=PC(i);return{space:"hex",values:t.values,hexValue:i,alpha:t.alpha}}const e=PC(i);return e.space?e:null}function rL(i){return Object.keys(Uo).includes(i.space)}class Rt extends oe{fieldView;labelView;statusView;fieldWrapperChildren;constructor(e,t){super(e);const n=`ck-labeled-field-view-${rn()}`,s=`ck-labeled-field-view-status-${rn()}`;this.fieldView=t(this,n,s),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(n),this.statusView=this._createStatusView(s),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(a,c)=>a||c);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const t=new ii(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new oe(this.locale),n=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",n.if("errorText","ck-labeled-field-view__status_error"),n.if("_statusText","ck-hidden",s=>!s)],id:e,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),t}focus(e){this.fieldView.focus(e)}}class aL extends oe{focusTracker;constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new dt,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),tabindex:t.to("tabIndex"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById"),"aria-label":t.to("ariaLabel")},on:{input:t.to((...n)=>{this.fire("input",...n),this._updateIsEmpty()}),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,n)=>{this._setDomElementValue(n),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=lL(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function lL(i){return!i.value}class xA extends aL{constructor(e){super(e),this.set("inputMode","text");const t=this.bindTemplate;this.extendTemplate({attributes:{inputmode:t.to("inputMode")}})}}class IA extends xA{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}class cL extends xA{constructor(e,{min:t,max:n,step:s}={}){super(e);const o=this.bindTemplate;this.set("min",t),this.set("max",n),this.set("step",s),this.extendTemplate({attributes:{type:"number",class:["ck-input-number"],min:o.to("min"),max:o.to("max"),step:o.to("step")}})}}class uL extends oe{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",n=>`ck-dropdown__panel_${n}`),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to(n=>{const s=n.target;s instanceof Element&&s.tagName.toLocaleLowerCase()==="input"||n.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():Be("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}class ch extends oe{buttonView;panelView;focusTracker;keystrokes;listView;toolbarView;menuView;constructor(e,t,n){super(e);const s=this.bindTemplate;this.buttonView=t,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Ct,this.focusTracker=new dt,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",s.to("class"),s.if("isEnabled","ck-disabled",o=>!o)],id:s.to("id"),"aria-describedby":s.to("ariaDescribedById")},children:[t,n]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":s.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(t,n,s)=>{if(s)if(this.panelPosition==="auto"){const o=ch._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._defaultPanelPositionName}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(t,n)=>{this.isOpen&&(this.isOpen=!1,n())};this.keystrokes.set("arrowdown",(t,n)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,n())}),this.keystrokes.set("arrowright",(t,n)=>{this.isOpen&&n()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:n,southWest:s,northEast:o,northWest:a,southMiddleEast:c,southMiddleWest:u,northMiddleEast:h,northMiddleWest:m}=ch.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[n,s,c,u,e,o,a,h,m,t]:[s,n,u,c,e,a,o,m,h,t]}get _defaultPanelPositionName(){return this.locale.uiLanguageDirection==="rtl"?"sw":"se"}static defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)*3/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)*3/4,name:"nmw"})};static _getOptimalPosition=$b}class PA extends ue{arrowView;constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",t=>String(t))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new ki;return e.content=$h,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}class vi extends oe{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",n=>!n)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}class Kh extends oe{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}class Ud extends oe{labelView;items;children;constructor(e,t=new ii){super(e);const n=this.bindTemplate,s=new Sa(e);this.set({label:"",isVisible:!0}),this.labelView=t,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,s]),s.set({role:"group",ariaLabelledBy:t.id}),s.focusTracker.destroy(),s.keystrokes.destroy(),this.items=s.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",n.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(t=>!(t instanceof Kh));e&&e.focus()}}}class Sa extends oe{focusables;items;focusTracker;keystrokes;_focusCycler;_listItemGroupToChangeListeners=new WeakMap;constructor(e){super(e);const t=this.bindTemplate;this.focusables=new Gt,this.items=this.createCollection(),this.focusTracker=new dt,this.keystrokes=new Ct,this._focusCycler=new an({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof Ud?this._registerFocusableItemsGroup(e):e instanceof vi&&this._registerFocusableListItem(e);this.items.on("change",(e,t)=>{for(const n of t.removed)n instanceof Ud?this._deregisterFocusableItemsGroup(n):n instanceof vi&&this._deregisterFocusableListItem(n);for(const n of Array.from(t.added).reverse())n instanceof Ud?this._registerFocusableItemsGroup(n,t.index):this._registerFocusableListItem(n,t.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(t,n)=>{for(const s of n.removed)this._deregisterFocusableListItem(s);for(const s of Array.from(n.added).reverse())this._registerFocusableListItem(s,this.items.getIndex(e)+n.index)}}_registerFocusableItemsGroup(e,t){Array.from(e.items).forEach((s,o)=>{const a=typeof t<"u"?t+o:void 0;this._registerFocusableListItem(s,a)});const n=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,n),e.items.on("change",n)}_deregisterFocusableItemsGroup(e){for(const t of e.items)this._deregisterFocusableListItem(t);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}class bw extends oe{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class dL extends oe{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}function hL(i){return i.bindTemplate.to(e=>{e.target===i.element&&e.preventDefault()})}function RA(i){if(Array.isArray(i))return{items:i,removeItems:[]};const e={items:[],removeItems:[]};return i?{...e,...i}:e}const fL={alignLeft:dw,bold:rA,importExport:fN,paragraph:SN,plus:PN,text:$N,threeVerticalDots:fw,pilcrow:IN,dragIndicator:aN};class Qo extends oe{options;items;focusTracker;keystrokes;itemsView;children;focusables;_focusCycler;_behavior;constructor(e,t){super(e);const n=this.bindTemplate,s=this.t;this.options=t||{},this.set("ariaLabel",s("Editor toolbar")),this.set("maxWidth","auto"),this.set("role","toolbar"),this.set("isGrouping",!!this.options.shouldGroupWhenFull),this.items=this.createCollection(),this.focusTracker=new dt,this.keystrokes=new Ct,this.set("class",void 0),this.set("isCompact",!1),this.set("isVertical",!1),this.itemsView=new mL(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new an({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const a=["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact"),n.if("isGrouping","ck-toolbar_grouping"),n.if("isVertical","ck-toolbar_vertical")];this.options.shouldGroupWhenFull&&this.options.isFloating&&a.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:a,role:n.to("role"),"aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:hL(this)}}),this._behavior=this.options.shouldGroupWhenFull?new JC(this):new YC(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e);this.items.on("add",(e,t)=>{this.focusTracker.add(t)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,n){this.items.addMany(this._buildItemsFromConfig(e,t,n))}switchBehavior(e){this._behavior.type!==e&&(this._behavior.destroy(),this.itemsView.children.clear(),this.focusables.clear(),e==="dynamic"?(this._behavior=new JC(this),this._behavior.render(this),this._behavior.refreshItems()):(this._behavior=new YC(this),this._behavior.render(this)))}_buildItemsFromConfig(e,t,n){const s=RA(e),o=n||s.removeItems;return this._cleanItemsConfiguration(s.items,t,o).map(c=>on(c)?this._createNestedToolbarDropdown(c,t,o):c==="|"?new bw:c==="-"?new dL:t.create(c)).filter(c=>!!c)}_cleanItemsConfiguration(e,t,n){const s=e.filter((o,a,c)=>o==="|"?!0:n.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(Be("toolbarview-line-break-ignored-when-grouping-items",c),!1):!0:!on(o)&&!t.has(o)?(Be("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(s)}_cleanSeparatorsAndLineBreaks(e){const t=a=>a!=="-"&&a!=="|",n=e.length,s=e.findIndex(t);if(s===-1)return[];const o=n-e.slice().reverse().findIndex(t);return e.slice(s,o).filter((a,c,u)=>t(a)?!0:!(c>0&&u[c-1]===a))}_createNestedToolbarDropdown(e,t,n){let{label:s,icon:o,items:a,tooltip:c=!0,withText:u=!1}=e;if(a=this._cleanItemsConfiguration(a,t,n),!a.length)return null;const h=this.locale,m=$t(h);return s||Be("toolbarview-nested-toolbar-dropdown-missing-label",e),m.class="ck-toolbar__nested-toolbar-dropdown",m.buttonView.set({label:s,tooltip:c,withText:!!u}),o!==!1?m.buttonView.icon=fL[o]||o||fw:m.buttonView.withText=!0,Dc(m,()=>m.toolbarView._buildItemsFromConfig(a,t,n)),m}}class mL extends oe{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class YC{type="static";constructor(e){e.isGrouping=!1,e.itemsView.children.bindTo(e.items).using(t=>t),e.focusables.bindTo(e.items).using(t=>Lc(t)?t:null)}render(){}destroy(){}}class JC{type="dynamic";view;viewChildren;viewFocusables;viewItemsView;viewFocusTracker;viewLocale;ungroupedItems;groupedItems;groupedItemsDropdown;resizeObserver=null;cachedPadding=null;shouldUpdateGroupingOnNextResize=!1;viewElement;constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.view.isGrouping=!0,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",(t,n)=>{const s=n.index,o=Array.from(n.added);for(const a of n.removed)s>=this.ungroupedItems.length?this.groupedItems.remove(a):this.ungroupedItems.remove(a);for(let a=s;a<s+o.length;a++){const c=o[a-s];a>this.ungroupedItems.length?this.groupedItems.add(c,a-this.ungroupedItems.length):this.ungroupedItems.add(c,a)}this._updateGrouping()})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.viewChildren.length>1&&(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last)),this.resizeObserver.destroy()}refreshItems(){const e=this.view;if(e.items.length){for(let t=0;t<e.items.length;t++){const n=[...e.items][t];this.ungroupedItems.add(n,t)}this._updateGrouping()}}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!Es(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new pe(e.lastChild),s=new pe(e);if(!this.cachedPadding){const o=ee.window.getComputedStyle(e),a=t==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[a])}return t==="ltr"?n.right>s.right-this.cachedPadding:n.left<s.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new lt(this.viewElement,t=>{(!e||e!==t.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new bw),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,n=$t(e);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",Dc(n,this.groupedItems),n.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:e.uiLanguageDirection==="rtl"?"se":"sw",icon:fw}),n}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{Lc(e)&&this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}class Aa extends oe{children;actionView;arrowView;keystrokes;focusTracker;constructor(e,t){super(e);const n=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(t),this.arrowView=this._createArrowView(),this.keystrokes=new Ct,this.focusTracker=new dt,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",n.to("class"),n.if("isVisible","ck-hidden",s=>!s),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const t=e||new ue;return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const e=new ue,t=e.bindTemplate;return e.icon=$h,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",n=>String(n))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}function $t(i,e=PA){const t=typeof e=="function"?new e(i):e,n=new uL(i),s=new ch(i,t,n);return t.bind("isEnabled").to(s),t instanceof Aa?t.arrowView.bind("isOn").to(s,"isOpen"):t.bind("isOn").to(s,"isOpen"),gL(s),s}function Dc(i,e,t={}){i.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),i.isOpen?QC(i,e,t):i.once("change:isOpen",()=>QC(i,e,t),{priority:"highest"}),t.enableActiveItemFocusOnDropdownOpen&&ww(i,()=>i.toolbarView.items.find(n=>n.isOn))}function QC(i,e,t){const n=i.locale,s=n.t,o=i.toolbarView=new Qo(n),a=typeof e=="function"?e():e;o.ariaLabel=t.ariaLabel||s("Dropdown toolbar"),t.maxWidth&&(o.maxWidth=t.maxWidth),t.class&&(o.class=t.class),t.isCompact&&(o.isCompact=t.isCompact),t.isVertical&&(o.isVertical=!0),a instanceof Gt?o.items.bindTo(a).using(c=>c):o.items.addMany(a),i.panelView.children.add(o),i.focusTracker.add(o),o.items.delegate("execute").to(i)}function mo(i,e,t={}){i.isOpen?XC(i,e,t):i.once("change:isOpen",()=>XC(i,e,t),{priority:"highest"}),ww(i,()=>i.listView.items.find(n=>n instanceof vi?n.children.first.isOn:!1))}function XC(i,e,t){const n=i.locale,s=i.listView=new Sa(n),o=typeof e=="function"?e():e;s.ariaLabel=t.ariaLabel,s.role=t.role,VA(i,s.items,o,n),i.panelView.children.add(s),s.items.delegate("execute").to(i)}function ww(i,e){i.on("change:isOpen",()=>{if(!i.isOpen)return;const t=e();t&&(typeof t.focus=="function"?t.focus():Be("ui-dropdown-focus-child-on-open-child-missing-focus",{view:t}))},{priority:_s.low-10})}function gL(i){pL(i),bL(i),wL(i),_L(i),yL(i),vL(i)}function pL(i){sr({emitter:i,activator:()=>i.isRendered&&i.isOpen,callback:()=>{i.isOpen=!1},contextElements:()=>[i.element,...OA(i.focusTracker).filter(e=>!i.element.contains(e))]})}function OA(i){return[...i.elements,...i.externalViews.flatMap(e=>OA(e.focusTracker))]}function bL(i){i.on("execute",e=>{e.source instanceof Gh||(i.isOpen=!1)})}function wL(i){i.focusTracker.on("change:isFocused",(e,t,n)=>{n||!i.isOpen||(i.isOpen=!1)})}function _L(i){i.keystrokes.set("arrowdown",(e,t)=>{i.isOpen&&(i.panelView.focus(),t())}),i.keystrokes.set("arrowup",(e,t)=>{i.isOpen&&(i.panelView.focusLast(),t())})}function yL(i){i.on("change:isOpen",(e,t,n)=>{if(n)return;i.focusTracker.elements.some(o=>o.contains(ee.document.activeElement))&&i.buttonView.focus()})}function vL(i){i.on("change:isOpen",(e,t,n)=>{n&&i.panelView.focus()},{priority:"low"})}function VA(i,e,t,n){CL(e),e.bindTo(t).using(s=>{if(s.type==="separator")return new Kh(n);if(s.type==="group"){const o=new Ud(n);return o.set({label:s.label}),VA(i,o.items,s.items,n),o.items.delegate("execute").to(i),o}else if(s.type==="button"||s.type==="switchbutton"){const o=s.model.role==="menuitemcheckbox"||s.model.role==="menuitemradio",a=new vi(n);let c;return s.type==="button"?(c=new Ea(n,s.labelView),c.set({isToggleable:o})):c=new Gh(n),c.bind(...Object.keys(s.model)).to(s.model),c.delegate("execute").to(a),a.children.add(c),a}return null})}function CL(i){let e=0;const t=o=>!(o instanceof vi)||!(o.children.first instanceof Ea)?null:o.children.first,n=o=>{const a=t(o);return!a||!a.isToggleable?null:a},s=o=>{for(const a of i){const c=t(a);c&&(c.hasCheckSpace=o)}};i.on("change",(o,a)=>{const c=e>0;for(const h of a.removed)n(h)&&e--;for(const h of a.added){const m=t(h);m&&(m.isToggleable&&e++,m.hasCheckSpace=e>0)}const u=e>0;c!==u&&s(u)})}const si=(i,e,t)=>{const n=new IA(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n},kL=(i,e,t)=>{const n=new cL(i.locale);return n.set({id:e,ariaDescribedById:t,inputMode:"numeric"}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n},BA=(i,e,t)=>{const n=$t(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isEnabled").to(i),n},TL=150;class EL extends oe{hexInputRow;_debounceColorPickerEvent;_config;constructor(e,t={}){super(e),this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const n=this.createCollection();t.hideInput||n.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:n}),this._config=t,this._debounceColorPickerEvent=Ni(s=>{this.set("color",s),this.fire("colorSelected",{color:this.color})},TL,{leading:!0}),this.on("set:color",(s,o,a)=>{s.return=SA(a,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=np(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),np(this.color)!=np(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),sL("hex-color-picker",v6),this.picker=ee.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const t=e.detail.value;this._debounceColorPickerEvent(t)})}focus(){!this._config.hideInput&&(le.isGecko||le.isiOS||le.isSafari||le.isBlink)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const n=[...this.picker.shadowRoot.children].filter(s=>s.getAttribute("role")==="slider").map(s=>new SL(s));this.slidersView=this.createCollection(),n.forEach(s=>{this.slidersView.add(s)})}_createInputRow(){const e=this._createColorInput();return new xL(this.locale,e)}_createColorInput(){const e=new Rt(this.locale,si),{t}=this.locale;return e.set({label:t("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",n=>e.isFocused?e.fieldView.value:n.startsWith("#")?n.substring(1):n),e.fieldView.on("input",()=>{const n=e.fieldView.element.value;if(n){const s=MA(n);s&&this._debounceColorPickerEvent(s)}}),e}isValid(){const{t:e}=this.locale;return this._config.hideInput?!0:(this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1))}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}}function np(i){let e=iL(i);return e||(e="#000"),e.length===4&&(e="#"+[e[1],e[1],e[2],e[2],e[3],e[3]].join("")),e.toLowerCase()}class SL extends oe{constructor(e){super(),this.element=e}focus(){this.element.focus()}}class AL extends oe{constructor(e){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class xL extends oe{children;inputView;constructor(e,t){super(e),this.inputView=t,this.children=this.createCollection([new AL,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return MA(this.inputView.fieldView.element.value)}}function MA(i){if(!i)return null;const e=i.trim().replace(/^#/,"");return![3,4,6,8].includes(e.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(e)?null:`#${e}`}class IL extends qe(Dt){constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(e,t){return this.find(n=>n.color===e.color)?this:super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}}class PL extends oe{items;colorDefinitions;focusTracker;columns;documentColors;documentColorsCount;staticColorsGrid;documentColorsGrid;colorPickerButtonView;removeColorButtonView;_focusables;_documentColorsLabel;_removeButtonLabel;_colorPickerLabel;constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:u,focusables:h}){super(e);const m=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=u,this.items=this.createCollection(),this.colorDefinitions=t,this.columns=n,this.documentColors=new IL,this.documentColorsCount=a,this._focusables=h,this._removeButtonLabel=s,this._colorPickerLabel=c,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",m.if("isVisible","ck-hidden",g=>!g)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,t){const n=e.document,s=this.documentColorsCount;this.documentColors.clear();for(const o of n.getRoots()){const a=e.createRangeIn(o);for(const c of a.getItems())if(c.is("$textProxy")&&c.hasAttribute(t)&&(this._addColorToDocumentColors(c.getAttribute(t)),this.documentColors.length>=s))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,n=this.selectedColor;t.selectedColor=n,e&&(e.selectedColor=n)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=yn.bind(this.documentColors,this.documentColors),t=new oe(this.locale);t.setTemplate({tag:"span",attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]},children:[{text:this._documentColorsLabel}]}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new ue,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:sN,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new ue;return e.set({withText:!0,icon:Qp,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new KC(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(t,n)=>{this.fire("execute",{value:n.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=yn.bind(this.documentColors,this.documentColors),t=new KC(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(n=>{const s=new EA;return s.set({color:n.color,hasBorder:n.options?.hasBorder}),n.label&&s.set({label:n.label,tooltip:!0}),s.on("execute",()=>{this.fire("execute",{value:n.color,source:"documentColorsGrid"})}),s}),this.documentColors.on("change:isEmpty",(n,s,o)=>{o&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(n=>n.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}class RL extends oe{items;colorPickerView;saveButtonView;cancelButtonView;actionBarView;focusTracker;keystrokes;_focusables;_colorPickerViewConfig;constructor(e,{focusTracker:t,focusables:n,keystrokes:s,colorPickerViewConfig:o}){super(e),this.items=this.createCollection(),this.focusTracker=t,this.keystrokes=s,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=n,this._colorPickerViewConfig=o;const a=this.bindTemplate,{saveButtonView:c,cancelButtonView:u}=this._createActionButtons();this.saveButtonView=c,this.cancelButtonView=u,this.actionBarView=this._createActionBarView({saveButtonView:c,cancelButtonView:u}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",a.if("isVisible","ck-hidden",h=>!h)]},children:this.items})}render(){super.render();const e=new EL(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(t,n,s)=>{e.color=s}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const t of this.colorPickerView.slidersView)this.focusTracker.add(t.element),this._focusables.add(t);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:t}){const n=new oe,s=this.createCollection();return s.add(e),s.add(t),n.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:s}),n}_createActionButtons(){const e=this.locale,t=e.t,n=new ue(e),s=new ue(e);return n.set({icon:Wh,class:"ck-button-save",type:"button",withText:!1,label:t("Accept")}),s.set({icon:qh,class:"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),n.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),s.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:n,cancelButtonView:s}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,t)=>{this.fire("execute",{value:t.color,source:"colorPicker"}),this.set("selectedColor",t.color)})}}class _w extends oe{focusTracker;keystrokes;items;colorGridsFragmentView;colorPickerFragmentView;_focusCycler;_focusables;_colorPickerViewConfig;constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,colorPickerViewConfig:u}){super(e),this.items=this.createCollection(),this.focusTracker=new dt,this.keystrokes=new Ct,this._focusables=new Gt,this._colorPickerViewConfig=u,this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new PL(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new RL(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:u}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(h,m,g)=>{this.colorGridsFragmentView.set("selectedColor",g),this.colorPickerFragmentView.set("selectedColor",g)}),this.colorGridsFragmentView.on("change:selectedColor",(h,m,g)=>{this.set("selectedColor",g)}),this.colorPickerFragmentView.on("change:selectedColor",(h,m,g)=>{this.set("selectedColor",g)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}class OL{editor;_components=new Map;constructor(e){this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(ip(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new E("componentfactory-item-missing",this,{name:e});return this._components.get(ip(e)).callback(this.editor.locale)}has(e){return this._components.has(ip(e))}}function ip(i){return String(i).toLowerCase()}const ZC="ck-tooltip";class tn extends Hn(){tooltipTextView;balloonPanelView;static defaultBalloonPositions=xt.generatePositions({heightOffset:5,sideOffset:13});_currentElementWithTooltip=null;_currentTooltipPosition=null;_mutationObserver=null;_pinTooltipDebounced;_unpinTooltipDebounced;_watchdogExcluded;static _editors=new Set;static _instance=null;constructor(e){if(super(),tn._editors.add(e),tn._instance)return tn._instance;tn._instance=this,this.tooltipTextView=new oe(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new xt(e.locale),this.balloonPanelView.class=ZC,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=VL(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=Ni(this._pinTooltip,600),this._unpinTooltipDebounced=Ni(this._unpinTooltip,400),this.listenTo(ee.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(ee.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(ee.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(ee.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(ee.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(ee.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const t=e.ui.view&&e.ui.view.body;tn._editors.delete(e),this.stopListening(e.ui),t&&t.has(this.balloonPanelView)&&t.remove(this.balloonPanelView),tn._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),tn._instance=null)}static getPositioningFunctions(e){const t=tn.defaultBalloonPositions;return{s:[t.southArrowNorth,t.southArrowNorthEast,t.southArrowNorthWest],n:[t.northArrowSouth],e:[t.eastArrowWest],w:[t.westArrowEast],sw:[t.southArrowNorthEast],se:[t.southArrowNorthWest]}[e]}_onKeyDown(e,t){t.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),t.stopPropagation())}_onEnterOrFocus(e,{target:t}){const n=sp(t);if(!n){e.name==="focus"&&this._unpinTooltip();return}if(n===this._currentElementWithTooltip){this._unpinTooltipDebounced.cancel();return}this._unpinTooltip(),e.name==="focus"&&!n.matches(":hover")||n.matches("[data-cke-tooltip-instant]")?this._pinTooltip(n,op(n)):this._pinTooltipDebounced(n,op(n))}_onLeaveOrBlur(e,{target:t,relatedTarget:n}){if(e.name==="mouseleave"){if(!ao(t))return;const s=this.balloonPanelView.element,o=s&&(s===n||s.contains(n)),a=!o&&t===s;if(o){this._unpinTooltipDebounced.cancel();return}if(!a&&this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;const c=sp(t),u=sp(n);(a||c&&c!==u)&&(this._pinTooltipDebounced.cancel(),this._currentElementWithTooltip&&this._currentElementWithTooltip.matches("[data-cke-tooltip-instant]")||c&&c.matches("[data-cke-tooltip-instant]")?this._unpinTooltip():this._unpinTooltipDebounced())}else{if(this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;this._pinTooltipDebounced.cancel(),this._unpinTooltipDebounced()}}_onScroll(e,{target:t}){this._currentElementWithTooltip&&(t.contains(this.balloonPanelView.element)&&t.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:t,position:n,cssClass:s}){this._unpinTooltip();const o=Ze(tn._editors.values()).ui.view.body;o.has(this.balloonPanelView)||o.add(this.balloonPanelView),this.tooltipTextView.text=t,this.balloonPanelView.class=[ZC,s].filter(a=>a).join(" "),this.balloonPanelView.pin({target:e,positions:tn.getPositioningFunctions(n)}),this._mutationObserver.attach(e);for(const a of tn._editors)this.listenTo(a.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=n}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of tn._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=op(this._currentElementWithTooltip);if(!Es(this._currentElementWithTooltip)||!e.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:tn.getPositioningFunctions(e.position)})}}function sp(i){return ao(i)?i.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function op(i){return{text:i.dataset.ckeTooltipText,position:i.dataset.ckeTooltipPosition||"s",cssClass:i.dataset.ckeTooltipClass||""}}function VL(i){const e=new MutationObserver(()=>{i()});return{attach(t){e.observe(t,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){e.disconnect()}}}class BL extends CA{licenseTypeMessage={evaluation:"For evaluation purposes only",trial:"For evaluation purposes only",development:"For development purposes only"};constructor(e){super(e,{balloonClass:"ck-evaluation-badge-balloon"})}_isEnabled(){const t=this.editor.config.get("licenseKey"),n=ek(t);return!!(n&&this.licenseTypeMessage[n])}_createBadgeContent(){const e=this.editor.config.get("licenseKey"),t=ek(e);return new ML(this.editor.locale,this.licenseTypeMessage[t])}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},n=t.position||e.position,s=t.side||e.side;return{position:n,side:s==="left"?"right":"left",verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset}}}class ML extends oe{constructor(e,t){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-evaluation-badge"],"aria-hidden":!0},children:[{tag:"span",attributes:{class:["ck","ck-evaluation-badge__label"]},children:[t]}]})}}function ek(i){if(i=="GPL")return"GPL";const e=Yb(i.split(".")[1]);return e?e.licenseType||"production":null}class Li extends vi{constructor(e,t){super(e);const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:n.to("mouseenter")}}),this.delegate("mouseenter").to(t)}}const bd=5,Zr={toggleMenusAndFocusItemsOnHover(i){i.on("menu:mouseenter",e=>{if(!(!i.isFocusBorderEnabled&&!i.isOpen)){if(i.isOpen)for(const t of i.menus){const n=e.path[0],s=n instanceof Li&&n.children.first===t;t.isOpen=(e.path.includes(t)||s)&&t.isEnabled}e.source.focus()}})},focusCycleMenusOnArrows(i){const e=i.locale.uiLanguageDirection==="rtl";i.on("menu:arrowright",n=>{t(n.source,e?-1:1)}),i.on("menu:arrowleft",n=>{t(n.source,e?1:-1)});function t(n,s){const o=i.children.getIndex(n),a=n.isOpen,c=i.children.length,u=i.children.get((o+c+s)%c);n.isOpen=!1,a&&(u.isOpen=!0),u.buttonView.focus()}},closeMenusWhenTheBarCloses(i){i.on("change:isOpen",()=>{i.isOpen||i.menus.forEach(e=>{e.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(i){i.on("menu:change:isOpen",(e,t,n)=>{n&&i.menus.filter(s=>e.source.parentMenuView===s.parentMenuView&&e.source!==s&&s.isOpen).forEach(s=>{s.isOpen=!1})})},closeOnClickOutside(i){sr({emitter:i,activator:()=>i.isOpen,callback:()=>i.close(),contextElements:()=>i.children.map(e=>e.element)})},enableFocusHighlightOnInteraction(i){let e=!1;i.on("change:isOpen",(t,n,s)=>{s||(e||(i.isFocusBorderEnabled=!1),e=!1)}),i.listenTo(i.element,"keydown",()=>{e=!0},{useCapture:!0}),i.listenTo(i.element,"keyup",()=>{e=!1},{useCapture:!0}),i.listenTo(i.element,"focus",()=>{e&&(i.isFocusBorderEnabled=!0)},{useCapture:!0})}},no={openAndFocusPanelOnArrowDownKey(i){i.keystrokes.set("arrowdown",(e,t)=>{i.isEnabled&&i.focusTracker.focusedElement===i.buttonView.element&&(i.isOpen||(i.isOpen=!0),i.panelView.focus(),t())})},openOnArrowRightKey(i){const e=i.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";i.keystrokes.set(e,(t,n)=>{i.focusTracker.focusedElement!==i.buttonView.element||!i.isEnabled||(i.isOpen||(i.isOpen=!0),i.panelView.focus(),n())})},openOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!0})},toggleOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!i.isOpen})},openAndFocusOnEnterKeyPress(i){i.keystrokes.set("enter",(e,t)=>{i.focusTracker.focusedElement===i.buttonView.element&&(i.isOpen=!0,i.panelView.focus(),t())})},closeOnArrowLeftKey(i){const e=i.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";i.keystrokes.set(e,(t,n)=>{i.isOpen&&(i.isOpen=!1,i.focus(),n())})},closeOnEscKey(i){i.keystrokes.set("esc",(e,t)=>{i.isOpen&&(i.isOpen=!1,i.focus(),t())})},closeOnParentClose(i){i.parentMenuView.on("change:isOpen",(e,t,n)=>{!n&&e.source===i.parentMenuView&&(i.isOpen=!1)})}},NL={southEast:i=>({top:i.bottom,left:i.left,name:"se"}),southWest:(i,e)=>({top:i.bottom,left:i.left-e.width+i.width,name:"sw"}),northEast:(i,e)=>({top:i.top-e.height,left:i.left,name:"ne"}),northWest:(i,e)=>({top:i.top-e.height,left:i.left-e.width+i.width,name:"nw"}),eastSouth:i=>({top:i.top,left:i.right-bd,name:"es"}),eastNorth:(i,e)=>({top:i.top-e.height,left:i.right-bd,name:"en"}),westSouth:(i,e)=>({top:i.top,left:i.left-e.width+bd,name:"ws"}),westNorth:(i,e)=>({top:i.top-e.height,left:i.left-e.width+bd,name:"wn"})},LL=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditingEnhanced",items:["menuBar:sourceEditingEnhanced"]},{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"fullscreen",items:["menuBar:fullscreen"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable","menuBar:insertTableLayout"]},{groupId:"insertInline",items:["menuBar:link","menuBar:insertFootnote","menuBar:bookmark","menuBar:comment","menuBar:insertMergeField","menuBar:emoji"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException:inline","menuBar:restrictedEditingException:block"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:lineHeight","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands","menuBar:toggleAi","menuBar:aiQuickActions"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function DL(i){let e;return!("items"in i)||!i.items?e={items:Cn(LL),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...i}:e={items:i.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...i},e}function FL({normalizedConfig:i,locale:e,componentFactory:t,extraItems:n}){const s=Cn(i);return tk(i,s,n),zL(i,s),tk(i,s,s.addItems),UL(i,s,t),NA(i,s),HL(s,e),s}function zL(i,e){const t=e.removeItems,n=[];e.items=e.items.filter(({menuId:s})=>t.includes(s)?(n.push(s),!1):!0),xa(e.items,s=>{s.groups=s.groups.filter(({groupId:o})=>t.includes(o)?(n.push(o),!1):!0);for(const o of s.groups)o.items=o.items.filter(a=>{const c=LA(a);return t.includes(c)?(n.push(c),!1):!0})});for(const s of t)n.includes(s)||Be("menu-bar-item-could-not-be-removed",{menuBarConfig:i,itemName:s})}function tk(i,e,t){const n=[];if(t.length!=0){for(const s of t){const o=WL(s.position),a=$L(s.position);if(jL(s))if(!a)o==="start"?(e.items.unshift(s.menu),n.push(s)):o==="end"&&(e.items.push(s.menu),n.push(s));else{const c=e.items.findIndex(u=>u.menuId===a);c!=-1?o==="before"?(e.items.splice(c,0,s.menu),n.push(s)):o==="after"&&(e.items.splice(c+1,0,s.menu),n.push(s)):nk(e,s.menu,a,o)&&n.push(s)}else qL(s)?xa(e.items,c=>{if(c.menuId===a)o==="start"?(c.groups.unshift(s.group),n.push(s)):o==="end"&&(c.groups.push(s.group),n.push(s));else{const u=c.groups.findIndex(h=>h.groupId===a);u!==-1&&(o==="before"?(c.groups.splice(u,0,s.group),n.push(s)):o==="after"&&(c.groups.splice(u+1,0,s.group),n.push(s)))}}):nk(e,s.item,a,o)&&n.push(s)}for(const s of t)n.includes(s)||Be("menu-bar-item-could-not-be-added",{menuBarConfig:i,addedItemConfig:s})}}function nk(i,e,t,n){let s=!1;return xa(i.items,o=>{for(const{groupId:a,items:c}of o.groups){if(s)return;if(a===t)n==="start"?(c.unshift(e),s=!0):n==="end"&&(c.push(e),s=!0);else{const u=c.findIndex(h=>LA(h)===t);u!==-1&&(n==="before"?(c.splice(u,0,e),s=!0):n==="after"&&(c.splice(u+1,0,e),s=!0))}}}),s}function UL(i,e,t){xa(e.items,n=>{for(const s of n.groups)s.items=s.items.filter(o=>{const a=typeof o=="string"&&!t.has(o);return a&&!e.isUsingDefaultConfig&&Be("menu-bar-item-unavailable",{menuBarConfig:i,parentMenuConfig:Cn(n),componentName:o}),!a})})}function NA(i,e){const t=e.isUsingDefaultConfig;let n=!1;if(e.items=e.items.filter(s=>s.groups.length?!0:(rp(i,s,t),!1)),!e.items.length){rp(i,i,t);return}xa(e.items,s=>{s.groups=s.groups.filter(o=>o.items.length?!0:(n=!0,!1));for(const o of s.groups)o.items=o.items.filter(a=>DA(a)&&!a.groups.length?(rp(i,a,t),n=!0,!1):!0)}),n&&NA(i,e)}function rp(i,e,t){t||Be("menu-bar-menu-empty",{menuBarConfig:i,emptyMenuConfig:e})}function HL(i,e){const t=e.t,n={File:t({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:t({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:t({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:t({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:t({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:t({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:t({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:t({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:t({string:"Font",id:"MENU_BAR_MENU_FONT"})};xa(i.items,s=>{s.label in n&&(s.label=n[s.label])})}function xa(i,e){if(Array.isArray(i))for(const n of i)t(n);function t(n){e(n);for(const s of n.groups)for(const o of s.items)DA(o)&&t(o)}}function jL(i){return typeof i=="object"&&"menu"in i}function qL(i){return typeof i=="object"&&"group"in i}function WL(i){return i.startsWith("start")?"start":i.startsWith("end")?"end":i.startsWith("after")?"after":"before"}function $L(i){const e=i.match(/^[^:]+:(.+)/);return e?e[1]:null}function LA(i){return typeof i=="string"?i:i.menuId}function DA(i){return typeof i=="object"&&"menuId"in i}class GL extends qe(){editor;componentFactory;focusTracker;tooltipManager;poweredBy;evaluationBadge;ariaLiveAnnouncer;isReady=!1;_editableElementsMap=new Map;_focusableToolbarDefinitions=[];_extraMenuBarElements=[];_lastFocusedForeignElement=null;_domEmitter;constructor(e){super();const t=e.editing.view;this.editor=e,this.componentFactory=new OL(e),this.focusTracker=new dt,this.tooltipManager=new tn(e),this.poweredBy=new Q6(e),this.evaluationBadge=new BL(e),this.ariaLiveAnnouncer=new V6(e),this._initViewportOffset(this._readViewportOffsetFromConfig()),this.once("ready",()=>{this._bindBodyCollectionWithFocusTracker(),this.isReady=!0}),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking(),this._initVisualViewportSupport()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy(),this.evaluationBadge.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[],this._domEmitter&&this._domEmitter.stopListening()}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const n=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?n():this.once("ready",n)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}extendMenuBar(e){this._extraMenuBarElements.push(e)}initMenuBar(e){const t=e.element;this.focusTracker.add(t),this.editor.keystrokes.listenTo(t);const n=DL(this.editor.config.get("menuBar")||{});e.fillFromConfig(n,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",(s,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):this.editor.editing.view.focus(),o())}),this.editor.keystrokes.set("Alt+F9",(s,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)||(this._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),o())})}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const n=e.config.get("toolbar.viewportTopOffset");return n?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:n}):{top:0}}_initFocusTracking(){const e=this.editor;let t;e.keystrokes.set("Alt+F10",(n,s)=>{this._saveLastFocusedForeignElement();const o=this._getCurrentFocusedToolbarDefinition();(!o||!t)&&(t=this._getFocusableCandidateToolbarDefinitions());for(let a=0;a<t.length;a++){const c=t.shift();if(t.push(c),c!==o&&this._focusFocusableCandidateToolbar(c)){o&&o.options.afterBlur&&o.options.afterBlur();break}}s()}),e.keystrokes.set("Esc",(n,s)=>{const o=this._getCurrentFocusedToolbarDefinition();o&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):e.editing.view.focus(),o.options.afterBlur&&o.options.afterBlur(),s())})}_saveLastFocusedForeignElement(){const e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e)}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:n,options:s}=t;(Es(n.element)||s.beforeFocus)&&e.push(t)}return e.sort((t,n)=>ik(t)-ik(n)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:n}}=e;return n&&n(),Es(t.element)?(t.focus(),!0):!1}_handleScrollToTheSelection(e,t){const n={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=n.top,t.viewportOffset.bottom+=n.bottom,t.viewportOffset.left+=n.left,t.viewportOffset.right+=n.right}_bindBodyCollectionWithFocusTracker(){const e=this.view.body;for(const t of e)this.focusTracker.add(t.element);e.on("add",(t,n)=>{this.focusTracker.add(n.element)}),e.on("remove",(t,n)=>{this.focusTracker.remove(n.element)})}_initViewportOffset(e){this.on("set:viewportOffset",(t,n,s)=>{const o=this._getVisualViewportTopOffset(s);s.visualTop!==o&&(t.return={...s,visualTop:o})}),this.set("viewportOffset",e)}_initVisualViewportSupport(){if(!ee.window.visualViewport)return;const e=()=>{const t=this._getVisualViewportTopOffset(this.viewportOffset);this.viewportOffset.visualTop!==t&&(this.viewportOffset={...this.viewportOffset,visualTop:t})};this._domEmitter=new(Hn()),this._domEmitter.listenTo(ee.window.visualViewport,"scroll",e),this._domEmitter.listenTo(ee.window.visualViewport,"resize",e)}_getVisualViewportTopOffset(e){const t=Ld().top,n=e.top||0;return t>n?0:n-t}}function ik(i){const{toolbarView:e,options:t}=i;let n=10;return Es(e.element)&&n--,t.isContextual&&(n-=2),n}class KL extends oe{body;menuBarView;toolbar;constructor(e){super(e),this.body=new hi(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class YL extends KL{top;main;_voiceLabelView;constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new ii;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}class JL extends oe{name=null;_editingView;_editableElement;_hasExternalElement;constructor(e,t,n){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?n(this):t(this);function t(s){e.change(o=>{const a=e.document.getRoot(s.name);o.addClass(s.isFocused?"ck-focused":"ck-blurred",a),o.removeClass(s.isFocused?"ck-blurred":"ck-focused",a)})}function n(s){e.once("change:isRenderingInProgress",(o,a,c)=>{c?n(s):t(s)})}}}class QL extends JL{_options;constructor(e,t,n,s={}){super(e,t,n),this._options=s,this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView;e.change(t=>{const n=e.document.getRoot(this.name);t.setAttribute("aria-label",this.getEditableAriaLabel(),n)})}getEditableAriaLabel(){const e=this.locale.t,t=this._options.label,n=this._editableElement,s=this.name;if(typeof t=="string")return t;if(typeof t=="object")return t[s];if(typeof t=="function")return t(this);if(n){const o=n.getAttribute("aria-label");if(o)return o}return e("Rich Text Editor. Editing area: %0",s)}}class qt extends oe{children;constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("class",["ck","ck-form__row",...st(t.class||[])]),this.children=this.createCollection(),t.children&&t.children.forEach(s=>this.children.add(s)),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:n.to("class",s=>s.join(" ")),role:n.to("_role"),"aria-labelledby":n.to("_ariaLabelledBy")},children:this.children})}}class sk extends nA{static get pluginName(){return"Notification"}static get isOfficialPlugin(){return!0}init(){this.on("show:warning",(e,t)=>{window.alert(t.message)},{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=e.namespace?`show:${e.type}:${e.namespace}`:`show:${e.type}`;this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}class co extends qe(){constructor(e,t){super(),t&&RE(this,t),e&&this.set(e)}}const wd=Mc("px");class As extends N{positionLimiter;visibleStack;_viewToStack=new Map;_idToStack=new Map;_view=null;_rotatorView=null;_fakePanelsView=null;static get pluginName(){return"ContextualBalloon"}static get isOfficialPlugin(){return!0}constructor(e){super(e),this.positionLimiter=()=>{const t=this.editor.editing.view,s=t.document.selection.editableElement;return s?t.domConverter.mapViewToDom(s.root):null},this.decorate("getPositionOptions"),this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new E("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t)){this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(t);return}const n=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),n.set(e.view,e),this._viewToStack.set(e.view,n),n===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new E("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(t.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),t.size===1?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition()}getPositionOptions(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:{...this.editor.ui.viewportOffset,top:this.editor.ui.viewportOffset.visualTop}})),e}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new E("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}_createPanelView(){this._view=new xt(this.editor.locale),this.editor.ui.view.body.add(this._view),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(n=>n[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new XL(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(n,s)=>!s&&n>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(n,s)=>{if(s<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[o,s])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new ZL(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,n)=>!n&&t>=2?Math.min(t-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:n=!0,singleViewMode:s=!1}){this.view.class=t,this.view.withArrow=n,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition(),s&&(this._singleViewMode=!0)}}class XL extends oe{focusTracker;buttonPrevView;buttonNextView;content;constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new dt,this.buttonPrevView=this._createButtonView(t("Previous"),Ta),this.buttonNextView=this._createButtonView(t("Next"),aA),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",s=>s?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const n=new ue(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n}}class ZL extends oe{content;_balloonPanelView;constructor(e,t){super(e);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",s=>s?"":"ck-hidden")],style:{top:n.to("top",wd),left:n.to("left",wd),width:n.to("width",wd),height:n.to("height",wd)}},children:this.content}),this.on("change:numberOfPanels",(s,o,a,c)=>{a>c?this._addPanels(a-c):this._removePanels(c-a),this.updatePosition()})}_addPanels(e){for(;e--;){const t=new oe;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(e){for(;e--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:n,height:s}=new pe(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:n,height:s})}}}const ea=Mc("px");class eD extends oe{content;contentPanelElement;_contentPanelPlaceholder;constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new yn({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",n=>n?"block":"none"),height:t.to("isSticky",n=>n?ea(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new yn({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",n=>n?ea(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_stickyTopOffset",n=>n&&ea(n)),bottom:t.to("_stickyBottomOffset",n=>n&&ea(n)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(ee.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()}),ee.window.visualViewport&&(this.listenTo(ee.window.visualViewport,"scroll",()=>{this.checkIfShouldBeSticky()}),this.listenTo(ee.window.visualViewport,"resize",()=>{this.checkIfShouldBeSticky()}))}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new pe(this.limiterElement);let t=e.getVisible();if(t){const o=new pe(ee.window);o.top+=this.viewportTopOffset,o.height-=this.viewportTopOffset,t=t.getIntersection(o)}const{left:n,top:s}=Ld();if(e.moveBy(n,s),t&&t.moveBy(n,s),t&&e.top<t.top)if(this._contentPanelRect.height+this.limiterBottomOffset>t.height){const o=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;this._contentPanelRect.height+o+1<e.height?this._stickToBottomOfLimiter(o):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(t.top):this._unstick();else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=ea(-ee.window.scrollX+Ld().left)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=ea(-ee.window.scrollX+Ld().left)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new pe(this.contentPanelElement)}}class tD extends Ea{arrowView;constructor(e){super(e);const t=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",n=>String(n)),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new ki;return e.content=$h,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}class nD extends oe{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",n=>`ck-menu-bar__menu__panel_position_${n}`),t.if("isVisible","ck-hidden",n=>!n)],tabindex:"-1"},children:this.children,on:{selectstart:t.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}}class vn extends oe{buttonView;panelView;focusTracker;keystrokes;constructor(e){super(e);const t=this.bindTemplate;this.buttonView=new tD(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new nD(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Ct,this.focusTracker=new dt,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",t.to("class"),t.if("isEnabled","ck-disabled",n=>!n),t.if("parentMenuView","ck-menu-bar__menu_top-level",n=>!n)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),no.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(no.openOnButtonClick(this),no.openOnArrowRightKey(this),no.closeOnArrowLeftKey(this),no.openAndFocusOnEnterKeyPress(this),no.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),no.openAndFocusPanelOnArrowDownKey(this),no.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(e,t)=>{this.fire("arrowright"),t()}),this.keystrokes.set("arrowleft",(e,t)=>{this.fire("arrowleft"),t()})}_repositionPanelOnOpen(){this.on("change:isOpen",(e,t,n)=>{if(!n)return;const s=vn._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=s?s.name:this._defaultMenuPositionName})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:t,northEast:n,northWest:s,westSouth:o,eastSouth:a,westNorth:c,eastNorth:u}=NL;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[a,u,o,c]:[e,t,n,s]:this.parentMenuView?[o,c,a,u]:[t,e,s,n]}get _defaultMenuPositionName(){return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?"es":"se":this.parentMenuView?"ws":"sw"}static _getOptimalPosition=$b}class xs extends Sa{constructor(e){super(e),this.role="menu",this.items.on("change",this._setItemsCheckSpace.bind(this))}_setItemsCheckSpace(){const e=Array.from(this.items).some(t=>{const n=ok(t);return n&&n.isToggleable});this.items.forEach(t=>{const n=ok(t);n&&(n.hasCheckSpace=e)})}}function ok(i){return i instanceof vi?i.children.map(e=>iD(e)?e.buttonView:e).find(e=>e instanceof Ea):null}function iD(i){return typeof i=="object"&&"buttonView"in i&&i.buttonView instanceof ue}class FA extends Z6{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}const rk=["mouseenter","arrowleft","arrowright","change:isOpen"];class sD extends oe{children;menus=[];constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set({isOpen:!1,isFocusBorderEnabled:!1}),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar",n.if("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":t("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,t,n=[]){const s=this.locale,a=FL({normalizedConfig:e,locale:s,componentFactory:t,extraItems:n}).items.map(c=>this._createMenu({componentFactory:t,menuDefinition:c}));this.children.addMany(a)}render(){super.render(),Zr.toggleMenusAndFocusItemsOnHover(this),Zr.closeMenusWhenTheBarCloses(this),Zr.closeMenuWhenAnotherOnTheSameLevelOpens(this),Zr.focusCycleMenusOnArrows(this),Zr.closeOnClickOutside(this),Zr.enableFocusHighlightOnInteraction(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}disable(){for(const e of this.children)e.isEnabled=!1}enable(){for(const e of this.children)e.isEnabled=!0}registerMenu(e,t=null){t?(e.delegate(...rk).to(t),e.parentMenuView=t):e.delegate(...rk).to(this,n=>"menu:"+n),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:t,parentMenuView:n}){const s=this.locale,o=new vn(s);return this.registerMenu(o,n),o.buttonView.set({label:t.label}),o.once("change:isOpen",()=>{const a=new xs(s);a.ariaLabel=t.label,o.panelView.children.add(a),a.items.addMany(this._createMenuItems({menuDefinition:t,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:t,componentFactory:n}){const s=this.locale,o=[];for(const a of e.groups){for(const c of a.items){const u=new Li(s,t);if(on(c))u.children.add(this._createMenu({componentFactory:n,menuDefinition:c,parentMenuView:t}));else{const h=this._createMenuItemContentFromFactory({componentName:c,componentFactory:n,parentMenuView:t});if(!h)continue;u.children.add(h)}o.push(u)}a!==e.groups[e.groups.length-1]&&o.push(new Kh(s))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:t,componentFactory:n}){const s=n.create(e);return s instanceof vn||s instanceof tt||s instanceof FA?(this._registerMenuTree(s,t),s.on("execute",()=>{this.close()}),s):(Be("menu-bar-component-unsupported",{componentName:e,componentView:s}),null)}_registerMenuTree(e,t){if(!(e instanceof vn)){e.delegate("mouseenter").to(t);return}this.registerMenu(e,t);const n=e.panelView.children.filter(o=>o instanceof xs)[0];if(!n){e.delegate("mouseenter").to(t);return}const s=n.items.filter(o=>o instanceof vi);for(const o of s)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(t,n,s)=>{clearTimeout(e),s?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}}const yw=["left","right","center","justify"];function zA(i){return yw.includes(i)}function UA(i,e){return e.contentLanguageDirection=="rtl"?i==="right":i==="left"}function HA(i){const e=i.map(n=>{let s;return typeof n=="string"?s={name:n}:s=n,s}).filter(n=>{const s=yw.includes(n.name);return s||Be("alignment-config-name-not-recognized",{option:n}),s}),t=e.filter(n=>!!n.className).length;if(t&&t<e.length)throw new E("alignment-config-classnames-are-missing",{configuredOptions:i});return e.forEach((n,s,o)=>{const a=o.slice(s+1);if(a.some(u=>u.name==n.name))throw new E("alignment-config-name-already-defined",{option:n,configuredOptions:i});if(n.className&&a.some(h=>h.className==n.className))throw new E("alignment-config-classname-already-defined",{option:n,configuredOptions:i})}),e}const vw="alignment";class oD extends me{refresh(){const t=this.editor.locale,n=Ze(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!n&&this._canBeAligned(n),this.isEnabled&&n.hasAttribute("alignment")?this.value=n.getAttribute("alignment"):this.value=t.contentLanguageDirection==="rtl"?"right":"left"}execute(e={}){const t=this.editor,n=t.locale,s=t.model,o=s.document,a=e.value;s.change(c=>{const u=Array.from(o.selection.getSelectedBlocks()).filter(g=>this._canBeAligned(g)),h=u[0].getAttribute("alignment");UA(a,n)||h===a||!a?rD(u,c):aD(u,c,a)})}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,vw)}}function rD(i,e){for(const t of i)e.removeAttribute(vw,t)}function aD(i,e,t){for(const n of i)e.setAttribute(vw,t,n)}class lD extends N{static get pluginName(){return"AlignmentEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("alignment",{options:yw.map(t=>({name:t}))})}init(){const e=this.editor,t=e.locale,n=e.model.schema,o=HA(e.config.get("alignment.options")).filter(h=>zA(h.name)&&!UA(h.name,t)),a=o.some(h=>!!h.className);n.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),a?e.conversion.attributeToAttribute(hD(o)):e.conversion.for("downcast").attributeToAttribute(cD(o));const c=uD(o);for(const h of c)e.conversion.for("upcast").attributeToAttribute(h);const u=dD(o);for(const h of u)e.conversion.for("upcast").attributeToAttribute(h);e.commands.add("alignment",new oD(e))}}function cD(i){const e={};for(const{name:n}of i)e[n]={key:"style",value:{"text-align":n}};return{model:{key:"alignment",values:i.map(n=>n.name)},view:e}}function uD(i){const e=[];for(const{name:t}of i)e.push({view:{key:"style",value:{"text-align":t}},model:{key:"alignment",value:t}});return e}function dD(i){const e=[];for(const{name:t}of i)e.push({view:{key:"align",value:t},model:{key:"alignment",value:t}});return e}function hD(i){const e={};for(const n of i)e[n.name]={key:"class",value:n.className};return{model:{key:"alignment",values:i.map(n=>n.name)},view:e}}const Ol=new Map([["left",dw],["right",oA],["center",iA],["justify",sA]]);class fD extends N{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=HA(e.config.get("alignment.options"));t.map(n=>n.name).filter(zA).forEach(n=>this._addButton(n)),this._addToolbarDropdown(t),this._addMenuBarMenu(t)}_addButton(e){this.editor.ui.componentFactory.add(`alignment:${e}`,n=>this._createButton(n,e))}_createButton(e,t,n={}){const s=this.editor,o=s.commands.get("alignment"),a=new ue(e);return a.set({label:this.localizedOptionTitles[t],icon:Ol.get(t),tooltip:!0,isToggleable:!0,...n}),a.bind("isEnabled").to(o),a.bind("isOn").to(o,"value",c=>c===t),this.listenTo(a,"execute",()=>{s.execute("alignment",{value:t}),s.editing.view.focus()}),a}_addToolbarDropdown(e){const t=this.editor;t.ui.componentFactory.add("alignment",s=>{const o=$t(s),a=s.uiLanguageDirection==="rtl"?"w":"e",c=s.t;Dc(o,()=>e.map(m=>this._createButton(s,m.name,{tooltipPosition:a})),{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:c("Text alignment toolbar")}),o.buttonView.set({label:c("Text alignment"),tooltip:!0}),o.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const u=s.contentLanguageDirection==="rtl"?Ol.get("right"):Ol.get("left"),h=t.commands.get("alignment");return o.buttonView.bind("icon").to(h,"value",m=>Ol.get(m)||u),o.bind("isEnabled").to(h,"isEnabled"),this.listenTo(o,"execute",()=>{t.editing.view.focus()}),o})}_addMenuBarMenu(e){const t=this.editor;t.ui.componentFactory.add("menuBar:alignment",n=>{const s=t.commands.get("alignment"),o=n.t,a=new vn(n),c=new xs(n);a.bind("isEnabled").to(s),c.set({ariaLabel:o("Text alignment"),role:"menu"}),a.buttonView.set({label:o("Text alignment")});for(const u of e){const h=new Li(n,a),m=new tt(n);m.delegate("execute").to(a),m.set({label:this.localizedOptionTitles[u.name],icon:Ol.get(u.name),role:"menuitemcheckbox",isToggleable:!0}),m.on("execute",()=>{t.execute("alignment",{value:u.name}),t.editing.view.focus()}),m.bind("isOn").to(s,"value",g=>g===u.name),m.bind("isEnabled").to(s,"isEnabled"),h.children.add(m),c.items.add(h)}return a.panelView.children.add(c),a})}}class mD extends N{static get requires(){return[lD,fD]}static get pluginName(){return"Alignment"}static get isOfficialPlugin(){return!0}}class jA{model;limit;_isLocked;_size;_batch=null;_changeCallback;_selectionChangeCallback;constructor(e,t=20){this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(n,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}}class gD extends me{_buffer;constructor(e,t){super(e),this._buffer=new jA(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,n=t.document,s=e.text||"",o=s.length;let a=n.selection;if(e.selection?a=e.selection:e.range&&(a=t.createSelection(e.range)),!t.canEditAt(a))return;const c=e.resultRange;t.enqueueChange(this._buffer.batch,u=>{this._buffer.lock();const h=Array.from(n.selection.getAttributes());t.deleteContent(a),s&&t.insertContent(u.createText(s,h),a),c?u.setSelection(c):a.is("documentSelection")||u.setSelection(a),this._buffer.unlock(),this._buffer.input(o)})}}const qA=["insertText","insertReplacementText"],pD=[...qA,"insertCompositionText"];class bD extends Hi{focusObserver;constructor(e){super(e),this.focusObserver=e.getObserver(ih);const t=le.isAndroid?pD:qA,n=e.document;n.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{data:a,targetRanges:c,inputType:u,domEvent:h,isComposing:m}=o;if(!t.includes(u))return;this.focusObserver.flush();const g=new Ts(n,"insertText");n.fire(g,new Yo(e,h,{text:a,selection:e.createSelection(c),isComposing:m})),g.stop.called&&s.stop()}),le.isAndroid||n.on("compositionend",(s,{data:o,domEvent:a})=>{this.isEnabled&&o&&n.fire("insertText",new Yo(e,a,{text:o,isComposing:!0}))},{priority:"low"})}observe(){}stopObserving(){}}class WA extends N{_typingQueue;static get pluginName(){return"Input"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.editing.mapper,o=t.document.selection;this._typingQueue=new wD(e),n.addObserver(bD);const a=new gD(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",a),e.commands.add("input",a),this.listenTo(n.document,"beforeinput",()=>{this._typingQueue.flush("next beforeinput")},{priority:"high"}),this.listenTo(n.document,"insertText",(c,u)=>{const{text:h,selection:m}=u;if(n.document.selection.isFake&&m&&n.document.selection.isSimilar(m)&&u.preventDefault(),m&&Array.from(m.getRanges()).some(v=>!v.isCollapsed)&&u.preventDefault(),!a.isEnabled){u.preventDefault();return}let g;m&&(g=Array.from(m.getRanges()).filter(v=>v.root.is("rootElement")).map(v=>s.toModelRange(v)).map(v=>rw(v,t.schema)||v)),(!g||!g.length)&&(g=Array.from(o.getRanges()));let w=h;if(le.isAndroid){const v=Array.from(g[0].getItems()).reduce((C,T)=>C+(T.is("$textProxy")?T.data:""),"");if(v&&(v.length<=w.length?w.startsWith(v)&&(w=w.substring(v.length),g[0].start=g[0].start.getShiftedBy(v.length)):v.startsWith(w)&&(g[0].start=g[0].start.getShiftedBy(w.length),w="")),w.length==0&&g[0].isCollapsed)return}const _={text:w,selection:t.createSelection(g)};this._typingQueue.push(_,!!u.isComposing),u.domEvent.defaultPrevented&&this._typingQueue.flush("beforeinput default prevented")}),le.isAndroid?this.listenTo(n.document,"keydown",(c,u)=>{o.isCollapsed||u.keyCode!=229||!n.document.isComposing||ak(t,a)}):this.listenTo(n.document,"compositionstart",()=>{o.isCollapsed||ak(t,a)},{priority:"high"}),this.listenTo(n.document,"mutations",(c,{mutations:u})=>{if(this._typingQueue.hasAffectedElements())for(const{node:h}of u){const m=yD(h,s),g=s.toModelElement(m);if(this._typingQueue.isElementAffected(g)){this._typingQueue.flush("mutations");return}}}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("before composition end")},{priority:"high"}),this.listenTo(n.document,"compositionend",()=>{this._typingQueue.flush("after composition end");const c=[];if(this._typingQueue.hasAffectedElements())for(const u of this._typingQueue.flushAffectedElements()){const h=s.toViewElement(u);h&&c.push({type:"children",node:h})}(c.length||!le.isAndroid)&&n.document.fire("mutations",{mutations:c})},{priority:"lowest"})}destroy(){super.destroy(),this._typingQueue.destroy()}}class wD{editor;flushDebounced=Ni(()=>this.flush("timeout"),50);_queue=[];_isComposing=!1;_affectedElements=new Set;constructor(e){this.editor=e}destroy(){for(this.flushDebounced.cancel(),this._affectedElements.clear();this._queue.length;)this.shift()}get length(){return this._queue.length}push(e,t){const n={text:e.text};if(e.selection){n.selectionRanges=[];for(const s of e.selection.getRanges())n.selectionRanges.push(wn.fromRange(s)),this._affectedElements.add(s.start.parent)}this._queue.push(n),this._isComposing||=t,this.flushDebounced()}shift(){const e=this._queue.shift(),t={text:e.text};if(e.selectionRanges){const n=e.selectionRanges.map(s=>_D(s)).filter(s=>!!s);n.length&&(t.selection=this.editor.model.createSelection(n))}return t}flush(e){const t=this.editor,n=t.model,s=t.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;const a=t.commands.get("insertText").buffer;n.enqueueChange(a.batch,()=>{for(a.lock();this._queue.length;){const c=this.shift();t.execute("insertText",c)}a.unlock(),this._isComposing||this._affectedElements.clear(),this._isComposing=!1}),s.scrollToTheSelection()}isElementAffected(e){return this._affectedElements.has(e)}hasAffectedElements(){return this._affectedElements.size>0}flushAffectedElements(){const e=Array.from(this._affectedElements);return this._affectedElements.clear(),e}}function ak(i,e){if(!e.isEnabled)return;const t=e.buffer;t.lock(),i.enqueueChange(t.batch,()=>{i.deleteContent(i.document.selection)}),t.unlock()}function _D(i){const e=i.toRange();return i.detach(),e.root.rootName=="$graveyard"?null:e}function yD(i,e){let t=i.is("$text")?i.parent:i;for(;!e.toModelElement(t);)t=t.parent;return t}class lk extends me{direction;_buffer;constructor(e,t){super(e),this.direction=t,this._buffer=new jA(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,n=t.document;t.enqueueChange(this._buffer.batch,s=>{this._buffer.lock();const o=s.createSelection(e.selection||n.selection);if(!t.canEditAt(o))return;const a=e.sequence||1,c=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(a)){this._replaceEntireContentWithParagraph(s);return}if(this._shouldReplaceFirstBlockWithParagraph(o,a)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let u=0;o.getFirstRange().getMinimalFlatRanges().forEach(h=>{u+=Hp(h.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:c,direction:this.direction}),this._buffer.input(u),s.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s);if(!(s.isCollapsed&&s.containsEntireContent(o))||!t.schema.checkChild(o,"paragraph"))return!1;const c=o.getChild(0);return!(c&&c.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s),a=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(a,o),e.setSelection(a,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const n=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const s=e.getFirstPosition(),o=n.schema.getLimitElement(s),a=o.getChild(0);return!(s.parent!=a||!e.containsEntireContent(a)||!n.schema.checkChild(o,"paragraph")||a.name=="paragraph")}}const vD="character",ck="word",CD="codePoint",so="selection",la="backward",ql="forward",$A={deleteContent:{unit:so,direction:la},deleteContentBackward:{unit:CD,direction:la},deleteWordBackward:{unit:ck,direction:la},deleteHardLineBackward:{unit:so,direction:la},deleteSoftLineBackward:{unit:so,direction:la},deleteContentForward:{unit:vD,direction:ql},deleteWordForward:{unit:ck,direction:ql},deleteHardLineForward:{unit:so,direction:ql},deleteSoftLineForward:{unit:so,direction:ql}};class kD extends Hi{constructor(e){super(e);const t=e.document;let n=0;t.on("keydown",()=>{n++}),t.on("keyup",()=>{n=0}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{targetRanges:a,domEvent:c,inputType:u}=o,h=$A[u];if(!h)return;const m={direction:h.direction,unit:h.unit,sequence:n};m.unit==so&&(m.selectionToRemove=e.createSelection(a[0])),u==="deleteContentBackward"&&(le.isAndroid&&(m.sequence=1),ED(a)&&(m.unit=so,m.selectionToRemove=e.createSelection(a)));const g=new nr(t,"delete",a[0]);t.fire(g,new Yo(e,c,m)),g.stop.called&&s.stop()}),le.isBlink&&TD(this)}observe(){}stopObserving(){}}function TD(i){const e=i.view,t=e.document;let n=null,s=!1;t.on("keydown",(c,{keyCode:u})=>{n=u,s=!1}),t.on("keyup",(c,{keyCode:u,domEvent:h})=>{const m=t.selection,g=i.isEnabled&&u==n&&o(u)&&!m.isCollapsed&&!s;if(n=null,g){const w=m.getFirstRange(),_=new nr(t,"delete",w),v={unit:so,direction:a(u),selectionToRemove:m};t.fire(_,new Yo(e,h,v))}}),t.on("beforeinput",(c,{inputType:u})=>{const h=$A[u];o(n)&&h&&h.direction==a(n)&&(s=!0)},{priority:"high"}),t.on("beforeinput",(c,{inputType:u,data:h})=>{n==ke.delete&&u=="insertText"&&h==""&&c.stop()},{priority:"high"});function o(c){return c==ke.backspace||c==ke.delete}function a(c){return c==ke.backspace?la:ql}}function ED(i){if(i.length!=1||i[0].isCollapsed)return!1;const e=i[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let t=0;for(const{nextPosition:n,item:s}of e){if(n.parent.is("$text")){const o=n.parent.data,a=n.offset;if(Jb(o,a)||Qb(o,a)||eS(o,a))continue;t++}else(s.is("containerElement")||s.is("emptyElement"))&&t++;if(t>1)return!0}return!1}class Is extends N{_undoOnBackspace;static get pluginName(){return"Delete"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.model.document;t.addObserver(kD),this._undoOnBackspace=!1;const o=new lk(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new lk(e,"backward")),this.listenTo(n,"delete",(a,c)=>{n.isComposing||c.preventDefault();const{direction:u,sequence:h,selectionToRemove:m,unit:g}=c,w=u==="forward"?"deleteForward":"delete",_={sequence:h};if(g=="selection"){const v=Array.from(m.getRanges()).map(C=>e.editing.mapper.toModelRange(C)).map(C=>rw(C,e.model.schema)||C);_.selection=e.model.createSelection(v)}else _.unit=g;e.execute(w,_),t.scrollToTheSelection()},{priority:"low"}),this.listenTo(n,"keydown",(a,c)=>{if(n.isComposing||c.keyCode!=ke.backspace||!s.selection.isCollapsed)return;const u=e.model.schema.getLimitElement(s.selection),h=e.model.createPositionAt(u,0);if(h.isTouching(s.selection.getFirstPosition())){c.preventDefault();const m=e.model.schema.getNearestSelectionRange(h,"forward");if(!m)return;const g=t.createSelection(e.editing.mapper.toViewRange(m)),w=g.getFirstRange(),_=new nr(document,"delete",w),v={unit:"selection",direction:"backward",selectionToRemove:g};n.fire(_,new Yo(t,c.domEvent,v))}}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(n,"delete",(a,c)=>{this._undoOnBackspace&&c.direction=="backward"&&c.sequence==1&&c.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),c.preventDefault(),a.stop())},{context:"$capture"}),this.listenTo(s,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class SD extends N{static get requires(){return[WA,Is]}static get pluginName(){return"Typing"}static get isOfficialPlugin(){return!0}}function GA(i,e){let t=i.start;return{text:Array.from(i.getWalker({ignoreElementEnd:!1})).reduce((s,{item:o})=>o.is("$text")||o.is("$textProxy")?s+o.data:(t=e.createPositionAfter(o),""),""),range:e.createRange(t,i.end)}}class AD extends qe(){model;testCallback;_hasMatch;constructor(e,t){super(),this.model=e,this.testCallback=t,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(n,{directChange:s})=>{if(s){if(!t.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(t,"change:data",(n,s)=>{s.isUndo||!s.isLocal||this._evaluateTextBeforeSelection("data",{batch:s})})}_evaluateTextBeforeSelection(e,t={}){const n=this.model,o=n.document.selection,a=n.createRange(n.createPositionAt(o.focus.parent,0),o.focus),{text:c,range:u}=GA(a,n),h=this.testCallback(c);if(!h&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!h,h){const m=Object.assign(t,{text:c,range:u});typeof h=="object"&&Object.assign(m,h),this.fire(`matched:${e}`,m)}}}class uh extends N{attributes;_overrideUid;_isNextGravityRestorationSkipped=!1;static get pluginName(){return"TwoStepCaretMovement"}static get isOfficialPlugin(){return!0}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.locale,o=t.document.selection;this.listenTo(n.document,"arrowKey",(a,c)=>{if(!o.isCollapsed||c.shiftKey||c.altKey||c.ctrlKey)return;const u=c.keyCode==ke.arrowright,h=c.keyCode==ke.arrowleft;if(!u&&!h)return;const m=s.contentLanguageDirection;let g=!1;m==="ltr"&&u||m==="rtl"&&h?g=this._handleForwardMovement(c):g=this._handleBackwardMovement(c),g===!0&&a.stop()},{context:"$text",priority:"highest"}),this.listenTo(o,"change:range",(a,c)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!c.directChange&&ti(o.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,o=s.getFirstPosition();return this._isGravityOverridden||o.isAtStart&&us(s,t)?!1:ti(o,t)?(e&&Bl(e),us(s,t)&&ti(o,t,!0)?Vl(n,t):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,o=s.getFirstPosition();return this._isGravityOverridden?(e&&Bl(e),this._restoreGravity(),ti(o,t,!0)?Vl(n,t):_d(n,t,o),!0):o.isAtStart?us(s,t)?(e&&Bl(e),_d(n,t,o),!0):!1:!us(s,t)&&ti(o,t,!0)?(e&&Bl(e),_d(n,t,o),!0):uk(o,t)?o.isAtEnd&&!us(s,t)&&ti(o,t)?(e&&Bl(e),_d(n,t,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view.document;e.editing.view.addObserver(lw),e.editing.view.addObserver(i7);let o=!1,a=!1;this.listenTo(s,"touchstart",()=>{a=!1,o=!0}),this.listenTo(s,"mousedown",()=>{a=!0}),this.listenTo(s,"selectionChange",()=>{const c=this.attributes;if(!a&&!o||(a=!1,o=!1,!n.isCollapsed)||!us(n,c))return;const u=n.getFirstPosition();ti(u,c)&&(u.isAtStart||ti(u,c,!0)?Vl(t,c):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection,s=this.attributes;this.listenTo(t,"insertContent",()=>{const o=n.getFirstPosition();us(n,s)&&ti(o,s)&&Vl(t,s)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view;let o=!1,a=!1;this.listenTo(s.document,"delete",(c,u)=>{o=u.direction==="backward"},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{if(!o)return;const c=n.getFirstPosition();a=us(n,this.attributes)&&!uk(c,this.attributes)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{o&&(o=!1,!a&&e.model.enqueueChange(()=>{const c=n.getFirstPosition();us(n,this.attributes)&&ti(c,this.attributes)&&(c.isAtStart||ti(c,this.attributes,!0)?Vl(t,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function us(i,e){for(const t of e)if(i.hasAttribute(t))return!0;return!1}function _d(i,e,t){const n=t.nodeBefore;i.change(s=>{if(n){const o=[],a=i.schema.isObject(n)&&i.schema.isInline(n);for(const[c,u]of n.getAttributes())i.schema.checkAttribute("$text",c)&&(!a||i.schema.getAttributeProperties(c).copyFromObject!==!1)&&o.push([c,u]);s.setSelectionAttribute(o)}else s.removeSelectionAttribute(e)})}function Vl(i,e){i.change(t=>{t.removeSelectionAttribute(e)})}function Bl(i){i.preventDefault()}function uk(i,e){const t=i.getShiftedBy(-1);return ti(t,e)}function ti(i,e,t=!1){const{nodeBefore:n,nodeAfter:s}=i;for(const o of e){const a=n?n.getAttribute(o):void 0,c=s?s.getAttribute(o):void 0;if(!(t&&(a===void 0||c===void 0))&&c!==a)return!0}return!1}function Yh(i,e,t,n){return n.createRange(dk(i,e,t,!0,n),dk(i,e,t,!1,n))}function dk(i,e,t,n,s){let o=i.textNode||(n?i.nodeBefore:i.nodeAfter),a=null;for(;o&&o.getAttribute(e)==t;)a=o,o=n?o.previousSibling:o.nextSibling;return a?s.createPositionAt(a,n?"before":"after"):i}function KA(i,e,t,n){const s=i.editing.view,o=new Set;s.document.registerPostFixer(a=>{const c=i.model.document.selection;let u=!1;if(c.hasAttribute(e)){const h=Yh(c.getFirstPosition(),e,c.getAttribute(e),i.model),m=i.editing.mapper.toViewRange(h);for(const g of m.getItems())g.is("element",t)&&!g.hasClass(n)&&(a.addClass(n,g),o.add(g),u=!0)}return u}),i.conversion.for("editingDowncast").add(a=>{a.on("insert",c,{priority:"highest"}),a.on("remove",c,{priority:"highest"}),a.on("attribute",c,{priority:"highest"}),a.on("selection",c,{priority:"highest"});function c(){s.change(u=>{for(const h of o.values())u.removeClass(n,h),o.delete(h)})}})}function io(i,e,t,n){let s,o=null;typeof n=="function"?s=n:(o=i.commands.get(n),s=()=>{i.execute(n)}),i.model.document.on("change:data",(a,c)=>{if(o&&!o.isEnabled||!e.isEnabled)return;const u=Ze(i.model.document.selection.getRanges());if(!u.isCollapsed||c.isUndo||!c.isLocal)return;const h=Array.from(i.model.document.differ.getChanges()),m=h[0];if(h.length!=1||m.type!=="insert"||m.name!="$text"||m.length!=1)return;const g=m.position.parent;if(g.is("element","codeBlock")||g.is("element","listItem")&&typeof n!="function"&&!["numberedList","bulletedList","todoList"].includes(n)||o&&o.value===!0)return;const w=g.getChild(0),_=i.model.createRangeOn(w);if(!_.containsRange(u)&&!u.end.isEqual(_.end))return;const v=t.exec(w.data.substr(0,u.end.offset));v&&i.model.enqueueChange(C=>{const T=i.model.document.selection,A=C.createPositionAt(g,0),L=C.createPositionAt(g,v[0].length),z=new wn(A,L);if(s({match:v})!==!1){const Z=Array.from(T.getAttributes());C.remove(z);const ne=T.getFirstRange(),M=C.createRangeIn(g);g.isEmpty&&!M.isEqual(ne)&&!M.containsRange(ne,!0)&&C.remove(g),xD(C,T,Z)}z.detach(),i.model.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})})})}function xD(i,e,t){const n=i.model.schema,s=e.getFirstPosition();let o=new ys(s);n.checkChild(o,"$text")&&(o=o.push("$text"));for(const[a,c]of t)n.checkAttribute(o,a)&&i.setSelectionAttribute(a,c)}function ta(i,e,t,n){let s,o;t instanceof RegExp?s=t:o=t,o=o||(a=>{let c;const u=[],h=[];for(;(c=s.exec(a))!==null&&!(c&&c.length<4);){let{index:m,"1":g,"2":w,"3":_}=c;const v=g+w+_;m+=c[0].length-v.length;const C=[m,m+g.length],T=[m+g.length+w.length,m+g.length+w.length+_.length];u.push(C),u.push(T),h.push([m+g.length,m+g.length+w.length])}return{remove:u,format:h}}),i.model.document.on("change:data",(a,c)=>{if(c.isUndo||!c.isLocal||!e.isEnabled)return;const u=i.model,h=u.document.selection;if(!h.isCollapsed)return;const m=Array.from(u.document.differ.getChanges()),g=m[0];if(m.length!=1||g.type!=="insert"||g.name!="$text"||g.length!=1)return;const w=h.focus,_=w.parent,{text:v,range:C}=ID(u.createRange(u.createPositionAt(_,0),w),u),T=o(v),A=hk(C.start,T.format,u),L=hk(C.start,T.remove,u);A.length&&L.length&&u.enqueueChange(z=>{if(n(z,A)!==!1){for(const Z of L.reverse())z.remove(Z);u.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})}})})}function hk(i,e,t){return e.filter(n=>n[0]!==void 0&&n[1]!==void 0).map(n=>t.createRange(i.getShiftedBy(n[0]),i.getShiftedBy(n[1])))}function ID(i,e){let t=i.start;return{text:Array.from(i.getItems()).reduce((s,o)=>!(o.is("$text")||o.is("$textProxy"))||o.getAttribute("code")?(t=e.createPositionAfter(o),""):s+o.data,""),range:e.createRange(t,i.end)}}class PD extends N{static get requires(){return[Is]}static get pluginName(){return"Autoformat"}static get isOfficialPlugin(){return!0}afterInit(){const e=this.editor,t=this.editor.t;this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats(),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Revert autoformatting action"),keystroke:"Backspace"}]})}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&io(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&io(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&io(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&io(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const t=yd(this.editor,"bold");ta(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,t),ta(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,t)}if(e.get("italic")){const t=yd(this.editor,"italic");ta(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,t),ta(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,t)}if(e.get("code")){const t=yd(this.editor,"code");ta(this.editor,this,/(`)([^`]+)(`)$/g,t)}if(e.get("strikethrough")){const t=yd(this.editor,"strikethrough");ta(this.editor,this,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(t=>{const n=t[7],s=new RegExp(`^(#{${n}})\\s$`);io(this.editor,this,s,()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&io(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&io(e,this,/^```$/,()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&io(this.editor,this,/^---$/,"horizontalLine")}}function yd(i,e){return(t,n)=>{if(!i.commands.get(e).isEnabled)return!1;const o=i.model.schema.getValidRanges(n,e);for(const a of o)t.setAttribute(e,!0,a);t.removeSelectionAttribute(e)}}class rr extends me{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;t.change(a=>{if(s.isCollapsed)o?a.setSelectionAttribute(this.attributeKey,!0):a.removeSelectionAttribute(this.attributeKey);else{const c=t.schema.getValidRanges(s.getRanges(),this.attributeKey,{includeEmptyRanges:!0});for(const u of c){let h=u,m=this.attributeKey;u.isCollapsed&&(h=u.start.parent,m=kn._getStoreAttributeKey(this.attributeKey)),o?a.setAttribute(m,o,h):a.removeAttribute(m,h)}}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,n=e.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const s of n.getRanges())for(const o of s.getItems())if(t.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}}const na="bold";class RD extends N{static get pluginName(){return"BoldEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:na}),e.model.schema.setAttributeProperties(na,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:na,view:"strong",upcastAlso:["b",n=>{const s=n.getStyle("font-weight");return s&&(s=="bold"||Number(s)>=600)?{name:!0,styles:["font-weight"]}:null}]}),e.commands.add(na,new rr(e,na)),e.keystrokes.set("CTRL+B",na),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Bold text"),keystroke:"CTRL+B"}]})}}function ar({editor:i,commandName:e,plugin:t,icon:n,label:s,keystroke:o}){return a=>{const c=i.commands.get(e),u=new a(i.locale);return u.set({label:s,icon:n,keystroke:o,isToggleable:!0}),u.bind("isEnabled").to(c,"isEnabled"),u.bind("isOn").to(c,"value"),u instanceof tt?u.set({role:"menuitemcheckbox"}):u.set({tooltip:!0}),t.listenTo(u,"execute",()=>{i.execute(e),i.editing.view.focus()}),u}}const ap="bold";class OD extends N{static get pluginName(){return"BoldUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:ap,plugin:this,icon:rA,label:t("Bold"),keystroke:"CTRL+B"});e.ui.componentFactory.add(ap,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+ap,()=>n(tt))}}class VD extends N{static get requires(){return[RD,OD]}static get pluginName(){return"Bold"}static get isOfficialPlugin(){return!0}}const Lo="code",BD="ck-code_selected";class MD extends N{static get pluginName(){return"CodeEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[uh]}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Lo}),e.model.schema.setAttributeProperties(Lo,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:Lo,view:"code"}),e.commands.add(Lo,new rr(e,Lo)),e.plugins.get(uh).registerAttribute(Lo),KA(e,Lo,"code",BD),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Move out of an inline code style"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}}const lp="code";class ND extends N{static get pluginName(){return"CodeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:lp,plugin:this,icon:iN,label:t("Code")});e.ui.componentFactory.add(lp,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+lp,()=>n(tt))}}class LD extends N{static get requires(){return[MD,ND]}static get pluginName(){return"Code"}static get isOfficialPlugin(){return!0}}const ia="italic";class DD extends N{static get pluginName(){return"ItalicEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:ia}),e.model.schema.setAttributeProperties(ia,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:ia,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(ia,new rr(e,ia)),e.keystrokes.set("CTRL+I",ia),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Italic text"),keystroke:"CTRL+I"}]})}}const cp="italic";class FD extends N{static get pluginName(){return"ItalicUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:cp,plugin:this,icon:mN,keystroke:"CTRL+I",label:t("Italic")});e.ui.componentFactory.add(cp,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+cp,()=>n(tt))}}class zD extends N{static get requires(){return[DD,FD]}static get pluginName(){return"Italic"}static get isOfficialPlugin(){return!0}}const Ml="strikethrough";class UD extends N{static get pluginName(){return"StrikethroughEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Ml}),e.model.schema.setAttributeProperties(Ml,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Ml,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Ml,new rr(e,Ml)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Strikethrough text"),keystroke:"CTRL+SHIFT+X"}]})}}const up="strikethrough";class HD extends N{static get pluginName(){return"StrikethroughUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:up,plugin:this,icon:LN,keystroke:"CTRL+SHIFT+X",label:t("Strikethrough")});e.ui.componentFactory.add(up,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+up,()=>n(tt))}}class jD extends N{static get requires(){return[UD,HD]}static get pluginName(){return"Strikethrough"}static get isOfficialPlugin(){return!0}}const Nl="subscript";class qD extends N{static get pluginName(){return"SubscriptEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Nl}),e.model.schema.setAttributeProperties(Nl,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Nl,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add(Nl,new rr(e,Nl))}}const dp="subscript";class WD extends N{static get pluginName(){return"SubscriptUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:dp,plugin:this,icon:DN,label:t("Subscript")});e.ui.componentFactory.add(dp,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+dp,()=>n(tt))}}class $D extends N{static get requires(){return[qD,WD]}static get pluginName(){return"Subscript"}static get isOfficialPlugin(){return!0}}const Ll="superscript";class GD extends N{static get pluginName(){return"SuperscriptEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Ll}),e.model.schema.setAttributeProperties(Ll,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Ll,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(Ll,new rr(e,Ll))}}const hp="superscript";class KD extends N{static get pluginName(){return"SuperscriptUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:hp,plugin:this,icon:FN,label:t("Superscript")});e.ui.componentFactory.add(hp,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+hp,()=>n(tt))}}class YD extends N{static get requires(){return[GD,KD]}static get pluginName(){return"Superscript"}static get isOfficialPlugin(){return!0}}const Dl="underline";class JD extends N{static get pluginName(){return"UnderlineEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Dl}),e.model.schema.setAttributeProperties(Dl,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Dl,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Dl,new rr(e,Dl)),e.keystrokes.set("CTRL+U","underline"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Underline text"),keystroke:"CTRL+U"}]})}}const fp="underline";class QD extends N{static get pluginName(){return"UnderlineUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,n=ar({editor:e,commandName:fp,plugin:this,icon:KN,label:t("Underline"),keystroke:"CTRL+U"});e.ui.componentFactory.add(fp,()=>n(ue)),e.ui.componentFactory.add("menuBar:"+fp,()=>n(tt))}}class XD extends N{static get requires(){return[JD,QD]}static get pluginName(){return"Underline"}static get isOfficialPlugin(){return!0}}function*YA(i,e){for(const t of e)t&&i.getAttributeProperties(t[0]).copyOnEnter&&(yield t)}class ZD extends me{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,n=t.document.selection,s=t.schema,o=n.isCollapsed,a=n.getFirstRange(),c=a.start.parent,u=a.end.parent;if(s.isLimit(c)||s.isLimit(u))return!o&&c==u&&t.deleteContent(n),!1;if(o){const h=YA(e.model.schema,n.getAttributes());return fk(e,a.start),e.setSelectionAttribute(h),!0}else{const h=!(a.start.isAtStart&&a.end.isAtEnd),m=c==u;if(t.deleteContent(n,{leaveUnmerged:h}),h){if(m)return fk(e,n.focus),!0;e.setSelection(u,0)}}return!1}}function fk(i,e){i.split(e),i.setSelection(e.parent.nextSibling,0)}const e8={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class JA extends Hi{constructor(e){super(e);const t=this.document;let n=!1;t.on("keydown",(s,o)=>{n=o.shiftKey}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;let a=o.inputType;le.isSafari&&n&&a=="insertParagraph"&&(a="insertLineBreak");const c=o.domEvent,u=e8[a];if(!u)return;const h=new nr(t,"enter",o.targetRanges[0]);t.fire(h,new Yo(e,c,{isSoft:u.isSoft})),h.stop.called&&s.stop()})}observe(){}stopObserving(){}}class Jh extends N{static get pluginName(){return"Enter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,n=t.document,s=this.editor.t;t.addObserver(JA),e.commands.add("enter",new ZD(e)),this.listenTo(n,"enter",(o,a)=>{n.isComposing||a.preventDefault(),!a.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:s("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}class t8 extends me{execute(){const e=this.editor.model,t=e.document;e.change(n=>{i8(e,n,t.selection),this.fire("afterExecute",{writer:n})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=n8(e.schema,t.selection)}}function n8(i,e){if(e.rangeCount>1)return!1;const t=e.anchor;if(!t||!i.checkChild(t,"softBreak"))return!1;const n=e.getFirstRange(),s=n.start.parent,o=n.end.parent;return!((ib(s,i)||ib(o,i))&&s!==o)}function i8(i,e,t){const n=t.isCollapsed,s=t.getFirstRange(),o=s.start.parent,a=s.end.parent,c=o==a;if(n){const u=YA(i.schema,t.getAttributes());mk(i,e,s.end),e.removeSelectionAttribute(t.getAttributeKeys()),e.setSelectionAttribute(u)}else{const u=!(s.start.isAtStart&&s.end.isAtEnd);i.deleteContent(t,{leaveUnmerged:u}),c?mk(i,e,t.focus):u&&e.setSelection(a,0)}}function mk(i,e,t){const n=e.createElement("softBreak");i.insertContent(n,t),e.setSelection(n,"after")}function ib(i,e){return i.is("rootElement")?!1:e.isLimit(i)||ib(i.parent,e)}class QA extends N{static get pluginName(){return"ShiftEnter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema,n=e.conversion,s=e.editing.view,o=s.document,a=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(c,{writer:u})=>u.createEmptyElement("br")}),s.addObserver(JA),e.commands.add("shiftEnter",new t8(e)),this.listenTo(o,"enter",(c,u)=>{o.isComposing||u.preventDefault(),u.isSoft&&(e.execute("shiftEnter"),s.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:a("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}class s8 extends me{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.schema,s=t.document.selection,o=Array.from(s.getSelectedBlocks()),a=e.forceValue===void 0?!this.value:e.forceValue;t.change(c=>{if(!a)this._removeQuote(c,o.filter(vd));else{const u=o.filter(h=>vd(h)||pk(n,h));this._applyQuote(c,u)}})}_getValue(){const e=this.editor.model.document.selection,t=Ze(e.getSelectedBlocks());return!!(t&&vd(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Ze(e.getSelectedBlocks());return n?pk(t,n):!1}_removeQuote(e,t){gk(e,t).reverse().forEach(n=>{if(n.start.isAtStart&&n.end.isAtEnd){e.unwrap(n.start.parent);return}if(n.start.isAtStart){const o=e.createPositionBefore(n.start.parent);e.move(n,o);return}n.end.isAtEnd||e.split(n.end);const s=e.createPositionAfter(n.end.parent);e.move(n,s)})}_applyQuote(e,t){const n=[];gk(e,t).reverse().forEach(s=>{let o=vd(s.start);o||(o=e.createElement("blockQuote"),e.wrap(s,o)),n.push(o)}),n.reverse().reduce((s,o)=>s.nextSibling==o?(e.merge(e.createPositionAfter(s)),s):o)}}function vd(i){return i.parent.name=="blockQuote"?i.parent:null}function gk(i,e){let t,n=0;const s=[];for(;n<e.length;){const o=e[n],a=e[n+1];t||(t=i.createPositionBefore(o)),(!a||o.nextSibling!=a)&&(s.push(i.createRange(t,i.createPositionAfter(o))),t=null),n++}return s}function pk(i,e){const t=i.checkChild(e.parent,"blockQuote"),n=i.checkChild(["$root","blockQuote"],e);return t&&n}class o8 extends N{static get pluginName(){return"BlockQuoteEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Jh,Is]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new s8(e)),t.register("blockQuote",{inheritAllFrom:"$container"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(a=>{const c=e.model.document.differ.getChanges();for(const u of c)if(u.type=="insert"){const h=u.position.nodeAfter;if(!h)continue;if(h.is("element","blockQuote")&&h.isEmpty)return a.remove(h),!0;if(h.is("element","blockQuote")&&!t.checkChild(u.position,h))return a.unwrap(h),!0;if(h.is("element")){const m=a.createRangeIn(h);for(const g of m.getItems())if(g.is("element","blockQuote")&&!t.checkChild(a.createPositionBefore(g),g))return a.unwrap(g),!0}}else if(u.type=="remove"){const h=u.position.parent;if(h.is("element","blockQuote")&&h.isEmpty)return a.remove(h),!0}return!1});const n=this.editor.editing.view.document,s=e.model.document.selection,o=e.commands.get("blockQuote");this.listenTo(n,"enter",(a,c)=>{if(!s.isCollapsed||!o.value)return;s.getLastPosition().parent.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),c.preventDefault(),a.stop())},{context:"blockquote"}),this.listenTo(n,"delete",(a,c)=>{if(c.direction!="backward"||!s.isCollapsed||!o.value)return;const u=s.getLastPosition().parent;u.isEmpty&&!u.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),c.preventDefault(),a.stop())},{context:"blockquote"})}}class r8 extends N{static get pluginName(){return"BlockQuoteUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("blockQuote",()=>{const t=this._createButton(ue);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:blockQuote",()=>{const t=this._createButton(tt);return t.set({role:"menuitemcheckbox"}),t})}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("blockQuote"),o=new e(t.locale),a=n.t;return o.set({label:a("Block quote"),icon:ON,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value"),this.listenTo(o,"execute",()=>{t.execute("blockQuote"),t.editing.view.focus()}),o}}class a8 extends N{static get requires(){return[o8,r8]}static get pluginName(){return"BlockQuote"}static get isOfficialPlugin(){return!0}}class l8 extends Je(){_stack=[];add(e,t){const n=this._stack,s=n[0];this._insertDescriptor(e);const o=n[0];s!==o&&!mp(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}remove(e,t){const n=this._stack,s=n[0];this._removeDescriptor(e);const o=n[0];s!==o&&!mp(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}_insertDescriptor(e){const t=this._stack,n=t.findIndex(o=>o.id===e.id);if(mp(e,t[n]))return;n>-1&&t.splice(n,1);let s=0;for(;t[s]&&c8(t[s],e);)s++;t.splice(s,0,e)}_removeDescriptor(e){const t=this._stack,n=t.findIndex(s=>s.id===e);n>-1&&t.splice(n,1)}}function mp(i,e){return i&&e&&i.priority==e.priority&&dh(i.classes)==dh(e.classes)}function c8(i,e){return i.priority>e.priority?!0:i.priority<e.priority?!1:dh(i.classes)>dh(e.classes)}function dh(i){return Array.isArray(i)?i.sort().join(","):i}const u8="ck-widget",bk="ck-widget_selected";function ct(i){return i.is("element")?!!i.getCustomProperty("widget"):!1}function Qh(i,e,t={}){if(!i.is("containerElement"))throw new E("widget-to-widget-wrong-element-type",null,{element:i});return e.setAttribute("contenteditable","false",i),e.addClass(u8,i),e.setCustomProperty("widget",!0,i),i.getFillerOffset=g8,e.setCustomProperty("widgetLabel",[],i),t.label&&f8(i,t.label),t.hasSelectionHandle&&p8(i,e),XA(i,e),i}function d8(i,e,t){if(e.classes&&t.addClass(st(e.classes),i),e.attributes)for(const n in e.attributes)t.setAttribute(n,e.attributes[n],i)}function h8(i,e,t){if(e.classes&&t.removeClass(st(e.classes),i),e.attributes)for(const n in e.attributes)t.removeAttribute(n,i)}function XA(i,e,t=d8,n=h8){const s=new l8;s.on("change:top",(c,u)=>{u.oldDescriptor&&n(i,u.oldDescriptor,u.writer),u.newDescriptor&&t(i,u.newDescriptor,u.writer)});const o=(c,u,h)=>s.add(u,h),a=(c,u,h)=>s.remove(u,h);e.setCustomProperty("addHighlight",o,i),e.setCustomProperty("removeHighlight",a,i)}function f8(i,e){i.getCustomProperty("widgetLabel").push(e)}function m8(i){return i.getCustomProperty("widgetLabel").reduce((t,n)=>typeof n=="function"?t?t+". "+n():n():t?t+". "+n:n,"")}function ZA(i,e,t={}){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],i),t.withAriaRole!==!1&&e.setAttribute("role","textbox",i),i.isReadOnly||e.setAttribute("tabindex","-1",i),t.label&&e.setAttribute("aria-label",t.label,i),e.setAttribute("contenteditable",i.isReadOnly?"false":"true",i),i.on("change:isReadOnly",(n,s,o)=>{e.setAttribute("contenteditable",o?"false":"true",i),o?e.removeAttribute("tabindex",i):e.setAttribute("tabindex","-1",i)}),i.on("change:isFocused",(n,s,o)=>{o?e.addClass("ck-editor__nested-editable_focused",i):e.removeClass("ck-editor__nested-editable_focused",i)}),XA(i,e),i}function Cw(i,e){const t=i.getSelectedElement();if(t){const n=hs(i);if(n)return e.createRange(e.createPositionAt(t,n))}return e.schema.findOptimalInsertionRange(i)}function g8(){return null}function p8(i,e){const t=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(n){const s=this.toDomElement(n),o=new ki;return o.set("content",rN),o.render(),s.appendChild(o.element),s});e.insert(e.createPositionAt(i,0),t),e.addClass(["ck-widget_with-selection-handle"],i)}function kw(i){const e=c=>{const{width:u,paddingLeft:h,paddingRight:m}=c.ownerDocument.defaultView.getComputedStyle(c);return parseFloat(u)-(parseFloat(h)||0)-(parseFloat(m)||0)},t=i.parentElement;if(!t)return 0;let n=e(t);const s=5;let o=0,a=t;for(;isNaN(n);){if(a=a.parentElement,++o>s)return 0;n=e(a)}return n}function b8(i,e=new pe(i)){const t=kw(i);return t?e.width/t*100:0}const ds="widget-type-around";function Do(i,e,t){return!!i&&ct(i)&&!t.isInline(e)}function w8(i){return i.closest(".ck-widget__type-around__button")}function _8(i){return i.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function y8(i,e){const t=i.closest(".ck-widget");return e.mapDomToView(t)}function hs(i){return i.getAttribute(ds)}const e2=["before","after"],v8=new DOMParser().parseFromString(BN,"image/svg+xml").firstChild,wk="ck-widget__type-around_disabled";class C8 extends N{_currentFakeCaretModelElement=null;static get pluginName(){return"WidgetTypeAround"}static get isOfficialPlugin(){return!0}static get requires(){return[Jh,Is]}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(n,s,o)=>{t.change(a=>{for(const c of t.document.roots)o?a.removeClass(wk,c):a.addClass(wk,c)}),o||e.model.change(a=>{a.removeSelectionAttribute(ds)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const n=this.editor,s=n.editing.view,o=n.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);n.execute("insertParagraph",{position:n.model.createPositionAt(e,t),attributes:o}),s.focus(),s.scrollToTheSelection()}_listenToIfEnabled(e,t,n,s){this.listenTo(e,t,(...o)=>{this.isEnabled&&n(...o)},s)}_insertParagraphAccordingToFakeCaretPosition(){const n=this.editor.model.document.selection,s=hs(n);if(!s)return!1;const o=n.getSelectedElement();return this._insertParagraph(o,s),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,n=e.locale.t,s={before:n("Insert paragraph before block"),after:n("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,a,c)=>{const u=c.mapper.toViewElement(a.item);u&&Do(u,a.item,t)&&(k8(c.writer,s,u),u.getCustomProperty("widgetLabel").push(()=>this.isEnabled?n("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,n=t.document.selection,s=t.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(c,u)=>{this._handleArrowKeyPress(c,u)},{context:[ct,"$text"],priority:"high"}),this._listenToIfEnabled(n,"change:range",(c,u)=>{u.directChange&&e.model.change(h=>{h.removeSelectionAttribute(ds)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const c=n.getSelectedElement();if(c){const u=e.editing.mapper.toViewElement(c);if(Do(u,c,s))return}e.model.change(u=>{u.removeSelectionAttribute(ds)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(c,u,h)=>{const m=h.writer;if(this._currentFakeCaretModelElement){const v=h.mapper.toViewElement(this._currentFakeCaretModelElement);v&&(m.removeClass(e2.map(a),v),this._currentFakeCaretModelElement=null)}const g=u.selection.getSelectedElement();if(!g)return;const w=h.mapper.toViewElement(g);if(!Do(w,g,s))return;const _=hs(u.selection);_&&(m.addClass(a(_),w),this._currentFakeCaretModelElement=g)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(c,u,h)=>{h||e.model.change(m=>{m.removeSelectionAttribute(ds)})});function a(c){return`ck-widget_type-around_show-fake-caret_${c}`}}_handleArrowKeyPress(e,t){const n=this.editor,s=n.model,o=s.document.selection,a=s.schema,c=n.editing.view;if(t.shiftKey)return;const u=t.keyCode,h=iV(u,n.locale.contentLanguageDirection),m=c.document.selection.getSelectedElement(),g=n.editing.mapper.toModelElement(m);let w;Do(m,g,a)?w=this._handleArrowKeyPressOnSelectedWidget(h):o.isCollapsed?w=this._handleArrowKeyPressWhenSelectionNextToAWidget(h):t.shiftKey||(w=this._handleArrowKeyPressWhenNonCollapsedSelection(h)),w&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const n=this.editor.model,s=n.document.selection,o=hs(s);return n.change(a=>{if(o){if(!(o===(e?"after":"before")))return a.removeSelectionAttribute(ds),!0}else return a.setSelectionAttribute(ds,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,n=t.model,s=n.schema,o=t.plugins.get("Widget"),a=o._getObjectElementNextToSelection(e),c=t.editing.mapper.toViewElement(a);return Do(c,a,s)?(n.change(u=>{o._setSelectionOverElement(a),u.setSelectionAttribute(ds,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,n=t.model,s=n.schema,o=t.editing.mapper,a=n.document.selection,c=e?a.getLastPosition().nodeBefore:a.getFirstPosition().nodeAfter,u=o.toViewElement(c);return Do(u,c,s)?(n.change(h=>{h.setSelection(c,"on"),h.setSelectionAttribute(ds,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(n,s)=>{const o=w8(s.domTarget);if(!o)return;const a=_8(o),c=y8(o,t.domConverter),u=e.editing.mapper.toModelElement(c);this._insertParagraph(u,a),s.preventDefault(),n.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,n=e.editing.view;this._listenToIfEnabled(n.document,"enter",(s,o)=>{if(s.eventPhase!="atTarget")return;const a=t.getSelectedElement(),c=e.editing.mapper.toViewElement(a),u=e.model.schema;let h;this._insertParagraphAccordingToFakeCaretPosition()?h=!0:Do(c,a,u)&&(this._insertParagraph(a,o.isSoft?"before":"after"),h=!0),h&&(o.preventDefault(),s.stop())},{context:ct})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view.document;this._listenToIfEnabled(t,"insertText",(n,s)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(s.selection=t.selection)},{priority:"high"}),le.isAndroid?this._listenToIfEnabled(t,"keydown",(n,s)=>{s.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(t,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"highest"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,n=e.model,s=n.schema;this._listenToIfEnabled(t.document,"delete",(o,a)=>{if(o.eventPhase!="atTarget")return;const c=hs(n.document.selection);if(!c)return;const u=a.direction,h=n.document.selection.getSelectedElement(),m=c==="before",g=u=="forward";if(m===g)e.execute("delete",{selection:n.createSelection(h,"on")});else{const _=s.getNearestSelectionRange(n.createPositionAt(h,c),u);if(_)if(!_.isCollapsed)n.change(v=>{v.setSelection(_),e.execute(g?"deleteForward":"delete")});else{const v=n.createSelection(_.start);if(n.modifySelection(v,{direction:u}),!v.focus.isEqual(_.start))n.change(C=>{C.setSelection(_),e.execute(g?"deleteForward":"delete")});else{const C=S8(s,_.start.parent);n.deleteContent(n.createSelection(C,"on"),{doNotAutoparagraph:!0})}}}a.preventDefault(),o.stop()},{context:ct})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,n=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(s,[o,a])=>{if(a&&!a.is("documentSelection"))return;const c=hs(n);if(c)return s.stop(),t.change(u=>{const h=n.getSelectedElement(),m=t.createPositionAt(h,c),g=u.createSelection(m),w=t.insertContent(o,g);return u.setSelection(g),w})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(s,o)=>{const[,a,c={}]=o;if(a&&!a.is("documentSelection"))return;const u=hs(n);u&&(c.findOptimalPosition=u,o[3]=c)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(s,[o])=>{if(o&&!o.is("documentSelection"))return;hs(n)&&s.stop()},{priority:"high"})}}function k8(i,e,t){const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(s){const o=this.toDomElement(s);return T8(o,e),E8(o),o});i.insert(i.createPositionAt(t,"end"),n)}function T8(i,e){for(const t of e2){const n=new yn({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${t}`],title:e[t],"aria-hidden":"true"},children:[i.ownerDocument.importNode(v8,!0)]});i.appendChild(n.render())}}function E8(i){const e=new yn({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});i.appendChild(e.render())}function S8(i,e){let t=e;for(const n of e.getAncestors({parentFirst:!0})){if(n.childCount>1||i.isLimit(n))break;t=n}return t}function A8(i){const e=i.model;return(t,n)=>{const s=n.keyCode==ke.arrowup,o=n.keyCode==ke.arrowdown,a=n.shiftKey,c=e.document.selection;if(!s&&!o)return;const u=o,h=x8(i,c,u);if(h){if(h.isCollapsed){if(c.isCollapsed)return;if(a)return}(h.isCollapsed||I8(i,h,u))&&(e.change(m=>{const g=u?h.end:h.start;if(a){const w=e.createSelection(c.anchor);w.setFocus(g),m.setSelection(w)}else m.setSelection(g)}),t.stop(),n.preventDefault(),n.stopPropagation())}}}function x8(i,e,t){const n=i.model;if(t){const s=e.focus,o=_k(n,s,"forward");if(!o)return;const a=n.createRange(s,o),c=yk(n.schema,a,"backward");if(c)return n.createRange(s,c)}else{const s=e.focus,o=_k(n,s,"backward");if(!o)return;const a=n.createRange(o,s),c=yk(n.schema,a,"forward");if(c)return n.createRange(c,s)}}function _k(i,e,t){const n=i.schema,s=i.createRangeIn(e.root),o=t=="forward"?"elementStart":"elementEnd";for(const{previousPosition:a,item:c,type:u}of s.getWalker({startPosition:e,direction:t})){if(n.isLimit(c)&&!n.isInline(c))return a;if(u==o&&n.isBlock(c))return null}return null}function yk(i,e,t){const n=t=="backward"?e.end:e.start;if(i.checkChild(n,"$text"))return n;for(const{nextPosition:s}of e.getWalker({direction:t}))if(i.checkChild(s,"$text"))return s}function I8(i,e,t){const n=i.model,s=i.view.domConverter;if(t){const h=n.createSelection(e.start);n.modifySelection(h),!h.focus.isAtEnd&&!e.start.isEqual(h.focus)&&(e=n.createRange(h.focus,e.end))}const o=i.mapper.toViewRange(e),a=s.viewRangeToDom(o),c=pe.getDomRangeRects(a);let u;for(const h of c){if(u===void 0){u=Math.round(h.bottom);continue}if(Math.round(h.top)>=u)return!1;u=Math.max(u,Math.round(h.bottom))}return!0}class Ia extends N{_previouslySelected=new Set;static get pluginName(){return"Widget"}static get isOfficialPlugin(){return!0}static get requires(){return[C8,Is]}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{const u=c.writer,h=a.selection;if(h.isCollapsed)return;const m=h.getSelectedElement();if(!m)return;const g=e.editing.mapper.toViewElement(m);ct(g)&&c.consumable.consume(h,"selection")&&u.setSelection(u.createRangeOn(g),{fake:!0,label:m8(g)})}),this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{this._clearPreviouslySelectedWidgets(c.writer);const u=c.writer,h=u.document.selection;let m=null;for(const g of h.getRanges())for(const w of g){const _=w.item;ct(_)&&!B8(_,m)&&(u.addClass(bk,_),this._previouslySelected.add(_),m=_)}},{priority:"low"}),t.addObserver(lw),t.addObserver(WS),this.listenTo(n,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(n,"pointerdown",(...o)=>this._onPointerdown(...o)),this.listenTo(n,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[ct,"$text"]}),this.listenTo(n,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(n,"arrowKey",A8(this.editor.editing),{context:"$text"}),this.listenTo(n,"delete",(o,a)=>{this._handleDelete(a.direction=="forward")&&(a.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(n,"tab",(o,a)=>{this._selectNextEditable(a.shiftKey?"backward":"forward")&&(t.scrollToTheSelection(),a.preventDefault(),o.stop())},{context:o=>ct(o)||o.is("editableElement"),priority:"low"}),this.listenTo(n,"keydown",(o,a)=>{a.keystroke==ke.esc&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{context:o=>o.is("editableElement"),priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:s("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:s("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:s("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:s("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:s("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:s("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,t){const n=t.target;n&&t.domEvent.detail>=3&&this._selectBlockContent(n)&&t.preventDefault()}_onPointerdown(e,t){if(!t.domEvent.isPrimary)return;const n=this.editor,s=n.editing.view,o=s.document;let a=t.target;if(!a)return;if(!ct(a)){const u=O8(a);if(!u)return;if(ct(u))a=u;else{const h=V8(s,t);if(h&&ct(h))a=h;else return}}(le.isAndroid||le.isiOS)&&t.preventDefault(),o.isFocused||s.focus();const c=n.editing.mapper.toModelElement(a);this._setSelectionOverElement(c)}_selectBlockContent(e){const t=this.editor,n=t.model,s=t.editing.mapper,o=n.schema,a=s.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),c=M8(s.toModelElement(a),n.schema);return c?(n.change(u=>{const h=o.isLimit(c)?null:N8(u.createPositionAfter(c),o),m=u.createPositionAt(c,0),g=h?u.createPositionAt(h,0):u.createPositionAt(c,"end");u.setSelection(u.createRange(m,g))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,t){const n=t.keyCode,s=this.editor.model,o=s.schema,a=s.document.selection,c=a.getSelectedElement(),u=Fh(n,this.editor.locale.contentLanguageDirection),h=u=="down"||u=="right",m=u=="up"||u=="down";if(!t.shiftKey&&!a.isCollapsed){if(P8(a,o)){const A=h?a.getLastPosition():a.getFirstPosition(),L=o.getNearestSelectionRange(A,h?"forward":"backward");L&&(s.change(z=>{z.setSelection(L)}),t.preventDefault(),e.stop())}return}const g=R8(s,h),w=s.createSelection(g);if(s.modifySelection(w,{direction:h?"forward":"backward"}),w.isEqual(g))return;w.focus.isTouching(g.focus)&&s.modifySelection(w,{direction:h?"forward":"backward"});const _=h?g.focus.nodeBefore:g.focus.nodeAfter,v=w.focus.nodeBefore,C=w.focus.nodeAfter,T=h?v:C;if(t.shiftKey)(c&&o.isObject(c)||T&&o.isObject(T)||_&&o.isObject(_))&&(s.change(A=>{A.setSelection(w)}),t.preventDefault(),e.stop());else if(T&&o.isObject(T)){if(o.isInline(T)&&m)return;s.change(A=>{A.setSelection(T,"on")}),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const n=this.editor.model,s=n.schema,o=n.document.selection.getSelectedElement();o&&s.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){const n=this.editor.model.document.selection;if(!this.editor.model.canEditAt(n)||!n.isCollapsed)return;const s=this._getObjectElementNextToSelection(e);if(s)return this.editor.model.change(o=>{let a=n.anchor.parent;for(;a.isEmpty;){const c=a;a=c.parent,o.remove(c)}this._setSelectionOverElement(s)}),!0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,n=t.schema,s=t.document.selection,o=t.createSelection(s);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(s))return null;const a=e?o.focus.nodeBefore:o.focus.nodeAfter;return a&&n.isObject(a)?a:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(bk,t);this._previouslySelected.clear()}_selectNextEditable(e){const t=this.editor.editing,n=t.view,s=this.editor.model,o=n.document.selection,a=s.document.selection;let c;if(a.rangeCount>1){const h=a.isBackward?a.getFirstRange():a.getLastRange();c=t.mapper.toViewPosition(e=="forward"?h.end:h.start)}else c=e=="forward"?o.getFirstPosition():o.getLastPosition();const u=this._findNextFocusRange(c,e);return u?(s.change(h=>{h.setSelection(u)}),!0):!1}_findNextFocusRange(e,t){const n=this.editor.editing,s=n.view,o=this.editor.model,a=s.document.selection,c=a.editableElement,u=c.getPath();let h=a.getSelectedElement();h&&!ct(h)&&(h=null);const m=t=="forward"?s.createRange(e,s.createPositionAt(e.root,"end")):s.createRange(s.createPositionAt(e.root,0),e);for(const{nextPosition:g}of m.getWalker({direction:t})){const w=g.parent;if(ct(w)&&w!=h){const _=n.mapper.toModelElement(w);if(!o.schema.isBlock(_))continue;if(Nt(u,w.getPath())!="extension")return o.createRangeOn(_)}else if(w.is("editableElement")){if(w==c&&!h)continue;const _=n.mapper.toModelPosition(g),v=o.schema.getNearestSelectionRange(_,t);if(!v)continue;return w==c&&h?v:Nt(u,w.getPath())!="extension"?o.createRangeIn(o.schema.getLimitElement(v)):v}}return null}_selectAncestorWidget(){const e=this.editor,t=e.editing.mapper,s=e.editing.view.document.selection.getFirstPosition().parent,a=(s.is("$text")?s.parent:s).findAncestor(ct);if(!a)return!1;const c=t.toModelElement(a);return c?(e.model.change(u=>{u.setSelection(c,"on")}),!0):!1}}function P8(i,e){const t=i.getFirstPosition(),n=i.getLastPosition(),s=t.nodeAfter,o=n.nodeBefore;return!!s&&e.isObject(s)||!!o&&e.isObject(o)}function R8(i,e){const t=i.document.selection,n=t.getSelectedElement(),s=hs(t);return n&&s=="before"?i.createSelection(n,"before"):n&&s=="after"?i.createSelection(n,"after"):i.createSelection(t.getRanges(),{backward:n&&i.schema.isObject(n)?!e:t.isBackward})}function O8(i){let e=i;for(;e;){if(e.is("editableElement")||ct(e))return e;e=e.parent}return null}function V8(i,e){const t=jE(e.domEvent);let n=null;if(t?n=i.domConverter.domRangeToView(t):n=i.createRange(i.createPositionAt(e.target,0)),!n)return null;const s=n.start;if(!s.parent)return null;let o=s.parent;return s.parent.is("editableElement")&&(s.isAtEnd&&s.nodeBefore?o=s.nodeBefore:s.isAtStart&&s.nodeAfter&&(o=s.nodeAfter)),o.is("$text")?o.parent:o}function B8(i,e){return e?Array.from(i.getAncestors()).includes(e):!1}function M8(i,e){for(const t of i.getAncestors({includeSelf:!0,parentFirst:!0})){if(e.checkChild(t,"$text"))return t;if(e.isLimit(t)&&!e.isObject(t))break}return null}function N8(i,e){const t=new bs({startPosition:i});for(const{item:n}of t){if(e.isLimit(n)||!n.is("element"))return null;if(e.checkChild(n,"$text"))return n}return null}class hh extends N{_toolbarDefinitions=new Map;_balloon;static get requires(){return[As]}static get pluginName(){return"WidgetToolbarRepository"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",n=>{L8(e.editing.view.document.selection)&&n.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:n,getRelatedElement:s,balloonClassName:o="ck-toolbar-container",positions:a}){if(!n.length){Be("widget-toolbar-no-items",{toolbarId:e});return}const c=this.editor,u=c.t,h=new Qo(c.locale);if(h.ariaLabel=t||u("Widget toolbar"),this._toolbarDefinitions.has(e))throw new E("widget-toolbar-duplicated",this,{toolbarId:e});const m={view:h,getRelatedElement:s,balloonClassName:o,itemsConfig:n,positions:a,initialized:!1};c.ui.addToolbar(h,{isContextual:!0,beforeFocus:()=>{const g=s(c.editing.view.document.selection);g&&this._showToolbar(m,g)},afterBlur:()=>{this._hideToolbar(m)}}),this._toolbarDefinitions.set(e,m)}_updateToolbarsVisibility(){let e=0,t=null,n=null;for(const s of this._toolbarDefinitions.values()){const o=s.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!o)this._isToolbarInBalloon(s)&&this._hideToolbar(s);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(s)&&this._hideToolbar(s);else{const a=o.getAncestors().length;a>e&&(e=a,t=o,n=s)}}n&&this._showToolbar(n,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?vk(this.editor,t,e.positions):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:t2(this.editor,t,e.positions),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const n of this._toolbarDefinitions.values())if(this._isToolbarVisible(n)){const s=n.getRelatedElement(this.editor.editing.view.document.selection);vk(this.editor,s,e.positions)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function vk(i,e,t){const n=i.plugins.get("ContextualBalloon"),s=t2(i,e,t);n.updatePosition(s)}function t2(i,e,t){const n=i.editing.view,s=xt.defaultPositions;return{target:n.domConverter.mapViewToDom(e),positions:t||[s.northArrowSouth,s.northArrowSouthWest,s.northArrowSouthEast,s.southArrowNorth,s.southArrowNorthWest,s.southArrowNorthEast,s.viewportStickyNorth]}}function L8(i){const e=i.getSelectedElement();return!!(e&&ct(e))}class D8 extends qe(){_referenceCoordinates;_options;_originalWidth;_originalHeight;_originalWidthPercents;_aspectRatio;constructor(e){super(),this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}get originalWidth(){return this._originalWidth}get originalHeight(){return this._originalHeight}get originalWidthPercents(){return this._originalWidthPercents}get aspectRatio(){return this._aspectRatio}begin(e,t,n){const s=new pe(t);this.activeHandlePosition=U8(e),this._referenceCoordinates=F8(t,H8(this.activeHandlePosition)),this._originalWidth=s.width,this._originalHeight=s.height,this._aspectRatio=s.width/s.height;const o=n.style.width;o&&o.match(/^\d+(\.\d*)?%$/)?this._originalWidthPercents=parseFloat(o):this._originalWidthPercents=b8(n,s)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function F8(i,e){const t=new pe(i),n=e.split("-"),s={x:n[1]=="right"?t.right:t.left,y:n[0]=="bottom"?t.bottom:t.top};return s.x+=i.ownerDocument.defaultView.scrollX,s.y+=i.ownerDocument.defaultView.scrollY,s}function z8(i){return`ck-widget__resizer__handle-${i}`}function U8(i){const e=["top-left","top-right","bottom-right","bottom-left"];for(const t of e)if(i.classList.contains(z8(t)))return t}function H8(i){const e=i.split("-"),t={top:"bottom",bottom:"top",left:"right",right:"left"};return`${t[e[0]]}-${t[e[1]]}`}class j8 extends oe{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("_viewPosition",t=>t?`ck-orientation-${t}`:"")],style:{display:e.if("_isVisible","none",t=>!t)}},children:[{text:e.to("_label")}]})}_bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",(n,s)=>n!==null&&s!==null),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",(n,s,o)=>e.unit==="px"?`${n}${s}`:`${o}%`),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",(n,s,o)=>s<50||o<50?"above-center":n)}_dismiss(){this.unbind(),this._isVisible=!1}}class Ck extends qe(){_state;_sizeView;_options;_viewResizerWrapper=null;_initialViewWidth;constructor(e){super(),this._options=e,this.set("isEnabled",!0),this.set("isSelected",!1),this.bind("isVisible").to(this,"isEnabled",this,"isSelected",(t,n)=>t&&n),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",t=>{!this.state.proposedWidth&&!this.state.proposedWidthPercents&&(this._cleanup(),t.stop())},{priority:"high"})}get state(){return this._state}show(){this._options.editor.editing.view.change(t=>{t.removeClass("ck-hidden",this._viewResizerWrapper)})}hide(){this._options.editor.editing.view.change(t=>{t.addClass("ck-hidden",this._viewResizerWrapper)})}attach(){const e=this,t=this._options.viewElement;this._options.editor.editing.view.change(s=>{const o=s.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(a){const c=this.toDomElement(a);return e._appendHandles(c),e._appendSizeUI(c),c});s.insert(s.createPositionAt(t,"end"),o),s.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=o,this.isVisible||this.hide()}),this.on("change:isVisible",()=>{this.isVisible?(this.show(),this.redraw()):this.hide()})}begin(e){this._state=new D8(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e);this._options.editor.editing.view.change(h=>{const m=this._options.unit||"%",g=(m==="%"?t.widthPercents:t.width)+m;h.setStyle("width",g,this._options.viewElement)});const s=this._getHandleHost(),o=new pe(s),a=Math.round(o.width),c=Math.round(o.height),u=new pe(s);t.width=Math.round(u.width),t.height=Math.round(u.height),this.redraw(o),this.state.update({...t,handleHostWidth:a,handleHostHeight:c})}commit(){const e=this._options.unit||"%",t=(e==="%"?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(t)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!$8(t))return;const n=t.parentElement,s=this._getHandleHost(),o=this._viewResizerWrapper,a=[o.getStyle("width"),o.getStyle("height"),o.getStyle("left"),o.getStyle("top")];let c;if(n.isSameNode(s)){const u=e||new pe(s);c=[u.width+"px",u.height+"px",void 0,void 0]}else c=[s.offsetWidth+"px",s.offsetHeight+"px",s.offsetLeft+"px",s.offsetTop+"px"];Nt(a,c)!=="same"&&this._options.editor.editing.view.change(u=>{u.setStyle({width:c[0],height:c[1],left:c[2],top:c[3]},o)})}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(t=>{t.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(e){const t=this.state,n=W8(e),s=this._options.isCentered?this._options.isCentered(this):!0,o={x:t._referenceCoordinates.x-(n.x+t.originalWidth),y:n.y-t.originalHeight-t._referenceCoordinates.y};s&&t.activeHandlePosition.endsWith("-right")&&(o.x=n.x-(t._referenceCoordinates.x+t.originalWidth)),s&&(o.x*=2);let a=Math.abs(t.originalWidth+o.x),c=Math.abs(t.originalHeight+o.y);return(a/t.aspectRatio>c?"width":"height")=="width"?c=a/t.aspectRatio:a=c*t.aspectRatio,{width:Math.round(a),height:Math.round(c),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*a*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const n of t)e.appendChild(new yn({tag:"div",attributes:{class:`ck-widget__resizer__handle ${q8(n)}`}}).render())}_appendSizeUI(e){this._sizeView=new j8,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function q8(i){return`ck-widget__resizer__handle-${i}`}function W8(i){return{x:i.pageX,y:i.pageY}}function $8(i){return i&&i.ownerDocument&&i.ownerDocument.contains(i)}class gp extends N{_resizers=new Map;_observer;_redrawSelectedResizerThrottled;static get pluginName(){return"WidgetResize"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.editing,t=ee.window.document;this.set("selectedResizer",null),this.set("_activeResizer",null),e.view.addObserver(lw),this._observer=new(Hn()),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this)),this._redrawSelectedResizerThrottled=cc(()=>this.redrawSelectedResizer(),200),this.editor.ui.on("update",this._redrawSelectedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[s,o]of this._resizers)s.isAttached()||(this._resizers.delete(s),o.destroy())},{priority:"lowest"}),this._observer.listenTo(ee.window,"resize",this._redrawSelectedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",()=>{const s=n.getSelectedElement(),o=this.getResizerByViewElement(s)||null;o?this.select(o):this.deselect()})}redrawSelectedResizer(){this.selectedResizer&&this.selectedResizer.isVisible&&this.selectedResizer.redraw()}destroy(){super.destroy(),this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawSelectedResizerThrottled.cancel()}select(e){this.deselect(),this.selectedResizer=e,this.selectedResizer.isSelected=!0}deselect(){this.selectedResizer&&(this.selectedResizer.isSelected=!1),this.selectedResizer=null}attachTo(e){const t=new Ck(e),n=this.editor.plugins;if(t.attach(),n.has("WidgetToolbarRepository")){const a=n.get("WidgetToolbarRepository");t.on("begin",()=>{a.forceDisabled("resize")},{priority:"lowest"}),t.on("cancel",()=>{a.clearForceDisabled("resize")},{priority:"highest"}),t.on("commit",()=>{a.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(e.viewElement,t);const o=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(o)==t&&this.select(t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const n=t.domTarget;Ck.isResizeHandle(n)&&(this._activeResizer=this._getResizerByHandle(n)||null,this._activeResizer&&(this._activeResizer.begin(n),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}class kc extends Ci{domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"];constructor(e){super(e);const t=this.document;this.listenTo(t,"paste",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",n("dragging"),{priority:"low"});function n(s){return(o,a)=>{a.preventDefault();const c=a.dropRange?[a.dropRange]:null,u=new Ts(t,s);t.fire(u,{dataTransfer:a.dataTransfer,method:o.name,targetRanges:c,target:a.target,domEvent:a.domEvent}),u.stop.called&&a.stopPropagation()}}}onDomEvent(e){const t="clipboardData"in e?e.clipboardData:e.dataTransfer,n=e.type=="drop"||e.type=="paste",s={dataTransfer:new mS(t,{cacheFiles:n})};if(e.type=="drop"||e.type=="dragover"){const o=jE(e);s.dropRange=o&&this.view.domConverter.domRangeToView(o)}this.fire(e.type,e,s)}}function G8(i){return i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(i.includes("</p><p>")||i.includes("<br>"))&&(i=`<p>${i}</p>`),i}function K8(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>t.length==1?" ":t).replace(/<!--[\s\S]*?-->/g,"")}const kk=["figcaption","li"],Tk=["ol","ul"];function n2(i,e){if(e.is("$text")||e.is("$textProxy"))return e.data;if(e.is("element","img")&&e.hasAttribute("alt"))return e.getAttribute("alt");if(e.is("element","br"))return`
`;let t="",n=null;for(const s of e.getChildren())t+=Y8(s,n)+n2(i,s),n=s;if(e.is("rawElement")){const o=document.implementation.createHTMLDocument("").createElement("div");e.render(o,i),t+=i2(o)}return t}function i2(i){let e="";if(i.nodeType===Node.TEXT_NODE)return i.textContent;if(i.tagName==="BR")return`
`;for(const t of i.childNodes)e+=i2(t);return e}function Y8(i,e){return e?i.is("element","li")&&!i.isEmpty&&i.getChild(0).is("containerElement")||Tk.includes(i.name)&&Tk.includes(e.name)?`

`:!i.is("containerElement")&&!e.is("containerElement")?"":kk.includes(i.name)||kk.includes(e.name)?`
`:i.is("element")&&i.getCustomProperty("dataPipeline:transparentRendering")||e.is("element")&&e.getCustomProperty("dataPipeline:transparentRendering")?"":`

`:""}class ic extends N{_markersToCopy=new Map;static get pluginName(){return"ClipboardMarkersUtils"}static get isOfficialPlugin(){return!0}_registerMarkerToCopy(e,t){this._markersToCopy.set(e,t)}_copySelectedFragmentWithMarkers(e,t,n=s=>s.model.getSelectedContent(s.model.document.selection)){return this.editor.model.change(s=>{const o=s.model.document.selection;s.setSelection(t);const a=this._insertFakeMarkersIntoSelection(s,s.model.document.selection,e),c=n(s),u=this._removeFakeMarkersInsideElement(s,c);for(const[h,m]of Object.entries(a)){u[h]||=s.createRangeIn(c);for(const g of m)s.remove(g)}c.markers.clear();for(const[h,m]of Object.entries(u))c.markers.set(h,m);return s.setSelection(o),c})}_pasteMarkersIntoTransformedElement(e,t){const n=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(s=>{const o=this._insertFakeMarkersElements(s,n),a=t(s),c=this._removeFakeMarkersInsideElement(s,a);for(const u of Object.values(o).flat())s.remove(u);for(const[u,h]of Object.entries(c))s.model.markers.has(u)||s.addMarker(u,{usingOperation:!0,affectsData:!0,range:h});return a})}_pasteFragmentWithMarkers(e){const t=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const n of t)e.markers.set(n.name,n.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,t,n={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const s=this._markersToCopy.get(e);this._markersToCopy.set(e,n),t(),s?this._markersToCopy.set(e,s):this._markersToCopy.delete(e)}_isMarkerCopyable(e,t){const n=this._getMarkerClipboardConfig(e);if(!n)return!1;if(!t)return!0;const{allowedActions:s}=n;return s==="all"||s.includes(t)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[t]=e.split(":");return this._markersToCopy.get(t)||null}_insertFakeMarkersIntoSelection(e,t,n){const s=this._getCopyableMarkersFromSelection(e,t,n);return this._insertFakeMarkersElements(e,s)}_getCopyableMarkersFromSelection(e,t,n){const s=Array.from(t.getRanges()),o=new Set(s.flatMap(c=>Array.from(e.model.markers.getMarkersIntersectingRange(c)))),a=c=>{if(!this._isMarkerCopyable(c.name,n))return!1;const{copyPartiallySelected:h}=this._getMarkerClipboardConfig(c.name);if(!h){const m=c.getRange();return s.some(g=>g.containsRange(m,!0))}return!0};return Array.from(o).filter(a).map(c=>({name:n==="dragstart"?this._getUniqueMarkerName(c.name):c.name,range:c.getRange()}))}_getPasteMarkersFromRangeMap(e,t=null){const{model:n}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,a])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:a}];if(this._isMarkerCopyable(o,t)){const c=this._getMarkerClipboardConfig(o),u=n.markers.has(o)&&n.markers.get(o).getRange().root.rootName==="$graveyard";return(c.duplicateOnPaste||u)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:a}]}return[]})}_insertFakeMarkersElements(e,t){const n={},s=t.flatMap(o=>{const{start:a,end:c}=o.range;return[{position:a,marker:o,type:"start"},{position:c,marker:o,type:"end"}]}).sort(({position:o},{position:a})=>o.isBefore(a)?1:-1);for(const{position:o,marker:a,type:c}of s){const u=e.createElement("$marker",{"data-name":a.name,"data-type":c});n[a.name]||(n[a.name]=[]),n[a.name].push(u),e.insert(u,o)}return n}_removeFakeMarkersInsideElement(e,t){const s=this._getAllFakeMarkersFromElement(e,t).reduce((o,a)=>{const c=a.markerElement&&e.createPositionBefore(a.markerElement);let u=o[a.name],h=!1;return u?.start&&u?.end&&(this._getMarkerClipboardConfig(a.name).duplicateOnPaste?o[this._getUniqueMarkerName(a.name)]=o[a.name]:h=!0,u=null),h||(o[a.name]={...u,[a.type]:c}),a.markerElement&&e.remove(a.markerElement),o},{});return tO(s,o=>new F(o.start||e.createPositionFromPath(t,[0]),o.end||e.createPositionAt(t,"end")))}_getAllFakeMarkersFromElement(e,t){const n=Array.from(e.createRangeIn(t)).flatMap(({item:a})=>{if(!a.is("element","$marker"))return[];const c=a.getAttribute("data-name"),u=a.getAttribute("data-type");return[{markerElement:a,name:c,type:u}]}),s=[],o=[];for(const a of n)a.type==="end"&&(n.some(u=>u.name===a.name&&u.type==="start")||s.push({markerElement:null,name:a.name,type:"start"})),a.type==="start"&&(n.some(u=>u.name===a.name&&u.type==="end")||o.unshift({markerElement:null,name:a.name,type:"end"}));return[...s,...n,...o]}_getUniqueMarkerName(e){const t=e.split(":"),n=rn().substring(1,6);return t.length===3?`${t.slice(0,2).join(":")}:${n}`:`${t.join(":")}:${n}`}}class zn extends N{static get pluginName(){return"ClipboardPipeline"}static get isOfficialPlugin(){return!0}static get requires(){return[ic]}init(){this.editor.editing.view.addObserver(kc),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(e,t,n){const s=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:n==="cut"},()=>{const o=s._copySelectedFragmentWithMarkers(n,t);this.fire("outputTransformation",{dataTransfer:e,content:o,method:n})})}_setupPasteDrop(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(s,"clipboardInput",(a,c)=>{c.method=="paste"&&!e.model.canEditAt(e.model.document.selection)&&a.stop()},{priority:"highest"}),this.listenTo(s,"clipboardInput",(a,c)=>{const u=c.dataTransfer;let h;if(c.content)h=c.content;else{let w="";u.getData("text/html")?w=K8(u.getData("text/html")):u.getData("text/plain")&&(w=G8(u.getData("text/plain"))),h=this.editor.data.htmlProcessor.toView(w)}const m=new Ts(this,"inputTransformation"),g=u.getData("application/ckeditor5-editor-id")||null;this.fire(m,{content:h,dataTransfer:u,sourceEditorId:g,targetRanges:c.targetRanges,method:c.method}),m.stop.called&&a.stop(),n.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(a,c)=>{if(c.content.isEmpty)return;const h=this.editor.data.toModel(c.content,"$clipboardHolder");h.childCount!=0&&(a.stop(),t.change(()=>{this.fire("contentInsertion",{content:h,method:c.method,sourceEditorId:c.sourceEditorId,dataTransfer:c.dataTransfer,targetRanges:c.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(a,c)=>{c.resultRange=o._pasteFragmentWithMarkers(c.content)},{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,s=e.editing.view.document,o=(a,c)=>{const u=c.dataTransfer;c.preventDefault(),this._fireOutputTransformationEvent(u,t.selection,a.name)};this.listenTo(s,"copy",o,{priority:"low"}),this.listenTo(s,"cut",(a,c)=>{e.model.canEditAt(e.model.document.selection)?o(a,c):c.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(a,c)=>{const u=e.data.toView(c.content,{isClipboardPipeline:!0});s.fire("clipboardOutput",{dataTransfer:c.dataTransfer,content:u,method:c.method})},{priority:"low"}),this.listenTo(s,"clipboardOutput",(a,c)=>{c.content.isEmpty||(c.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(c.content)),c.dataTransfer.setData("text/plain",n2(e.data.htmlProcessor.domConverter,c.content)),c.dataTransfer.setData("application/ckeditor5-editor-id",this.editor.id)),c.method=="cut"&&e.model.deleteContent(t.selection)},{priority:"low"})}}const pp=Mc("px");class J8 extends oe{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",e.if("isVisible","ck-hidden",t=>!t)],style:{left:e.to("left",t=>pp(t)),top:e.to("top",t=>pp(t)),width:e.to("width",t=>pp(t))}}})}}class Cd extends N{removeDropMarkerDelayed=Kb(()=>this.removeDropMarker(),40);_updateDropMarkerThrottled=cc(e=>this._updateDropMarker(e),40);_reconvertMarkerThrottled=cc(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0);_dropTargetLineView=new J8;_domEmitter=new(Hn());_scrollables=new Map;static get pluginName(){return"DragDropTarget"}static get isOfficialPlugin(){return!0}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,t,n,s,o,a){this.removeDropMarkerDelayed.cancel();const c=Ek(this.editor,e,t,n,s,o,a);return c?a&&a.containsRange(c)?(this.removeDropMarker(),null):c&&!this.editor.model.canEditAt(c)?(this.removeDropMarker(),null):(this._updateDropMarkerThrottled(c),c):null}getFinalDropRange(e,t,n,s,o,a){const c=Ek(this.editor,e,t,n,s,o,a);return this.removeDropMarker(),c}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(t=>{t.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:n})=>{if(e.model.schema.checkChild(t.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(n);t.markerRange.isCollapsed?this._updateDropTargetLine(t.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const t=this.editor,n=t.model.markers;t.model.change(s=>{n.has("drop-target")?n.get("drop-target").getRange().isEqual(e)||s.updateMarker("drop-target",{range:e}):s.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(t){const n=this.toDomElement(t);return n.append("",t.createElement("span"),""),n})}_updateDropTargetLine(e){const t=this.editor.editing,n=e.start.nodeBefore,s=e.start.nodeAfter,o=e.start.parent,a=n?t.mapper.toViewElement(n):null,c=a?t.view.domConverter.mapViewToDom(a):null,u=s?t.mapper.toViewElement(s):null,h=u?t.view.domConverter.mapViewToDom(u):null,m=t.mapper.toViewElement(o);if(!m)return;const g=t.view.domConverter.mapViewToDom(m),w=this._getScrollableRect(m),{scrollX:_,scrollY:v}=ee.window,C=c?new pe(c):null,T=h?new pe(h):null,A=new pe(g).excludeScrollbarsAndBorders(),L=C?C.bottom:A.top,z=T?T.top:A.bottom,j=ee.window.getComputedStyle(g),Z=L<=z?(L+z)/2:z;if(w.top<Z&&Z<w.bottom){const ne=A.left+parseFloat(j.paddingLeft),M=A.right-parseFloat(j.paddingRight),J=Math.max(ne+_,w.left),Y=Math.min(M+_,w.right);this._dropTargetLineView.set({isVisible:!0,left:J,top:Z+v,width:Y-J})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const t=e.root.rootName;let n;if(this._scrollables.has(t))n=this._scrollables.get(t).domElement;else{const s=this.editor.editing.view.domConverter.mapViewToDom(e);n=X8(s),this._domEmitter.listenTo(n,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new lt(n,this._reconvertMarkerThrottled);this._scrollables.set(t,{domElement:n,resizeObserver:o})}return new pe(n).excludeScrollbarsAndBorders()}}function Ek(i,e,t,n,s,o,a){const c=i.model,u=i.editing.mapper;let m=Sk(i,e);for(;m;){if(!o){if(c.schema.checkChild(m,"$text")){if(t){const g=t[0].start,w=u.toModelPosition(g);if(!a||Array.from(a.getItems({shallow:!0})).some(v=>c.schema.checkChild(w,v))){if(c.schema.checkChild(w,"$text"))return c.createRange(w);if(g)return kd(i,Sk(i,g.parent),n,s)}}}else if(c.schema.isInline(m))return kd(i,m,n,s)}if(c.schema.isBlock(m))return kd(i,m,n,s);if(c.schema.checkChild(m,"$block")){const g=Array.from(m.getChildren()).filter(v=>v.is("element")&&!Q8(i,v));let w=0,_=g.length;if(_==0)return c.createRange(c.createPositionAt(m,"end"));for(;w<_-1;){const v=Math.floor((w+_)/2);s2(i,g[v],n,s)=="before"?_=v:w=v}return kd(i,g[w],n,s)}m=m.parent}return null}function Q8(i,e){const t=i.editing.mapper,n=i.editing.view.domConverter,s=t.toViewElement(e);if(!s)return!0;const o=n.mapViewToDom(s);return ee.window.getComputedStyle(o).float!="none"}function kd(i,e,t,n){const s=i.model;return s.createRange(s.createPositionAt(e,s2(i,e,t,n)))}function s2(i,e,t,n){const s=i.editing.mapper,o=i.editing.view.domConverter,a=s.toViewElement(e),c=o.mapViewToDom(a),u=new pe(c);return i.model.schema.isInline(e)?t<(u.left+u.right)/2?"before":"after":n<(u.top+u.bottom)/2?"before":"after"}function Sk(i,e){const t=i.editing.mapper,n=i.editing.view,s=t.toModelElement(e);if(s)return s;const o=n.createPositionBefore(e),a=t.findMappedViewAncestor(o);return t.toModelElement(a)}function X8(i){let e=i;do{e=e.parentElement;const t=ee.window.getComputedStyle(e).overflowY;if(t=="auto"||t=="scroll")break}while(e.tagName!="BODY");return e}class Z8 extends N{_isBlockDragging=!1;_domEmitter=new(Hn());static get pluginName(){return"DragDropBlockToolbar"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(t,n,s)=>{s?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),le.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const n=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(n,"dragstart",(s,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(ee.document,"dragover",(s,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(ee.document,"drop",(s,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(ee.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&n.setAttribute("draggable","true"),this.on("change:isEnabled",(s,o,a)=>{n.setAttribute("draggable",a?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const t=this.editor.model,n=t.document.selection,s=this.editor.editing.view,o=Array.from(n.getSelectedBlocks()),a=t.createRange(t.createPositionBefore(o[0]),t.createPositionAfter(o[o.length-1]));t.change(c=>c.setSelection(a)),this._isBlockDragging=!0,s.focus(),s.getObserver(kc).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const t=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),n=e.clientY,s=document.elementFromPoint(t,n),o=this.editor.editing.view;!s||!s.closest(".ck-editor__editable")||o.getObserver(kc).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:s,clientX:t,clientY:n,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}}class eF extends N{_draggedRange;_draggingUid;_draggableElement;_clearDraggableAttributesDelayed=Kb(()=>this._clearDraggableAttributes(),40);_blockMode=!1;_domEmitter=new(Hn());_previewContainer;static get pluginName(){return"DragDrop"}static get isOfficialPlugin(){return!0}static get requires(){return[zn,Ia,Cd,Z8]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,t.addObserver(kc),t.addObserver(WS),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(n,s,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(n,s,o)=>{o||this._finalizeDragging(!1)}),le.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=e.plugins.get(Cd);this.listenTo(s,"dragstart",(a,c)=>{if(c.target?.is("editableElement")){c.preventDefault();return}if(this._prepareDraggedRange(c.target),!this._draggedRange){c.preventDefault();return}this._draggingUid=rn();const u=this.isEnabled&&e.model.canEditAt(this._draggedRange);c.dataTransfer.effectAllowed=u?"copyMove":"copy",c.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const h=t.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(c.dataTransfer,h,"dragstart");const{dataTransfer:g,domTarget:w,domEvent:_}=c,{clientX:v}=_;this._updatePreview({dataTransfer:g,domTarget:w,clientX:v}),c.stopPropagation(),u||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(s,"dragend",(a,c)=>{this._finalizeDragging(!c.dataTransfer.isCanceled&&c.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(ee.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(s,"dragenter",()=>{this.isEnabled&&n.focus()}),this.listenTo(s,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(s,"dragging",(a,c)=>{if(!this.isEnabled){c.dataTransfer.dropEffect="none";return}const{clientX:u,clientY:h}=c.domEvent;if(!o.updateDropMarker(c.target,c.targetRanges,u,h,this._blockMode,this._draggedRange)){c.dataTransfer.dropEffect="none";return}this._draggedRange||(c.dataTransfer.dropEffect="copy"),le.isGecko||(c.dataTransfer.effectAllowed=="copy"?c.dataTransfer.dropEffect="copy":["all","copyMove"].includes(c.dataTransfer.effectAllowed)&&(c.dataTransfer.dropEffect="move")),a.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,n=e.editing.view.document,s=e.plugins.get(Cd);this.listenTo(n,"clipboardInput",(o,a)=>{if(a.method!="drop")return;const{clientX:c,clientY:u}=a.domEvent,h=s.getFinalDropRange(a.target,a.targetRanges,c,u,this._blockMode,this._draggedRange);if(!h){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=a.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),Ak(a.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(h,!0)){this._finalizeDragging(!1),o.stop();return}a.targetRanges=[e.editing.mapper.toViewRange(h)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(zn);e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=n.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(s))},{priority:"high"}),e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=Ak(n.dataTransfer)=="move",o=!n.resultRange||!n.resultRange.isCollapsed;this._finalizeDragging(o&&s)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,n=t.document;this.listenTo(n,"pointerdown",(s,o)=>{if(le.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let a=xk(o.target);if(le.isBlink&&!e.isReadOnly&&!a&&!n.selection.isCollapsed){const c=n.selection.getSelectedElement();(!c||!ct(c))&&(a=n.selection.editableElement)}a&&(t.change(c=>{c.setAttribute("draggable","true",a)}),this._draggableElement=e.editing.mapper.toModelElement(a))}),this.listenTo(n,"pointerup",()=>{le.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(t=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const t=this.editor,n=t.model;t.plugins.get(Cd).removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&n.change(o=>{const a=n.createSelection(this._draggedRange);n.deleteContent(a,{doNotAutoparagraph:!0});const c=a.getFirstPosition().parent;c.isEmpty&&!n.schema.checkChild(c,"$text")&&n.schema.checkChild(c,"paragraph")&&o.insertElement("paragraph",c,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const t=this.editor,n=t.model,s=n.document.selection,o=e?xk(e):null;if(o){const h=t.editing.mapper.toModelElement(o);this._draggedRange=wn.fromRange(n.createRangeOn(h)),this._blockMode=n.schema.isBlock(h),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(s.isCollapsed&&!s.getFirstPosition().parent.isEmpty)return;const a=Array.from(s.getSelectedBlocks()),c=s.getFirstRange();if(a.length==0){this._draggedRange=wn.fromRange(c);return}const u=o2(n,a);if(a.length>1)this._draggedRange=wn.fromRange(u),this._blockMode=!0;else if(a.length==1){const h=c.start.isTouching(u.start)&&c.end.isTouching(u.end);this._draggedRange=wn.fromRange(h?u:c),this._blockMode=h}n.change(h=>h.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:t,clientX:n}){const s=this.editor.editing.view,o=s.document.selection.editableElement,a=s.domConverter.mapViewToDom(o),c=ee.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=fi(ee.document,"div",{style:"position: fixed; left: -999999px;"}),ee.document.body.appendChild(this._previewContainer));const u=fi(ee.document,"div");u.className="ck ck-content ck-clipboard-preview";const h=new pe(a),m=parseFloat(c.paddingLeft),g=parseFloat(c.paddingRight),w=parseFloat(c.width)-m-g;if(a.contains(t))if(le.isiOS)u.style.maxWidth=`${w}px`,u.style.padding="10px",u.style.minWidth="200px",u.style.minHeight="20px",u.style.boxSizing="border-box",u.style.backgroundColor="var(--ck-color-base-background)";else return;else if(le.isiOS)u.style.width=`${w}px`,u.style.backgroundColor="var(--ck-color-base-background)";else{const _=h.left-n+m;u.style.width=`${w+_}px`,u.style.paddingLeft=`${_}px`}s.domConverter.setContentOf(u,e.getData("text/html")),e.setDragImage(u,0,0),this._previewContainer.appendChild(u)}}function Ak(i){return le.isGecko?i.dropEffect:["all","copyMove"].includes(i.effectAllowed)?"move":"copy"}function xk(i){if(i.is("editableElement"))return null;if(i.hasClass("ck-widget__selection-handle"))return i.findAncestor(ct);if(ct(i))return i;const e=i.findAncestor(t=>ct(t)||t.is("editableElement"));return ct(e)?e:null}function o2(i,e){const t=e[0],n=e[e.length-1],s=t.getCommonAncestor(n),o=i.createPositionBefore(t),a=i.createPositionAfter(n);if(s&&s.is("element")&&!i.schema.isLimit(s)){const c=i.createRangeOn(s),u=o.isTouching(c.start),h=a.isTouching(c.end);if(u&&h)return o2(i,[s])}return i.createRange(o,a)}class tF extends N{static get pluginName(){return"PastePlainText"}static get isOfficialPlugin(){return!0}static get requires(){return[zn]}init(){const e=this.editor,t=e.model,n=e.editing.view,s=t.document.selection;n.addObserver(kc),e.plugins.get(zn).on("contentInsertion",(o,a)=>{nF(a.content,t)&&t.change(c=>{const u=Array.from(s.getAttributes()).filter(([m])=>t.schema.getAttributeProperties(m).isFormatting);s.isCollapsed||t.deleteContent(s,{doNotAutoparagraph:!0}),u.push(...s.getAttributes());const h=c.createRangeIn(a.content);for(const m of h.getItems())for(const g of u)t.schema.checkAttribute(m,g[0])&&c.setAttribute(g[0],g[1],m)})})}}function nF(i,e){let t=e.createRangeIn(i);if(i.childCount==1){const n=i.getChild(0);n.is("element")&&e.schema.isBlock(n)&&!e.schema.isObject(n)&&!e.schema.isLimit(n)&&(t=e.createRangeIn(n))}for(const n of t.getItems())if(!e.schema.isInline(n)||Array.from(n.getAttributeKeys()).find(o=>e.schema.getAttributeProperties(o).isFormatting))return!1;return!0}class r2 extends N{static get pluginName(){return"Clipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[ic,zn,eF,tF]}init(){const e=this.editor,t=this.editor.t;e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Copy selected content"),keystroke:"CTRL+C"},{label:t("Paste content"),keystroke:"CTRL+V"},{label:t("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}}function fh(i){const e=i.t,t=i.config.get("codeBlock.languages");for(const n of t)n.label==="Plain text"&&(n.label=e("Plain text")),n.class===void 0&&(n.class=`language-${n.language}`);return t}function mh(i,e,t){const n={};for(const s of i)if(e==="class"){const o=s[e].split(" ").shift();n[o]=s[t]}else n[s[e]]=s[t];return n}function Tw(i){return i.data.match(/^(\s*)/)[0]}function iF(i,e){const t=i.createDocumentFragment(),n=e.split(`
`),s=n.reduce((o,a,c)=>(o.push(a),c<n.length-1&&o.push(i.createElement("br")),o),[]);return i.appendChild(s,t),t}function sb(i){const e=i.document.selection,t=[];if(e.isCollapsed)return[e.anchor];const n=e.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:s}of n){let o=s.is("$textProxy")?s.textNode:s;const a=o.parent;if(!a.is("element","codeBlock")||o.is("element","softBreak"))continue;for(;o.previousSibling&&!o.previousSibling.is("element","softBreak");)o=o.previousSibling;const c=o.is("$text")?o.startOffset+Tw(o).length:o.startOffset,u=i.createPositionAt(a,c);t.every(h=>!h.isEqual(u))&&t.push(u)}return t}function a2(i){const e=Ze(i.getSelectedBlocks());return!!e&&e.is("element","codeBlock")}function Ik(i,e){return e.is("rootElement")||i.isLimit(e)?!1:i.checkChild(e.parent,"codeBlock")}function Pk(i,e,t,n){const s=mh(e,"language","label"),o=t.getAttribute("language");if(o in s){const a=s[o];return i(n==="enter"?"Entering %0 code snippet":"Leaving %0 code snippet",a)}return i(n==="enter"?"Entering code snippet":"Leaving code snippet")}function l2(i,e){for(i.textNode&&(i=e.createPositionBefore(i.textNode));i.nodeBefore&&!i.nodeBefore.is("element","softBreak");)i=e.createPositionBefore(i.nodeBefore);const t=i.nodeAfter;return t&&t.is("$text")?t:null}class sF extends me{_lastLanguage;constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,n=t.model,s=n.document.selection,a=fh(t)[0],c=Array.from(s.getSelectedBlocks()),u=e.forceValue==null?!this.value:e.forceValue,h=oF(e,this._lastLanguage,a.language);n.change(m=>{u?this._applyCodeBlock(m,c,h):this._removeCodeBlock(m,c)})}_getValue(){const e=this.editor.model.document.selection,t=Ze(e.getSelectedBlocks());return!!t?.is("element","codeBlock")?t.getAttribute("language"):!1}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Ze(e.getSelectedBlocks());return n?Ik(t,n):!1}_applyCodeBlock(e,t,n){this._lastLanguage=n;const s=this.editor.model.schema,o=t.filter(a=>Ik(s,a));for(const a of o)e.rename(a,"codeBlock"),e.setAttribute("language",n,a),s.removeDisallowedAttributes([a],e),Array.from(a.getChildren()).filter(c=>!s.checkChild(a,c)).forEach(c=>e.remove(c));o.reverse().forEach((a,c)=>{const u=o[c+1];a.previousSibling===u&&(e.appendElement("softBreak",u),e.merge(e.createPositionBefore(a)))})}_removeCodeBlock(e,t){const n=t.filter(s=>s.is("element","codeBlock"));for(const s of n){const o=e.createRangeOn(s);for(const a of Array.from(o.getItems()).reverse())if(a.is("element","softBreak")&&a.parent.is("element","codeBlock")){const{position:c}=e.split(e.createPositionBefore(a)),u=c.nodeAfter;e.rename(u,"paragraph"),e.removeAttribute("language",u),e.remove(a)}e.rename(s,"paragraph"),e.removeAttribute("language",s)}}}function oF(i,e,t){return i.language?i.language:i.usePreviousLanguageChoice&&e?e:t}class rF extends me{_indentSequence;constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(n=>{const s=sb(t);for(const o of s){const a=n.createText(this._indentSequence);t.insertContent(a,o)}})}_checkEnabled(){return this._indentSequence?a2(this.editor.model.document.selection):!1}}class aF extends me{_indentSequence;constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(()=>{const n=sb(t);for(const s of n){const o=Rk(t,s,this._indentSequence);o&&t.deleteContent(t.createSelection(o))}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return a2(e.document.selection)?sb(e).some(t=>Rk(e,t,this._indentSequence)):!1}}function Rk(i,e,t){const n=l2(e,i);if(!n)return null;const s=Tw(n),o=s.lastIndexOf(t);if(o+t.length!==s.length||o===-1)return null;const{parent:a,startOffset:c}=n;return i.createRange(i.createPositionAt(a,c+o),i.createPositionAt(a,c+o+t.length))}function Ok(i,e,t=!1){const n=mh(e,"language","class"),s=mh(e,"language","label");return(o,a,c)=>{const{writer:u,mapper:h,consumable:m}=c;if(!m.consume(a.item,"insert"))return;const g=a.item.getAttribute("language"),w=h.toViewPosition(i.createPositionBefore(a.item)),_={};t&&(_["data-language"]=s[g],_.spellcheck="false");const v=n[g]?{class:n[g]}:void 0,C=u.createContainerElement("code",v),T=u.createContainerElement("pre",_,C);u.insert(w,T),h.bindElements(a.item,C)}}function lF(i){return(e,t,n)=>{if(t.item.parent.name!=="codeBlock")return;const{writer:s,mapper:o,consumable:a}=n;if(!a.consume(t.item,"insert"))return;const c=o.toViewPosition(i.createPositionBefore(t.item));s.insert(c,s.createText(`
`))}}function cF(i,e){const t=mh(e,"class","language"),n=e[0].language;return(s,o,a)=>{const c=o.viewItem,u=c.parent;if(!u||!u.is("element","pre")||o.modelCursor.findAncestor("codeBlock"))return;const{consumable:h,writer:m}=a;if(!h.test(c,{name:!0}))return;const g=m.createElement("codeBlock"),w=[...c.getClassNames()];w.length||w.push("");for(const _ of w){const v=t[_];if(v){h.consume(c,{classes:[_]}),m.setAttribute("language",v,g);break}}g.hasAttribute("language")||m.setAttribute("language",n,g),a.convertChildren(c,g),a.safeInsert(g,o.modelCursor)&&(h.consume(c,{name:!0}),a.updateConversionResult(g,o))}}function uF(){return(i,e,{consumable:t,writer:n})=>{let s=e.modelCursor;if(!t.test(e.viewItem)||!s.findAncestor("codeBlock"))return;t.consume(e.viewItem);const a=e.viewItem.data.split(`
`).map(u=>n.createText(u)),c=a[a.length-1];for(const u of a)if(n.insert(u,s),s=s.getShiftedBy(u.offsetSize),u!==c){const h=n.createElement("softBreak");n.insert(h,s),s=n.createPositionAfter(h)}e.modelRange=n.createRange(e.modelCursor,s),e.modelCursor=s}}function dF(){return(i,e,{consumable:t})=>{const n=e.viewItem;if(n.findAncestor("pre"))return;const s=Array.from(n.getChildren()),o=s.find(a=>a.is("element","code"));if(o)for(const a of s)a===o||!a.is("$text")||t.consume(a,{name:!0})}}const c2="paragraph";class hF extends N{static get pluginName(){return"CodeBlockEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[QA]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"go",label:"Go"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"	"})}init(){const e=this.editor,t=e.model.schema,n=e.model,s=e.editing.view,o=fh(e);e.commands.add("codeBlock",new sF(e)),e.commands.add("indentCodeBlock",new rF(e)),e.commands.add("outdentCodeBlock",new aF(e)),this.listenTo(s.document,"tab",(a,c)=>{const u=c.shiftKey?"outdentCodeBlock":"indentCodeBlock";e.commands.get(u).isEnabled&&(e.execute(u),c.stopPropagation(),c.preventDefault(),a.stop())},{context:"pre"}),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",disallowChildren:"$inlineObject",allowAttributes:["language"],allowAttributesOf:"$listItem",isBlock:!0}),t.addAttributeCheck((a,c)=>{const u=a.getItem(a.length-2);if(t.getAttributeProperties(c).isFormatting&&u&&u.name=="codeBlock")return!1}),e.editing.downcastDispatcher.on("insert:codeBlock",Ok(n,o,!0)),e.data.downcastDispatcher.on("insert:codeBlock",Ok(n,o)),e.data.downcastDispatcher.on("insert:softBreak",lF(n),{priority:"high"}),e.data.upcastDispatcher.on("element:code",cF(s,o)),e.data.upcastDispatcher.on("text",uF()),e.data.upcastDispatcher.on("element:pre",dF(),{priority:"high"}),this.listenTo(e.editing.view.document,"clipboardInput",(a,c)=>{let u=n.createRange(n.document.selection.anchor);if(c.targetRanges&&(u=e.editing.mapper.toModelRange(c.targetRanges[0])),!u.start.parent.is("element","codeBlock"))return;const h=c.dataTransfer.getData("text/plain"),m=new Hh(e.editing.view.document);c.content=iF(m,h)}),e.plugins.has("ClipboardPipeline")&&e.plugins.get(zn).on("contentInsertion",(a,c)=>{const u=e.model,h=u.document.selection;h.anchor.parent.is("element","codeBlock")&&u.change(m=>{const g=m.createRangeIn(c.content);for(const w of[...g.getItems()])w.is("node")&&!t.checkChild(h.anchor,w)&&m.remove(w)})}),this.listenTo(n,"getSelectedContent",(a,[c])=>{const u=c.anchor;c.isCollapsed||!u.parent.is("element","codeBlock")||!u.hasSameParentAs(c.focus)||n.change(h=>{const m=a.return;if(u.parent.is("element")&&(m.childCount>1||c.containsEntireContent(u.parent))){const w=h.createElement("codeBlock",u.parent.getAttributes());h.append(m,w);const _=h.createDocumentFragment();h.append(w,_),a.return=_;return}const g=m.getChild(0);t.checkAttribute(g,"code")&&h.setAttribute("code",!0,g)})})}afterInit(){const e=this.editor,t=e.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentCodeBlock"),{priority:"highest"}),s&&s.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",(o,a)=>{e.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(!mF(e,a.isSoft)&&!gF(e,a.isSoft)&&fF(e),a.preventDefault(),o.stop())},{context:"pre"}),this._initAriaAnnouncements()}_initAriaAnnouncements(){const{model:e,ui:t,t:n}=this.editor,s=fh(this.editor);let o=null;e.document.selection.on("change:range",()=>{const a=e.document.selection.focus.parent;!t||o===a||!a.is("element")||(o&&o.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(Pk(n,s,o,"leave")),a.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(Pk(n,s,a,"enter")),o=a)})}}function fF(i){const e=i.model,t=e.document,n=t.selection.getLastPosition();let s;const o=l2(n,e);o&&o.is("$text")&&(s=Tw(o)),i.model.change(a=>{i.execute("shiftEnter"),s&&a.insertText(s,t.selection.anchor)})}function mF(i,e){const n=i.model.document,s=i.editing.view,o=n.selection.getLastPosition(),a=o.nodeAfter;return e||!n.selection.isCollapsed||!o.isAtStart||!Fo(a)?!1:(i.model.change(c=>{i.execute("enter");const u=n.selection.anchor.parent.previousSibling;c.rename(u,c2),c.setSelection(u,"in"),i.model.schema.removeDisallowedAttributes([u],c),c.remove(a)}),s.scrollToTheSelection(),!0)}function gF(i,e){const t=i.model,n=t.document,s=i.editing.view,o=n.selection.getLastPosition(),a=o.nodeBefore;let c;if(e||!n.selection.isCollapsed||!o.isAtEnd||!a||!a.previousSibling)return!1;if(Fo(a)&&Fo(a.previousSibling))c=t.createRange(t.createPositionBefore(a.previousSibling),t.createPositionAfter(a));else if(bp(a)&&Fo(a.previousSibling)&&Fo(a.previousSibling.previousSibling))c=t.createRange(t.createPositionBefore(a.previousSibling.previousSibling),t.createPositionAfter(a));else if(bp(a)&&Fo(a.previousSibling)&&bp(a.previousSibling.previousSibling)&&a.previousSibling.previousSibling&&Fo(a.previousSibling.previousSibling.previousSibling))c=t.createRange(t.createPositionBefore(a.previousSibling.previousSibling.previousSibling),t.createPositionAfter(a));else return!1;return i.model.change(u=>{u.remove(c),i.execute("enter");const h=n.selection.anchor.parent;u.rename(h,c2),i.model.schema.removeDisallowedAttributes([h],u)}),s.scrollToTheSelection(),!0}function bp(i){return i&&i.is("$text")&&!i.data.match(/\S/)}function Fo(i){return i&&i.is("element","softBreak")}class pF extends N{static get pluginName(){return"CodeBlockUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,n=e.ui.componentFactory,s=fh(e),o=this._getLanguageListItemDefinitions(s),a=e.commands.get("codeBlock");n.add("codeBlock",c=>{const u=$t(c,Aa),h=u.buttonView,m=t("Insert code block");return h.set({label:m,tooltip:!0,icon:vC,isToggleable:!0}),h.bind("isOn").to(a,"value",g=>!!g),h.on("execute",()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()}),u.on("execute",g=>{e.execute("codeBlock",{language:g.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()}),u.class="ck-code-block-dropdown",u.bind("isEnabled").to(a),mo(u,o,{role:"menu",ariaLabel:m}),u}),n.add("menuBar:codeBlock",c=>{const u=new vn(c);u.buttonView.set({role:"menuitem",label:t("Code block"),icon:vC}),u.bind("isEnabled").to(a);const h=new xs(c);h.set({ariaLabel:t("Insert code block")});for(const m of o){const g=new Li(c,u),w=new tt(c);w.bind(...Object.keys(m.model)).to(m.model),w.set({isToggleable:!0,role:"menuitemcheckbox"}),w.delegate("execute").to(u),w.on("execute",()=>{e.execute("codeBlock",{language:m.model._codeBlockLanguage,forceValue:a.value!=m.model._codeBlockLanguage}),e.editing.view.focus()}),g.children.add(w),h.items.add(g)}return u.panelView.children.add(h),u})}_getLanguageListItemDefinitions(e){const n=this.editor.commands.get("codeBlock"),s=new Dt;for(const o of e){const a={type:"button",model:new co({_codeBlockLanguage:o.language,label:o.label,role:"menuitemradio",withText:!0})};a.model.bind("isOn").to(n,"value",c=>c===a.model._codeBlockLanguage),s.add(a)}return s}}class bF extends N{static get requires(){return[hF,pF]}static get pluginName(){return"CodeBlock"}static get isOfficialPlugin(){return!0}}class wF extends GL{view;_toolbarConfig;_elementReplacer;constructor(e,t){super(e),this.view=t,this._toolbarConfig=RA(e.config.get("toolbar")),this._elementReplacer=new NO,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,n=this.view,s=t.editing.view,o=n.editable,a=s.document.getRoot();o.name=a.rootName,n.render();const c=o.element;this.setEditableElement(o.name,c),n.editable.bind("isFocused").to(this.focusTracker),s.attachDomRoot(c),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),n.menuBarView&&this.initMenuBar(n.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({visualTop:t})=>t||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,n=t.document.getRoot(),s=e.sourceElement;let o;const a=e.config.get("placeholder");a&&(o=typeof a=="string"?a:a[this.view.editable.name]),!o&&s&&s.tagName.toLowerCase()==="textarea"&&(o=s.getAttribute("placeholder")),o&&(n.placeholder=o),tS({view:t,element:n,isDirectHost:!1,keepOnFocus:!0})}_initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;const{stickyPanel:e}=this.view,t=this.editor.plugins.get("ContextualBalloon");t.on("getPositionOptions",s=>{const o=s.return;if(!o||!e.isSticky||!e.element)return;const a=new pe(e.element).height,c=typeof o.target=="function"?o.target():o.target,u=typeof o.limiter=="function"?o.limiter():o.limiter;if(c&&u&&new pe(c).height>=new pe(u).height-a)return;const h={...o.viewportOffsetConfig},m=(h.top||0)+a;s.return={...o,viewportOffsetConfig:{...h,top:m}}},{priority:"low"});const n=()=>{t.visibleView&&t.updatePosition()};this.listenTo(e,"change:isSticky",n),this.listenTo(this.editor.ui,"change:viewportOffset",n)}_handleScrollToTheSelectionWithStickyPanel(e,t,n){const s=this.view.stickyPanel;if(s.isSticky){const o=new pe(s.element).height;t.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(n)};this.listenTo(s,"change:isSticky",o),setTimeout(()=>{this.stopListening(s,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",()=>{const n=t.view;n.on("moveTo",(s,o)=>{if(!e.isSticky||n.wasMoved||n.isModal)return;const a=new pe(e.contentPanelElement);o[1]<a.bottom+yc.defaultOffset&&(o[1]=a.bottom+yc.defaultOffset)},{priority:"high"})},{priority:"low"})}}class _F extends YL{stickyPanel;toolbar;editable;constructor(e,t,n={}){super(e),this.stickyPanel=new eD(e),this.toolbar=new Qo(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),n.useMenuBar&&(this.menuBarView=new sD(e)),this.editable=new QL(e,t,void 0,{label:n.label})}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class yF extends J7($7){static get editorName(){return"ClassicEditor"}ui;constructor(e,t={}){if(!Hd(e)&&t.initialData!==void 0)throw new E("editor-create-initial-data",null);super(t),this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",vF(e)),Hd(e)&&(this.sourceElement=e),this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),s=this.config.get("menuBar"),o=new _F(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n,useMenuBar:s.isVisible,label:this.config.get("label")});this.ui=new wF(this,o),K7(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(n=>{const s=new this(e,t);n(s.initPlugins().then(()=>s.ui.init(Hd(e)?e:null)).then(()=>s.data.init(s.config.get("initialData"))).then(()=>s.fire("ready")).then(()=>s))})}}function vF(i){return Hd(i)?HO(i):i}function Hd(i){return ao(i)}class CF extends me{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let n=e.schema.getLimitElement(t);if(t.containsEntireContent(n)||!Vk(e.schema,n))do if(n=n.parent,!n)return;while(!Vk(e.schema,n));e.change(s=>{s.setSelection(n,"in")})}}function Vk(i,e){return i.isLimit(e)&&(i.checkChild(e,"$text")||i.checkChild(e,"paragraph"))}const kF=Dh("Ctrl+A");class TF extends N{static get pluginName(){return"SelectAllEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,s=e.editing.view.document;e.commands.add("selectAll",new CF(e)),this.listenTo(s,"keydown",(o,a)=>{Go(a)===kF&&(e.execute("selectAll"),a.preventDefault())}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Select all"),keystroke:"CTRL+A"}]})}}class EF extends N{static get pluginName(){return"SelectAllUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",()=>{const t=this._createButton(ue);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(tt))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("selectAll"),o=new e(t.locale),a=n.t;return o.set({label:a("Select all"),icon:MN,keystroke:"Ctrl+A"}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),o}}class SF extends N{static get requires(){return[TF,EF]}static get pluginName(){return"SelectAll"}static get isOfficialPlugin(){return!0}}class u2 extends me{_stack=[];_createdBatches=new WeakSet;constructor(e){super(e),this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(t,n)=>{n[1]={...n[1]};const s=n[1];s.batchType||(s.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(t,n)=>{n[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const t=this.editor.model.document.selection,n={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,n){const s=this.editor.model,o=s.document,a=[],c=e.map(h=>h.getTransformedByOperations(n)),u=c.flat();for(const h of c){const m=h.filter(g=>g.root!=o.graveyard).filter(g=>!xF(g,u));m.length&&(AF(m),a.push(m[0]))}a.length&&s.change(h=>{h.setSelection(a,{backward:t})})}_undo(e,t){const n=this.editor.model,s=n.document;this._createdBatches.add(t);const o=e.operations.slice().filter(a=>a.isDocumentOperation);o.reverse();for(const a of o){const c=a.baseVersion+1,u=Array.from(s.history.getOperations(c)),m=hM([a.getReversed()],u,{useRelations:!0,document:this.editor.model.document,forceWeakRemove:!0}).operationsA;for(let g of m){const w=g.affectedSelectable;w&&!n.canEditAt(w)&&(g=new Vt(g.baseVersion)),t.addOperation(g),n.applyOperation(g),s.history.setOperationAsUndone(a,g)}}}}function AF(i){i.sort((e,t)=>e.start.isBefore(t.start)?-1:1);for(let e=1;e<i.length;e++){const n=i[e-1].getJoined(i[e],!0);n&&(e--,i.splice(e,2,n))}}function xF(i,e){return e.some(t=>t!==i&&t.containsRange(i,!0))}class IF extends u2{execute(e=null){const t=e?this._stack.findIndex(o=>o.batch==e):this._stack.length-1,n=this._stack.splice(t,1)[0],s=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(s,()=>{this._undo(n.batch,s);const o=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,o)}),this.fire("revert",n.batch,s),this.refresh()}}class PF extends u2{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,()=>{const s=e.batch.operations[e.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(s);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)}),this.fire("revert",e.batch,t),this.refresh()}}class RF extends N{_undoCommand;_redoCommand;_batchRegistry=new WeakSet;static get pluginName(){return"UndoEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t;this._undoCommand=new IF(e),this._redoCommand=new PF(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(n,s)=>{const o=s[0];if(!o.isDocumentOperation)return;const a=o.batch,c=this._redoCommand.createdBatches.has(a),u=this._undoCommand.createdBatches.has(a);this._batchRegistry.has(a)||(this._batchRegistry.add(a),a.isUndoable&&(c?this._undoCommand.addBatch(a):u||(this._undoCommand.addBatch(a),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(n,s,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Undo"),keystroke:"CTRL+Z"},{label:t("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}}class OF extends N{static get pluginName(){return"UndoUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?xC:SC,o=t.uiLanguageDirection=="ltr"?SC:xC;this._addButtonsToFactory("undo",n("Undo"),"CTRL+Z",s),this._addButtonsToFactory("redo",n("Redo"),"CTRL+Y",o)}_addButtonsToFactory(e,t,n,s){const o=this.editor;o.ui.componentFactory.add(e,()=>{const a=this._createButton(ue,e,t,n,s);return a.set({tooltip:!0}),a}),o.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(tt,e,t,n,s))}_createButton(e,t,n,s,o){const a=this.editor,c=a.locale,u=a.commands.get(t),h=new e(c);return h.set({label:n,icon:o,keystroke:s}),h.bind("isEnabled").to(u,"isEnabled"),this.listenTo(h,"execute",()=>{a.execute(t),a.editing.view.focus()}),h}}class d2 extends N{static get requires(){return[RF,OF]}static get pluginName(){return"Undo"}static get isOfficialPlugin(){return!0}}class VF extends N{static get requires(){return[q6,r2,Jh,SF,QA,SD,d2]}static get pluginName(){return"Essentials"}static get isOfficialPlugin(){return!0}}class Xh extends me{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.value,a=e.batch,c=u=>{if(s.isCollapsed)o?u.setSelectionAttribute(this.attributeKey,o):u.removeSelectionAttribute(this.attributeKey);else{const h=t.schema.getValidRanges(s.getRanges(),this.attributeKey,{includeEmptyRanges:!0});for(const m of h){let g=m,w=this.attributeKey;m.isCollapsed&&(g=m.start.parent,w=kn._getStoreAttributeKey(this.attributeKey)),o?u.setAttribute(w,o,g):u.removeAttribute(w,g)}}};a?t.enqueueChange(a,u=>{c(u)}):t.change(u=>{c(u)})}}const gn="fontSize",pn="fontFamily",Oi="fontColor",ms="fontBackgroundColor";function h2(i,e){const t={model:{key:i,values:[]},view:{},upcastAlso:{}};for(const n of e)t.model.values.push(n.model),t.view[n.model]=n.view,n.upcastAlso&&(t.upcastAlso[n.model]=n.upcastAlso);return t}function f2(i){return e=>MF(e.getStyle(i))}function m2(i){return(e,{writer:t})=>t.createAttributeElement("span",{style:`${i}:${e}`},{priority:7})}function BF({dropdownView:i,colors:e,columns:t,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:o,documentColorsCount:a,colorPickerViewConfig:c}){const u=i.locale,h=new _w(u,{colors:e,columns:t,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:o,documentColorsCount:a,colorPickerViewConfig:c});return i.colorSelectorView=h,i.panelView.children.add(h),h}function MF(i){return i.replace(/\s/g,"")}class NF extends Xh{constructor(e){super(e,pn)}}function g2(i){return i.map(LF).filter(e=>e!==void 0)}function ob(i){return i.replace(/["']/g,"").split(",").map(e=>e.trim())}function LF(i){if(typeof i=="object")return i;if(i==="default")return{title:"Default",model:void 0};if(typeof i=="string")return DF(i)}function DF(i){const e=ob(i),t=e[0],n=e.map(FF).join(", ");return{title:t,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}function FF(i){return i=i.trim(),i.indexOf(" ")>0&&(i=`'${i}'`),i}class zF extends N{static get pluginName(){return"FontFamilyEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(pn,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:pn}),e.model.schema.setAttributeProperties(pn,{isFormatting:!0,copyOnEnter:!0});const t=g2(e.config.get("fontFamily.options")).filter(s=>s.model),n=h2(pn,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(n),e.commands.add(pn,new NF(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:pn,view:(t,{writer:n})=>n.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:pn,value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:pn,value:t=>t.getAttribute("face")}})}}class UF extends N{static get pluginName(){return"FontFamilyUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,n=this._getLocalizedOptions(),s=e.commands.get(pn),o=t("Font Family"),a=HF(n,s);e.ui.componentFactory.add(pn,c=>{const u=$t(c);return mo(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:CC,tooltip:!0}),u.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),u.bind("isEnabled").to(s),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${pn}`,c=>{const u=new vn(c);u.buttonView.set({label:o,icon:CC}),u.bind("isEnabled").to(s);const h=new xs(c);for(const m of a){const g=new Li(c,u),w=new tt(c);w.set({role:"menuitemradio",isToggleable:!0}),w.bind(...Object.keys(m.model)).to(m.model),w.delegate("execute").to(u),w.on("execute",()=>{e.execute(m.model.commandName,{value:m.model.commandParam}),e.editing.view.focus()}),g.children.add(w),h.items.add(g)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t;return g2(e.config.get(pn).options).map(s=>(s.title==="Default"&&(s.title=t("Default")),s))}}function HF(i,e){const t=new Dt;for(const n of i){const s={type:"button",model:new co({commandName:pn,commandParam:n.model,label:n.title,role:"menuitemradio",withText:!0})};s.model.bind("isOn").to(e,"value",o=>{if(o===n.model)return!0;if(!o||!n.model)return!1;const a=ob(o)[0].toLowerCase(),c=ob(n.model)[0].toLowerCase();return a===c}),n.view&&typeof n.view!="string"&&n.view.styles&&s.model.set("labelStyle",`font-family: ${n.view.styles["font-family"]}`),t.add(s)}return t}class jF extends N{static get requires(){return[zF,UF]}static get pluginName(){return"FontFamily"}static get isOfficialPlugin(){return!0}}class qF extends Xh{constructor(e){super(e,gn)}}function Tc(i){return i.map(e=>WF(e)).filter(e=>e!==void 0)}const Bk={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function WF(i){if(typeof i=="number"&&(i=String(i)),typeof i=="object"&&KF(i))return rb(i);const e=GF(i);if(e)return rb(e);if(i==="default")return{model:void 0,title:"Default"};if(!YF(i))return $F(i)}function $F(i){return typeof i=="string"&&(i={title:i,model:`${parseFloat(i)}px`}),i.view={name:"span",styles:{"font-size":i.model}},rb(i)}function rb(i){return i.view&&typeof i.view!="string"&&!i.view.priority&&(i.view.priority=7),i}function GF(i){return typeof i=="string"?Bk[i]:Bk[i.model]}function KF(i){return i.title&&i.model&&i.view}function YF(i){let e;if(typeof i=="object")if(i.model)e=parseFloat(i.model);else throw new E("font-size-invalid-definition",null,i);else e=parseFloat(i);return isNaN(e)}const Mk=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class JF extends N{static get pluginName(){return"FontSizeEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(gn,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:gn}),e.model.schema.setAttributeProperties(gn,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),n=Tc(this.editor.config.get("fontSize.options")).filter(o=>o.model),s=h2(gn,n);t?(this._prepareAnyValueConverters(s),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(s),e.commands.add(gn,new qF(e))}_prepareAnyValueConverters(e){const t=this.editor,n=e.model.values.filter(s=>!jh(String(s))&&!GS(String(s)));if(n.length)throw new E("font-size-invalid-use-of-named-presets",null,{presets:n});t.conversion.for("downcast").attributeToElement({model:gn,view:(s,{writer:o})=>{if(s)return o.createAttributeElement("span",{style:"font-size:"+s},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:gn,value:s=>s.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:gn,value:t=>{const n=t.getAttribute("size"),s=n[0]==="-"||n[0]==="+";let o=parseInt(n,10);s&&(o=3+o);const a=Mk.length-1,c=Math.min(Math.max(o,0),a);return Mk[c]}}})}}class QF extends N{static get pluginName(){return"FontSizeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,n=this._getLocalizedOptions(),s=e.commands.get(gn),o=t("Font Size"),a=XF(n,s);e.ui.componentFactory.add(gn,c=>{const u=$t(c);return mo(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:kC,tooltip:!0}),u.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),u.bind("isEnabled").to(s),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${gn}`,c=>{const u=new vn(c);u.buttonView.set({label:o,icon:kC}),u.bind("isEnabled").to(s);const h=new xs(c);for(const m of a){const g=new Li(c,u),w=new tt(c);w.set({role:"menuitemradio",isToggleable:!0}),w.bind(...Object.keys(m.model)).to(m.model),w.delegate("execute").to(u),w.on("execute",()=>{e.execute(m.model.commandName,{value:m.model.commandParam}),e.editing.view.focus()}),g.children.add(w),h.items.add(g)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t,n={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return Tc(e.config.get(gn).options).map(o=>{const a=n[o.title];return a&&a!=o.title&&(o=Object.assign({},o,{title:a})),o})}}function XF(i,e){const t=new Dt;for(const n of i){const s={type:"button",model:new co({commandName:gn,commandParam:n.model,label:n.title,class:"ck-fontsize-option",role:"menuitemradio",withText:!0})};n.view&&typeof n.view!="string"&&(n.view.styles&&s.model.set("labelStyle",`font-size:${n.view.styles["font-size"]}`),n.view.classes&&s.model.set("class",`${s.model.class} ${n.view.classes}`)),s.model.bind("isOn").to(e,"value",o=>o===n.model),t.add(s)}return t}class ZF extends N{static get requires(){return[JF,QF]}static get pluginName(){return"FontSize"}static get isOfficialPlugin(){return!0}normalizeSizeOptions(e){return Tc(e)}}class e9 extends Xh{constructor(e){super(e,Oi)}}class t9 extends N{static get pluginName(){return"FontColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(Oi,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:Oi,value:f2("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:Oi,value:t=>t.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:Oi,view:m2("color")}),e.commands.add(Oi,new e9(e)),e.model.schema.extend("$text",{allowAttributes:Oi}),e.model.schema.setAttributeProperties(Oi,{isFormatting:!0,copyOnEnter:!0})}}class p2 extends N{commandName;componentName;icon;dropdownLabel;columns;constructor(e,{commandName:t,componentName:n,icon:s,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=n,this.icon=s,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`)}init(){const e=this.editor,t=e.locale,n=t.t,s=e.commands.get(this.commandName),o=e.config.get(this.componentName),a=Cc(o.colors),c=vc(t,a),u=o.documentColors,h=o.colorPicker!==!1;e.ui.componentFactory.add(this.componentName,m=>{const g=$t(m);let w=!1;const _=BF({dropdownView:g,colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:n("Remove color"),colorPickerLabel:n("Color picker"),documentColorsLabel:u!==0?n("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:h?o.colorPicker||{}:!1});return _.bind("selectedColor").to(s,"value"),g.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),g.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),g.bind("isEnabled").to(s),_.on("execute",(v,C)=>{g.isOpen&&e.execute(this.commandName,{value:C.value,batch:this._undoStepBatch}),C.source!=="colorPicker"&&e.editing.view.focus(),C.source==="colorPickerSaveButton"&&(g.isOpen=!1)}),_.on("colorPicker:show",()=>{this._undoStepBatch=e.model.createBatch()}),_.on("colorPicker:cancel",()=>{this._undoStepBatch.operations.length&&(g.isOpen=!1,e.execute("undo",this._undoStepBatch)),e.editing.view.focus()}),g.on("change:isOpen",(v,C,T)=>{w||(w=!0,g.colorSelectorView.appendUI()),T&&(u!==0&&_.updateDocumentColors(e.model,this.componentName),_.updateSelectedColors(),_.showColorGridsFragment())}),ww(g,()=>g.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(v=>v.isOn)),g}),e.ui.componentFactory.add(`menuBar:${this.componentName}`,m=>{const g=new vn(m);g.buttonView.set({label:this.dropdownLabel,icon:this.icon}),g.bind("isEnabled").to(s);let w=!1;const _=new _w(m,{colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:n("Remove color"),colorPickerLabel:n("Color picker"),documentColorsLabel:u!==0?n("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:!1});return _.bind("selectedColor").to(s,"value"),_.delegate("execute").to(g),_.on("execute",(v,C)=>{e.execute(this.commandName,{value:C.value,batch:this._undoStepBatch}),e.editing.view.focus()}),g.on("change:isOpen",(v,C,T)=>{w||(w=!0,_.appendUI()),T&&(u!==0&&_.updateDocumentColors(e.model,this.componentName),_.updateSelectedColors(),_.showColorGridsFragment())}),g.panelView.children.add(_),g})}}class n9 extends p2{constructor(e){const t=e.locale.t;super(e,{commandName:Oi,componentName:Oi,icon:cN,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}class i9 extends N{static get requires(){return[t9,n9]}static get pluginName(){return"FontColor"}static get isOfficialPlugin(){return!0}}class s9 extends Xh{constructor(e){super(e,ms)}}class o9 extends N{static get pluginName(){return"FontBackgroundColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(ms,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(uw),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:ms,value:f2("background-color")}}),e.conversion.for("downcast").attributeToElement({model:ms,view:m2("background-color")}),e.commands.add(ms,new s9(e)),e.model.schema.extend("$text",{allowAttributes:ms}),e.model.schema.setAttributeProperties(ms,{isFormatting:!0,copyOnEnter:!0})}}class r9 extends p2{constructor(e){const t=e.locale.t;super(e,{commandName:ms,componentName:ms,icon:lN,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}class a9 extends N{static get requires(){return[o9,r9]}static get pluginName(){return"FontBackgroundColor"}static get isOfficialPlugin(){return!0}}class l9 extends N{static get requires(){return[jF,ZF,i9,a9]}static get pluginName(){return"Font"}static get isOfficialPlugin(){return!0}}class c9 extends me{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document,n=Ze(t.selection.getSelectedBlocks());this.value=!!n&&n.is("element","paragraph"),this.isEnabled=!!n&&Nk(n,e.schema)}execute(e={}){const t=this.editor.model,n=t.document,s=e.selection||n.selection;t.canEditAt(s)&&t.change(o=>{const a=s.getSelectedBlocks();for(const c of a)!c.is("element","paragraph")&&Nk(c,t.schema)&&o.rename(c,"paragraph")})}}function Nk(i,e){return e.checkChild(i.parent,"paragraph")&&!e.isObject(i)}class u9 extends me{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}execute(e){const t=this.editor.model,n=e.attributes;let s=e.position;return t.canEditAt(s)?t.change(o=>{if(s=this._findPositionToInsertParagraph(s,o),!s)return null;const a=o.createElement("paragraph");return n&&t.schema.setAllowedAttributes(a,n,o),t.insertContent(a,s),o.setSelection(a,"in"),o.createPositionAt(a,0)}):null}_findPositionToInsertParagraph(e,t){const n=this.editor.model;if(n.schema.checkChild(e,"paragraph"))return e;const s=n.schema.findAllowedParent(e,"paragraph");if(!s)return null;const o=e.parent,a=n.schema.checkChild(o,"$text");return o.isEmpty||a&&e.isAtEnd?n.createPositionAfter(o):!o.isEmpty&&a&&e.isAtStart?n.createPositionBefore(o):t.split(e,s).position}}class Zh extends N{static get pluginName(){return"Paragraph"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model;e.commands.add("paragraph",new c9(e)),e.commands.add("insertParagraph",new u9(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(n,{writer:s})=>!Zh.paragraphLikeElements.has(n.name)||n.isEmpty?null:s.createElement("paragraph"),view:/.+/,converterPriority:"low"})}static paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"])}class d9 extends me{modelElements;constructor(e,t){super(e),this.modelElements=t}refresh(){const e=Ze(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(t=>Lk(e,t,this.editor.model.schema))}execute(e){const t=this.editor.model,n=t.document,s=e.value;t.change(o=>{const a=Array.from(n.selection.getSelectedBlocks()).filter(c=>Lk(c,s,t.schema));for(const c of a)c.is("element",s)||o.rename(c,s)})}}function Lk(i,e,t){return t.checkChild(i.parent,e)&&!t.isObject(i)}const Dk="paragraph";class h9 extends N{static get pluginName(){return"HeadingEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Zh]}init(){const e=this.editor,t=e.config.get("heading.options"),n=[];for(const s of t)s.model!=="paragraph"&&(e.model.schema.register(s.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(s),n.push(s.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new d9(e,n))}afterInit(){const e=this.editor,t=e.commands.get("enter"),n=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",(s,o)=>{const a=e.model.document.selection.getFirstPosition().parent;n.some(u=>a.is("element",u.model))&&!a.is("element",Dk)&&a.childCount===0&&o.writer.rename(a,Dk)})}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:_s.low+1})}}function f9(i){const e=i.t,t={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3"),"Heading 4":e("Heading 4"),"Heading 5":e("Heading 5"),"Heading 6":e("Heading 6")};return i.config.get("heading.options").map(n=>{const s=t[n.title];return s&&s!=n.title&&(n.title=s),n})}class m9 extends N{static get pluginName(){return"HeadingUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,n=f9(e),s=t("Choose heading"),o=t("Heading");e.ui.componentFactory.add("heading",a=>{const c={},u=new Dt,h=e.commands.get("heading"),m=e.commands.get("paragraph"),g=[h];for(const _ of n){const v={type:"button",model:new co({label:_.title,class:_.class,role:"menuitemradio",withText:!0})};_.model==="paragraph"?(v.model.bind("isOn").to(m,"value"),v.model.set("commandName","paragraph"),g.push(m)):(v.model.bind("isOn").to(h,"value",C=>C===_.model),v.model.set({commandName:"heading",commandValue:_.model})),u.add(v),c[_.model]=_.title}const w=$t(a);return mo(w,u,{ariaLabel:o,role:"menu"}),w.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),w.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),w.bind("isEnabled").toMany(g,"isEnabled",(..._)=>_.some(v=>v)),w.buttonView.bind("label").to(h,"value",m,"value",(_,v)=>{const C=v?"paragraph":_;return typeof C=="boolean"||!c[C]?s:c[C]}),w.buttonView.bind("ariaLabel").to(h,"value",m,"value",(_,v)=>{const C=v?"paragraph":_;return typeof C=="boolean"||!c[C]?o:`${c[C]}, ${o}`}),this.listenTo(w,"execute",_=>{const{commandName:v,commandValue:C}=_.source;e.execute(v,C?{value:C}:void 0),e.editing.view.focus()}),w}),e.ui.componentFactory.add("menuBar:heading",a=>{const c=new vn(a),u=e.commands.get("heading"),h=e.commands.get("paragraph"),m=[u],g=new xs(a);c.set({class:"ck-heading-dropdown"}),g.set({ariaLabel:t("Heading"),role:"menu"}),c.buttonView.set({label:t("Heading")}),c.panelView.children.add(g);for(const w of n){const _=new Li(a,c),v=new tt(a);_.children.add(v),g.items.add(_),v.set({isToggleable:!0,label:w.title,role:"menuitemradio",class:w.class}),v.delegate("execute").to(c),v.on("execute",()=>{const C=w.model==="paragraph"?"paragraph":"heading";e.execute(C,{value:w.model}),e.editing.view.focus()}),w.model==="paragraph"?(v.bind("isOn").to(h,"value"),m.push(h)):v.bind("isOn").to(u,"value",C=>C===w.model)}return c.bind("isEnabled").toMany(m,"isEnabled",(...w)=>w.some(_=>_)),c})}}class g9 extends N{static get requires(){return[h9,m9]}static get pluginName(){return"Heading"}static get isOfficialPlugin(){return!0}}class p9 extends me{refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("highlight"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"highlight")}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.value;t.change(a=>{if(s.isCollapsed){const c=s.getFirstPosition();if(s.hasAttribute("highlight")){const u=w=>w.item.hasAttribute("highlight")&&w.item.getAttribute("highlight")===this.value,h=c.getLastMatchingPosition(u,{direction:"backward"}),m=c.getLastMatchingPosition(u),g=a.createRange(h,m);!o||this.value===o?(c.isEqual(m)||a.removeAttribute("highlight",g),a.removeSelectionAttribute("highlight")):(c.isEqual(m)||a.setAttribute("highlight",o,g),a.setSelectionAttribute("highlight",o))}else o&&a.setSelectionAttribute("highlight",o)}else{const c=t.schema.getValidRanges(s.getRanges(),"highlight",{includeEmptyRanges:!0});for(const u of c){let h=u,m="highlight";u.isCollapsed&&(h=u.start.parent,m=kn._getStoreAttributeKey("highlight")),o?a.setAttribute(m,o,h):a.removeAttribute(m,h)}}})}}class b9 extends N{static get pluginName(){return"HighlightEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-content-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-content-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-content-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-content-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-content-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-content-highlight-pen-green)",type:"pen"}]})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"highlight"});const t=e.config.get("highlight.options");e.conversion.attributeToElement(w9(t)),e.commands.add("highlight",new p9(e))}}function w9(i){const e={model:{key:"highlight",values:[]},view:{}};for(const t of i)e.model.values.push(t.model),e.view[t.model]={name:"mark",classes:t.class};return e}class _9 extends N{get localizedOptionTitles(){const e=this.editor.t;return{"Yellow marker":e("Yellow marker"),"Green marker":e("Green marker"),"Pink marker":e("Pink marker"),"Blue marker":e("Blue marker"),"Red pen":e("Red pen"),"Green pen":e("Green pen")}}static get pluginName(){return"HighlightUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.config.get("highlight.options");for(const t of e)this._addHighlighterButton(t);this._addRemoveHighlightButton(),this._addDropdown(e),this._addMenuBarButton(e)}_addRemoveHighlightButton(){const e=this.editor.t,t=this.editor.commands.get("highlight");this._addButton("removeHighlight",e("Remove highlight"),Qp,null,n=>{n.bind("isEnabled").to(t,"isEnabled")})}_addHighlighterButton(e){const t=this.editor.commands.get("highlight");this._addButton("highlight:"+e.model,e.title,Td(e.type),e.model,n);function n(s){s.bind("isEnabled").to(t,"isEnabled"),s.bind("isOn").to(t,"value",o=>o===e.model),s.iconView.fillColor=e.color,s.isToggleable=!0}}_addButton(e,t,n,s,o){const a=this.editor;a.ui.componentFactory.add(e,c=>{const u=new ue(c),h=this.localizedOptionTitles[t]?this.localizedOptionTitles[t]:t;return u.set({label:h,icon:n,tooltip:!0}),u.on("execute",()=>{a.execute("highlight",{value:s}),a.editing.view.focus()}),o(u),u})}_addDropdown(e){const t=this.editor,n=t.t,s=t.ui.componentFactory,o=e[0],a=e.reduce((c,u)=>(c[u.model]=u,c),{});s.add("highlight",c=>{const u=t.commands.get("highlight"),h=$t(c,Aa),m=h.buttonView;m.set({label:n("Highlight"),tooltip:!0,lastExecuted:o.model,commandValue:o.model,isToggleable:!0}),m.bind("icon").to(u,"value",_=>Td(w(_,"type"))),m.bind("color").to(u,"value",_=>w(_,"color")),m.bind("commandValue").to(u,"value",_=>w(_,"model")),m.bind("isOn").to(u,"value",_=>!!_),m.delegate("execute").to(h);const g=()=>{const _=e.map(v=>{const C=s.create("highlight:"+v.model);return this.listenTo(C,"execute",()=>{h.buttonView.set({lastExecuted:v.model})}),C});return _.push(new bw),_.push(s.create("removeHighlight")),_};h.bind("isEnabled").to(u,"isEnabled"),Dc(h,g,{enableActiveItemFocusOnDropdownOpen:!0,ariaLabel:n("Text highlight toolbar")}),y9(h),m.on("execute",()=>{t.execute("highlight",{value:m.commandValue})}),this.listenTo(h,"execute",()=>{t.editing.view.focus()});function w(_,v){const C=!_||_===m.lastExecuted?m.lastExecuted:_;return a[C][v]}return h})}_addMenuBarButton(e){const t=this.editor,n=t.t,s=t.commands.get("highlight");t.ui.componentFactory.add("menuBar:highlight",o=>{const a=new vn(o);a.buttonView.set({label:n("Highlight"),icon:Td("marker")}),a.bind("isEnabled").to(s),a.buttonView.iconView.fillColor="transparent";const c=new xs(o);for(const m of e){const g=new Li(o,a),w=new tt(o);w.set({label:m.title,icon:Td(m.type),role:"menuitemradio",isToggleable:!0}),w.iconView.fillColor=m.color,w.delegate("execute").to(a),w.bind("isOn").to(s,"value",_=>_===m.model),w.on("execute",()=>{t.execute("highlight",{value:m.model}),t.editing.view.focus()}),g.children.add(w),c.items.add(g)}c.items.add(new Kh(o));const u=new Li(o,a),h=new tt(o);return h.set({label:n("Remove highlight"),icon:Qp}),h.delegate("execute").to(a),h.on("execute",()=>{t.execute("highlight",{value:null}),t.editing.view.focus()}),u.children.add(h),c.items.add(u),a.panelView.children.add(c),a})}}function y9(i){i.buttonView.actionView.iconView.bind("fillColor").to(i.buttonView,"color")}function Td(i){return i==="marker"?pN:xN}class v9 extends N{static get requires(){return[b9,_9]}static get pluginName(){return"Highlight"}static get isOfficialPlugin(){return!0}}class C9 extends me{refresh(){const e=this.editor.model,t=e.schema,n=e.document.selection;this.isEnabled=k9(n,t,e)}execute(){const e=this.editor.model;e.change(t=>{const n=t.createElement("horizontalLine");e.insertObject(n,null,null,{setSelection:"after"})})}}function k9(i,e,t){const n=T9(i,t);return e.checkChild(n,"horizontalLine")}function T9(i,e){const n=Cw(i,e).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}class E9 extends N{static get pluginName(){return"HorizontalLineEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema,n=e.t,s=e.conversion;t.register("horizontalLine",{inheritAllFrom:"$blockObject"}),s.for("dataDowncast").elementToElement({model:"horizontalLine",view:(o,{writer:a})=>a.createEmptyElement("hr")}),s.for("editingDowncast").elementToStructure({model:"horizontalLine",view:(o,{writer:a})=>{const c=n("Horizontal line"),u=a.createContainerElement("div",null,a.createEmptyElement("hr"));return a.addClass("ck-horizontal-line",u),a.setCustomProperty("hr",!0,u),S9(u,a,c)}}),s.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new C9(e))}}function S9(i,e,t){return e.setCustomProperty("horizontalLine",!0,i),Qh(i,e,{label:t})}class A9 extends N{static get pluginName(){return"HorizontalLineUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("horizontalLine",()=>{const t=this._createButton(ue);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:horizontalLine",()=>this._createButton(tt))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("horizontalLine"),o=new e(t.locale),a=n.t;return o.set({label:a("Horizontal line"),icon:uN}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("horizontalLine"),t.editing.view.focus()}),o}}class x9 extends N{static get requires(){return[E9,A9,Ia]}static get pluginName(){return"HorizontalLine"}static get isOfficialPlugin(){return!0}}var wp={},_p={},yp={},Fk;function I9(){return Fk||(Fk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});function e(t){if(!t||typeof t!="object")return!1;const n=Object.getPrototypeOf(t);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(t)==="[object Object]":!1}i.isPlainObject=e})(yp)),yp}var vp={},zk;function P9(){return zk||(zk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});function e(t){return Object.getOwnPropertySymbols(t).filter(n=>Object.prototype.propertyIsEnumerable.call(t,n))}i.getSymbols=e})(vp)),vp}var Cp={},Uk;function R9(){return Uk||(Uk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});function e(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}i.getTag=e})(Cp)),Cp}var kp={},Hk;function O9(){return Hk||(Hk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",t="[object String]",n="[object Number]",s="[object Boolean]",o="[object Arguments]",a="[object Symbol]",c="[object Date]",u="[object Map]",h="[object Set]",m="[object Array]",g="[object Function]",w="[object ArrayBuffer]",_="[object Object]",v="[object Error]",C="[object DataView]",T="[object Uint8Array]",A="[object Uint8ClampedArray]",L="[object Uint16Array]",z="[object Uint32Array]",j="[object BigUint64Array]",Z="[object Int8Array]",ne="[object Int16Array]",M="[object Int32Array]",J="[object BigInt64Array]",Y="[object Float32Array]",ie="[object Float64Array]";i.argumentsTag=o,i.arrayBufferTag=w,i.arrayTag=m,i.bigInt64ArrayTag=J,i.bigUint64ArrayTag=j,i.booleanTag=s,i.dataViewTag=C,i.dateTag=c,i.errorTag=v,i.float32ArrayTag=Y,i.float64ArrayTag=ie,i.functionTag=g,i.int16ArrayTag=ne,i.int32ArrayTag=M,i.int8ArrayTag=Z,i.mapTag=u,i.numberTag=n,i.objectTag=_,i.regexpTag=e,i.setTag=h,i.stringTag=t,i.symbolTag=a,i.uint16ArrayTag=L,i.uint32ArrayTag=z,i.uint8ArrayTag=T,i.uint8ClampedArrayTag=A})(kp)),kp}var Tp={},jk;function V9(){return jk||(jk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});function e(t,n){return t===n||Number.isNaN(t)&&Number.isNaN(n)}i.eq=e})(Tp)),Tp}var qk;function B9(){return qk||(qk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e=I9(),t=P9(),n=R9(),s=O9(),o=V9();function a(h,m,g){return c(h,m,void 0,void 0,void 0,void 0,g)}function c(h,m,g,w,_,v,C){const T=C(h,m,g,w,_,v);if(T!==void 0)return T;if(typeof h==typeof m)switch(typeof h){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return h===m;case"number":return h===m||Object.is(h,m);case"function":return h===m;case"object":return u(h,m,v,C)}return u(h,m,v,C)}function u(h,m,g,w){if(Object.is(h,m))return!0;let _=n.getTag(h),v=n.getTag(m);if(_===s.argumentsTag&&(_=s.objectTag),v===s.argumentsTag&&(v=s.objectTag),_!==v)return!1;switch(_){case s.stringTag:return h.toString()===m.toString();case s.numberTag:{const A=h.valueOf(),L=m.valueOf();return o.eq(A,L)}case s.booleanTag:case s.dateTag:case s.symbolTag:return Object.is(h.valueOf(),m.valueOf());case s.regexpTag:return h.source===m.source&&h.flags===m.flags;case s.functionTag:return h===m}g=g??new Map;const C=g.get(h),T=g.get(m);if(C!=null&&T!=null)return C===m;g.set(h,m),g.set(m,h);try{switch(_){case s.mapTag:{if(h.size!==m.size)return!1;for(const[A,L]of h.entries())if(!m.has(A)||!c(L,m.get(A),A,h,m,g,w))return!1;return!0}case s.setTag:{if(h.size!==m.size)return!1;const A=Array.from(h.values()),L=Array.from(m.values());for(let z=0;z<A.length;z++){const j=A[z],Z=L.findIndex(ne=>c(j,ne,void 0,h,m,g,w));if(Z===-1)return!1;L.splice(Z,1)}return!0}case s.arrayTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:case s.bigUint64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.bigInt64ArrayTag:case s.float32ArrayTag:case s.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(h)!==Buffer.isBuffer(m)||h.length!==m.length)return!1;for(let A=0;A<h.length;A++)if(!c(h[A],m[A],A,h,m,g,w))return!1;return!0}case s.arrayBufferTag:return h.byteLength!==m.byteLength?!1:u(new Uint8Array(h),new Uint8Array(m),g,w);case s.dataViewTag:return h.byteLength!==m.byteLength||h.byteOffset!==m.byteOffset?!1:u(new Uint8Array(h),new Uint8Array(m),g,w);case s.errorTag:return h.name===m.name&&h.message===m.message;case s.objectTag:{if(!(u(h.constructor,m.constructor,g,w)||e.isPlainObject(h)&&e.isPlainObject(m)))return!1;const L=[...Object.keys(h),...t.getSymbols(h)],z=[...Object.keys(m),...t.getSymbols(m)];if(L.length!==z.length)return!1;for(let j=0;j<L.length;j++){const Z=L[j],ne=h[Z];if(!Object.hasOwn(m,Z))return!1;const M=m[Z];if(!c(ne,M,Z,h,m,g,w))return!1}return!0}default:return!1}}finally{g.delete(h),g.delete(m)}}i.isEqualWith=a})(_p)),_p}var Ep={},Wk;function M9(){return Wk||(Wk=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});function e(){}i.noop=e})(Ep)),Ep}var $k;function N9(){return $k||($k=1,(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e=B9(),t=M9();function n(s,o){return e.isEqualWith(s,o,t.noop)}i.isEqual=n})(wp)),wp}var Sp,Gk;function L9(){return Gk||(Gk=1,Sp=N9().isEqual),Sp}var D9=L9();const F9=qT(D9);function z9(i){return i.createContainerElement("span",{class:"image-inline"},i.createEmptyElement("img"))}function Kk(i){return i.createContainerElement("figure",{class:"image"},[i.createEmptyElement("img"),i.createSlot("children")])}function b2(i,e){const t=i.plugins.get("ImageUtils"),n=i.plugins.has("ImageInlineEditing")&&i.plugins.has("ImageBlockEditing");return o=>t.isInlineImageView(o)?n&&(o.getStyle("display")=="block"||o.findAncestor(t.isBlockImageView)?"imageBlock":"imageInline")!==e?null:s(o):null;function s(o){const a={name:!0};return o.hasAttribute("src")&&(a.attributes=["src"]),a}}function Ew(i,e){const t=Ze(e.getSelectedBlocks());return!t||i.isObject(t)||t.isEmpty&&t.name!="listItem"?"imageBlock":"imageInline"}function gh(i){return i&&i.endsWith("px")?parseInt(i):null}function ph(i){const e=gh(i.getStyle("width")),t=gh(i.getStyle("height"));return!!(e&&t)}const U9=/^(image|image-inline)$/;class Zt extends N{_domEmitter=new(Hn());static get pluginName(){return"ImageUtils"}static get isOfficialPlugin(){return!0}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,n=null,s={}){const o=this.editor,a=o.model,c=a.document.selection,u=w2(o,t||c,n);e={...Object.fromEntries(c.getAttributes()),...e};for(const h in e)a.schema.checkAttribute(u,h)||delete e[h];return a.change(h=>{const{setImageSizes:m=!0}=s,g=h.createElement(u,e);return a.insertObject(g,t,null,{setSelection:"on",findOptimalPosition:!t&&u!="imageInline"?"auto":void 0}),g.parent?(m&&this.setImageNaturalSizeAttributes(g),g):null})}setImageNaturalSizeAttributes(e){const t=e.getAttribute("src");t&&(e.getAttribute("width")||e.getAttribute("height")||this.editor.model.change(n=>{const s=new ee.window.Image;this._domEmitter.listenTo(s,"load",()=>{!e.getAttribute("width")&&!e.getAttribute("height")&&this.editor.model.enqueueChange(n.batch,o=>{o.setAttribute("width",s.naturalWidth,e),o.setAttribute("height",s.naturalHeight,e)}),this._domEmitter.stopListening(s,"load")}),s.src=t}))}getClosestSelectedImageWidget(e){const t=e.getFirstPosition();if(!t)return null;const n=e.getSelectedElement();if(n&&this.isImageWidget(n))return n;let s=t.parent;for(;s;){if(s.is("element")&&this.isImageWidget(s))return s;s=s.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}getImageWidgetFromImageView(e){return e.findAncestor({classes:U9})}isImageAllowed(){const t=this.editor.model.document.selection;return H9(this.editor,t)&&j9(t)}toImageWidget(e,t,n){return t.setCustomProperty("image",!0,e),Qh(e,t,{label:()=>{const a=this.findViewImgElement(e).getAttribute("alt");return a?`${a} ${n}`:n}})}isImageWidget(e){return!!e.getCustomProperty("image")&&ct(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:n}of t.createRangeIn(e))if(this.isInlineImageView(n))return n}destroy(){return this._domEmitter.stopListening(),super.destroy()}}function H9(i,e){if(w2(i,e,null)=="imageBlock"){const n=q9(e,i.model);if(i.model.schema.checkChild(n,"imageBlock"))return!0}else if(i.model.schema.checkChild(e.focus,"imageInline"))return!0;return!1}function j9(i){return[...i.focus.getAncestors()].every(e=>!e.is("element","imageBlock"))}function q9(i,e){const n=Cw(i,e).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}function w2(i,e,t){const n=i.model.schema,s=i.config.get("image.insert.type");return i.plugins.has("ImageBlockEditing")?i.plugins.has("ImageInlineEditing")?t||(s==="inline"?"imageInline":s!=="auto"?"imageBlock":e.is("selection")?Ew(n,e):n.checkChild(e,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}class W9 extends me{refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled&&n.hasAttribute("alt")?this.value=n.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor,n=t.plugins.get("ImageUtils"),s=t.model,o=n.getClosestSelectedImageElement(s.document.selection);s.change(a=>{a.setAttribute("alt",e.newValue,o)})}}class $9 extends N{static get requires(){return[Zt]}static get pluginName(){return"ImageTextAlternativeEditing"}static get isOfficialPlugin(){return!0}init(){this.editor.commands.add("imageTextAlternative",new W9(this.editor))}}class G9 extends oe{focusTracker;keystrokes;labeledInput;backButtonView;saveButtonView;children;_focusables;_focusCycler;constructor(e){super(e),this.focusTracker=new dt,this.keystrokes=new Ct,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.labeledInput=this._createLabeledInputView(),this.children=this.createCollection([this._createHeaderView()]),this.children.add(new qt(e,{children:[this.labeledInput,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding"]})),this._focusables=new Gt,this.keystrokes.set("Esc",(t,n)=>{this.fire("cancel"),n()}),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),or({view:this}),[this.backButtonView,this.labeledInput,this.saveButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createBackButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:Ta,tooltip:!0}),t.delegate("execute").to(this,"cancel"),t}_createSaveButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({label:e("Save"),withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),t}_createHeaderView(){const e=this.locale.t,t=new fo(this.locale,{label:e("Text Alternative")});return t.children.add(this.backButtonView,0),t}_createLabeledInputView(){const e=this.locale.t,t=new Rt(this.locale,si);return t.label=e("Text alternative"),t.class="ck-labeled-field-view_full-width",t}}function K9(i){const e=i.plugins.get("ContextualBalloon");if(i.plugins.get("ImageUtils").getClosestSelectedImageWidget(i.editing.view.document.selection)){const n=Sw(i);e.updatePosition(n)}}function Sw(i){const e=i.editing.view,t=xt.defaultPositions,n=i.plugins.get("ImageUtils");return{target:e.domConverter.mapViewToDom(n.getClosestSelectedImageWidget(e.document.selection)),positions:[t.northArrowSouth,t.northArrowSouthWest,t.northArrowSouthEast,t.southArrowNorth,t.southArrowNorthWest,t.southArrowNorthEast,t.viewportStickyNorth]}}class Y9 extends N{_balloon;_form;static get requires(){return[As]}static get pluginName(){return"ImageTextAlternativeUI"}static get isOfficialPlugin(){return!0}init(){this._createButton()}destroy(){super.destroy(),this._form&&this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",n=>{const s=e.commands.get("imageTextAlternative"),o=new ue(n);return o.set({label:t("Change image text alternative"),icon:WN,tooltip:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",a=>!!a),this.listenTo(o,"execute",()=>{this._showForm()}),o})}_createForm(){const e=this.editor,n=e.editing.view.document,s=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(_c(G9))(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this.listenTo(e.ui,"update",()=>{s.getClosestSelectedImageWidget(n.selection)?this._isVisible&&K9(e):this._hideForm(!0)}),sr({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;this._form||this._createForm();const e=this.editor,t=e.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Sw(e)}),n.fieldView.value=n.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}class _2 extends N{static get requires(){return[$9,Y9]}static get pluginName(){return"ImageTextAlternative"}static get isOfficialPlugin(){return!0}}function J9(i){const e=(t,n,s)=>{if(!s.consumable.test(n.viewItem,{name:!0,classes:"image"}))return;const o=i.findViewImgElement(n.viewItem);if(!o||!s.consumable.test(o,{name:!0}))return;s.consumable.consume(n.viewItem,{name:!0,classes:"image"});const a=s.convertItem(o,n.modelCursor),c=Ze(a.modelRange.getItems());if(!c){s.consumable.revert(n.viewItem,{name:!0,classes:"image"});return}s.convertChildren(n.viewItem,c),s.updateConversionResult(c,n)};return t=>{t.on("element:figure",e)}}function y2(i,e){const t=(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const a=o.writer,c=o.mapper.toViewElement(s.item),u=i.findViewImgElement(c);s.attributeNewValue===null?(a.removeAttribute("srcset",u),a.removeAttribute("sizes",u)):s.attributeNewValue&&(a.setAttribute("srcset",s.attributeNewValue,u),a.setAttribute("sizes","100vw",u))};return n=>{n.on(`attribute:srcset:${e}`,t)}}function bh(i,e,t){const n=(s,o,a)=>{if(!a.consumable.consume(o.item,s.name))return;const c=a.writer,u=a.mapper.toViewElement(o.item),h=i.findViewImgElement(u);c.setAttribute(o.attributeKey,o.attributeNewValue||"",h)};return s=>{s.on(`attribute:${t}:${e}`,n)}}class Aw extends Hi{observe(e){this.listenTo(e,"load",(t,n)=>{const s=n.target;this.checkShouldIgnoreEventFromTarget(s)||s.tagName=="IMG"&&this._fireEvents(n)},{useCapture:!0})}stopObserving(e){this.stopListening(e)}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}class Q9 extends me{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||t==="block"&&Be("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||t==="inline"&&Be("image-inline-plugin-required")}refresh(){const e=this.editor.plugins.get("ImageUtils");this.isEnabled=e.isImageAllowed()}execute(e){const t=st(e.source),n=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(n.getAttributes());t.forEach((a,c)=>{const u=n.getSelectedElement();if(typeof a=="string"&&(a={src:a}),c&&u&&s.isImage(u)){const h=this.editor.model.createPositionAfter(u);s.insertImage({...a,...o},h,e.imageType)}else e.breakBlock?s.insertImage({...a,...o},n.getFirstPosition(),e.imageType):s.insertImage({...a,...o},null,e.imageType)})}}class X9 extends me{constructor(e){super(e),this.decorate("cleanupImage")}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=this.editor.model.document.selection.getSelectedElement();this.isEnabled=t.isImage(n),this.value=this.isEnabled?n.getAttribute("src"):null}execute(e){const t=this.editor.model.document.selection.getSelectedElement(),n=this.editor.plugins.get("ImageUtils");this.editor.model.change(s=>{s.setAttribute("src",e.source,t),this.cleanupImage(s,t),n.setImageNaturalSizeAttributes(t)})}cleanupImage(e,t){e.removeAttribute("srcset",t),e.removeAttribute("sizes",t),e.removeAttribute("sources",t),e.removeAttribute("width",t),e.removeAttribute("height",t),e.removeAttribute("alt",t)}}class v2 extends N{static get requires(){return[Zt]}static get pluginName(){return"ImageEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(Aw),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:"srcset"});const n=new Q9(e),s=new X9(e);e.commands.add("insertImage",n),e.commands.add("replaceImageSource",s),e.commands.add("imageInsert",n)}}class C2 extends N{static get requires(){return[Zt]}static get pluginName(){return"ImageSizeAttributes"}static get isOfficialPlugin(){return!0}afterInit(){this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline")}_registerSchema(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["width","height"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["width","height"]})}_registerConverters(e){const t=this.editor,n=t.plugins.get("ImageUtils"),s=e==="imageBlock"?"figure":"img";t.conversion.for("upcast").attributeToAttribute({view:{name:s,styles:{width:/.+/}},model:{key:"width",value:a=>ph(a)?gh(a.getStyle("width")):null}}).attributeToAttribute({view:{name:s,key:"width"},model:"width"}).attributeToAttribute({view:{name:s,styles:{height:/.+/}},model:{key:"height",value:a=>ph(a)?gh(a.getStyle("height")):null}}).attributeToAttribute({view:{name:s,key:"height"},model:"height"}),t.conversion.for("editingDowncast").add(a=>{o(a,"width","width",!0,!0),o(a,"height","height",!0,!0)}),t.conversion.for("dataDowncast").add(a=>{o(a,"width","width",!1),o(a,"height","height",!1)}),t.conversion.for("upcast").add(a=>{a.on("element:img",(c,u,h)=>{const m=u.viewItem.getAttribute("width"),g=u.viewItem.getAttribute("height");m&&g&&h.consumable.consume(u.viewItem,{styles:["aspect-ratio"]})})});function o(a,c,u,h,m=!1){a.on(`attribute:${c}:${e}`,(g,w,_)=>{if(!_.consumable.consume(w.item,g.name))return;const v=_.writer,C=_.mapper.toViewElement(w.item),T=n.findViewImgElement(C);w.attributeNewValue!==null?v.setAttribute(u,w.attributeNewValue,T):v.removeAttribute(u,T);const A=w.item.getAttribute("width"),L=w.item.getAttribute("height"),z=A&&L;if(z&&m&&v.setAttribute("loading","lazy",T),w.item.hasAttribute("sources"))return;const j=w.item.hasAttribute("resizedWidth");e==="imageInline"&&!j&&!h||z&&v.setStyle("aspect-ratio",`${A}/${L}`,T)})}}}class k2 extends me{_modelElementName;constructor(e,t){super(e),this._modelElementName=t}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=t.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=t.isInlineImage(n):this.isEnabled=t.isBlockImage(n)}execute(e={}){const t=this.editor,n=this.editor.model,s=t.plugins.get("ImageUtils"),o=s.getClosestSelectedImageElement(n.document.selection),a=Object.fromEntries(o.getAttributes());return!a.src&&!a.uploadId?null:n.change(c=>{const{setImageSizes:u=!0}=e,h=Array.from(n.markers).filter(w=>w.getRange().containsItem(o)),m=s.insertImage(a,n.createSelection(o,"on"),this._modelElementName,{setImageSizes:u});if(!m)return null;const g=c.createRangeOn(m);for(const w of h){const _=w.getRange(),v=_.root.rootName!="$graveyard"?_.getJoined(g,!0):g;c.updateMarker(w,{range:v})}return{oldElement:o,newElement:m}})}}class T2 extends N{static get requires(){return[Zt]}static get pluginName(){return"ImagePlaceholder"}static get isOfficialPlugin(){return!0}afterInit(){this._setupSchema(),this._setupConversion(),this._setupLoadListener()}_setupSchema(){const e=this.editor.model.schema;e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["placeholder"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["placeholder"]})}_setupConversion(){const e=this.editor,t=e.conversion,n=e.plugins.get("ImageUtils");t.for("editingDowncast").add(s=>{s.on("attribute:placeholder",(o,a,c)=>{if(!c.consumable.test(a.item,o.name)||!a.item.is("element","imageBlock")&&!a.item.is("element","imageInline"))return;c.consumable.consume(a.item,o.name);const u=c.writer,h=c.mapper.toViewElement(a.item),m=n.findViewImgElement(h);a.attributeNewValue?(u.addClass("image_placeholder",m),u.setStyle("background-image",`url(${a.attributeNewValue})`,m),u.setCustomProperty("editingPipeline:doNotReuseOnce",!0,m)):(u.removeClass("image_placeholder",m),u.removeStyle("background-image",m))})})}_setupLoadListener(){const e=this.editor,t=e.model,n=e.editing,s=n.view,o=e.plugins.get("ImageUtils");s.addObserver(Aw),this.listenTo(s.document,"imageLoaded",(a,c)=>{const u=s.domConverter.mapDomToView(c.target);if(!u)return;const h=o.getImageWidgetFromImageView(u);if(!h)return;const m=n.mapper.toModelElement(h);!m||!m.hasAttribute("placeholder")||t.enqueueChange({isUndoable:!1},g=>{g.removeAttribute("placeholder",m)})})}}class E2 extends N{static get requires(){return[v2,C2,Zt,T2,zn]}static get pluginName(){return"ImageBlockEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new k2(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,n=e.conversion,s=e.plugins.get("ImageUtils");n.for("dataDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:a})=>Kk(a)}),n.for("editingDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:a})=>s.toImageWidget(Kk(a),a,t("image widget"))}),n.for("downcast").add(bh(s,"imageBlock","src")).add(bh(s,"imageBlock","alt")).add(y2(s,"imageBlock")),n.for("upcast").elementToElement({view:b2(e,"imageBlock"),model:(o,{writer:a})=>a.createElement("imageBlock",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)}).add(J9(s))}_setupClipboardIntegration(){const e=this.editor,t=e.model,n=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(a,c)=>{const u=Array.from(c.content.getChildren());let h;if(!u.every(s.isInlineImageView))return;c.targetRanges?h=e.editing.mapper.toModelRange(c.targetRanges[0]):h=t.document.selection.getFirstRange();const m=t.createSelection(h);if(Ew(t.schema,m)==="imageBlock"){const g=new Hh(n.document),w=u.map(_=>g.createElement("figure",{class:"image"},_));c.content=g.createDocumentFragment(w)}}),this.listenTo(o,"contentInsertion",(a,c)=>{c.method==="paste"&&t.change(u=>{const h=u.createRangeIn(c.content);for(const m of h.getItems())m.is("element","imageBlock")&&s.setImageNaturalSizeAttributes(m)})})}}class Z9 extends oe{focusTracker;keystrokes;_focusables;_focusCycler;children;constructor(e,t=[]){super(e),this.focusTracker=new dt,this.keystrokes=new Ct,this._focusables=new Gt,this.children=this.createCollection(),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});for(const n of t)this.children.add(n),this._focusables.add(n),n instanceof tL&&this._focusables.addMany(n.children);this.setTemplate({tag:"form",attributes:{class:["ck","ck-image-insert-form"],tabindex:-1},children:this.children})}render(){super.render(),or({view:this});for(const t of this._focusables)this.focusTracker.add(t.element);this.keystrokes.listenTo(this.element);const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}}class S2 extends N{static get pluginName(){return"ImageInsertUI"}static get isOfficialPlugin(){return!0}static get requires(){return[Zt]}dropdownView;_integrations=new Map;constructor(e){super(e),e.config.define("image.insert.integrations",["upload","assetManager","url"])}init(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("ImageUtils");this.set("isImageSelected",!1),this.listenTo(e.model.document,"change",()=>{this.isImageSelected=n.isImage(t.getSelectedElement())});const s=a=>this._createToolbarComponent(a),o=a=>this._createMenuBarComponent(a);e.ui.componentFactory.add("insertImage",s),e.ui.componentFactory.add("imageInsert",s),e.ui.componentFactory.add("menuBar:insertImage",o)}registerIntegration({name:e,observable:t,buttonViewCreator:n,formViewCreator:s,menuBarButtonViewCreator:o,requiresForm:a=!1,override:c=!1}){this._integrations.has(e)&&!c&&Be("image-insert-integration-exists",{name:e}),this._integrations.set(e,{observable:t,buttonViewCreator:n,menuBarButtonViewCreator:o,formViewCreator:s,requiresForm:a})}_createToolbarComponent(e){const t=this.editor,n=e.t,s=this._prepareIntegrations();if(!s.length)return null;let o;const a=s[0];if(s.length==1){if(!a.requiresForm)return a.buttonViewCreator(!0);o=a.buttonViewCreator(!0)}else{const h=a.buttonViewCreator(!1);o=new Aa(e,h),o.tooltip=!0,o.bind("label").to(this,"isImageSelected",m=>n(m?"Replace image":"Insert image"))}const c=this.dropdownView=$t(e,o),u=s.map(({observable:h})=>typeof h=="function"?h():h);return c.bind("isEnabled").toMany(u,"isEnabled",(...h)=>h.some(m=>m)),c.once("change:isOpen",()=>{const h=s.flatMap(({formViewCreator:g})=>g(s.length==1)),m=new Z9(t.locale,h);c.panelView.children.add(m)}),c}_createMenuBarComponent(e){const t=e.t,n=this._prepareIntegrations();if(!n.length)return null;const s=n.flatMap(({menuBarButtonViewCreator:c})=>c(n.length==1)),o=new vn(e),a=new xs(e);o.panelView.children.add(a),o.buttonView.set({icon:dN,label:t("Image")});for(const c of s){const u=new Li(e,o);u.children.add(c),a.items.add(u),c.delegate("execute").to(o)}return o}_prepareIntegrations(){const t=this.editor.config.get("image.insert.integrations"),n=[];if(!t.length)return Be("image-insert-integrations-not-specified"),n;for(const s of t){if(!this._integrations.has(s)){["upload","assetManager","url"].includes(s)||Be("image-insert-unknown-integration",{item:s});continue}n.push(this._integrations.get(s))}return n.length||Be("image-insert-integrations-not-registered"),n}}class ez extends N{static get requires(){return[E2,Ia,_2,S2]}static get pluginName(){return"ImageBlock"}static get isOfficialPlugin(){return!0}}class tz extends N{static get requires(){return[v2,C2,Zt,T2,zn]}static get pluginName(){return"ImageInlineEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.model.schema.register("imageInline",{inheritAllFrom:"$inlineObject",allowAttributes:["alt","src","srcset"],disallowIn:["caption"]}),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new k2(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,n=e.conversion,s=e.plugins.get("ImageUtils");n.for("dataDowncast").elementToElement({model:"imageInline",view:(o,{writer:a})=>a.createEmptyElement("img")}),n.for("editingDowncast").elementToStructure({model:"imageInline",view:(o,{writer:a})=>s.toImageWidget(z9(a),a,t("image widget"))}),n.for("downcast").add(bh(s,"imageInline","src")).add(bh(s,"imageInline","alt")).add(y2(s,"imageInline")),n.for("upcast").elementToElement({view:b2(e,"imageInline"),model:(o,{writer:a})=>a.createElement("imageInline",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)})}_setupClipboardIntegration(){const e=this.editor,t=e.model,n=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(a,c)=>{const u=Array.from(c.content.getChildren());let h;if(!u.every(s.isBlockImageView))return;c.targetRanges?h=e.editing.mapper.toModelRange(c.targetRanges[0]):h=t.document.selection.getFirstRange();const m=t.createSelection(h);if(Ew(t.schema,m)==="imageInline"){const g=new Hh(n.document),w=u.map(_=>_.childCount===1?(Array.from(_.getAttributes()).forEach(v=>g.setAttribute(...v,s.findViewImgElement(_))),_.getChild(0)):_);c.content=g.createDocumentFragment(w)}}),this.listenTo(o,"contentInsertion",(a,c)=>{c.method==="paste"&&t.change(u=>{const h=u.createRangeIn(c.content);for(const m of h.getItems())m.is("element","imageInline")&&s.setImageNaturalSizeAttributes(m)})})}}class nz extends N{static get requires(){return[tz,Ia,_2,S2]}static get pluginName(){return"ImageInline"}static get isOfficialPlugin(){return!0}}class iz extends N{static get requires(){return[ez,nz]}static get pluginName(){return"Image"}static get isOfficialPlugin(){return!0}}class A2 extends N{static get pluginName(){return"ImageCaptionUtils"}static get isOfficialPlugin(){return!0}static get requires(){return[Zt]}getCaptionFromImageModelElement(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}getCaptionFromModelSelection(e){const t=this.editor.plugins.get("ImageUtils"),n=e.getFirstPosition().findAncestor("caption");return n&&t.isBlockImage(n.parent)?n:null}matchImageCaptionViewElement(e){const t=this.editor.plugins.get("ImageUtils");return e.name=="figcaption"&&t.isBlockImageView(e.parent)?{name:!0}:null}}class sz extends me{refresh(){const e=this.editor,t=e.plugins.get("ImageCaptionUtils"),n=e.plugins.get("ImageUtils");if(!e.plugins.has(E2)){this.isEnabled=!1,this.value=!1;return}const s=e.model.document.selection,o=s.getSelectedElement();if(!o){const a=t.getCaptionFromModelSelection(s);this.isEnabled=!!a,this.value=!!a;return}this.isEnabled=n.isImage(o),this.isEnabled?this.value=!!t.getCaptionFromImageModelElement(o):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change(n=>{this.value?this._hideImageCaption(n):this._showImageCaption(n,t)})}_showImageCaption(e,t){const s=this.editor.model.document.selection,o=this.editor.plugins.get("ImageCaptionEditing"),a=this.editor.plugins.get("ImageUtils");let c=s.getSelectedElement();const u=o._getSavedCaption(c);a.isInlineImage(c)&&(this.editor.execute("imageTypeBlock"),c=s.getSelectedElement());const h=u||e.createElement("caption");e.append(h,c),t&&e.setSelection(h,"in")}_hideImageCaption(e){const t=this.editor,n=t.model.document.selection,s=t.plugins.get("ImageCaptionEditing"),o=t.plugins.get("ImageCaptionUtils");let a=n.getSelectedElement(),c;a?c=o.getCaptionFromImageModelElement(a):(c=o.getCaptionFromModelSelection(n),a=c.parent),s._saveCaption(a,c),e.setSelection(a,"on"),e.remove(c)}}class oz extends N{static get requires(){return[Zt,A2]}static get pluginName(){return"ImageCaptionEditing"}static get isOfficialPlugin(){return!0}_savedCaptionsMap;constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new sz(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration(),this._registerCaptionReconversion()}_setupConversion(){const e=this.editor,t=e.editing.view,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ImageCaptionUtils"),o=e.t;e.conversion.for("upcast").elementToElement({view:a=>s.matchImageCaptionViewElement(a),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(a,{writer:c})=>n.isBlockImage(a.parent)?c.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(a,{writer:c})=>{if(!n.isBlockImage(a.parent))return null;const u=c.createEditableElement("figcaption");c.setCustomProperty("imageCaption",!0,u),u.placeholder=o("Enter image caption"),tS({view:t,element:u,keepOnFocus:!0});const h=a.parent.getAttribute("alt"),m=h?o("Caption for image: %0",[h]):o("Caption for the image");return ZA(u,c,{label:m})}})}_setupImageTypeCommandsIntegration(){const e=this.editor,t=e.plugins.get("ImageUtils"),n=e.plugins.get("ImageCaptionUtils"),s=e.commands.get("imageTypeInline"),o=e.commands.get("imageTypeBlock"),a=c=>{if(!c.return)return;const{oldElement:u,newElement:h}=c.return;if(!u)return;if(t.isBlockImage(u)){const g=n.getCaptionFromImageModelElement(u);if(g){this._saveCaption(h,g);return}}const m=this._getSavedCaption(u);m&&this._saveCaption(h,m)};s&&this.listenTo(s,"execute",a,{priority:"low"}),o&&this.listenTo(o,"execute",a,{priority:"low"})}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?Xe.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}_registerCaptionReconversion(){const e=this.editor,t=e.model,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ImageCaptionUtils");t.document.on("change:data",()=>{const o=t.document.differ.getChanges();for(const a of o){if(a.attributeKey!=="alt")continue;const c=a.range.start.nodeAfter;if(n.isBlockImage(c)){const u=s.getCaptionFromImageModelElement(c);if(!u)return;e.editing.reconvertItem(u)}}})}}class rz extends N{static get requires(){return[A2]}static get pluginName(){return"ImageCaptionUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,n=e.plugins.get("ImageCaptionUtils"),s=e.t;e.ui.componentFactory.add("toggleImageCaption",o=>{const a=e.commands.get("toggleImageCaption"),c=new ue(o);return c.set({icon:nN,tooltip:!0,isToggleable:!0}),c.bind("isOn","isEnabled").to(a,"value","isEnabled"),c.bind("label").to(a,"value",u=>s(u?"Toggle caption off":"Toggle caption on")),this.listenTo(c,"execute",()=>{e.execute("toggleImageCaption",{focusCaptionOnShow:!0});const u=n.getCaptionFromModelSelection(e.model.document.selection);if(u){const h=e.editing.mapper.toViewElement(u);t.scrollToTheSelection(),t.change(m=>{m.addClass("image__caption_highlighted",h)})}e.editing.view.focus()}),c})}}class az extends N{static get requires(){return[oz,rz]}static get pluginName(){return"ImageCaption"}static get isOfficialPlugin(){return!0}}function x2(i){const e=i.map(t=>t.replace("+","\\+"));return new RegExp(`^image\\/(${e.join("|")})$`)}function lz(i){return new Promise((e,t)=>{const n=i.getAttribute("src");fetch(n).then(s=>s.blob()).then(s=>{const o=I2(s,n),c=`image.${o.replace("image/","")}`,u=new File([s],c,{type:o});e(u)}).catch(s=>s&&s.name==="TypeError"?uz(n).then(e).catch(t):t(s))})}function cz(i,e){return!i.isInlineImageView(e)||!e.getAttribute("src")?!1:!!e.getAttribute("src").match(/^data:image\/\w+;base64,/g)||!!e.getAttribute("src").match(/^blob:/g)}function I2(i,e){return i.type?i.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function uz(i){return dz(i).then(e=>{const t=I2(e,i),s=`image.${t.replace("image/","")}`;return new File([e],s,{type:t})})}function dz(i){return new Promise((e,t)=>{const n=ee.document.createElement("img");n.addEventListener("load",()=>{const s=ee.document.createElement("canvas");s.width=n.width,s.height=n.height,s.getContext("2d").drawImage(n,0,0),s.toBlob(a=>a?e(a):t())}),n.addEventListener("error",()=>t()),n.src=i})}class hz extends N{static get pluginName(){return"ImageUploadUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("uploadImage",()=>this._createToolbarButton()),e.ui.componentFactory.add("imageUpload",()=>this._createToolbarButton()),e.ui.componentFactory.add("menuBar:uploadImage",()=>this._createMenuBarButton("standalone")),e.plugins.has("ImageInsertUI")&&e.plugins.get("ImageInsertUI").registerIntegration({name:"upload",observable:()=>e.commands.get("uploadImage"),buttonViewCreator:()=>this._createToolbarButton(),formViewCreator:()=>this._createDropdownButton(),menuBarButtonViewCreator:t=>this._createMenuBarButton(t?"insertOnly":"insertNested")})}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("uploadImage"),o=t.config.get("image.upload.types"),a=x2(o),c=new e(t.locale),u=n.t;return c.set({acceptedType:o.map(h=>`image/${h}`).join(","),allowMultipleFiles:!0,label:u("Upload from computer"),icon:hN}),c.bind("isEnabled").to(s),c.on("done",(h,m)=>{const g=Array.from(m).filter(w=>a.test(w.type));g.length&&(t.execute("uploadImage",{file:g}),t.editing.view.focus())}),c}_createToolbarButton(){const e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),n=this.editor.commands.get("uploadImage"),s=this._createButton(GC);return s.tooltip=!0,s.bind("label").to(t,"isImageSelected",n,"isAccessAllowed",(o,a)=>e(a?o?"Replace image from computer":"Upload image from computer":"You have no image upload permissions.")),s}_createDropdownButton(){const e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),n=this._createButton(GC);return n.withText=!0,n.bind("label").to(t,"isImageSelected",s=>e(s?"Replace from computer":"Upload from computer")),n.on("execute",()=>{t.dropdownView.isOpen=!1}),n}_createMenuBarButton(e){const t=this.editor.locale.t,n=this._createButton(FA);switch(n.withText=!0,e){case"standalone":n.label=t("Image from computer");break;case"insertOnly":n.label=t("Image");break;case"insertNested":n.label=t("From computer");break}return n}}class fz extends N{static get pluginName(){return"ImageUploadProgress"}static get isOfficialPlugin(){return!0}placeholder;constructor(e){super(e),this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",this.uploadStatusChange),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",this.uploadStatusChange)}uploadStatusChange=(e,t,n)=>{const s=this.editor,o=t.item,a=o.getAttribute("uploadId");if(!n.consumable.consume(t.item,e.name))return;const c=s.plugins.get("ImageUtils"),u=s.plugins.get(qo),h=a?t.attributeNewValue:null,m=this.placeholder,g=s.editing.mapper.toViewElement(o),w=n.writer;if(h=="reading"){Yk(g,w),Jk(c,m,g,w);return}if(h=="uploading"){const _=u.loaders.get(a);Yk(g,w),_?(Qk(g,w),gz(g,w,_,s.editing.view),yz(c,g,w,_)):Jk(c,m,g,w);return}h=="complete"&&u.loaders.get(a)&&bz(g,w,s.editing.view),pz(g,w),Qk(g,w),mz(g,w)}}function Yk(i,e){i.hasClass("ck-appear")||e.addClass("ck-appear",i)}function mz(i,e){e.removeClass("ck-appear",i)}function Jk(i,e,t,n){t.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",t);const s=i.findViewImgElement(t);s.getAttribute("src")!==e&&n.setAttribute("src",e,s),P2(t,"placeholder")||n.insert(n.createPositionAfter(s),_z(n))}function Qk(i,e){i.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",i),R2(i,e,"placeholder")}function gz(i,e,t,n){const s=wz(e);e.insert(e.createPositionAt(i,"end"),s),t.on("change:uploadedPercent",(o,a,c)=>{n.change(u=>{u.setStyle("width",c+"%",s)})})}function pz(i,e){R2(i,e,"progressBar")}function bz(i,e,t){const n=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(i,"end"),n),setTimeout(()=>{t.change(s=>s.remove(s.createRangeOn(n)))},3e3)}function wz(i){const e=i.createUIElement("div",{class:"ck-progress-bar"});return i.setCustomProperty("progressBar",!0,e),e}function _z(i){const e=i.createUIElement("div",{class:"ck-upload-placeholder-loader"});return i.setCustomProperty("placeholder",!0,e),e}function P2(i,e){for(const t of i.getChildren())if(t.getCustomProperty(e))return t}function R2(i,e,t){const n=P2(i,t);n&&e.remove(e.createRangeOn(n))}function yz(i,e,t,n){if(n.data){const s=i.findViewImgElement(e);t.setAttribute("src",n.data,s)}}class vz extends me{constructor(e){super(e),this.set("isAccessAllowed",!0)}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),n=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(n)}execute(e){const t=st(e.file),n=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(n.getAttributes());t.forEach((a,c)=>{const u=n.getSelectedElement();if(c&&u&&s.isImage(u)){const h=this.editor.model.createPositionAfter(u);this._uploadImage(a,o,h)}else this._uploadImage(a,o)})}_uploadImage(e,t,n){const s=this.editor,a=s.plugins.get(qo).createLoader(e),c=s.plugins.get("ImageUtils");a&&c.insertImage({...t,uploadId:a.id},n)}}class Cz extends N{static get requires(){return[qo,sk,zn,Zt]}static get pluginName(){return"ImageUploadEditing"}static get isOfficialPlugin(){return!0}_uploadImageElements;_uploadedImages=new Map;constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const e=this.editor,t=e.model.document,n=e.conversion,s=e.plugins.get(qo),o=e.plugins.get("ImageUtils"),a=e.plugins.get("ClipboardPipeline"),c=x2(e.config.get("image.upload.types")),u=new vz(e);e.commands.add("uploadImage",u),e.commands.add("imageUpload",u),n.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}).add(h=>h.on("element:img",(m,g,w)=>{if(!w.consumable.test(g.viewItem,{attributes:["data-ck-upload-id"]}))return;const _=g.viewItem.getAttribute("data-ck-upload-id");if(!_)return;const[v]=Array.from(g.modelRange.getItems({shallow:!0})),C=s.loaders.get(_);v&&(w.writer.setAttribute("uploadId",_,v),w.consumable.consume(g.viewItem,{attributes:["data-ck-upload-id"]}),C&&C.data&&w.writer.setAttribute("uploadStatus",C.status,v))},{priority:"low"})),this.listenTo(e.editing.view.document,"clipboardInput",(h,m)=>{if(kz(m.dataTransfer))return;const g=Array.from(m.dataTransfer.files).filter(_=>_?c.test(_.type):!1);if(!g.length)return;if(h.stop(),e.model.change(_=>{m.targetRanges&&_.setSelection(m.targetRanges.map(v=>e.editing.mapper.toModelRange(v))),e.execute("uploadImage",{file:g})}),!e.commands.get("uploadImage").isAccessAllowed){const _=e.plugins.get("Notification"),v=e.locale.t;_.showWarning(v("You have no image upload permissions."),{namespace:"image"})}}),this.listenTo(a,"inputTransformation",(h,m)=>{const g=Array.from(e.editing.view.createRangeIn(m.content)).map(_=>_.item).filter(_=>cz(o,_)&&!_.getAttribute("uploadProcessed")).map(_=>({promise:lz(_),imageElement:_}));if(!g.length)return;const w=new Hh(e.editing.view.document);for(const _ of g){w.setAttribute("uploadProcessed",!0,_.imageElement);const v=s.createLoader(_.promise);v&&(w.setAttribute("src","",_.imageElement),w.setAttribute("uploadId",v.id,_.imageElement))}}),e.editing.view.document.on("dragover",(h,m)=>{m.preventDefault()}),t.on("change",()=>{const h=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),m=new Set;for(const g of h)if(g.type=="insert"&&g.name!="$text"){const w=g.position.nodeAfter,_=g.position.root.rootName=="$graveyard";for(const v of Tz(e,w)){const C=v.getAttribute("uploadId"),T=v.getAttribute("uploadStatus");if(!C||T=="complete")continue;const A=s.loaders.get(C);if(!A){!_&&this._uploadedImages.has(C)&&e.model.enqueueChange({isUndoable:!1},L=>{L.setAttribute("uploadStatus","complete",v),this.fire("uploadComplete",{data:this._uploadedImages.get(C),imageElement:v})});continue}_?m.has(C)||Array.from(this._uploadImageElements.get(C)).every(z=>z.root.rootName=="$graveyard")&&A.abort():(m.add(C),this._uploadImageElements.has(C)?this._uploadImageElements.get(C).add(v):this._uploadImageElements.set(C,new Set([v])),A.status=="idle"&&this._readAndUpload(A))}}}),this.on("uploadComplete",(h,{imageElement:m,data:g})=>{const w=g.urls?g.urls:g;this.editor.model.change(_=>{_.setAttribute("src",w.default,m),this._parseAndSetSrcsetAttributeOnImage(w,m,_),o.setImageNaturalSizeAttributes(m)})},{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&(e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this._registerConverters("imageBlock")),this.editor.plugins.has("ImageInlineEditing")&&(e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]}),this._registerConverters("imageInline"))}_readAndUpload(e){const t=this.editor,n=t.model,s=t.locale.t,o=t.plugins.get(qo),a=t.plugins.get(sk),c=t.plugins.get("ImageUtils"),u=this._uploadImageElements;return n.enqueueChange({isUndoable:!1},m=>{const g=u.get(e.id);for(const w of g)m.setAttribute("uploadStatus","reading",w)}),e.read().then(()=>{const m=e.upload();t.ui&&t.ui.ariaLiveAnnouncer.announce(s("Uploading image"));for(const g of u.get(e.id)){if(le.isSafari){const w=t.editing.mapper.toViewElement(g),_=c.findViewImgElement(w);t.editing.view.once("render",()=>{if(!_.parent)return;const v=t.editing.view.domConverter.mapViewToDom(_.parent);if(!v)return;const C=v.style.display;v.style.display="none",v._ckHack=v.offsetHeight,v.style.display=C})}n.enqueueChange({isUndoable:!1},w=>{w.setAttribute("uploadStatus","uploading",g)})}return m}).then(m=>{n.enqueueChange({isUndoable:!1},g=>{for(const w of u.get(e.id))g.setAttribute("uploadStatus","complete",w),this.fire("uploadComplete",{data:m,imageElement:w});t.ui&&t.ui.ariaLiveAnnouncer.announce(s("Image upload complete")),this._uploadedImages.set(e.id,m)}),h()}).catch(m=>{if(t.ui&&t.ui.ariaLiveAnnouncer.announce(s("Error during image upload")),e.status!=="error"&&e.status!=="aborted")throw m;e.status=="error"&&m&&a.showWarning(m,{title:s("Upload failed"),namespace:"upload"}),n.enqueueChange({isUndoable:!1},g=>{for(const w of u.get(e.id))w.root.rootName!=="$graveyard"&&g.remove(w)}),h()});function h(){n.enqueueChange({isUndoable:!1},m=>{for(const g of u.get(e.id))m.removeAttribute("uploadId",g),m.removeAttribute("uploadStatus",g);u.delete(e.id)}),o.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,n){let s=0;const o=Object.keys(e).filter(a=>{const c=parseInt(a,10);if(!isNaN(c))return s=Math.max(s,c),!0}).map(a=>`${e[a]} ${a}w`).join(", ");if(o!=""){const a={srcset:o};!t.hasAttribute("width")&&!t.hasAttribute("height")&&(a.width=s),n.setAttributes(a,t)}}_registerConverters(e){const{conversion:t,plugins:n}=this.editor,s=n.get(qo),o=n.get(Zt);t.for("dataDowncast").add(a=>{a.on(`attribute:uploadId:${e}`,(c,u,h)=>{if(!h.consumable.test(u.item,c.name))return;const m=s.loaders.get(u.attributeNewValue);if(!m||!m.data)return null;const g=h.mapper.toViewElement(u.item),w=o.findViewImgElement(g);w&&(h.consumable.consume(u.item,c.name),h.writer.setAttribute("data-ck-upload-id",m.id,w))})})}}function kz(i){return Array.from(i.types).includes("text/html")&&i.getData("text/html")!==""}function Tz(i,e){const t=i.plugins.get("ImageUtils");return Array.from(i.model.createRangeOn(e)).filter(n=>t.isImage(n.item)).map(n=>n.item)}class Ez extends N{static get pluginName(){return"ImageUpload"}static get isOfficialPlugin(){return!0}static get requires(){return[Cz,hz,fz]}}class Sz extends me{refresh(){const e=this.editor,n=e.plugins.get("ImageUtils").getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!n,!n||!n.hasAttribute("resizedWidth")?this.value=null:this.value={width:n.getAttribute("resizedWidth"),height:null}}execute(e){const t=this.editor,n=t.model,s=t.plugins.get("ImageUtils"),o=s.getClosestSelectedImageElement(n.document.selection);this.value={width:e.width,height:null},o&&n.change(a=>{a.setAttribute("resizedWidth",e.width,o),a.removeAttribute("resizedHeight",o),s.setImageNaturalSizeAttributes(o)})}}class O2 extends N{static get requires(){return[Zt]}static get pluginName(){return"ImageResizeEditing"}static get licenseFeatureCode(){return"IR"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:custom",value:"custom",icon:"custom"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new Sz(e);this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}afterInit(){this._registerSchema()}_registerSchema(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&(e.extend("imageBlock",{allowAttributes:["resizedWidth","resizedHeight"]}),e.setAttributeProperties("resizedWidth",{isFormatting:!0}),e.setAttributeProperties("resizedHeight",{isFormatting:!0})),this.editor.plugins.has("ImageInlineEditing")&&(e.extend("imageInline",{allowAttributes:["resizedWidth","resizedHeight"]}),e.setAttributeProperties("resizedWidth",{isFormatting:!0}),e.setAttributeProperties("resizedHeight",{isFormatting:!0}))}_registerConverters(e){const t=this.editor,n=t.plugins.get("ImageUtils");t.conversion.for("downcast").add(s=>s.on(`attribute:resizedWidth:${e}`,(o,a,c)=>{if(!c.consumable.consume(a.item,o.name))return;const u=c.writer,h=c.mapper.toViewElement(a.item);a.attributeNewValue!==null?(u.setStyle("width",a.attributeNewValue,h),u.addClass("image_resized",h)):(u.removeStyle("width",h),u.removeClass("image_resized",h))})),t.conversion.for("dataDowncast").attributeToAttribute({model:{name:e,key:"resizedHeight"},view:s=>({key:"style",value:{height:s}})}),t.conversion.for("editingDowncast").add(s=>s.on(`attribute:resizedHeight:${e}`,(o,a,c)=>{if(!c.consumable.consume(a.item,o.name))return;const u=c.writer,h=c.mapper.toViewElement(a.item),m=e==="imageInline"?n.findViewImgElement(h):h;a.attributeNewValue!==null?u.setStyle("height",a.attributeNewValue,m):u.removeStyle("height",m)})),t.conversion.for("upcast").attributeToAttribute({view:{name:e==="imageBlock"?"figure":"img",styles:{width:/.+/}},model:{key:"resizedWidth",value:s=>ph(s)?null:s.getStyle("width")}}),t.conversion.for("upcast").attributeToAttribute({view:{name:e==="imageBlock"?"figure":"img",styles:{height:/.+/}},model:{key:"resizedHeight",value:s=>ph(s)?null:s.getStyle("height")}}),t.conversion.for("upcast").add(s=>{s.on(`element:${e==="imageBlock"?"figure":"img"}`,(o,a,c)=>{c.consumable.consume(a.viewItem,{classes:["image_resized"]})})})}}const Ap={small:EN,medium:TN,large:kN,custom:vN,original:CN};class Az extends N{static get requires(){return[O2]}static get pluginName(){return"ImageResizeButtons"}static get isOfficialPlugin(){return!0}_resizeUnit;constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),n=e.commands.get("resizeImage");this.bind("isEnabled").to(n);for(const s of t)this._registerImageResizeButton(s);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:n,value:s,icon:o}=e;t.ui.componentFactory.add(n,a=>{const c=new ue(a),u=t.commands.get("resizeImage"),h=this._getOptionLabelValue(e,!0);if(!Ap[o])throw new E("imageresizebuttons-missing-icon",t,e);if(c.set({label:h,icon:Ap[o],tooltip:h,isToggleable:!0}),c.bind("isEnabled").to(this),t.plugins.has("ImageCustomResizeUI")&&Fl(e)){const m=t.plugins.get("ImageCustomResizeUI");this.listenTo(c,"execute",()=>{m._showForm(this._resizeUnit)})}else{const m=s?s+this._resizeUnit:null;c.bind("isOn").to(u,"value",u,"isEnabled",ab(m)),this.listenTo(c,"execute",()=>{t.execute("resizeImage",{width:m})})}return c})}_registerImageResizeDropdown(e){const t=this.editor,n=t.t,s=e.find(a=>!a.value),o=a=>{const c=t.commands.get("resizeImage"),u=$t(a,PA),h=u.buttonView,m=n("Resize image");return h.set({tooltip:m,commandValue:s.value,icon:Ap.medium,isToggleable:!0,label:this._getOptionLabelValue(s),withText:!0,class:"ck-resize-image-button",ariaLabel:m,ariaLabelledBy:void 0}),h.bind("label").to(c,"value",g=>g&&g.width?g.width:this._getOptionLabelValue(s)),u.bind("isEnabled").to(this),mo(u,()=>this._getResizeDropdownListItemDefinitions(e,c),{ariaLabel:n("Image resize list"),role:"menu"}),this.listenTo(u,"execute",g=>{"onClick"in g.source?g.source.onClick():(t.execute(g.source.commandName,{width:g.source.commandValue}),t.editing.view.focus())}),u};t.ui.componentFactory.add("resizeImage",o),t.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(e,t=!1){const n=this.editor.t;return e.label?e.label:t?Fl(e)?n("Custom image size"):e.value?n("Resize image to %0",e.value+this._resizeUnit):n("Resize image to the original size"):Fl(e)?n("Custom"):e.value?e.value+this._resizeUnit:n("Original")}_getResizeDropdownListItemDefinitions(e,t){const{editor:n}=this,s=new Dt,o=e.map(a=>Fl(a)?{...a,valueWithUnits:"custom"}:a.value?{...a,valueWithUnits:`${a.value}${this._resizeUnit}`}:{...a,valueWithUnits:null});for(const a of o){let c=null;if(n.plugins.has("ImageCustomResizeUI")&&Fl(a)){const u=n.plugins.get("ImageCustomResizeUI");c={type:"button",model:new co({label:this._getOptionLabelValue(a),role:"menuitemradio",withText:!0,icon:null,onClick:()=>{u._showForm(this._resizeUnit)}})};const h=Object.values(o).map(m=>m.valueWithUnits);c.model.bind("isOn").to(t,"value",t,"isEnabled",xz(h))}else c={type:"button",model:new co({commandName:"resizeImage",commandValue:a.valueWithUnits,label:this._getOptionLabelValue(a),role:"menuitemradio",withText:!0,icon:null})},c.model.bind("isOn").to(t,"value",t,"isEnabled",ab(a.valueWithUnits));c.model.bind("isEnabled").to(t,"isEnabled"),s.add(c)}return s}}function Fl(i){return i.value==="custom"}function ab(i){return(e,t)=>{const n=e;return n===void 0||!t?!1:i===null&&n===i?!0:n!==null&&n.width===i}}function xz(i){return(e,t)=>!i.some(n=>ab(n)(e,t))}const Iz="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",xp="image_resized";class Pz extends N{static get requires(){return[gp,Zt]}static get pluginName(){return"ImageResizeHandles"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view,n=e.plugins.get("ImageUtils");t.addObserver(Aw),this.listenTo(t.document,"imageLoaded",(s,o)=>{if(!o.target.matches(Iz))return;const a=e.editing.view.domConverter,c=a.domToView(o.target),u=n.getImageWidgetFromImageView(c);let h=this.editor.plugins.get(gp).getResizerByViewElement(u);if(h){h.redraw();return}const m=e.editing.mapper,g=m.toModelElement(u);h=e.plugins.get(gp).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:g,viewElement:u,editor:e,getHandleHost(w){return w.querySelector("img")},getResizeHost(){return a.mapViewToDom(m.toViewElement(g))},isCentered(){return g.getAttribute("imageStyle")=="alignCenter"},onCommit(w){t.change(_=>{_.removeClass(xp,u)}),e.execute("resizeImage",{width:w})}}),h.on("updateSize",()=>{u.hasClass(xp)||t.change(_=>{_.addClass(xp,u)});const w=g.name==="imageInline"?c:u;w.getStyle("height")&&t.change(_=>{_.removeStyle("height",w)})}),h.bind("isEnabled").to(this)})}}function V2(i){if(!i)return null;const[,e,t]=i.trim().match(/([.,\d]+)(%|px)$/)||[],n=Number.parseFloat(e);return Number.isNaN(n)?null:{value:n,unit:t}}function B2(i,e,t){return t==="px"?{value:e.value,unit:"px"}:{value:e.value/i*100,unit:"%"}}function M2(i){const{editing:e}=i,n=i.plugins.get("ImageUtils").getClosestSelectedImageElement(i.model.document.selection);if(!n)return null;const s=e.mapper.toViewElement(n),o=e.view.domConverter.mapViewToDom(s);return{model:n,view:s,dom:o}}function Rz(i,e){const t=M2(i);if(!t)return null;const n=V2(t.model.getAttribute("resizedWidth")||null);if(!n)return null;if(n.unit===e)return n;const s=kw(t.dom),o={value:new pe(t.dom).width};return B2(s,o,e)}class Oz extends oe{focusTracker;keystrokes;unit;backButtonView;saveButtonView;labeledInput;children;_focusables;_focusCycler;_validators;constructor(e,t,n){super(e),this.focusTracker=new dt,this.keystrokes=new Ct,this.unit=t,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.labeledInput=this._createLabeledInputView(),this.children=this.createCollection([this._createHeaderView()]),this.children.add(new qt(e,{children:[this.labeledInput,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding"]})),this._focusables=new Gt,this._validators=n,this.keystrokes.set("Esc",(s,o)=>{this.fire("cancel"),o()}),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-image-custom-resize-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),or({view:this}),[this.backButtonView,this.labeledInput,this.saveButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createBackButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:Ta,tooltip:!0}),t.delegate("execute").to(this,"cancel"),t}_createSaveButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({label:e("Save"),withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),t}_createHeaderView(){const e=this.locale.t,t=new fo(this.locale,{label:e("Image Resize")});return t.children.add(this.backButtonView,0),t}_createLabeledInputView(){const e=this.locale.t,t=new Rt(this.locale,kL);return t.label=e("Resize image (in %0)",this.unit),t.class="ck-labeled-field-view_full-width",t.fieldView.set({step:.1}),t}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.labeledInput.errorText=t,!1}return!0}resetFormStatus(){this.labeledInput.errorText=null}get rawSize(){const{element:e}=this.labeledInput.fieldView;return e?e.value:null}get parsedSize(){const{rawSize:e}=this;if(e===null)return null;const t=Number.parseFloat(e);return Number.isNaN(t)?null:t}get sizeWithUnits(){const{parsedSize:e,unit:t}=this;return e===null?null:`${e}${t}`}}function Vz(i,e){const t=M2(i);if(!t)return null;const n=kw(t.dom),s=V2(window.getComputedStyle(t.dom).minWidth)||{value:1},o=Math.max(.1,B2(n,s,e).value);return{unit:e,lower:o,upper:e==="px"?n:100}}class Bz extends N{_balloon;_form;static get requires(){return[As]}static get pluginName(){return"ImageCustomResizeUI"}static get isOfficialPlugin(){return!0}destroy(){super.destroy(),this._form&&this._form.destroy()}_createForm(e){const t=this.editor;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(_c(Oz))(t.locale,e,Mz(t)),this._form.render(),this.listenTo(this._form,"submit",()=>{this._form.isValid()&&(t.execute("resizeImage",{width:this._form.sizeWithUnits}),this._hideForm(!0))}),this.listenTo(this._form.labeledInput,"change:errorText",()=>{t.ui.update()}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),sr({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(e){if(this._isVisible)return;this._form||this._createForm(e);const t=this.editor,n=this._form.labeledInput;this._form.disableCssTransitions(),this._form.resetFormStatus(),this._isInBalloon||this._balloon.add({view:this._form,position:Sw(t)});const s=Rz(t,e),o=s?s.value.toFixed(1):"",a=Vz(t,e);n.fieldView.value=n.fieldView.element.value=o,a&&Object.assign(n.fieldView,{min:a.lower.toFixed(1),max:Math.ceil(a.upper).toFixed(1)}),this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}function Mz(i){const e=i.t;return[t=>{if(t.rawSize.trim()==="")return e("The value must not be empty.");if(t.parsedSize===null)return e("The value should be a plain number.")}]}class Nz extends N{static get requires(){return[O2,Pz,Bz,Az]}static get pluginName(){return"ImageResize"}static get isOfficialPlugin(){return!0}}class Lz extends me{_defaultStyles;_styles;constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map(n=>{if(n.isDefault)for(const s of n.modelElements)this._defaultStyles[s]=n.name;return[n.name,n]}))}refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled?n.hasAttribute("imageStyle")?this.value=n.getAttribute("imageStyle"):this.value=this._defaultStyles[n.name]:this.value=!1}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("ImageUtils");n.change(o=>{const a=e.value,{setImageSizes:c=!0}=e;let u=s.getClosestSelectedImageElement(n.document.selection);a&&this.shouldConvertImageType(a,u)&&(this.editor.execute(s.isBlockImage(u)?"imageTypeInline":"imageTypeBlock",{setImageSizes:c}),u=s.getClosestSelectedImageElement(n.document.selection)),!a||this._styles.get(a).isDefault?o.removeAttribute("imageStyle",u):o.setAttribute("imageStyle",a,u),c&&s.setImageNaturalSizeAttributes(u)})}shouldConvertImageType(e,t){return!this._styles.get(e).modelElements.includes(t.name)}}const jd={get inline(){return{name:"inline",title:"In line",icon:lA,modelElements:["imageInline"],isDefault:!0}},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:hw,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"}},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:cA,modelElements:["imageBlock"],className:"image-style-block-align-left"}},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:rh,modelElements:["imageBlock"],className:"image-style-align-center"}},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:ah,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"}},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:uA,modelElements:["imageBlock"],className:"image-style-block-align-right"}},get block(){return{name:"block",title:"Centered image",icon:rh,modelElements:["imageBlock"],isDefault:!0}},get side(){return{name:"side",title:"Side image",icon:ah,modelElements:["imageBlock"],className:"image-style-side"}}},Dz={full:yN,left:cA,right:uA,center:rh,inlineLeft:hw,inlineRight:ah,inline:lA},Fz=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function zz(i){return(i.configuredStyles.options||[]).map(n=>jz(n)).filter(n=>qz(n,i))}function Uz(i,e){return i&&e?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:i?{options:["block","side"]}:e?{options:["inline","alignLeft","alignRight"]}:{}}function Hz(i){return i.has("ImageBlockEditing")&&i.has("ImageInlineEditing")?[...Fz]:[]}function jz(i){return typeof i=="string"?jd[i]?i={...jd[i]}:i={name:i}:i=Wz(jd[i.name],i),typeof i.icon=="string"&&(i.icon=Dz[i.icon]||i.icon),i}function qz(i,{isBlockPluginLoaded:e,isInlinePluginLoaded:t}){const{modelElements:n,name:s}=i;if(!n||!n.length||!s)return N2({style:i}),!1;{const o=[e?"imageBlock":null,t?"imageInline":null];if(!n.some(a=>o.includes(a)))return Be("image-style-missing-dependency",{style:i,missingPlugins:n.map(a=>a==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}function Wz(i,e){const t={...e};for(const n in i)Object.prototype.hasOwnProperty.call(e,n)||(t[n]=i[n]);return t}function N2(i){Be("image-style-configuration-definition-invalid",i)}const wh={normalizeStyles:zz,getDefaultStylesConfiguration:Uz,getDefaultDropdownDefinitions:Hz,warnInvalidStyle:N2};function $z(i){return(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const s=lb(t.attributeNewValue,i),o=lb(t.attributeOldValue,i),a=n.mapper.toViewElement(t.item),c=n.writer;o&&c.removeClass(o.className,a),s&&c.addClass(s.className,a)}}function Gz(i){const e={imageInline:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageInline")),imageBlock:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageBlock"))};return(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem,a=Ze(n.modelRange.getItems());if(a&&s.schema.checkAttribute(a,"imageStyle")){for(const c of e[a.name])s.consumable.consume(o,{classes:c.className})&&s.writer.setAttribute("imageStyle",c.name,a);Kz(s,o,a,i)}}}function Kz(i,e,t,n){if(!i.consumable.test(e,{styles:["float"]}))return;let s=null;switch(e.getStyle("float")){case"left":s="alignLeft";break;case"right":s="alignRight";break}if(!s)return;const o=lb(s,n);if(!o)return;const a=jd[o.name];F9(o,a)&&(i.writer.setAttribute("imageStyle",s,t),i.consumable.consume(e,{styles:["float"]}))}function lb(i,e){for(const t of e)if(t.name===i)return t}class L2 extends N{static get pluginName(){return"ImageStyleEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Zt]}normalizedStyles;init(){const e=this.editor,t=e.plugins.has("ImageBlockEditing"),n=e.plugins.has("ImageInlineEditing");e.config.define("image.styles",wh.getDefaultStylesConfiguration(t,n)),this.normalizedStyles=wh.normalizeStyles({configuredStyles:e.config.get("image.styles"),isBlockPluginLoaded:t,isInlinePluginLoaded:n}),this._setupConversion(t,n),this._setupPostFixer(),e.commands.add("imageStyle",new Lz(e,this.normalizedStyles))}_setupConversion(e,t){const n=this.editor,s=n.model.schema,o=$z(this.normalizedStyles),a=Gz(this.normalizedStyles);n.editing.downcastDispatcher.on("attribute:imageStyle",o),n.data.downcastDispatcher.on("attribute:imageStyle",o),e&&(s.extend("imageBlock",{allowAttributes:"imageStyle"}),s.setAttributeProperties("imageStyle",{isFormatting:!0}),n.data.upcastDispatcher.on("element:figure",a,{priority:"low"})),t&&(s.extend("imageInline",{allowAttributes:"imageStyle"}),s.setAttributeProperties("imageStyle",{isFormatting:!0}),n.data.upcastDispatcher.on("element:img",a,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,n=e.plugins.get(Zt),s=new Map(this.normalizedStyles.map(o=>[o.name,o]));t.registerPostFixer(o=>{let a=!1;for(const c of t.differ.getChanges())if(c.type=="insert"||c.type=="attribute"&&c.attributeKey=="imageStyle"){let u=c.type=="insert"?c.position.nodeAfter:c.range.start.nodeAfter;if(u&&u.is("element","paragraph")&&u.childCount>0&&(u=u.getChild(0)),!n.isImage(u))continue;const h=u.getAttribute("imageStyle");if(!h)continue;const m=s.get(h);(!m||!m.modelElements.includes(u.name))&&(o.removeAttribute("imageStyle",u),a=!0)}return a})}}class Yz extends N{static get requires(){return[L2]}static get pluginName(){return"ImageStyleUI"}static get isOfficialPlugin(){return!0}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],n=e.get("ImageStyleEditing"),s=Xk(n.normalizedStyles,this.localizedDefaultStylesTitles);for(const a of s)this._createButton(a);const o=Xk([...t.filter(on),...wh.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const a of o)this._createDropdown(a,s)}_createDropdown(e,t){const n=this.editor.ui.componentFactory;n.add(e.name,s=>{let o;const{defaultItem:a,items:c,title:u}=e,h=c.filter(_=>t.find(({name:v})=>Zk(v)===_)).map(_=>{const v=n.create(_);return _===a&&(o=v),v});c.length!==h.length&&wh.warnInvalidStyle({dropdown:e});const m=$t(s,Aa),g=m.buttonView,w=g.arrowView;return Dc(m,h,{enableActiveItemFocusOnDropdownOpen:!0}),g.set({label:eT(u,o.label),class:null,tooltip:!0}),w.unbind("label"),w.set({label:u}),g.bind("icon").toMany(h,"isOn",(..._)=>{const v=_.findIndex(El);return v<0?o.icon:h[v].icon}),g.bind("label").toMany(h,"isOn",(..._)=>{const v=_.findIndex(El);return eT(u,v<0?o.label:h[v].label)}),g.bind("isOn").toMany(h,"isOn",(..._)=>_.some(El)),g.bind("class").toMany(h,"isOn",(..._)=>_.some(El)?"ck-splitbutton_flatten":void 0),g.on("execute",()=>{h.some(({isOn:_})=>_)?m.isOpen=!m.isOpen:o.fire("execute")}),m.bind("isEnabled").toMany(h,"isEnabled",(..._)=>_.some(El)),this.listenTo(m,"execute",()=>{this.editor.editing.view.focus()}),m})}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Zk(t),n=>{const s=this.editor.commands.get("imageStyle"),o=new ue(n);return o.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",a=>a===t),o.on("execute",this._executeCommand.bind(this,t)),o})}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Xk(i,e){for(const t of i)e[t.title]&&(t.title=e[t.title]);return i}function Zk(i){return`imageStyle:${i}`}function eT(i,e){return(i?i+": ":"")+e}class Jz extends N{static get requires(){return[L2,Yz]}static get pluginName(){return"ImageStyle"}static get isOfficialPlugin(){return!0}}class Qz extends N{static get requires(){return[hh,Zt]}static get pluginName(){return"ImageToolbar"}static get isOfficialPlugin(){return!0}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(hh),s=e.plugins.get("ImageUtils");n.register("image",{ariaLabel:t("Image toolbar"),items:Xz(e.config.get("image.toolbar")||[]),getRelatedElement:o=>s.getClosestSelectedImageWidget(o)})}}function Xz(i){return i.map(e=>on(e)?e.name:e)}class Zz extends N{static get pluginName(){return"IndentEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.commands.add("indent",new gC(e)),e.commands.add("outdent",new gC(e))}}class eU extends N{static get pluginName(){return"IndentUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?TC:EC,o=t.uiLanguageDirection=="ltr"?EC:TC;this._defineButton("indent",n("Increase indent"),s),this._defineButton("outdent",n("Decrease indent"),o)}_defineButton(e,t,n){const s=this.editor;s.ui.componentFactory.add(e,()=>{const o=this._createButton(ue,e,t,n);return o.set({tooltip:!0}),o}),s.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(tt,e,t,n))}_createButton(e,t,n,s){const o=this.editor,a=o.commands.get(t),c=new e(o.locale);return c.set({label:n,icon:s}),c.bind("isEnabled").to(a,"isEnabled"),this.listenTo(c,"execute",()=>{o.execute(t),o.editing.view.focus()}),c}}class tU extends N{static get pluginName(){return"Indent"}static get isOfficialPlugin(){return!0}static get requires(){return[Zz,eU]}}class Ed extends me{_indentBehavior;constructor(e,t){super(e),this._indentBehavior=t}refresh(){const t=this.editor.model,n=Ze(t.document.selection.getSelectedBlocks());if(!n||!this._isIndentationChangeAllowed(n)){this.isEnabled=!1;return}this.isEnabled=this._indentBehavior.checkEnabled(n.getAttribute("blockIndent"))}execute(){const e=this.editor.model,t=this._getBlocksToChange();e.change(n=>{for(const s of t){const o=s.getAttribute("blockIndent"),a=this._indentBehavior.getNextIndent(o);a?n.setAttribute("blockIndent",a,s):n.removeAttribute("blockIndent",s)}})}_getBlocksToChange(){const t=this.editor.model.document.selection;return Array.from(t.getSelectedBlocks()).filter(s=>this._isIndentationChangeAllowed(s))}_isIndentationChangeAllowed(e){const t=this.editor;return t.model.schema.checkAttribute(e,"blockIndent")?!t.plugins.has("ListUtils")||!this._indentBehavior.isForward?!0:!t.plugins.get("ListUtils").isListItemBlock(e):!1}}class tT{isForward;offset;unit;constructor(e){this.isForward=e.direction==="forward",this.offset=e.offset,this.unit=e.unit}checkEnabled(e){const t=parseFloat(e||"0");return this.isForward||t>0}getNextIndent(e){const t=parseFloat(e||"0");if(!(!e||e.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;const s=this.isForward?this.offset:-this.offset,o=t+s;return o>0?o+this.unit:void 0}}class nT{isForward;classes;constructor(e){this.isForward=e.direction==="forward",this.classes=e.classes}checkEnabled(e){const t=this.classes.indexOf(e);return this.isForward?t<this.classes.length-1:t>=0}getNextIndent(e){const t=this.classes.indexOf(e),n=this.isForward?1:-1;return this.classes[t+n]}}const nU=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class iU extends N{constructor(e){super(e),e.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.config.get("indentBlock");t.classes&&t.classes.length?(this._setupConversionUsingClasses(t.classes),e.commands.add("indentBlock",new Ed(e,new nT({direction:"forward",classes:t.classes}))),e.commands.add("outdentBlock",new Ed(e,new nT({direction:"backward",classes:t.classes})))):(e.data.addStyleProcessorRules(QS),this._setupConversionUsingOffset(),e.commands.add("indentBlock",new Ed(e,new tT({direction:"forward",offset:t.offset,unit:t.unit}))),e.commands.add("outdentBlock",new Ed(e,new tT({direction:"backward",offset:t.offset,unit:t.unit}))))}afterInit(){const e=this.editor,t=e.model.schema,n=e.commands.get("indent"),s=e.commands.get("outdent"),o=e.config.get("heading.options");(o&&o.map(u=>u.model)||nU).forEach(u=>{t.isRegistered(u)&&t.extend(u,{allowAttributes:"blockIndent"})}),t.setAttributeProperties("blockIndent",{isFormatting:!0}),n.registerChildCommand(e.commands.get("indentBlock")),s.registerChildCommand(e.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const e=this.editor.conversion,n=this.editor.locale.contentLanguageDirection==="rtl"?"margin-right":"margin-left";e.for("upcast").attributeToAttribute({view:{styles:{[n]:/[\s\S]+/}},model:{key:"blockIndent",value:s=>{if(!s.is("element","li"))return s.getStyle(n)}}}),e.for("downcast").attributeToAttribute({model:"blockIndent",view:s=>({key:"style",value:{[n]:s}})})}_setupConversionUsingClasses(e){const t={model:{key:"blockIndent",values:[]},view:{}};for(const n of e)t.model.values.push(n),t.view[n]={key:"class",value:[n]};this.editor.conversion.attributeToAttribute(t)}}class sU{_definitions=new Set;get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach(t=>this._definitions.add(t)):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",(t,n,s)=>{if(!s.consumable.test(n.item,"attribute:linkHref")||!(n.item.is("selection")||s.schema.isInline(n.item)))return;const o=s.writer,a=o.document.selection;for(const c of this._definitions){const u=o.createAttributeElement("a",c.attributes,{priority:5});c.classes&&o.addClass(c.classes,u);for(const h in c.styles)o.setStyle(h,c.styles[h],u);o.setCustomProperty("link",!0,u),c.callback(n.attributeNewValue)?n.item.is("selection")?o.wrap(a.getFirstRange(),u):o.wrap(s.mapper.toViewRange(n.range),u):o.unwrap(s.mapper.toViewRange(n.range),u)}},{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:imageBlock",(t,n,{writer:s,mapper:o})=>{const a=o.toViewElement(n.item),c=Array.from(a.getChildren()).find(u=>u.is("element","a"));if(c)for(const u of this._definitions){const h=Ss(u.attributes);if(u.callback(n.attributeNewValue)){for(const[m,g]of h)m==="class"?s.addClass(g,c):s.setAttribute(m,g,c);u.classes&&s.addClass(u.classes,c);for(const m in u.styles)s.setStyle(m,u.styles[m],c)}else{for(const[m,g]of h)m==="class"?s.removeClass(g,c):s.removeAttribute(m,c);u.classes&&s.removeClass(u.classes,c);for(const m in u.styles)s.removeStyle(m,c)}}})}}}const oU=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,rU="^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))",aU=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,lU=/^((\w+:(\/{2,})?)|(\W))/i,cU=["https?","ftps?","mailto"],Sd="Ctrl+K";function uU(i){return i.is("attributeElement")&&!!i.getCustomProperty("link")}function iT(i,{writer:e}){const t=e.createAttributeElement("a",{href:i},{priority:5});return e.setCustomProperty("link",!0,t),t}function D2(i,e=cU){const t=String(i),n=e.join("|"),s=new RegExp(`${rU.replace("<protocols>",n)}`,"i");return dU(t,s)?t:"#"}function dU(i,e){return!!i.replace(oU,"").match(e)}function hU(i,e){const t={"Open in a new tab":i("Open in a new tab"),Downloadable:i("Downloadable")};return e.forEach(n=>("label"in n&&t[n.label]&&(n.label=t[n.label]),n)),e}function fU(i){const e=[];if(i)for(const[t,n]of Object.entries(i)){const s=Object.assign({},n,{id:`link${oO(t)}`});e.push(s)}return e}function cb(i,e){return i?e.checkAttribute(i.name,"linkHref"):!1}function mU(i){return aU.test(i)}function xw(i,e){const t=mU(i)?"mailto:":e,n=!!t&&!F2(i);return i&&n?t+i:i}function F2(i){return lU.test(i)}function gU(i){window.open(i,"_blank","noopener")}function ub(i){let e="";for(const t of i.getItems()){if(!t.is("$text")&&!t.is("$textProxy"))return;e+=t.data}return e}class pU extends me{manualDecorators=new Dt;automaticDecorators=new sU;restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document.selection,n=t.getSelectedElement()||Ze(t.getSelectedBlocks());cb(n,e.schema)?(this.value=n.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(n,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));for(const s of this.manualDecorators)s.value=this._getDecoratorStateFromModel(s.id)}execute(e,t={},n){const s=this.editor.model,o=s.document.selection,a=[],c=[];for(const u in t)t[u]?a.push(u):c.push(u);s.change(u=>{const h=w=>{u.setAttribute("linkHref",e,w),a.forEach(_=>u.setAttribute(_,!0,w)),c.forEach(_=>u.removeAttribute(_,w))},m=(w,_)=>{const v=ub(w);if(!v)return w;let C=n;if(C||(C=_&&_==v?e:v),C!=v){const T=u.createDocumentFragment();for(const j of w.getItems()){const Z=j;u.append(u.createText(Z.data,Z.getAttributes()),T)}const A=u.createRangeIn(T),L=bU(v,C);let z=0;for(const{offset:j,actual:Z,expected:ne}of L){const M=j+z,J=u.createRange(A.start.getShiftedBy(M),A.start.getShiftedBy(M+Z.length)),ie=wU(J,A).getAttributes(),Ee=Array.from(ie).filter(([ot])=>s.schema.getAttributeProperties(ot).isFormatting),Ve=u.createText(ne,Ee);h(Ve),u.remove(J),u.insert(Ve,J.start),z+=ne.length}return s.insertContent(T,w),u.createRange(w.start,w.start.getShiftedBy(C.length))}},g=w=>{const{plugins:_}=this.editor;if(u.setSelection(w.end),_.has("TwoStepCaretMovement"))_.get("TwoStepCaretMovement")._handleForwardMovement();else for(const v of["linkHref",...a,...c])u.removeSelectionAttribute(v)};if(o.isCollapsed){const w=o.getFirstPosition();if(o.hasAttribute("linkHref")){const _=o.getAttribute("linkHref"),v=Yh(w,"linkHref",_,s),C=m(v,_);h(C||v),C&&g(C)}else if(e!==""){const _=Ss(o.getAttributes());_.set("linkHref",e),a.forEach(C=>{_.set(C,!0)});const v=s.insertContent(u.createText(n||e,_),w);g(v)}}else{const w=Array.from(o.getRanges()),_=s.schema.getValidRanges(w,"linkHref"),v=[];for(const A of o.getSelectedBlocks())s.schema.checkAttribute(A,"linkHref")&&v.push(u.createRangeOn(A));const C=v.slice();for(const A of _)this._isRangeToUpdate(A,v)&&C.push(A);const T=w.map(A=>({start:wt.fromPosition(A.start,"toPrevious"),end:wt.fromPosition(A.end,"toNext")}));for(let A of C){const L=(A.start.textNode||A.start.nodeAfter).getAttribute("linkHref");A=m(A,L)||A,h(A)}u.setSelection(T.map(A=>{const L=A.start.toPosition(),z=A.end.toPosition();return A.start.detach(),A.end.detach(),s.createRange(L,z)}))}})}_getDecoratorStateFromModel(e){const t=this.editor.model,n=t.document.selection,s=n.getSelectedElement();return cb(s,t.schema)?s.getAttribute(e):n.getAttribute(e)}_isRangeToUpdate(e,t){for(const n of t)if(n.containsRange(e))return!1;return!0}}function bU(i,e){const t=fa(i,e),n={equal:0,insert:0,delete:0},s=[];let o="",a="";for(const c of[...t,null])c=="insert"?a+=e[n.equal+n.insert]:c=="delete"?o+=i[n.equal+n.delete]:(o.length||a.length)&&(s.push({offset:n.equal,actual:o,expected:a}),o="",a=""),c&&n[c]++;return s}function wU(i,e){if(!i.isCollapsed)return Ze(i.getItems());const t=i.start;return t.textNode?t.textNode:!t.nodeBefore||t.isEqual(e.start)?t.nodeAfter:t.nodeBefore}class _U extends me{refresh(){const e=this.editor.model,t=e.document.selection,n=t.getSelectedElement();cb(n,e.schema)?this.isEnabled=e.schema.checkAttribute(n,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref")}execute(){const e=this.editor,t=this.editor.model,n=t.document.selection,s=e.commands.get("link");t.change(o=>{const a=n.isCollapsed?[Yh(n.getFirstPosition(),"linkHref",n.getAttribute("linkHref"),t)]:t.schema.getValidRanges(n.getRanges(),"linkHref");for(const c of a)if(o.removeAttribute("linkHref",c),s)for(const u of s.manualDecorators)o.removeAttribute(u.id,c)})}}class yU extends qe(){id;defaultValue;label;attributes;classes;styles;constructor({id:e,label:t,attributes:n,classes:s,styles:o,defaultValue:a}){super(),this.id=e,this.set("value",void 0),this.defaultValue=a,this.label=t,this.attributes=n,this.classes=s,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}const vU="ck-link_selected",sT="automatic",CU="manual",kU=/^(https?:)?\/\//;class _h extends N{_linkOpeners=[];static get pluginName(){return"LinkEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[uh,WA,zn]}constructor(e){super(e),e.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1,toolbar:["linkPreview","|","editLink","linkProperties","unlink"]})}init(){const e=this.editor,t=this.editor.config.get("link.allowedProtocols");e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:iT}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(o,a)=>iT(D2(o,t),a)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:o=>o.getAttribute("href")}}),e.commands.add("link",new pU(e)),e.commands.add("unlink",new _U(e));const n=hU(e.t,fU(e.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter(o=>o.mode===sT)),this._enableManualDecorators(n.filter(o=>o.mode===CU)),e.plugins.get(uh).registerAttribute("linkHref"),KA(e,"linkHref","a",vU),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration()}_registerLinkOpener(e){this._linkOpeners.push(e)}_enableAutomaticDecorators(e){const t=this.editor,s=t.commands.get("link").automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&s.add({id:"linkIsExternal",mode:sT,callback:o=>!!o&&kU.test(o),attributes:{target:"_blank",rel:"noopener noreferrer"}}),s.add(e),s.length&&t.conversion.for("downcast").add(s.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,s=t.commands.get("link").manualDecorators;e.forEach(o=>{t.model.schema.extend("$text",{allowAttributes:o.id});const a=new yU(o);s.add(a),t.conversion.for("downcast").attributeToElement({model:a.id,view:(c,{writer:u,schema:h},{item:m})=>{if((m.is("selection")||h.isInline(m))&&c){const g=u.createAttributeElement("a",a.attributes,{priority:5});a.classes&&u.addClass(a.classes,g);for(const w in a.styles)u.setStyle(w,a.styles[w],g);return u.setCustomProperty("link",!0,g),g}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",...a._createPattern()},model:{key:a.id}})})}_enableLinkOpen(){const e=this.editor,n=e.editing.view.document,s=o=>{this._linkOpeners.some(a=>a(o))||gU(o)};this.listenTo(n,"click",(o,a)=>{if(!(le.isMac?a.domEvent.metaKey:a.domEvent.ctrlKey))return;let u=a.domTarget;if(u.tagName.toLowerCase()!="a"&&(u=u.closest("a")),!u)return;const h=u.getAttribute("href");h&&(o.stop(),a.preventDefault(),s(h))},{context:"$capture"}),this.listenTo(n,"keydown",(o,a)=>{const u=e.commands.get("link").value;u&&a.keyCode===ke.enter&&a.altKey&&(o.stop(),s(u))})}_enableSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection;this.listenTo(n,"change:attribute",(s,{attributeKeys:o})=>{!o.includes("linkHref")||n.hasAttribute("linkHref")||t.change(a=>{TU(a,EU(t.schema))})})}_enableClipboardIntegration(){const e=this.editor,t=e.model,n=this.editor.config.get("link.defaultProtocol");n&&this.listenTo(e.plugins.get("ClipboardPipeline"),"contentInsertion",(s,o)=>{t.change(a=>{const c=a.createRangeIn(o.content);for(const u of c.getItems())if(u.hasAttribute("linkHref")){const h=xw(u.getAttribute("linkHref"),n);a.setAttribute("linkHref",h,u)}})})}}function TU(i,e){i.removeSelectionAttribute("linkHref");for(const t of e)i.removeSelectionAttribute(t)}function EU(i){return i.getDefinition("$text").allowAttributes.filter(t=>t.startsWith("link"))}class SU extends ue{constructor(e){super(e);const t=this.bindTemplate;this.set({href:void 0,withText:!0}),this.extendTemplate({attributes:{class:["ck-link-toolbar__preview"],href:t.to("href"),target:"_blank",rel:"noopener noreferrer"},on:{click:t.to(n=>{if(this.href){const s=()=>n.preventDefault();this.fire("navigate",this.href,s)}})}}),this.template.tag="a"}}class AU extends oe{focusTracker=new dt;keystrokes=new Ct;backButtonView;saveButtonView;displayedTextInputView;urlInputView;children;providersListChildren;_validators;_focusables=new Gt;_focusCycler;constructor(e,t){super(e),this._validators=t,this.backButtonView=this._createBackButton(),this.saveButtonView=this._createSaveButton(),this.displayedTextInputView=this._createDisplayedTextInput(),this.urlInputView=this._createUrlInput(),this.providersListChildren=this.createCollection(),this.children=this.createCollection([this._createHeaderView()]),this._createFormChildren(),this.listenTo(this.providersListChildren,"add",()=>{this.stopListening(this.providersListChildren,"add"),this.children.add(this._createProvidersListView())}),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-link-form","ck-responsive-form"],tabindex:"-1"},children:this.children})}render(){super.render(),or({view:this}),[this.urlInputView,this.saveButtonView,...this.providersListChildren,this.backButtonView,this.displayedTextInputView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createBackButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:Ta,tooltip:!0}),t.delegate("execute").to(this,"cancel"),t}_createSaveButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({label:e("Insert"),tooltip:!1,withText:!0,type:"submit",class:"ck-button-action ck-button-bold"}),t}_createHeaderView(){const e=this.locale.t,t=new fo(this.locale,{label:e("Link")});return t.children.add(this.backButtonView,0),t}_createProvidersListView(){const e=new Sa(this.locale);return e.extendTemplate({attributes:{class:["ck-link-form__providers-list"]}}),e.items.bindTo(this.providersListChildren).using(t=>{const n=new vi(this.locale);return n.children.add(t),n}),e}_createDisplayedTextInput(){const e=this.locale.t,t=new Rt(this.locale,si);return t.label=e("Displayed text"),t.class="ck-labeled-field-view_full-width",t}_createUrlInput(){const e=this.locale.t,t=new Rt(this.locale,si);return t.fieldView.inputMode="url",t.label=e("Link URL"),t.class="ck-labeled-field-view_full-width",t}_createFormChildren(){this.children.add(new qt(this.locale,{children:[this.displayedTextInputView],class:["ck-form__row_large-top-padding"]})),this.children.add(new qt(this.locale,{children:[this.urlInputView,this.saveButtonView],class:["ck-form__row_with-submit","ck-form__row_large-top-padding","ck-form__row_large-bottom-padding"]}))}get url(){const{element:e}=this.urlInputView.fieldView;return e?e.value.trim():null}}class xU extends oe{focusTracker=new dt;keystrokes=new Ct;backButtonView;listView;listChildren;emptyListInformation;children;_focusables=new Gt;_focusCycler;constructor(e){super(e),this.listChildren=this.createCollection(),this.backButtonView=this._createBackButton(),this.listView=this._createListView(),this.emptyListInformation=this._createEmptyLinksListItemView(),this.children=this.createCollection([this._createHeaderView(),this.emptyListInformation]),this.set("title",""),this.set("emptyListPlaceholder",""),this.set("hasItems",!1),this.listenTo(this.listChildren,"change",()=>{this.hasItems=this.listChildren.length>0}),this.on("change:hasItems",(t,n,s)=>{s?(this.children.remove(this.emptyListInformation),this.children.add(this.listView)):(this.children.remove(this.listView),this.children.add(this.emptyListInformation))}),this.keystrokes.set("Esc",(t,n)=>{this.fire("cancel"),n()}),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-providers"],tabindex:"-1"},children:this.children})}render(){super.render(),[this.listView,this.backButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createListView(){const e=new Sa(this.locale);return e.extendTemplate({attributes:{class:["ck-link-providers__list"]}}),e.items.bindTo(this.listChildren).using(t=>{const n=new vi(this.locale);return n.children.add(t),n}),e}_createBackButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:Ta,tooltip:!0}),t.delegate("execute").to(this,"cancel"),t}_createHeaderView(){const e=new fo(this.locale);return e.bind("label").to(this,"title"),e.children.add(this.backButtonView,0),e}_createEmptyLinksListItemView(){const e=new oe(this.locale);return e.setTemplate({tag:"p",attributes:{class:["ck","ck-link__empty-list-info"]},children:[{text:this.bindTemplate.to("emptyListPlaceholder")}]}),e}}class IU extends oe{focusTracker=new dt;keystrokes=new Ct;backButtonView;children;listChildren;_focusables=new Gt;_focusCycler;constructor(e){super(e),this.backButtonView=this._createBackButton(),this.listChildren=this.createCollection(),this.children=this.createCollection([this._createHeaderView(),this._createListView()]),this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-properties"],tabindex:"-1"},children:this.children}),this.keystrokes.set("Esc",(t,n)=>{this.fire("back"),n()})}render(){super.render(),[...this.listChildren,this.backButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBackButton(){const e=this.locale.t,t=new ue(this.locale);return t.set({class:"ck-button-back",label:e("Back"),icon:Ta,tooltip:!0}),t.delegate("execute").to(this,"back"),t}_createHeaderView(){const e=this.locale.t,t=new fo(this.locale,{label:e("Link properties")});return t.children.add(this.backButtonView,0),t}_createListView(){const e=new Sa(this.locale);return e.extendTemplate({attributes:{class:["ck-link__list"]}}),e.items.bindTo(this.listChildren).using(t=>{const n=new vi(this.locale);return n.children.add(t),n}),e}}class PU extends ue{arrowView;constructor(e){super(e),this.set({withText:!0}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-link__button"]}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new ki;return e.content=aA,e}}const Ii="link-ui";class RU extends N{toolbarView=null;formView=null;linkProviderItemsView=null;propertiesView=null;_balloon;_linksProviders=new Dt;static get requires(){return[As,_h]}static get pluginName(){return"LinkUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;this.set("selectedLinkableText",void 0),e.editing.view.addObserver(n7),this._balloon=e.plugins.get(As),this._registerComponents(),this._registerEditingOpeners(),this._enableBalloonActivators(),e.conversion.for("editingDowncast").markerToHighlight({model:Ii,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:Ii,view:(n,{writer:s})=>{if(!n.markerRange.isCollapsed)return null;const o=s.createUIElement("span");return s.addClass(["ck-fake-link-selection","ck-fake-link-selection_collapsed"],o),o}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Create link"),keystroke:Sd},{label:t("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}destroy(){super.destroy(),this.propertiesView&&this.propertiesView.destroy(),this.formView&&this.formView.destroy(),this.toolbarView&&this.toolbarView.destroy(),this.linkProviderItemsView&&this.linkProviderItemsView.destroy()}registerLinksListProvider(e){const t=this._linksProviders.filter(n=>(n.order||0)<=(e.order||0)).length;this._linksProviders.add(e,t)}_createViews(){const e=this.editor.commands.get("link");this.toolbarView=this._createToolbarView(),this.formView=this._createFormView(),e.manualDecorators.length&&(this.propertiesView=this._createPropertiesView()),this._enableUserBalloonInteractions()}_createToolbarView(){const e=this.editor,t=new Qo(e.locale),n=e.commands.get("link");t.class="ck-link-toolbar";let s=e.config.get("link.toolbar");return n.manualDecorators.length||(s=s.filter(o=>o!=="linkProperties")),t.fillFromConfig(s,e.ui.componentFactory),t.keystrokes.set("Esc",(o,a)=>{this._hideUI(),a()}),t.keystrokes.set(Sd,(o,a)=>{this._addFormView(),a()}),e.ui.addToolbar(t,{isContextual:!0,beforeFocus:()=>{this._getSelectedLinkElement()&&!this._isToolbarVisible&&this._showUI(!0)},afterBlur:()=>{this._hideUI(!1)}}),t}_createFormView(){const e=this.editor,t=e.locale.t,n=e.commands.get("link"),s=e.config.get("link.defaultProtocol"),o=new(_c(AU))(e.locale,OU(e));return o.displayedTextInputView.bind("isEnabled").to(this,"selectedLinkableText",a=>a!==void 0),o.urlInputView.bind("isEnabled").to(n,"isEnabled"),o.saveButtonView.bind("isEnabled").to(n,"isEnabled"),o.saveButtonView.bind("label").to(n,"value",a=>t(a?"Update":"Insert")),this.listenTo(o,"submit",()=>{if(o.isValid()){const a=o.urlInputView.fieldView.element.value,c=xw(a,s),u=o.displayedTextInputView.fieldView.element.value;e.execute("link",c,this._getDecoratorSwitchesState(),u!==this.selectedLinkableText?u:void 0),this._closeFormView()}}),this.listenTo(o.urlInputView,"change:errorText",()=>{e.ui.update()}),this.listenTo(o,"cancel",()=>{this._closeFormView()}),o.keystrokes.set("Esc",(a,c)=>{this._closeFormView(),c()}),o.providersListChildren.bindTo(this._linksProviders).using(a=>this._createLinksListProviderButton(a)),o}_createLinkProviderListView(e){return e.getListItems().map(({href:t,label:n,icon:s})=>{const o=new ue;return o.set({label:n,icon:s,tooltip:!1,withText:!0}),o.on("execute",()=>{this.formView.resetFormStatus(),this.formView.urlInputView.fieldView.value=t,this.editor.editing.view.focus(),this._removeLinksProviderView(),this.formView.focus()}),o})}_createLinkProviderItemsView(e){const t=this.editor,n=t.locale.t,s=new xU(t.locale),{emptyListPlaceholder:o,label:a}=e;return s.emptyListPlaceholder=o||n("No links available"),s.title=a,this.listenTo(s,"cancel",()=>{t.editing.view.focus(),this._removeLinksProviderView(),this.formView.focus()}),s}_createPropertiesView(){const e=this.editor,t=this.editor.commands.get("link"),n=new(_c(IU))(e.locale);return this.listenTo(n,"back",()=>{e.editing.view.focus(),this._removePropertiesView()}),n.listChildren.bindTo(t.manualDecorators).using(s=>{const o=new Gh(e.locale);return o.set({label:s.label,withText:!0}),o.bind("isOn").toMany([s,t],"value",(a,c)=>c===void 0&&a===void 0?!!s.defaultValue:!!a),o.on("execute",()=>{s.set("value",!o.isOn),e.execute("link",t.value,this._getDecoratorSwitchesState())}),o}),n}_getDecoratorSwitchesState(){const e=this.editor.commands.get("link");return Array.from(e.manualDecorators).reduce((t,n)=>{const s=e.value===void 0&&n.value===void 0?n.defaultValue:n.value;return{...t,[n.id]:!!s}},{})}_registerEditingOpeners(){this.editor.plugins.get(_h)._registerLinkOpener(t=>{const n=this._getLinkProviderLinkByHref(t);if(!n)return!1;const{item:s,provider:o}=n;return o.navigate?o.navigate(s):!1})}_registerComponents(){const e=this.editor;e.ui.componentFactory.add("link",()=>{const t=this._createButton(ue);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:link",()=>{const t=this._createButton(tt);return t.set({role:"menuitemcheckbox"}),t}),e.ui.componentFactory.add("linkPreview",t=>{const n=new SU(t),s=e.config.get("link.allowedProtocols"),o=e.commands.get("link"),a=t.t;n.bind("isEnabled").to(o,"value",u=>!!u),n.bind("href").to(o,"value",u=>u&&D2(u,s));const c=u=>{if(!u){n.label=void 0,n.icon=void 0,n.tooltip=a("Open link in new tab");return}const h=this._getLinkProviderLinkByHref(u);if(h){const{label:m,tooltip:g,icon:w}=h.item;n.label=m,n.tooltip=g||!1,n.icon=w}else n.label=u,n.icon=void 0,n.tooltip=a("Open link in new tab")};return c(o.value),this.listenTo(o,"change:value",(u,h,m)=>{c(m)}),this.listenTo(n,"navigate",(u,h,m)=>{const g=this._getLinkProviderLinkByHref(h);if(!g)return;const{provider:w,item:_}=g,{navigate:v}=w;v&&v(_)&&(u.stop(),m())}),n}),e.ui.componentFactory.add("unlink",t=>{const n=e.commands.get("unlink"),s=new ue(t),o=t.t;return s.set({label:o("Unlink"),icon:YN,tooltip:!0}),s.bind("isEnabled").to(n),this.listenTo(s,"execute",()=>{e.execute("unlink"),this._hideUI()}),s}),e.ui.componentFactory.add("editLink",t=>{const n=e.commands.get("link"),s=new ue(t),o=t.t;return s.set({label:o("Edit link"),icon:AN,tooltip:!0}),s.bind("isEnabled").to(n),this.listenTo(s,"execute",()=>{this._addFormView()}),s}),e.ui.componentFactory.add("linkProperties",t=>{const n=e.commands.get("link"),s=new ue(t),o=t.t;return s.set({label:o("Link properties"),icon:NN,tooltip:!0}),s.bind("isEnabled").to(n,"isEnabled",n,"value",n,"manualDecorators",(a,c,u)=>a&&!!c&&u.length>0),this.listenTo(s,"execute",()=>{this._addPropertiesView()}),s})}_createLinksListProviderButton(e){const t=this.editor.locale,n=new PU(t);return n.set({label:e.label}),this.listenTo(n,"execute",()=>{this._showLinksProviderView(e)}),n}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("link"),o=new e(t.locale),a=n.t;return o.set({label:a("Link"),icon:gN,keystroke:Sd,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",c=>!!c),this.listenTo(o,"execute",()=>{t.editing.view.scrollToTheSelection(),this._showUI(!0),this._getSelectedLinkElement()&&this._addFormView()}),o}_enableBalloonActivators(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),e.keystrokes.set(Sd,(n,s)=>{s(),e.commands.get("link").isEnabled&&(e.editing.view.scrollToTheSelection(),this._showUI(!0))})}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Tab",(e,t)=>{this._isToolbarVisible&&!this.toolbarView.focusTracker.isFocused&&(this.toolbarView.focus(),t())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,t)=>{this._isUIVisible&&(this._hideUI(),t())}),sr({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>{this._hideUI(!1)}})}_addToolbarView(){this.toolbarView||this._createViews(),!this._isToolbarInPanel&&this._balloon.add({view:this.toolbarView,position:this._getBalloonPositionData(),balloonClassName:"ck-toolbar-container"})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const e=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this.formView.backButtonView.isVisible=e.isEnabled&&!!e.value,this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.selectedLinkableText=this._getSelectedLinkableText(),this.formView.displayedTextInputView.fieldView.value=this.selectedLinkableText||"",this.formView.urlInputView.fieldView.value=e.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions()}_addPropertiesView(){this.propertiesView||this._createViews(),!this._arePropertiesInPanel&&(this.propertiesView.disableCssTransitions(),this._balloon.add({view:this.propertiesView,position:this._getBalloonPositionData()}),this.propertiesView.enableCssTransitions(),this.propertiesView.focus())}_showLinksProviderView(e){this.linkProviderItemsView&&this._removeLinksProviderView(),this.linkProviderItemsView=this._createLinkProviderItemsView(e),this._addLinkProviderItemsView(e)}_addLinkProviderItemsView(e){this.linkProviderItemsView.listChildren.clear(),this.linkProviderItemsView.listChildren.addMany(this._createLinkProviderListView(e)),this._balloon.add({view:this.linkProviderItemsView,position:this._getBalloonPositionData()}),this.linkProviderItemsView.focus()}_closeFormView(){const e=this.editor.commands.get("link");this.selectedLinkableText=void 0,e.value!==void 0?this._removeFormView():this._hideUI()}_removePropertiesView(){this._arePropertiesInPanel&&this._balloon.remove(this.propertiesView)}_removeLinksProviderView(){this._isLinksListInPanel&&this._balloon.remove(this.linkProviderItemsView)}_removeFormView(e=!0){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.displayedTextInputView.fieldView.reset(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),e&&this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this.formView||this._createViews(),this._getSelectedLinkElement()?(this._isToolbarVisible?this._addFormView():this._addToolbarView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addToolbarView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(e=!0){const t=this.editor;this._isUIInPanel&&(this.stopListening(t.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e&&t.editing.view.focus(),this._removeLinksProviderView(),this._removePropertiesView(),this._removeFormView(e),this._isToolbarInPanel&&this._balloon.remove(this.toolbarView),this._hideFakeVisualSelection())}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let n=this._getSelectedLinkElement(),s=a();const o=()=>{const c=this._getSelectedLinkElement(),u=a();n&&!c||!n&&u!==s?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),n=c,s=u};function a(){return t.selection.focus.getAncestors().reverse().find(c=>c.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _arePropertiesInPanel(){return!!this.propertiesView&&this._balloon.hasView(this.propertiesView)}get _isLinksListInPanel(){return!!this.linkProviderItemsView&&this._balloon.hasView(this.linkProviderItemsView)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _isToolbarInPanel(){return!!this.toolbarView&&this._balloon.hasView(this.toolbarView)}get _isPropertiesVisible(){return!!this.propertiesView&&this._balloon.visibleView===this.propertiesView}get _isFormVisible(){return!!this.formView&&this._balloon.visibleView==this.formView}get _isToolbarVisible(){return!!this.toolbarView&&this._balloon.visibleView===this.toolbarView}get _isUIInPanel(){return this._arePropertiesInPanel||this._isLinksListInPanel||this._isFormInPanel||this._isToolbarInPanel}get _isUIVisible(){return this._isPropertiesVisible||this._isLinksListInPanel||this._isFormVisible||this._isToolbarVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document;if(this.editor.model.markers.has(Ii)){const s=this.editor.editing.mapper.markerNameToElements(Ii);if(s){const o=Array.from(s),a=e.createRange(e.createPositionBefore(o[0]),e.createPositionAfter(o[o.length-1]));return{target:e.domConverter.viewRangeToDom(a)}}}return{target:()=>{const s=this._getSelectedLinkElement();return s?e.domConverter.mapViewToDom(s):e.domConverter.viewRangeToDom(t.selection.getFirstRange())}}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection,n=t.getSelectedElement();if(t.isCollapsed||n&&ct(n))return Ip(t.getFirstPosition());{const s=t.getFirstRange().getTrimmed(),o=Ip(s.start),a=Ip(s.end);return!o||o!=a?null:e.createRangeIn(o).getTrimmed().isEqual(s)?o:null}}_getSelectedLinkableText(){const e=this.editor.model,t=this.editor.editing,n=this._getSelectedLinkElement();if(!n)return ub(e.document.selection.getFirstRange());const s=t.view.createRangeOn(n),o=t.mapper.toModelRange(s);return ub(o)}_getLinkProviderLinkByHref(e){if(!e)return null;for(const t of this._linksProviders){const n=t.getItem?t.getItem(e):t.getListItems().find(s=>s.href===e);if(n)return{provider:t,item:n}}return null}_showFakeVisualSelection(){const e=this.editor.model;e.change(t=>{const n=e.document.selection.getFirstRange();if(e.markers.has(Ii))t.updateMarker(Ii,{range:n});else if(n.start.isAtEnd){const s=n.start.getLastMatchingPosition(({item:o})=>!e.schema.isContent(o),{boundaries:n});t.addMarker(Ii,{usingOperation:!1,affectsData:!1,range:t.createRange(s,n.end)})}else t.addMarker(Ii,{usingOperation:!1,affectsData:!1,range:n})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(Ii)&&e.change(t=>{t.removeMarker(Ii)})}}function Ip(i){return i.getAncestors().find(e=>uU(e))||null}function OU(i){const e=i.t,t=i.config.get("link.allowCreatingEmptyLinks");return[n=>{if(!t&&!n.url.length)return e("Link URL must not be empty.")}]}const VU=4,z2=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63}))|localhost)(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),BU=2;class MU extends N{static get requires(){return[Is,_h]}static get pluginName(){return"AutoLink"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking()}_expandLinkRange(e,t){return t.textNode&&t.textNode.hasAttribute("linkHref")?Yh(t,"linkHref",t.textNode.getAttribute("linkHref"),e):null}_selectEntireLinks(e,t){const s=this.editor.model,o=s.document.selection,a=o.getFirstPosition(),c=o.getLastPosition();let u=t.getJoined(this._expandLinkRange(s,a)||t);u&&(u=u.getJoined(this._expandLinkRange(s,c)||t)),u&&(u.start.isBefore(a)||u.end.isAfter(c))&&e.setSelection(u)}_enablePasteLinking(){const e=this.editor,t=e.model,n=t.document.selection,s=e.plugins.get("ClipboardPipeline"),o=e.commands.get("link");s.on("inputTransformation",(a,c)=>{if(!this.isEnabled||!o.isEnabled||n.isCollapsed||c.method!=="paste"||n.rangeCount>1)return;const u=n.getFirstRange(),h=c.dataTransfer.getData("text/plain");if(!h)return;const m=h.match(z2);m&&m[2]===h&&(t.change(g=>{this._selectEntireLinks(g,u),o.execute(h)}),a.stop())},{priority:"high"})}_enableTypingHandling(){const e=this.editor,t=new AD(e.model,n=>{let s=n;if(!NU(s))return;s=s.slice(0,-1),"!.:,;?".includes(s[s.length-1])&&(s=s.slice(0,-1));const o=oT(s);if(o)return{url:o,removedTrailingCharacters:n.length-s.length}});t.on("matched:data",(n,s)=>{const{batch:o,range:a,url:c,removedTrailingCharacters:u}=s;if(!o.isTyping)return;const h=a.end.getShiftedBy(-u),m=h.getShiftedBy(-c.length),g=e.model.createRange(m,h);this._applyAutoLink(c,g)}),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,n=e.commands.get("enter");n&&n.on("execute",()=>{const s=t.document.selection.getFirstPosition();let o;s.parent.previousSibling?.is("element")?o=t.createRangeIn(s.parent.previousSibling):o=t.createRange(t.createPositionAt(s.parent,0),s),this._checkAndApplyAutoLinkOnRange(o)})}_enableShiftEnterHandling(){const e=this.editor,t=e.model,n=e.commands.get("shiftEnter");n&&n.on("execute",()=>{const s=t.document.selection.getFirstPosition(),o=t.createRange(t.createPositionAt(s.parent,0),s.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(o)})}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:n,range:s}=GA(e,t),o=oT(n);if(o){const a=t.createRange(s.end.getShiftedBy(-o.length),s.end);this._applyAutoLink(o,a)}}_applyAutoLink(e,t){const n=this.editor.model,s=this.editor.config.get("link.defaultProtocol"),o=xw(e,s);!this.isEnabled||!LU(t,n)||!F2(o)||DU(t)||this._persistAutoLink(o,t)}_persistAutoLink(e,t){const n=this.editor.model,s=this.editor.plugins.get("Delete");n.enqueueChange(o=>{o.setAttribute("linkHref",e,t),n.enqueueChange(()=>{s.requestUndoOnBackspace()})})}}function NU(i){return i.length>VU&&i[i.length-1]===" "&&i[i.length-2]!==" "}function oT(i){const e=z2.exec(i);return e?e[BU]:null}function LU(i,e){return e.schema.checkAttributeInSelection(e.createSelection(i),"linkHref")}function DU(i){const e=i.start.nodeAfter;return!!e&&e.hasAttribute("linkHref")}class FU extends N{static get requires(){return[_h,RU,MU]}static get pluginName(){return"Link"}static get isOfficialPlugin(){return!0}}class oi{_startElement;_referenceIndent;_isForward;_includeSelf;_sameAttributes;_sameIndent;_lowerIndent;_higherIndent;constructor(e,t){this._startElement=e,this._referenceIndent=e.getAttribute("listIndent"),this._isForward=t.direction=="forward",this._includeSelf=!!t.includeSelf,this._sameAttributes=st(t.sameAttributes||[]),this._sameIndent=!!t.sameIndent,this._lowerIndent=!!t.lowerIndent,this._higherIndent=!!t.higherIndent}static first(e,t){const s=new this(e,t)[Symbol.iterator]();return Ze(s)}*[Symbol.iterator](){const e=[];for(const{node:t}of new Fc(this._getStartNode(),this._isForward?"forward":"backward")){const n=t.getAttribute("listIndent");if(n<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=n}else if(n>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){e.push(t);continue}}else{if(!this._sameIndent){if(this._higherIndent){e.length&&(yield*e,e.length=0);break}continue}if(this._sameAttributes.some(s=>t.getAttribute(s)!==this._startElement.getAttribute(s)))break}e.length&&(yield*e,e.length=0),yield t}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}class Fc{_node;_isForward;_previousNodesByIndent=[];_previous=null;_previousNodeIndent=null;constructor(e,t="forward"){this._node=e,this._isForward=t==="forward"}[Symbol.iterator](){return this}next(){if(!je(this._node))return{done:!0,value:void 0};const e=this._node.getAttribute("listIndent");let t=null;if(this._previous){const s=this._previousNodeIndent;e>s?this._previousNodesByIndent[s]=this._previous:e<s?(t=this._previousNodesByIndent[e]||null,this._previousNodesByIndent.length=e):t=this._previous}const n={node:this._node,previous:this._previous,previousNodeInList:t};return this._previous=this._node,this._previousNodeIndent=e,this._node=this._isForward?this._node.nextSibling:this._node.previousSibling,{value:n,done:!1}}}class zU{_listHead;constructor(e){this._listHead=e}[Symbol.iterator](){return new Fc(this._listHead)}}class Ca{static next(){return rn()}}function je(i){return!!i&&i.is("element")&&i.hasAttribute("listItemId")}function Ps(i,e={}){return[...uo(i,{...e,direction:"backward"}),...uo(i,{...e,direction:"forward"})]}function uo(i,e={}){const t=e.direction=="forward",n=Array.from(new oi(i,{...e,includeSelf:t,sameIndent:!0,sameAttributes:"listItemId"}));return t?n:n.reverse()}function UU(i){return Array.from(new oi(i,{direction:"forward",higherIndent:!0}))}function U2(i,e){const t=new oi(i,{sameIndent:!0,sameAttributes:"listType",...e}),n=new oi(i,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...e});return[...Array.from(t).reverse(),...n]}function Di(i){return!oi.first(i,{sameIndent:!0,sameAttributes:"listItemId"})}function rT(i){return!oi.first(i,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function zc(i,e={}){i=st(i);const t=e.withNested!==!1,n=new Set;for(const s of i)for(const o of Ps(s,{higherIndent:t}))n.add(o);return lr(n)}function HU(i){i=st(i);const e=new Set;for(const t of i)for(const n of U2(t))e.add(n);return lr(e)}function Iw(i,e){const t=uo(i,{direction:"forward"}),n=Ca.next();for(const s of t)e.setAttribute("listItemId",n,s);return t}function db(i,e,t){const n={};for(const[o,a]of e.getAttributes())o.startsWith("list")&&(n[o]=a);const s=uo(i,{direction:"forward"});for(const o of s)t.setAttributes(n,o);return s}function hb(i,e,{expand:t,indentBy:n=1}={}){i=st(i);const s=t?zc(i):i;for(const o of s){const a=o.getAttribute("listIndent")+n;a<0?ef(o,e):e.setAttribute("listIndent",a,o)}return s}function jU(i,e){i=st(i);const t=zc(i),n=new Set,s=Math.min(...t.map(a=>a.getAttribute("listIndent"))),o=new Map;for(const a of t)o.set(a,oi.first(a,{lowerIndent:!0}));for(const a of t){if(n.has(a))continue;n.add(a);const c=a.getAttribute("listIndent")-1;if(c<0){ef(a,e);continue}if(a.getAttribute("listIndent")==s){const u=$U(a,o.get(a),e);for(const h of u)n.add(h);if(u.length)continue}e.setAttribute("listIndent",c,a)}return lr(n)}function ef(i,e){i=st(i);for(const t of i)t.is("element","listItem")&&e.rename(t,"paragraph");for(const t of i)for(const n of t.getAttributeKeys())n.startsWith("list")&&e.removeAttribute(n,t);return i}function Ec(i){if(!i.length)return!1;const e=i[0].getAttribute("listItemId");return e?!i.some(t=>t.getAttribute("listItemId")!=e):!1}function qU(i,e){const t=[];let n=Number.POSITIVE_INFINITY;for(const{node:s}of new Fc(i.nextSibling)){const o=s.getAttribute("listIndent");if(o==0)break;o<n&&(n=o);const a=o-n;e.setAttribute("listIndent",a,s),t.push(s)}return t}function lr(i){return Array.from(i).filter(e=>e.root.rootName!=="$graveyard").sort((e,t)=>e.index-t.index)}function Sc(i){const e=i.document.selection.getSelectedElement();return e&&i.schema.isObject(e)&&i.schema.isBlock(e)?e:null}function Pp(i,e){return e.checkChild(i.parent,"listItem")&&e.checkChild(i,"$text")&&!e.isObject(i)}function WU(i){return i=="numbered"||i=="customNumbered"}function $U(i,e,t){return uo(e,{direction:"forward"}).pop().index>i.index?db(i,e,t):[]}class aT extends me{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=lT(e.document.selection);e.change(n=>{const s=[];Ec(t)&&!Di(t[0])?(this._direction=="forward"&&s.push(...hb(t,n)),s.push(...Iw(t[0],n))):this._direction=="forward"?s.push(...hb(t,n,{expand:!0})):s.push(...jU(t,n));for(const o of s){if(!o.hasAttribute("listType"))continue;const a=oi.first(o,{sameIndent:!0});a&&n.setAttribute("listType",a.getAttribute("listType"),o)}this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",lr(new Set(e)))}_checkEnabled(){let e=lT(this.editor.model.document.selection),t=e[0];if(!t)return!1;if(this._direction=="backward"||Ec(e)&&!Di(e[0]))return!0;e=zc(e),t=e[0];const n=oi.first(t,{sameIndent:!0});return n?n.getAttribute("listType")==t.getAttribute("listType"):!1}}function lT(i){const e=Array.from(i.getSelectedBlocks()),t=e.findIndex(n=>!je(n));return t!=-1&&(e.length=t),e}class Wl extends me{type;_listWalkerOptions;constructor(e,t,n={}){super(e),this.type=t,this._listWalkerOptions=n.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.document,s=Sc(t),o=Array.from(n.selection.getSelectedBlocks()).filter(c=>t.schema.checkAttribute(c,"listType")||Pp(c,t.schema)),a=e.forceValue!==void 0?!e.forceValue:this.value;t.change(c=>{if(a){const u=o[o.length-1],h=uo(u,{direction:"forward"}),m=[];h.length>1&&m.push(...Iw(h[1],c)),m.push(...ef(o,c)),m.push(...qU(u,c)),this._fireAfterExecute(m)}else if((s||n.selection.isCollapsed)&&je(o[0])){const u=U2(s||o[0],this._listWalkerOptions);for(const h of u)c.setAttributes({...e.additionalAttributes,listType:this.type},h);this._fireAfterExecute(u)}else{const u=[];for(const h of o)if(!h.hasAttribute("listType"))!h.is("element","listItem")&&Pp(h,t.schema)&&c.rename(h,"listItem"),c.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:Ca.next(),listType:this.type},h),u.push(h);else for(const m of zc(h,{withNested:!1}))m.getAttribute("listType")!=this.type&&(c.setAttributes({...e.additionalAttributes,listType:this.type},m),u.push(m));this._fireAfterExecute(u)}})}_fireAfterExecute(e){this.fire("afterExecute",lr(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,t=Array.from(e.getSelectedBlocks());if(!t.length)return!1;for(const n of t)if(n.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model,t=e.schema,n=e.document.selection,s=Array.from(n.getSelectedBlocks());if(!s.length)return!1;if(this.value)return!0;for(const o of s)if(t.checkAttribute(o,"listType")||Pp(o,t))return!0;return!1}}class cT extends me{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const t=this.editor.model,n=t.document.selection,s=[];t.change(o=>{const{firstElement:a,lastElement:c}=this._getMergeSubjectElements(n,e),u=a.getAttribute("listIndent")||0,h=c.getAttribute("listIndent"),m=c.getAttribute("listItemId");if(u!=h){const g=UU(c);s.push(...hb([c,...g],o,{indentBy:u-h,expand:u<h}))}if(e){let g=n;n.isCollapsed&&(g=o.createSelection(o.createRange(o.createPositionAt(a,"end"),o.createPositionAt(c,0)))),t.deleteContent(g,{doNotResetEntireContent:n.isCollapsed});const w=g.getLastPosition().parent,_=w.nextSibling;s.push(w),_&&_!==c&&_.getAttribute("listItemId")==m&&s.push(...db(_,w,o))}else s.push(...db(c,a,o));this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",lr(new Set(e)))}_checkEnabled(){const e=this.editor.model,t=e.document.selection,n=Sc(e);if(t.isCollapsed||n){const s=n||t.getFirstPosition().parent;if(!je(s))return!1;const o=this._direction=="backward"?s.previousSibling:s.nextSibling;if(!o||Ec([s,o]))return!1}else{const s=t.getLastPosition(),o=t.getFirstPosition();if(s.parent===o.parent||!je(s.parent))return!1}return!0}_getMergeSubjectElements(e,t){const n=this.editor.model,s=Sc(n);let o,a;if(e.isCollapsed||s){const c=s||e.getFirstPosition().parent,u=Di(c);this._direction=="backward"?(a=c,u&&!t?o=oi.first(c,{sameIndent:!0,lowerIndent:!0}):o=c.previousSibling):(o=c,a=c.nextSibling)}else o=e.getFirstPosition().parent,a=e.getLastPosition().parent;return{firstElement:o,lastElement:a}}}class uT extends me{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(t=>{const n=Iw(this._getStartBlock(),t);this._fireAfterExecute(n)})}_fireAfterExecute(e){this.fire("afterExecute",lr(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,t=this._getStartBlock();return e.isCollapsed&&je(t)&&!Di(t)}_getStartBlock(){const t=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?t:t.nextSibling}}class GU extends N{static get pluginName(){return"ListItemBoldIntegration"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.plugins.get("ListFormatting"),n=e.plugins.get(Un);!e.plugins.has("BoldEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.registerFormatAttribute("bold","listItemBold"),n.registerDowncastStrategy({scope:"item",attributeName:"listItemBold",setAttributeOnDowncast(s,o,a,c){o&&(s.addClass("ck-list-marker-bold",a),le.isSafari&&!(c&&c.dataPipeline)&&s.setStyle("--ck-content-list-marker-dummy-bold","0",a))}}))}afterInit(){const e=this.editor,t=e.model;!e.plugins.has("BoldEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.schema.extend("$listItem",{allowAttributes:"listItemBold"}),t.schema.setAttributeProperties("listItemBold",{isFormatting:!0}),t.schema.addAttributeCheck(n=>{if(!n.last.getAttribute("listItemId"))return!1},"listItemBold"),e.conversion.for("upcast").attributeToAttribute({model:"listItemBold",view:{name:"li",classes:"ck-list-marker-bold"}}))}}class KU extends N{static get pluginName(){return"ListItemItalicIntegration"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.plugins.get("ListFormatting"),n=e.plugins.get(Un);!e.plugins.has("ItalicEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.registerFormatAttribute("italic","listItemItalic"),n.registerDowncastStrategy({scope:"item",attributeName:"listItemItalic",setAttributeOnDowncast(s,o,a,c){o&&(s.addClass("ck-list-marker-italic",a),le.isSafari&&!(c&&c.dataPipeline)&&s.setStyle("--ck-content-list-marker-dummy-italic","0",a))}}))}afterInit(){const e=this.editor,t=e.model;!e.plugins.has("ItalicEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.schema.extend("$listItem",{allowAttributes:"listItemItalic"}),t.schema.setAttributeProperties("listItemItalic",{isFormatting:!0}),t.schema.addAttributeCheck(n=>{if(!n.last.getAttribute("listItemId"))return!1},"listItemItalic"),e.conversion.for("upcast").attributeToAttribute({model:"listItemItalic",view:{name:"li",classes:"ck-list-marker-italic"}}))}}class YU extends N{static get pluginName(){return"ListItemFontSizeIntegration"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.plugins.get("ListFormatting"),n=e.plugins.get(Un);if(!e.plugins.has("FontSizeEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting"))return;const s=Tc(e.config.get("fontSize.options"));t.registerFormatAttribute("fontSize","listItemFontSize"),n.registerDowncastStrategy({scope:"item",attributeName:"listItemFontSize",setAttributeOnDowncast(o,a,c,u){if(a){const h=s.find(m=>m.model==a);h&&h.view&&typeof h.view!="string"?h.view.styles?(o.addClass("ck-list-marker-font-size",c),o.setStyle("--ck-content-list-marker-font-size",h.view.styles["font-size"],c)):h.view.classes&&(o.addClass(`ck-list-marker-font-size-${a}`,c),le.isSafari&&!(u&&u.dataPipeline)&&o.setStyle("--ck-content-list-marker-dummy-font-size","0",c)):(o.addClass("ck-list-marker-font-size",c),o.setStyle("--ck-content-list-marker-font-size",a,c))}}})}afterInit(){const e=this.editor,t=e.model;if(!e.plugins.has("FontSizeEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting"))return;t.schema.extend("$listItem",{allowAttributes:"listItemFontSize"}),t.schema.setAttributeProperties("listItemFontSize",{isFormatting:!0}),t.schema.addAttributeCheck(s=>{if(!s.last.getAttribute("listItemId"))return!1},"listItemFontSize"),e.conversion.for("upcast").elementToAttribute({model:{key:"listItemFontSize",value:s=>s.getStyle("--ck-content-list-marker-font-size")},view:{name:"li",classes:"ck-list-marker-font-size",styles:{"--ck-content-list-marker-font-size":/.*/}}});const n=Tc(e.config.get("fontSize.options"));for(const s of n)s.model&&s.view&&e.conversion.for("upcast").elementToAttribute({model:{key:"listItemFontSize",value:s.model},view:{name:"li",classes:`ck-list-marker-font-size-${s.model}`}})}}class JU extends N{static get pluginName(){return"ListItemFontColorIntegration"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.plugins.get("ListFormatting"),n=e.plugins.get(Un);!e.plugins.has("FontColorEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.registerFormatAttribute("fontColor","listItemFontColor"),n.registerDowncastStrategy({scope:"item",attributeName:"listItemFontColor",setAttributeOnDowncast(s,o,a){o&&(s.addClass("ck-list-marker-color",a),s.setStyle("--ck-content-list-marker-color",o,a))}}))}afterInit(){const e=this.editor,t=e.model;!e.plugins.has("FontColorEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.schema.extend("$listItem",{allowAttributes:"listItemFontColor"}),t.schema.setAttributeProperties("listItemFontColor",{isFormatting:!0}),t.schema.addAttributeCheck(n=>{if(!n.last.getAttribute("listItemId"))return!1},"listItemFontColor"),e.conversion.for("upcast").attributeToAttribute({model:{key:"listItemFontColor",value:n=>n.getStyle("--ck-content-list-marker-color")},view:{name:"li",classes:"ck-list-marker-color",styles:{"--ck-content-list-marker-color":/.*/}}}))}}class QU extends N{static get pluginName(){return"ListItemFontFamilyIntegration"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.plugins.get("ListFormatting"),n=e.plugins.get(Un);!e.plugins.has("FontFamilyEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.registerFormatAttribute("fontFamily","listItemFontFamily"),n.registerDowncastStrategy({scope:"item",attributeName:"listItemFontFamily",setAttributeOnDowncast(s,o,a){o&&(s.addClass("ck-list-marker-font-family",a),s.setStyle("--ck-content-list-marker-font-family",o,a))}}))}afterInit(){const e=this.editor,t=e.model;!e.plugins.has("FontFamilyEditing")||!this.editor.config.get("list.enableListItemMarkerFormatting")||(t.schema.extend("$listItem",{allowAttributes:"listItemFontFamily"}),t.schema.setAttributeProperties("listItemFontFamily",{isFormatting:!0}),t.schema.addAttributeCheck(n=>{if(!n.last.getAttribute("listItemId"))return!1},"listItemFontFamily"),e.conversion.for("upcast").attributeToAttribute({model:{key:"listItemFontFamily",value:n=>n.getStyle("--ck-content-list-marker-font-family")},view:{name:"li",classes:"ck-list-marker-font-family",styles:{"--ck-content-list-marker-font-family":/.*/}}}))}}class XU extends N{_loadedFormatting={};static get pluginName(){return"ListFormatting"}static get isOfficialPlugin(){return!0}static get requires(){return[GU,KU,YU,JU,QU]}constructor(e){super(e),e.config.define("list.enableListItemMarkerFormatting",!0)}afterInit(){this.editor.config.get("list.enableListItemMarkerFormatting")&&this._registerPostfixerForListItemFormatting()}_registerPostfixerForListItemFormatting(){const e=this.editor.model;e.document.registerPostFixer(t=>{const n=e.document.differ.getChanges(),s=new Set;let o=!1;for(const a of n)if(a.type==="attribute")(a.attributeKey=="listItemId"||a.attributeKey=="listType"||this._isInlineOrSelectionFormatting(a.attributeKey)||Object.values(this._loadedFormatting).includes(a.attributeKey))&&(je(a.range.start.nodeAfter)?s.add(a.range.start.nodeAfter):je(a.range.start.parent)&&s.add(a.range.start.parent));else if(je(a.position.nodeAfter)&&s.add(a.position.nodeAfter),je(a.position.nodeBefore)&&s.add(a.position.nodeBefore),je(a.position.parent)&&s.add(a.position.parent),a.type=="insert"&&a.name!="$text"){const c=t.createRangeIn(a.position.nodeAfter);for(const u of c.getItems())je(u)&&s.add(u)}for(const a of s){const c=ZU(e,a,Object.keys(this._loadedFormatting));for(const[u,h]of Object.entries(c)){const m=this._loadedFormatting[u];(h&&eH(t,a,m,h)||!h&&tH(t,a,m))&&(o=!0)}}return o})}registerFormatAttribute(e,t){this._loadedFormatting[e]=t}_isInlineOrSelectionFormatting(e){return e.replace(/^selection:/,"")in this._loadedFormatting}}function ZU(i,e,t){if(Di(e))return dT(i,e,t);const n=Ps(e);return dT(i,n[0],t)}function dT(i,e,t){if(!nH(e)||i.schema.isLimit(e))return Object.fromEntries(t.map(c=>[c]));if(e.isEmpty)return Object.fromEntries(t.map(c=>[c,e.getAttribute(`selection:${c}`)]));const n=new Set(t),s={},a=i.createRangeIn(e).getWalker({ignoreElementEnd:!0});for(const{item:c}of a){for(const u of n)if(i.schema.checkAttribute(c,u)){const h=c.getAttribute(u);h===void 0?(n.delete(u),s[u]=void 0):s[u]===void 0?s[u]=h:s[u]!==h&&(n.delete(u),s[u]=void 0)}else u in s||(s[u]=void 0);if(!n.size)break;i.schema.isLimit(c)&&a.jumpTo(i.createPositionAfter(c))}return s}function eH(i,e,t,n){const s=Ps(e);let o=!1;for(const a of s)(!a.hasAttribute(t)||a.getAttribute(t)!==n)&&(i.setAttribute(t,n,a),o=!0);return o}function tH(i,e,t){const n=Ps(e);let s=!1;for(const o of n)o.hasAttribute(t)&&(i.removeAttribute(t,o),s=!0);return s}function nH(i){return["numbered","bulleted","customNumbered","customBulleted"].includes(i.getAttribute("listType"))}class iH extends N{static get pluginName(){return"ListUtils"}static get isOfficialPlugin(){return!0}expandListBlocksToCompleteList(e){return HU(e)}isFirstBlockOfListItem(e){return Di(e)}isListItemBlock(e){return je(e)}expandListBlocksToCompleteItems(e,t={}){return zc(e,t)}isNumberedListType(e){return WU(e)}}function sH(i){return i.is("element","ol")||i.is("element","ul")}function fb(i){return i.is("element","li")}function oH(i){let e=0,t=i.parent;for(;t;){if(fb(t))e++;else{const n=t.previousSibling;n&&fb(n)&&e++}t=t.parent}return e}function rH(i,e,t,n=j2(t,e)){return i.createAttributeElement(H2(t),null,{priority:2*e/100-100,id:n})}function aH(i,e,t){return i.createAttributeElement("li",null,{priority:(2*e+1)/100-100,id:t})}function H2(i){return i=="numbered"||i=="customNumbered"?"ol":"ul"}function j2(i,e){return`list-${i}-${e}`}function gi(i,e,t){const n=i.nodeBefore;if(je(n)){let s=n;for(const{node:o}of new Fc(s,"backward"))if(s=o,t.has(s)||(t.add(s),e.has(n)))return;e.add(s)}else{const s=i.nodeAfter;je(s)&&e.add(s)}}function lH(i,e){let t=0,n=-1,s=null,o=!1;for(const{node:a}of i){const c=a.getAttribute("listIndent");if(c>t){let u;s===null?(s=c-t,u=t):(s>c&&(s=c),u=c-s),u>n+1&&(u=n+1),e.setAttribute("listIndent",u,a),o=!0,n=u}else s=null,t=c+1,n=c}return o}function cH(i,e,t){const n=new Set;let s=!1;for(const{node:o}of i){if(n.has(o))continue;let a=o.getAttribute("listType"),c=o.getAttribute("listItemId");if(e.has(c)&&(c=Ca.next()),e.add(c),o.is("element","listItem")){o.getAttribute("listItemId")!=c&&(t.setAttribute("listItemId",c,o),s=!0);continue}for(const u of uo(o,{direction:"forward"}))n.add(u),u.getAttribute("listType")!=a&&(c=Ca.next(),a=u.getAttribute("listType")),u.getAttribute("listItemId")!=c&&(t.setAttribute("listItemId",c,u),s=!0)}return s}function uH(){return(i,e,t)=>{const{writer:n,schema:s}=t;if(!e.modelRange)return;const o=Array.from(e.modelRange.getItems({shallow:!0})).filter(g=>s.checkAttribute(g,"listItemId"));if(!o.length)return;const a=e.viewItem.getAttribute("data-list-item-id")||Ca.next();t.consumable.consume(e.viewItem,{attributes:"data-list-item-id"});const c=oH(e.viewItem);let u=e.viewItem.parent&&e.viewItem.parent.is("element","ol")?"numbered":"bulleted";const h=o[0].getAttribute("listType");h&&(u=h);const m={listItemId:a,listIndent:c,listType:u};for(const g of o)g.hasAttribute("listItemId")||n.setAttributes(m,g);o.length>1&&o[1].getAttribute("listItemId")!=m.listItemId&&t.keepEmptyElement(o[0])}}function dH(i,e,t,n){return()=>{const u=i.document.differ.getChanges(),h=[],m=new Set,g=new Set,w=new Set;for(const _ of u)if(_.type=="insert"&&_.name!="$text")gi(_.position,m,w),_.attributes.has("listItemId")?g.add(_.position.nodeAfter):gi(_.position.getShiftedBy(_.length),m,w);else if(_.type=="remove"&&_.attributes.has("listItemId"))gi(_.position,m,w);else if(_.type=="attribute"){const v=_.range.start.nodeAfter;t.includes(_.attributeKey)?(gi(_.range.start,m,w),_.attributeNewValue===null?(gi(_.range.start.getShiftedBy(1),m,w),o(v)&&h.push(v)):g.add(v)):je(v)&&o(v)&&h.push(v)}for(const _ of m.values())h.push(...s(_,g));for(const _ of new Set(h))e.reconvertItem(_)};function s(u,h){const m=[],g=new Set,w=[];for(const{node:_,previous:v}of new Fc(u)){if(g.has(_))continue;const C=_.getAttribute("listIndent");v&&C<v.getAttribute("listIndent")&&(w.length=C+1),w[C]={modelAttributes:Object.fromEntries(Array.from(_.getAttributes()).filter(([A])=>t.includes(A))),modelElement:_};const T=uo(_,{direction:"forward"});for(const A of T)g.add(A),(o(A,T)||c(A,w,h))&&m.push(A)}return m}function o(u,h){const m=e.mapper.toViewElement(u);if(!m)return!1;if(a(m)||n.fire("checkElement",{modelElement:u,viewElement:m}))return!0;if(!u.is("element","paragraph")&&!u.is("element","listItem"))return!1;const w=W2(u,t,h);return w&&m.is("element","p")?!0:!!(!w&&m.is("element","span"))}function a(u){for(u=u.parent;u.is("attributeElement")&&["ol","ul","li"].includes(u.name);)u=u.parent;return!!(u.getCustomProperty("$structureSlotParent")&&!e.mapper.toModelElement(u))}function c(u,h,m){if(m.has(u))return!1;const g=e.mapper.toViewElement(u);let w=h.length-1;for(let _=g.parent;!_.is("editableElement");_=_.parent){const v=fb(_),C=sH(_);if(!C&&!v)continue;const T=`checkAttributes:${v?"item":"list"}`;if(n.fire(T,{viewElement:_,modelAttributes:h[w].modelAttributes,modelReferenceElement:h[w].modelElement}))break;if(C&&(w--,w<0))return!1}return!0}}function hT(i,e,t,{dataPipeline:n}={}){const s=wH(i,e);return(o,a,c)=>{const{writer:u,mapper:h,consumable:m}=c,g=a.item;if(!i.includes(a.attributeKey)||!s(g,m))return;const w={...c.options,dataPipeline:n},_=fH(g,h,t,u);q2(_,u,h),pH(_,u);const v=gH(g,_,e,u,w);bH(g,v,e,u,w)}}function hH(i){return(e,t,n)=>{const{writer:s,mapper:o}=n,a=e.name.split(":")[1];if(!i.checkAttribute(a,"listItemId"))return;const c=o.toViewPosition(t.position),u=t.position.getShiftedBy(t.length),h=o.toViewPosition(u,{isPhantom:!0}),g=s.createRange(c,h).getTrimmed().end.nodeBefore;g&&q2(g,s,o)}}function fT(i,{dataPipeline:e}={}){return(t,{writer:n})=>{if(!W2(t,i))return null;if(!e)return n.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const s=n.createContainerElement("p");return n.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function fH(i,e,t,n){const s=t.createRangeOn(i),a=e.toViewRange(s).getTrimmed().getWalker();for(const{item:c}of a)if(c.is("element")&&c.getCustomProperty("listItemMarker"))a.jumpTo(n.createPositionAfter(c));else if(c.is("element")&&!c.getCustomProperty("listItemWrapper"))return c}function mH(i,e){return(t,n)=>{if(n.modelPosition.offset>0)return;const s=n.modelPosition.parent;if(!je(s)||!i.some(h=>h.scope=="itemMarker"&&h.canInjectMarkerIntoElement&&h.canInjectMarkerIntoElement(s)))return;const o=n.mapper.toViewElement(s),a=e.createRangeIn(o),c=a.getWalker();let u=a.start;for(const{item:h}of c){if(h.is("element")&&n.mapper.toModelElement(h)||h.is("$textProxy"))break;h.is("element")&&h.getCustomProperty("listItemMarker")&&(u=e.createPositionAfter(h),c.skip(({previousPosition:m})=>!m.isEqual(u)))}n.viewPosition=u}}function q2(i,e,t){for(;i.parent.is("attributeElement")&&i.parent.getCustomProperty("listItemWrapper");)e.unwrap(e.createRangeOn(i),i.parent);const n=[];s(e.createPositionBefore(i).getWalker({direction:"backward"})),s(e.createRangeIn(i).getWalker());for(const o of n)e.remove(o);function s(o){for(const{item:a}of o){if(a.is("element")&&t.toModelElement(a))break;a.is("element")&&a.getCustomProperty("listItemMarker")&&n.push(a)}}}function gH(i,e,t,n,{dataPipeline:s}){let o=n.createRangeOn(e);if(!Di(i))return o;for(const a of t){if(a.scope!="itemMarker")continue;const c=a.createElement(n,i,{dataPipeline:s});if(!c||(n.setCustomProperty("listItemMarker",!0,c),a.canInjectMarkerIntoElement&&a.canInjectMarkerIntoElement(i)?n.insert(n.createPositionAt(e,0),c):(n.insert(o.start,c),o=n.createRange(n.createPositionBefore(c),n.createPositionAfter(e))),!a.createWrapperElement||!a.canWrapElement))continue;const u=a.createWrapperElement(n,i,{dataPipeline:s});n.setCustomProperty("listItemWrapper",!0,u),a.canWrapElement(i)?o=n.wrap(o,u):(o=n.wrap(n.createRangeOn(c),u),o=n.createRange(o.start,n.createPositionAfter(e)))}return o}function pH(i,e){let t=i.parent;for(;t.is("attributeElement")&&["ul","ol","li"].includes(t.name);){const n=t.parent;e.unwrap(e.createRangeOn(i),t),t=n}}function bH(i,e,t,n,s){if(!i.hasAttribute("listIndent"))return;const o=i.getAttribute("listIndent");let a=i;for(let c=o;c>=0;c--){const u=aH(n,c,a.getAttribute("listItemId")),h=rH(n,c,a.getAttribute("listType"));for(const m of t)(m.scope=="list"||m.scope=="item")&&a.hasAttribute(m.attributeName)&&m.setAttributeOnDowncast(n,a.getAttribute(m.attributeName),m.scope=="list"?h:u,s,a);if(e=n.wrap(e,u),e=n.wrap(e,h),c==0||(a=oi.first(a,{lowerIndent:!0}),!a))break}}function wH(i,e){const t=e.filter(n=>n.consume===!1).map(n=>n.attributeName);return(n,s)=>{const o=[];for(const a of i)n.hasAttribute(a)&&!t.includes(a)&&o.push(`attribute:${a}`);return o.every(a=>s.test(n,a)!==!1)?(o.forEach(a=>s.consume(n,a)),!0):!1}}function W2(i,e,t=Ps(i)){if(!je(i))return!1;for(const n of i.getAttributeKeys())if(!(n.startsWith("selection:")||n=="htmlEmptyBlock")&&!e.includes(n))return!1;return t.length<2}const qd=["listType","listIndent","listItemId"];class Un extends N{_downcastStrategies=[];static get pluginName(){return"ListEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Jh,Is,iH,zn,XU]}constructor(e){super(e),e.config.define("list.multiBlock",!0)}init(){const e=this.editor,t=e.model,n=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new E("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});t.schema.register("$listItem",{allowAttributes:qd}),n?(t.schema.extend("$container",{allowAttributesOf:"$listItem"}),t.schema.extend("$block",{allowAttributesOf:"$listItem"}),t.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):t.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(const s of qd)t.schema.setAttributeProperties(s,{copyOnReplace:!0});e.commands.add("numberedList",new Wl(e,"numbered")),e.commands.add("bulletedList",new Wl(e,"bulleted")),e.commands.add("customNumberedList",new Wl(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new Wl(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new aT(e,"forward")),e.commands.add("outdentList",new aT(e,"backward")),e.commands.add("splitListItemBefore",new uT(e,"before")),e.commands.add("splitListItemAfter",new uT(e,"after")),n&&(e.commands.add("mergeListItemBackward",new cT(e,"backward")),e.commands.add("mergeListItemForward",new cT(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration(),this._setupListItemIdConversionStrategy()}afterInit(){const t=this.editor.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentList"),{priority:"high"}),s&&s.registerChildCommand(t.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[...qd,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,t=e.commands.get("mergeListItemBackward"),n=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(s,o)=>{const a=e.model.document.selection;Sc(e.model)||e.model.change(()=>{const c=a.getFirstPosition();if(a.isCollapsed&&o.direction=="backward"){if(!c.isAtStart)return;const u=c.parent;if(!je(u))return;if(!oi.first(u,{sameAttributes:"listType",sameIndent:!0})&&u.getAttribute("listIndent")===0)rT(u)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!t||!t.isEnabled)return;t.execute({shouldMergeOnBlocksContentLevel:mT(e.model,"backward")})}o.preventDefault(),s.stop()}else{if(a.isCollapsed&&!a.getLastPosition().isAtEnd||!n||!n.isEnabled)return;n.execute({shouldMergeOnBlocksContentLevel:mT(e.model,"forward")}),o.preventDefault(),s.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,t=e.model,n=e.commands,s=n.get("enter");this.listenTo(e.editing.view.document,"enter",(o,a)=>{const c=t.document,u=c.selection.getFirstPosition().parent;if(c.selection.isCollapsed&&je(u)&&u.isEmpty&&!a.isSoft){const h=Di(u),m=rT(u);h&&m?(e.execute("outdentList"),a.preventDefault(),o.stop()):h&&!m?(e.execute("splitListItemAfter"),a.preventDefault(),o.stop()):m&&(e.execute("splitListItemBefore"),a.preventDefault(),o.stop())}},{context:"li"}),this.listenTo(s,"afterExecute",()=>{const o=n.get("splitListItemBefore");if(o.refresh(),!o.isEnabled)return;const c=e.model.document.selection.getLastPosition().parent;Ps(c).length===2&&o.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(t,n)=>{const s=n.shiftKey?"outdentList":"indentList";this.editor.commands.get(s).isEnabled&&(e.execute(s),n.stopPropagation(),n.preventDefault(),t.stop())},{context:"li"})}_setupConversion(){const e=this.editor,t=e.model,n=this.getListAttributeNames(),s=e.config.get("list.multiBlock"),o=s?"paragraph":"listItem";e.conversion.for("upcast").elementToElement({view:"li",model:(c,{writer:u})=>u.createElement(o,{listType:""})}).elementToElement({view:"p",model:(c,{writer:u})=>c.parent&&c.parent.is("element","li")?u.createElement(o,{listType:""}):null,converterPriority:"high"}).add(c=>{c.on("element:li",uH())}),s||e.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion.for("editingDowncast").elementToElement({model:o,view:fT(n),converterPriority:"high"}).add(c=>{c.on("attribute",hT(n,this._downcastStrategies,t)),c.on("remove",hH(t.schema))}),e.conversion.for("dataDowncast").elementToElement({model:o,view:fT(n,{dataPipeline:!0}),converterPriority:"high"}).add(c=>{c.on("attribute",hT(n,this._downcastStrategies,t,{dataPipeline:!0}))});const a=mH(this._downcastStrategies,e.editing.view);e.editing.mapper.on("modelToViewPosition",a),e.data.mapper.on("modelToViewPosition",a),this.listenTo(t.document,"change:data",dH(t,e.editing,n,this),{priority:"high"}),this.on("checkAttributes:item",(c,{viewElement:u,modelAttributes:h})=>{u.id!=h.listItemId&&(c.return=!0,c.stop())}),this.on("checkAttributes:list",(c,{viewElement:u,modelAttributes:h})=>{(u.name!=H2(h.listType)||u.id!=j2(h.listType,h.listIndent))&&(c.return=!0,c.stop())})}_setupModelPostFixing(){const e=this.editor.model,t=this.getListAttributeNames();e.document.registerPostFixer(n=>_H(e,n,t,this)),this.on("postFixer",(n,{listNodes:s,writer:o})=>{n.return=lH(s,o)||n.return},{priority:"high"}),this.on("postFixer",(n,{listNodes:s,writer:o,seenIds:a})=>{n.return=cH(s,a,o)||n.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model,t=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",yH(e),{priority:"high"}),this.listenTo(t,"outputTransformation",(n,s)=>{e.change(o=>{const a=Array.from(s.content.getChildren()),c=a[a.length-1];if(a.length>1&&c.is("element")&&c.isEmpty&&a.slice(0,-1).every(je)&&o.remove(c),s.method=="copy"||s.method=="cut"){const u=Array.from(s.content.getChildren());Ec(u)&&ef(u,o)}})})}_setupAccessibilityIntegration(){const e=this.editor,t=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:t("Keystrokes that can be used in a list"),keystrokes:[{label:t("Increase list item indent"),keystroke:"Tab"},{label:t("Decrease list item indent"),keystroke:"Shift+Tab"}]})}_setupListItemIdConversionStrategy(){this.registerDowncastStrategy({scope:"item",attributeName:"listItemId",setAttributeOnDowncast(e,t,n,s){s&&(s.skipListItemIds||s.isClipboardPipeline)||e.setAttribute("data-list-item-id",t,n)}})}}function _H(i,e,t,n){const s=i.document.differ.getChanges(),o=new Set,a=new Set,c=n.editor.config.get("list.multiBlock");let u=!1;for(const m of s){if(m.type=="insert"&&m.name!="$text"){const g=m.position.nodeAfter;if(!i.schema.checkAttribute(g,"listItemId"))for(const w of Array.from(g.getAttributeKeys()))t.includes(w)&&(e.removeAttribute(w,g),u=!0);gi(m.position,a,o),m.attributes.has("listItemId")||gi(m.position.getShiftedBy(m.length),a,o);for(const{item:w,previousPosition:_}of i.createRangeIn(g))je(w)&&gi(_,a,o)}else m.type=="remove"?gi(m.position,a,o):m.type=="attribute"&&t.includes(m.attributeKey)&&(gi(m.range.start,a,o),m.attributeNewValue===null&&gi(m.range.start.getShiftedBy(1),a,o));if(!c&&m.type=="attribute"&&qd.includes(m.attributeKey)){const g=m.range.start.nodeAfter;m.attributeNewValue===null&&g&&g.is("element","listItem")?(e.rename(g,"paragraph"),u=!0):m.attributeOldValue===null&&g&&g.is("element")&&g.name!="listItem"&&(e.rename(g,"listItem"),u=!0)}}const h=new Set;for(const m of a.values())u=n.fire("postFixer",{listNodes:new zU(m),listHead:m,writer:e,seenIds:h})||u;return u}function yH(i){return(e,[t,n])=>{const s=t.is("documentFragment")?Array.from(t.getChildren()):[t];if(!s.length)return;const a=(n?i.createSelection(n):i.document.selection).getFirstPosition();let c;if(je(a.parent))c=a.parent;else if(je(a.nodeBefore)&&je(a.nodeAfter))c=a.nodeBefore;else return;i.change(u=>{const h=c.getAttribute("listType"),m=c.getAttribute("listIndent"),g=s[0].getAttribute("listIndent")||0,w=Math.max(m-g,0);for(const _ of s){const v=je(_);c.is("element","listItem")&&_.is("element","paragraph")&&u.rename(_,"listItem"),u.setAttributes({listIndent:(v?_.getAttribute("listIndent"):0)+w,listItemId:v?_.getAttribute("listItemId"):Ca.next(),listType:h},_)}})}}function mT(i,e){const t=i.document.selection;if(!t.isCollapsed)return!Sc(i);if(e==="forward")return!0;const s=t.getFirstPosition().parent,o=s.previousSibling;return i.schema.isObject(o)?!1:o.isEmpty?!0:Ec([s,o])}function mb(i,e,t,n){i.ui.componentFactory.add(e,()=>{const s=gT(ue,i,e,t,n);return s.set({tooltip:!0,isToggleable:!0}),s}),i.ui.componentFactory.add(`menuBar:${e}`,()=>{const s=gT(tt,i,e,t,n);return s.set({role:"menuitemcheckbox",isToggleable:!0}),s})}function gT(i,e,t,n,s){const o=e.commands.get(t),a=new i(e.locale);return a.set({label:n,icon:s}),a.bind("isOn","isEnabled").to(o,"value","isEnabled"),a.on("execute",()=>{e.execute(t),e.editing.view.focus()}),a}class vH extends N{static get pluginName(){return"ListUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||mb(this.editor,"numberedList",e("Numbered List"),_N),this.editor.ui.componentFactory.has("bulletedList")||mb(this.editor,"bulletedList",e("Bulleted List"),tN)}}class CH extends N{static get requires(){return[Un,vH]}static get pluginName(){return"List"}static get isOfficialPlugin(){return!0}}const kH=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:i,typeAttribute:e,listType:t}of kH);class TH extends me{constructor(e){super(e),this.on("execute",()=>{this.refresh()},{priority:"highest"})}refresh(){const e=this._getSelectedItems();this.value=this._getValue(e),this.isEnabled=!!e.length}execute(e={}){this.editor.model.change(t=>{const n=this._getSelectedItems(),s=e.forceValue===void 0?!this._getValue(n):e.forceValue;for(const o of n)s?t.setAttribute("todoListChecked",!0,o):t.removeAttribute("todoListChecked",o)})}_getValue(e){return e.every(t=>t.getAttribute("todoListChecked"))}_getSelectedItems(){const e=this.editor.model,t=e.schema,n=e.document.selection.getFirstRange(),s=n.start.parent,o=[];t.checkAttribute(s,"todoListChecked")&&o.push(...Ps(s));for(const a of n.getItems({shallow:!0}))t.checkAttribute(a,"todoListChecked")&&!o.includes(a)&&o.push(...Ps(a));return o}}class EH extends Ci{domEventType=["change"];onDomEvent(e){if(e.target){const t=this.view.domConverter.mapDomToView(e.target);t&&t.is("element","input")&&t.getAttribute("type")=="checkbox"&&t.findAncestor({classes:"todo-list__label"})&&this.fire("todoCheckboxChange",e)}}}const SH=Dh("Ctrl+Enter");class AH extends N{static get pluginName(){return"TodoListEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Un]}init(){const e=this.editor,t=e.model,n=e.editing,s=e.plugins.get(Un),a=e.config.get("list.multiBlock")?"paragraph":"listItem";e.commands.add("todoList",new Wl(e,"todo")),e.commands.add("checkTodoList",new TH(e)),n.view.addObserver(EH),t.schema.extend("$listItem",{allowAttributes:"todoListChecked"}),t.schema.addAttributeCheck(c=>{const u=c.last;if(!u.getAttribute("listItemId")||u.getAttribute("listType")!="todo")return!1},"todoListChecked"),e.conversion.for("upcast").add(c=>{c.on("element:input",IH()),c.on("element:li",xH(),{priority:"low"}),c.on("element:label",Rp({name:"label",classes:"todo-list__label"})),c.on("element:label",Rp({name:"label",classes:["todo-list__label","todo-list__label_without-description"]})),c.on("element:span",Rp({name:"span",classes:"todo-list__label__description"})),c.on("element:ul",PH({name:"ul",classes:"todo-list"}))}),e.conversion.for("downcast").elementToElement({model:a,view:(c,{writer:u})=>{if(Ad(c,s.getListAttributeNames()))return u.createContainerElement("span",{class:"todo-list__label__description"})},converterPriority:"highest"}),s.registerDowncastStrategy({scope:"list",attributeName:"listType",setAttributeOnDowncast(c,u,h){u=="todo"?c.addClass("todo-list",h):c.removeClass("todo-list",h)}}),s.registerDowncastStrategy({scope:"itemMarker",attributeName:"todoListChecked",createElement(c,u,{dataPipeline:h}){if(u.getAttribute("listType")!="todo")return null;const m=c.createUIElement("input",{type:"checkbox",...u.getAttribute("todoListChecked")?{checked:"checked"}:null,...h?{disabled:"disabled"}:{tabindex:"-1"}});if(h)return m;const g=c.createContainerElement("span",{contenteditable:"false"},m);return g.getFillerOffset=()=>null,g},canWrapElement(c){return Ad(c,s.getListAttributeNames())},createWrapperElement(c,u,{dataPipeline:h}){const m=["todo-list__label"];return Ad(u,s.getListAttributeNames())||m.push("todo-list__label_without-description"),c.createAttributeElement(h?"label":"span",{class:m.join(" ")})}}),s.on("checkElement",(c,{modelElement:u,viewElement:h})=>{const m=Ad(u,s.getListAttributeNames());h.hasClass("todo-list__label__description")!=m&&(c.return=!0,c.stop())}),s.on("checkElement",(c,{modelElement:u,viewElement:h})=>{const m=u.getAttribute("listType")=="todo"&&Di(u);let g=!1;const w=e.editing.view.createPositionBefore(h).getWalker({direction:"backward"});for(const{item:_}of w){if(_.is("element")&&e.editing.mapper.toModelElement(_))break;_.is("element","input")&&_.getAttribute("type")=="checkbox"&&(g=!0)}g!=m&&(c.return=!0,c.stop())}),s.on("postFixer",(c,{listNodes:u,writer:h})=>{for(const{node:m,previousNodeInList:g}of u){if(!g||g.getAttribute("listItemId")!=m.getAttribute("listItemId"))continue;const w=g.hasAttribute("todoListChecked"),_=m.hasAttribute("todoListChecked");_&&!w?(h.removeAttribute("todoListChecked",m),c.return=!0):!_&&w&&(h.setAttribute("todoListChecked",!0,m),c.return=!0)}}),t.document.registerPostFixer(c=>{const u=t.document.differ.getChanges();let h=!1;for(const m of u)if(m.type=="attribute"&&m.attributeKey=="listType"){const g=m.range.start.nodeAfter;m.attributeOldValue=="todo"&&g.hasAttribute("todoListChecked")&&(c.removeAttribute("todoListChecked",g),h=!0)}else if(m.type=="insert"&&m.name!="$text")for(const{item:g}of c.createRangeOn(m.position.nodeAfter))g.is("element")&&g.getAttribute("listType")!="todo"&&g.hasAttribute("todoListChecked")&&(c.removeAttribute("todoListChecked",g),h=!0);return h}),this.listenTo(n.view.document,"keydown",(c,u)=>{Go(u)===SH&&(e.execute("checkTodoList"),c.stop())},{priority:"high"}),this.listenTo(n.view.document,"todoCheckboxChange",(c,u)=>{const h=u.target;if(!h||!h.is("element","input"))return;const m=n.view.createPositionAfter(h),w=n.mapper.toModelPosition(m).parent;w&&je(w)&&w.getAttribute("listType")=="todo"&&this._handleCheckmarkChange(w)}),this.listenTo(n.view.document,"arrowKey",OH(t,e.locale),{context:"$text"}),this.listenTo(n.mapper,"viewToModelPosition",(c,u)=>{const h=u.viewPosition.parent,m=h.is("attributeElement","li")&&u.viewPosition.offset==0,g=pT(h)&&u.viewPosition.offset<=1,w=h.is("element","span")&&h.getAttribute("contenteditable")=="false"&&pT(h.parent);if(!m&&!g&&!w)return;const _=u.modelPosition.nodeAfter;_&&_.getAttribute("listType")=="todo"&&(u.modelPosition=t.createPositionAt(_,0))},{priority:"low"}),this._initAriaAnnouncements()}_handleCheckmarkChange(e){const t=this.editor,n=t.model,s=Array.from(n.document.selection.getRanges());n.change(o=>{o.setSelection(e,"end"),t.execute("checkTodoList"),o.setSelection(s)})}_initAriaAnnouncements(){const{model:e,ui:t,t:n}=this.editor;let s=null;t&&e.document.selection.on("change:range",()=>{const o=e.document.selection.focus.parent,a=bT(s),c=bT(o);a&&!c?t.ariaLiveAnnouncer.announce(n("Leaving a to-do list")):!a&&c&&t.ariaLiveAnnouncer.announce(n("Entering a to-do list")),s=o})}}function xH(){return(i,e,t)=>{const{writer:n,schema:s}=t;if(!e.modelRange)return;const o=Array.from(e.modelRange.getItems({shallow:!0})).filter(a=>a.getAttribute("listType")==="todo"&&s.checkAttribute(a,"listItemId")).reduce((a,c)=>{const u=c.getAttribute("listItemId");return a.has(u)||a.set(u,Ps(c)),a},new Map);for(const[,a]of o.entries())if(a.some(c=>c.getAttribute("todoListChecked")))for(const c of a)n.setAttribute("todoListChecked",!0,c)}}function IH(){return(i,e,t)=>{const n=e.modelCursor,s=n.parent,o=e.viewItem;if(!t.consumable.test(o,{name:!0})||o.getAttribute("type")!="checkbox"||!n.isAtStart||!s.hasAttribute("listType"))return;t.consumable.consume(o,{name:!0});const a=t.writer;a.setAttribute("listType","todo",s),e.viewItem.hasAttribute("checked")&&a.setAttribute("todoListChecked",!0,s),e.modelRange=a.createRange(n)}}function Rp(i){const e=new Ko(i);return(t,n,s)=>{const o=e.match(n.viewItem);o&&s.consumable.consume(n.viewItem,o.match)&&Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor))}}function PH(i){const e=new Ko(i);return(t,n,s)=>{const o=e.match(n.viewItem);if(!o)return;const a=o.match;a.name=!1,s.consumable.consume(n.viewItem,a)}}function Ad(i,e){return(i.is("element","paragraph")||i.is("element","listItem"))&&i.getAttribute("listType")=="todo"&&Di(i)&&RH(i,e)}function RH(i,e){for(const t of i.getAttributeKeys())if(!t.startsWith("selection:")&&!e.includes(t))return!1;return!0}function OH(i,e){return(t,n)=>{const s=Fh(n.keyCode,e.contentLanguageDirection),o=i.schema,a=i.document.selection;if(!a.isCollapsed)return;const c=a.getFirstPosition(),u=c.parent;if(s=="right"&&c.isAtEnd){const h=o.getNearestSelectionRange(i.createPositionAfter(u),"forward");if(!h)return;const m=h.start.parent;m&&je(m)&&m.getAttribute("listType")=="todo"&&(i.change(g=>g.setSelection(h)),n.preventDefault(),n.stopPropagation(),t.stop())}else if(s=="left"&&c.isAtStart&&je(u)&&u.getAttribute("listType")=="todo"){const h=o.getNearestSelectionRange(i.createPositionBefore(u),"backward");if(!h)return;i.change(m=>m.setSelection(h)),n.preventDefault(),n.stopPropagation(),t.stop()}}}function pT(i){return!!i&&i.is("attributeElement")&&i.hasClass("todo-list__label")}function bT(i){return!i||!i.is("element","paragraph")&&!i.is("element","listItem")?!1:i.getAttribute("listType")=="todo"}class VH extends N{static get pluginName(){return"TodoListUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor.t;mb(this.editor,"todoList",e("To-do List"),GN)}}class BH extends N{static get requires(){return[AH,VH]}static get pluginName(){return"TodoList"}static get isOfficialPlugin(){return!0}}function wT(i,e){const t=(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const a=s.attributeNewValue,c=o.writer,u=o.mapper.toViewElement(s.item),h=[...u.getChildren()].find(g=>g.getCustomProperty("media-content"));c.remove(h);const m=i.getMediaViewElement(c,a,e);c.insert(c.createPositionAt(u,0),m)};return n=>{n.on("attribute:url:media",t)}}function MH(i,e,t){return e.setCustomProperty("media",!0,i),Qh(i,e,{label:t})}function _T(i,e,t,n){return i.createContainerElement("figure",{class:"media"},[e.getMediaViewElement(i,t,n),i.createSlot()])}function yT(i){const e=i.getSelectedElement();return e&&e.is("element","media")?e:null}function $2(i,e,t,n){i.change(s=>{const o=s.createElement("media",{url:e});i.insertObject(o,t,null,{setSelection:"on",findOptimalPosition:n?"auto":void 0})})}class NH extends me{refresh(){const e=this.editor.model,t=e.document.selection,n=yT(t);this.value=n?n.getAttribute("url"):void 0,this.isEnabled=DH(t)||LH(t,e)}execute(e){const t=this.editor.model,n=t.document.selection,s=yT(n);s?t.change(o=>{o.setAttribute("url",e,s)}):$2(t,e,n,!0)}}function LH(i,e){let n=Cw(i,e).start.parent;return n.isEmpty&&!e.schema.isLimit(n)&&(n=n.parent),e.schema.checkChild(n,"media")}function DH(i){const e=i.getSelectedElement();return!!e&&e.name==="media"}const FH="0 0 64 42";class zH{locale;providerDefinitions;constructor(e,t){const n=t.providers,s=t.extraProviders||[],o=new Set(t.removeProviders),a=n.concat(s).filter(c=>{const u=c.name;return u?!o.has(u):(Be("media-embed-no-provider-name",{provider:c}),!1)});this.locale=e,this.providerDefinitions=a}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,n){return this._getMedia(t).getViewElement(e,n)}_getMedia(e){if(!e)return new vT(this.locale);e=e.trim();for(const t of this.providerDefinitions){const n=t.html,s=st(t.url);for(const o of s){const a=this._getUrlMatches(e,o);if(a)return new vT(this.locale,e,a,n)}}return null}_getUrlMatches(e,t){let n=e.match(t);if(n)return n;let s=e.replace(/^https?:\/\//,"");return n=s.match(t),n||(s=s.replace(/^www\./,""),n=s.match(t),n)?n:null}}class vT{url;_locale;_match;_previewRenderer;constructor(e,t,n,s){this.url=this._getValidUrl(t),this._locale=e,this._match=n,this._previewRenderer=s}getViewElement(e,t){const n={};let s;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(n["data-oembed-url"]=this.url),t.renderForEditingView&&(n.class="ck-media__wrapper");const o=this._getPreviewHtml(t);s=e.createRawElement("div",n,(a,c)=>{c.setContentOf(a,o)})}else this.url&&(n.url=this.url),s=e.createEmptyElement(t.elementName,n);return e.setCustomProperty("media-content",!0,s),s}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new ki,t=this._locale.t;return e.content=bN,e.viewBox=FH,new yn({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[e]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url,"data-cke-tooltip-text":t("Open media in new tab")},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]}]}]}).render().outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}class yh extends N{static get pluginName(){return"MediaEmbedEditing"}static get isOfficialPlugin(){return!0}registry;constructor(e){super(e),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:[/^dailymotion\.com\/video\/(\w+)/,/^dai.ly\/(\w+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)(?:&t=(\d+))?/,/^(?:m\.)?youtube\.com\/shorts\/([\w-]+)(?:\?t=(\d+))?/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)(?:\?t=(\d+))?/,/^youtube\.com\/embed\/([\w-]+)(?:\?start=(\d+))?/,/^youtu\.be\/([\w-]+)(?:\?t=(\d+))?/],html:t=>{const n=t[1],s=t[2];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${n}${s?`?start=${s}`:""}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:[/^instagram\.com\/p\/(\w+)/,/^instagram\.com\/reel\/(\w+)/]},{name:"twitter",url:[/^twitter\.com/,/^x\.com/]},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new zH(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,n=e.t,s=e.conversion,o=e.config.get("mediaEmbed.previewsInData"),a=e.config.get("mediaEmbed.elementName"),c=this.registry;e.commands.add("mediaEmbed",new NH(e)),t.register("media",{inheritAllFrom:"$blockObject",allowAttributes:["url"]}),s.for("dataDowncast").elementToStructure({model:"media",view:(u,{writer:h})=>{const m=u.getAttribute("url");return _T(h,c,m,{elementName:a,renderMediaPreview:!!m&&o})}}),s.for("dataDowncast").add(wT(c,{elementName:a,renderMediaPreview:o})),s.for("editingDowncast").elementToStructure({model:"media",view:(u,{writer:h})=>{const m=u.getAttribute("url"),g=_T(h,c,m,{elementName:a,renderForEditingView:!0});return MH(g,h,n("media widget"))}}),s.for("editingDowncast").add(wT(c,{elementName:a,renderForEditingView:!0})),s.for("upcast").elementToElement({view:u=>["oembed",a].includes(u.name)&&u.getAttribute("url")?{name:!0}:null,model:(u,{writer:h})=>{const m=u.getAttribute("url");return c.hasMedia(m)?h.createElement("media",{url:m}):null}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(u,{writer:h})=>{const m=u.getAttribute("data-oembed-url");return c.hasMedia(m)?h.createElement("media",{url:m}):null}}).add(u=>{const h=(m,g,w)=>{if(!w.consumable.consume(g.viewItem,{name:!0,classes:"media"}))return;const{modelRange:_,modelCursor:v}=w.convertChildren(g.viewItem,g.modelCursor);g.modelRange=_,g.modelCursor=v,Ze(_.getItems())||w.consumable.revert(g.viewItem,{name:!0,classes:"media"})};u.on("element:figure",h)})}}const UH=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class HH extends N{static get requires(){return[r2,Is,d2]}static get pluginName(){return"AutoMediaEmbed"}static get isOfficialPlugin(){return!0}_timeoutId;_positionToInsert;constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",()=>{const o=t.selection.getFirstRange(),a=wt.fromPosition(o.start);a.stickiness="toPrevious";const c=wt.fromPosition(o.end);c.stickiness="toNext",t.once("change:data",()=>{this._embedMediaBetweenPositions(a,c),a.detach(),c.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(ee.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(e,t){const n=this.editor,s=n.plugins.get(yh).registry,o=new wn(e,t),a=o.getWalker({ignoreElementEnd:!0});let c="";for(const h of a)h.item.is("$textProxy")&&(c+=h.item.data);if(c=c.trim(),!c.match(UH)){o.detach();return}if(!s.hasMedia(c)){o.detach();return}if(!n.commands.get("mediaEmbed").isEnabled){o.detach();return}this._positionToInsert=wt.fromPosition(e),this._timeoutId=ee.window.setTimeout(()=>{n.model.change(h=>{this._timeoutId=null,h.remove(o),o.detach();let m=null;this._positionToInsert.root.rootName!=="$graveyard"&&(m=this._positionToInsert),$2(n.model,c,m,!1),this._positionToInsert.detach(),this._positionToInsert=null}),n.plugins.get(Is).requestUndoOnBackspace()},100)}}class jH extends oe{focusTracker;keystrokes;urlInputView;_validators;_urlInputViewInfoDefault;_urlInputViewInfoTip;constructor(e,t){super(t),this.focusTracker=new dt,this.keystrokes=new Ct,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView]})}render(){super.render(),or({view:this}),this.focusTracker.add(this.urlInputView.element),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.urlInputView.focus()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new Rt(this.locale,si),n=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,n.inputMode="url",n.on("input",()=>{t.infoText=n.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=n.element.value.trim()}),t}}class qH extends N{static get requires(){return[yh,mi]}static get pluginName(){return"MediaEmbedUI"}static get isOfficialPlugin(){return!0}_formView;init(){const e=this.editor;e.ui.componentFactory.add("mediaEmbed",()=>{const t=this.editor.locale.t,n=this._createDialogButton(ue);return n.tooltip=!0,n.label=t("Insert media"),n}),e.ui.componentFactory.add("menuBar:mediaEmbed",()=>{const t=this.editor.locale.t,n=this._createDialogButton(tt);return n.label=t("Media"),n})}_createDialogButton(e){const t=this.editor,n=new e(t.locale),s=t.commands.get("mediaEmbed"),o=this.editor.plugins.get("Dialog");return n.icon=wN,n.bind("isEnabled").to(s,"isEnabled"),n.on("execute",()=>{o.id==="mediaEmbed"?o.hide():this._showDialog()}),n}_showDialog(){const e=this.editor,t=e.plugins.get("Dialog"),n=e.commands.get("mediaEmbed"),s=e.locale.t,o=n.value!==void 0;if(!this._formView){const a=e.plugins.get(yh).registry;this._formView=new(_c(jH))(WH(e.t,a),e.locale),this._formView.on("submit",()=>this._handleSubmitForm())}t.show({id:"mediaEmbed",title:s("Media embed"),content:this._formView,isModal:!0,onShow:()=>{this._formView.url=n.value||"",this._formView.resetFormStatus(),this._formView.urlInputView.fieldView.select()},actionButtons:[{label:s("Cancel"),withText:!0,onExecute:()=>t.hide()},{label:s(o?"Save":"Insert"),class:"ck-button-action",withText:!0,onExecute:()=>this._handleSubmitForm()}]})}_handleSubmitForm(){const e=this.editor,t=e.plugins.get("Dialog");this._formView.isValid()&&(e.execute("mediaEmbed",this._formView.url),t.hide(),e.editing.view.focus())}}function WH(i,e){return[t=>{if(!t.url.length)return i("The URL must not be empty.")},t=>{if(!e.hasMedia(t.url))return i("This media URL is not supported.")}]}class $H extends N{static get requires(){return[yh,qH,HH,Ia]}static get pluginName(){return"MediaEmbed"}static get isOfficialPlugin(){return!0}}ke.arrowup,ke.arrowdown,ke.esc;ke.enter,ke.tab;const xd="removeFormat";class GH extends N{static get pluginName(){return"RemoveFormatUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add(xd,()=>{const t=this._createButton(ue);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add(`menuBar:${xd}`,()=>this._createButton(tt))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get(xd),o=new e(t.locale),a=n.t;return o.set({label:a("Remove Format"),icon:VN}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute(xd),t.editing.view.focus()}),o}}class KH extends me{_customAttributesHandlers=[];refresh(){const e=this.editor.model;this.isEnabled=!!Ze(this._getFormattingItems(e.document.selection))}execute(){const e=this.editor.model;e.change(t=>{for(const n of this._getFormattingItems(e.document.selection))if(n.is("selection"))for(const s of this._getFormattingAttributes(n))t.removeSelectionAttribute(s);else{const s=t.createRangeOn(n);for(const o of this._getFormattingAttributes(n))this._removeFormatting(o,n,s,t)}})}registerCustomAttribute(e,t){this._customAttributesHandlers.push({isFormatting:e,removeFormatting:t})}_removeFormatting(e,t,n,s){let o=!1;for(const{isFormatting:a,removeFormatting:c}of this._customAttributesHandlers)a(e,t)&&(c(e,n,s),o=!0);o||s.removeAttribute(e,n)}*_getFormattingItems(e){const t=this.editor.model,n=t.schema,s=o=>!!Ze(this._getFormattingAttributes(o));for(const o of e.getRanges())for(const a of o.getItems())n.isBlock(a)&&o.end.isTouching(t.createPositionAt(a,0))||s(a)&&(yield a);for(const o of e.getSelectedBlocks())s(o)&&(yield o);s(e)&&(yield e)}*_getFormattingAttributes(e){const t=this.editor.model.schema;for(const[n]of e.getAttributes()){for(const{isFormatting:o}of this._customAttributesHandlers)o(n,e)&&(yield n);const s=t.getAttributeProperties(n);s&&s.isFormatting&&(yield n)}}}class YH extends N{static get pluginName(){return"RemoveFormatEditing"}static get licenseFeatureCode(){return"RF"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}init(){const e=this.editor;e.commands.add("removeFormat",new KH(e))}}class JH extends N{static get requires(){return[YH,GH]}static get pluginName(){return"RemoveFormat"}static get isOfficialPlugin(){return!0}}const QH=/^(left|center|right)$/,XH=/^(left|none|right)$/;function Pw(i,e){const{modelAttribute:t,styleName:n,attributeName:s,attributeType:o,viewElement:a,defaultValue:c,shouldUpcast:u=()=>!0,reduceBoxSides:h=!1}=e;i.for("upcast").attributeToAttribute({view:{name:a,styles:{[n]:/[\s\S]+/}},model:{key:t,value:(m,g,w)=>{if(!u(m))return;const _=wi(c,"",w),v=m.getNormalizedStyle(n),C=h?$d(v):v;if(_!==C)return C;g.consumable.consume(m,{styles:n})}}}),s&&i.for("upcast").attributeToAttribute({view:{name:a,attributes:{[s]:/.+/}},model:{key:t,value:(m,g,w)=>{if(m.name=="figure"||m.hasStyle(n)||m.name=="table"&&m.parent.name=="figure"&&m.parent.hasStyle(n))return;const _=wi(c,"",w);let v=m.getAttribute(s);if(v&&o=="length"){const C=parseFloat(v);isNaN(C)?v=_:v=C+(v.includes("%")?"%":"px")}if(_!==v)return v;g.consumable.consume(m,{attributes:s})}}})}function gb(i,e,t,n){const{conversion:s}=i;s.for("upcast").add(o=>o.on("element:"+e,(a,c,u)=>{if(!c.modelRange)return;const h=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(T=>c.viewItem.hasStyle(T));if(!h.length)return;const m={styles:h};if(!u.consumable.test(c.viewItem,m))return;const g=[...c.modelRange.getItems({shallow:!0})].pop(),w=g.findAncestor("table",{includeSelf:!0});let _=n;w&&w.getAttribute("tableType")=="layout"&&(_={style:"none",color:"",width:""}),u.consumable.consume(c.viewItem,m);const v={style:c.viewItem.getNormalizedStyle("border-style"),color:c.viewItem.getNormalizedStyle("border-color"),width:c.viewItem.getNormalizedStyle("border-width")},C={style:$d(v.style),color:$d(v.color),width:$d(v.width)};C.style!==_.style&&u.writer.setAttribute(t.style,C.style,g),C.color!==_.color&&u.writer.setAttribute(t.color,C.color,g),C.width!==_.width&&u.writer.setAttribute(t.width,C.width,g)})),i.config.get("experimentalFlags.upcastTableBorderZeroAttributes")&&s.for("upcast").add(o=>{o.on(`element:${e}`,(a,c,u)=>{const{modelRange:h,viewItem:m}=c,g=m.is("element","table")?m:m.findAncestor("table");if(!u.consumable.test(g,{attributes:"border"})||g.getAttribute("border")!=="0")return;const w=h?.start?.nodeAfter;!w||Object.values(t).some(_=>w.hasAttribute(_))||(u.writer.setAttribute(t.style,"none",w),m.is("element","table")&&u.consumable.consume(m,{attributes:"border"}))})})}function sc(i,e){const{modelElement:t,modelAttribute:n,styleName:s}=e;i.for("downcast").attributeToAttribute({model:{name:t,key:n},view:o=>({key:"style",value:{[s]:o}})})}function Wd(i,e){const{modelAttribute:t,styleName:n}=e;i.for("downcast").add(s=>s.on(`attribute:${t}:table`,(o,a,c)=>{const{item:u,attributeNewValue:h}=a,{mapper:m,writer:g}=c;if(!c.consumable.consume(a.item,o.name))return;const w=[...m.toViewElement(u).getChildren()].find(_=>_.is("element","table"));h?g.setStyle(n,h,w):g.removeStyle(n,w)}))}function wi(i,e,t){const n=t.modelRange&&Ze(t.modelRange.getItems({shallow:!0})),s=n&&n.is("element")&&n.findAncestor("table",{includeSelf:!0});return s&&s.getAttribute("tableType")==="layout"?e:i}function $d(i){if(!i)return;const e=["top","right","bottom","left"];if(!e.every(o=>i[o]))return i;const n=i.top;return e.every(o=>i[o]===n)?n:i}const Xt={left:{className:"table-style-align-left"},center:{className:"table-style-align-center"},right:{className:"table-style-align-right"},blockLeft:{className:"table-style-block-align-left"},blockRight:{className:"table-style-block-align-right"}},ZH=[{view:{name:/^(table|figure)$/,styles:{float:XH}},getAlign:i=>{let e=i.getStyle("float");return e==="none"&&(e="center"),e},getConsumables(i){const e=i.getStyle("float"),t=["float"];return e==="left"&&i.hasStyle("margin-right")?t.push("margin-right"):e==="right"&&i.hasStyle("margin-left")&&t.push("margin-left"),{styles:t}}},{view:{name:/^(table|figure)$/,styles:{"margin-left":"auto","margin-right":"auto"}},getAlign:()=>"center",getConsumables:()=>({styles:["margin-left","margin-right"]})},{view:{name:/^(table|figure)$/,key:"class",value:"table-style-align-left"},getAlign:()=>"left",getConsumables(){return{classes:Xt.left.className}}},{view:{name:/^(table|figure)$/,key:"class",value:Xt.right.className},getAlign:()=>"right",getConsumables(){return{classes:Xt.right.className}}},{view:{name:/^(table|figure)$/,key:"class",value:Xt.center.className},getAlign:()=>"center",getConsumables(){return{classes:Xt.center.className}}},{view:{name:/^(table|figure)$/,key:"class",value:Xt.blockLeft.className},getAlign:()=>"blockLeft",getConsumables(){return{classes:Xt.blockLeft.className}}},{view:{name:/^(table|figure)$/,key:"class",value:Xt.blockRight.className},getAlign:()=>"blockRight",getConsumables(){return{classes:Xt.blockRight.className}}},{view:{name:/^(table|figure)$/,styles:{"margin-left":"0","margin-right":"auto"}},getAlign:()=>"blockLeft",getConsumables(){return{styles:["margin-left","margin-right"]}}},{view:{name:/^(table|figure)$/,styles:{"margin-left":"auto","margin-right":"0"}},getAlign:()=>"blockRight",getConsumables(){return{styles:["margin-left","margin-right"]}}},{view:{name:"table",attributes:{align:QH}},getAlign:i=>i.getAttribute("align"),getConsumables(){return{attributes:"align"}}}],Id={center:{align:"center",style:"margin-left: auto; margin-right: auto;",className:"table-style-align-center"},left:{align:"left",style:"float: left;",className:"table-style-align-left"},right:{align:"right",style:"float: right;",className:"table-style-align-right"},blockLeft:{align:void 0,style:"margin-left: 0; margin-right: auto;",className:Xt.blockLeft.className},blockRight:{align:void 0,style:"margin-left: auto; margin-right: 0;",className:Xt.blockRight.className}};class Pe{_table;_startRow;_endRow;_startColumn;_endColumn;_includeAllSlots;_skipRows;_row;_rowIndex;_column;_cellIndex;_spannedCells;_nextCellAtColumn;_jumpedToStartRow=!1;constructor(e,t={}){this._table=e,this._startRow=t.row!==void 0?t.row:t.startRow||0,this._endRow=t.row!==void 0?t.row:t.endRow,this._startColumn=t.column!==void 0?t.column:t.startColumn||0,this._endColumn=t.column!==void 0?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0,value:void 0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const n=this._getSpanned();if(n)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(n.cell,n.row,n.column));else{const s=e.getChild(this._cellIndex);if(!s)return this._advanceToNextRow();const o=parseInt(s.getAttribute("colspan")||"1"),a=parseInt(s.getAttribute("rowspan")||"1");(o>1||a>1)&&this._recordSpans(s,a,o),this._shouldSkipSlot()||(t=this._formatOutValue(s)),this._nextCellAtColumn=this._column+o}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(e,t=this._row,n=this._column){return{done:!1,value:new ej(this,e,t,n)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,n=this._column<this._startColumn,s=this._endColumn!==void 0&&this._column>this._endColumn;return e||t||n||s}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,n){const s={cell:e,row:this._row,column:this._column};for(let o=this._row;o<this._row+t;o++)for(let a=this._column;a<this._column+n;a++)(o!=this._row||a!=this._column)&&this._markSpannedCell(o,a,s)}_markSpannedCell(e,t,n){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(t,n)}_canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow}_jumpToNonSpannedRowClosestToStartRow(){const e=this._getRowLength(0);for(let t=this._startRow;!this._jumpedToStartRow;t--)e===this._getRowLength(t)&&(this._row=t,this._rowIndex=t,this._jumpedToStartRow=!0)}_getRowLength(e){return[...this._table.getChild(e).getChildren()].reduce((n,s)=>n+parseInt(s.getAttribute("colspan")||"1"),0)}}class ej{cell;row;column;cellAnchorRow;cellAnchorColumn;_cellIndex;_rowIndex;_table;constructor(e,t,n,s){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=n,this.cellAnchorColumn=s,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function _t(i,e,t,n,s=1){e!=null&&s!==void 0&&s!==null&&e>s?n.setAttribute(i,e,t):n.removeAttribute(i,t)}function cr(i,e,t={}){const n=i.createElement("tableCell",t);return i.insertElement("paragraph",n),i.insert(n,e),n}function pb(i,e){const t=e.parent.parent,n=parseInt(t.getAttribute("headingColumns")||"0"),{column:s}=i.getCellLocation(e);return!!n&&s<n}function Gd(i,e,t){const{modelAttribute:n}=t;i.extend("tableCell",{allowAttributes:[n]}),i.setAttributeProperties(n,{isFormatting:!0}),Pw(e,{viewElement:/^(td|th)$/,...t}),sc(e,{modelElement:"tableCell",...t})}function Ac(i){const e=i.getSelectedElement();return e&&e.is("element","table")?e:i.getFirstPosition().findAncestor("table")}function tj(i){const e=new Map;for(const t of i){const n=t.findAncestor("table");e.has(n)||e.set(n,[]),e.get(n).push(t)}return e}function sa({table:i,row:e,column:t}){const n=new Pe(i,{row:e,column:t});for(const{cell:s}of n)if(s.getAttribute("tableCellType")!=="header")return!1;return!0}function gs(i){const{model:e,config:t}=i;return e.schema.checkAttribute("tableCell","tableCellType")&&t.get("experimentalFlags.tableCellTypeSupport")===!0}function G2(i,e,t){const{startRow:n,startColumn:s,endRow:o,endColumn:a}=e,c=t.createElement("table"),u=i.getAttribute("tableType");u&&t.setAttribute("tableType",u,c);const h=o-n+1;for(let g=0;g<h;g++)t.insertElement("tableRow",c,"end");const m=[...new Pe(i,{startRow:n,endRow:o,startColumn:s,endColumn:a,includeAllSlots:!0})];for(const{row:g,column:w,cell:_,isAnchor:v,cellAnchorRow:C,cellAnchorColumn:T}of m){const A=g-n,L=c.getChild(A);if(!v)(C<n||T<s)&&cr(t,t.createPositionAt(L,"end"));else{const z=t.cloneElement(_);t.append(z,L),X2(z,g,w,o,a,t)}}return nj(c,i,n,s,t),c}function K2(i,e,t=0){const n=[],s=new Pe(i,{startRow:t,endRow:e-1});for(const o of s){const{row:a,cellHeight:c}=o,u=a+c-1;a<e&&e<=u&&n.push(o)}return n}function Y2(i,e,t){const n=i.parent,s=n.parent,o=n.index,a=parseInt(i.getAttribute("rowspan")),c=e-o,u={},h=a-c;h>1&&(u.rowspan=h);const m=parseInt(i.getAttribute("colspan")||"1");m>1&&(u.colspan=m);const g=o,w=g+c,_=[...new Pe(s,{startRow:g,endRow:w,includeAllSlots:!0})];let v=null,C;for(const T of _){const{row:A,column:L,cell:z}=T;z===i&&C===void 0&&(C=L),C!==void 0&&C===L&&A===w&&(v=cr(t,T.getPositionBefore(),u))}return _t("rowspan",c,i,t),v}function J2(i,e){const t=[],n=new Pe(i);for(const s of n){const{column:o,cellWidth:a}=s,c=o+a-1;o<e&&e<=c&&t.push(s)}return t}function Q2(i,e,t,n){const s=parseInt(i.getAttribute("colspan")),o=t-e,a={},c=s-o;c>1&&(a.colspan=c);const u=parseInt(i.getAttribute("rowspan")||"1");u>1&&(a.rowspan=u);const h=cr(n,n.createPositionAfter(i),a);return _t("colspan",o,i,n),h}function X2(i,e,t,n,s,o){const a=parseInt(i.getAttribute("colspan")||"1"),c=parseInt(i.getAttribute("rowspan")||"1");if(t+a-1>s){const m=s-t+1;_t("colspan",m,i,o,1)}if(e+c-1>n){const m=n-e+1;_t("rowspan",m,i,o,1)}}function nj(i,e,t,n,s){const o=parseInt(e.getAttribute("headingRows")||"0");if(o>0){const c=o-t;_t("headingRows",c,i,s,0)}const a=parseInt(e.getAttribute("headingColumns")||"0");if(a>0){const c=a-n;_t("headingColumns",c,i,s,0)}}function bb(i,e){const t=e.getColumns(i),n=new Array(t).fill(0);for(const{column:o}of new Pe(i))n[o]++;const s=n.reduce((o,a,c)=>a?o:[...o,c],[]);if(s.length>0){const o=s[s.length-1];return e.removeColumns(i,{at:o}),!0}return!1}function wb(i,e){const t=[],n=e.getRows(i);for(let s=0;s<n;s++)i.getChild(s).isEmpty&&t.push(s);if(t.length>0){const s=t[t.length-1];return e.removeRows(i,{at:s}),!0}return!1}function Rw(i,e){bb(i,e)||wb(i,e)}function Z2(i,e){const t=Array.from(new Pe(i,{startColumn:e.firstColumn,endColumn:e.lastColumn,row:e.lastRow}));if(t.every(({cellHeight:o})=>o===1))return e.lastRow;const s=t[0].cellHeight-1;return e.lastRow+s}function ex(i,e){const t=Array.from(new Pe(i,{startRow:e.firstRow,endRow:e.lastRow,column:e.lastColumn}));if(t.every(({cellWidth:o})=>o===1))return e.lastColumn;const s=t[0].cellWidth-1;return e.lastColumn+s}function tx(i){for(const e of i.getChildren())if(e.is("element","table"))return e}function ij(){return i=>{i.on("element:figure",(e,t,n)=>{if(!n.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const s=tx(t.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(t.viewItem,{name:!0,classes:"table"});const o=n.convertItem(s,t.modelCursor),a=Ze(o.modelRange.getItems());if(!a||!a.is("element","table")){n.consumable.revert(t.viewItem,{name:!0,classes:"table"}),o.modelRange&&!o.modelRange.isCollapsed&&(t.modelRange=o.modelRange,t.modelCursor=o.modelCursor);return}n.convertChildren(t.viewItem,n.writer.createPositionAt(a,"end")),n.updateConversionResult(a,t)})}}function sj(){return i=>{i.on("element:table",(e,t,n)=>{const s=t.viewItem;if(!n.consumable.test(s,{name:!0}))return;const{rows:o,headingRows:a,headingColumns:c}=rj(s),u={};c&&(u.headingColumns=c),a&&(u.headingRows=a);const h=n.writer.createElement("table",u);if(n.safeInsert(h,t.modelCursor)){if(n.consumable.consume(s,{name:!0}),o.forEach(m=>n.convertItem(m,n.writer.createPositionAt(h,"end"))),n.convertChildren(s,n.writer.createPositionAt(h,"end")),h.isEmpty){const m=n.writer.createElement("tableRow");n.writer.insert(m,n.writer.createPositionAt(h,"end")),cr(n.writer,n.writer.createPositionAt(m,"end"))}n.updateConversionResult(h,t)}})}}function oj(){return i=>{i.on("element:tr",(e,t)=>{t.viewItem.isEmpty&&t.modelCursor.index==0&&e.stop()},{priority:"high"})}}function CT(i){return e=>{e.on(`element:${i}`,(t,n,{writer:s})=>{if(!n.modelRange)return;const o=n.modelRange.start.nodeAfter,a=s.createPositionAt(o,0);if(n.viewItem.isEmpty){s.insertElement("paragraph",a);return}const c=Array.from(o.getChildren());if(c.every(u=>u.is("element","$marker"))){const u=s.createElement("paragraph");s.insert(u,s.createPositionAt(o,0));for(const h of c)s.move(s.createRangeOn(h),s.createPositionAt(u,"end"))}},{priority:"low"})}}function rj(i){let e,t=!0;const n=[],s=[];let o;for(const c of Array.from(i.getChildren())){if(c.name!=="tbody"&&c.name!=="thead"&&c.name!=="tfoot")continue;c.name==="thead"&&!o&&(t=!0,o=c);const u=Array.from(c.getChildren()).filter(m=>m.is("element","tr"));let h=null;for(const m of u){const g=Array.from(m.getChildren()).filter(w=>w.is("element","td")||w.is("element","th"));o&&c===o||c.name==="tbody"&&g.length>0&&(h===null||g.length===h)&&g.every(w=>w.is("element","th"))&&t?(n.push(m),t=!0):(s.push(m),t=!1),h=Math.max(h||0,g.length)}}const a=aj(s);for(const c of a){let u=0;for(;u<c.length&&c[u]?.name==="th";)u+=1;(e===void 0||u<e)&&(e=u)}return{headingRows:n.length,headingColumns:e||0,rows:[...n,...s]}}function aj(i){let e=new Map,t=0;const n=i.map(s=>{const o=[],a=Array.from(s.getChildren()).filter(u=>u.name==="th"||u.name==="td"),c=new Map;for(;a.length||o.length<t;){const u=e.get(o.length);if(u&&u.remaining>0)o.push(u.cell);else{const h=a.shift();if(h){const m=parseInt(h.getAttribute("colspan")||"1"),g=parseInt(h.getAttribute("rowspan")||"1");for(let w=0;w<m;w++)g>1&&c.set(o.length,{cell:h,remaining:g-1}),o.push(h)}else{o.push(null);continue}}}for(const[u,h]of e.entries())h.remaining-=1,h.remaining>0&&!c.has(u)&&c.set(u,h);return e=c,t=Math.max(t,o.length),o});for(const s of n)for(;s.length<t;)s.push(null);return n}function ur(i){if(!i||!on(i))return i;const{top:e,right:t,bottom:n,left:s}=i;if(e==t&&t==n&&n==s)return e}function dr(i,e){const t=parseFloat(i);return Number.isNaN(t)||String(t)!==String(i)?i:`${t}${e}`}function tf(i,e={}){const t={borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",...i};return e.includeAlignmentProperty&&!t.alignment&&(t.alignment="center"),e.includePaddingProperty&&!t.padding&&(t.padding=""),e.includeVerticalAlignmentProperty&&!t.verticalAlignment&&(t.verticalAlignment="middle"),e.includeHorizontalAlignmentProperty&&!t.horizontalAlignment&&(t.horizontalAlignment=e.isRightToLeftContent?"right":"left"),t}function Ow(i,e){return tf({borderStyle:"double",borderColor:"hsl(0, 0%, 70%)",borderWidth:"1px",...i},e)}function Vw(i,e){return tf({borderStyle:"solid",borderColor:"hsl(0, 0%, 75%)",borderWidth:"1px",...i},e)}function kT(i,e){return(t,{writer:n})=>{const s=t.getAttribute("headingRows")||0,o=n.createContainerElement("table",null,[]),a=n.createContainerElement("figure",{class:"table"},o);s>0&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("thead",null,n.createSlot(c=>c.is("element","tableRow")&&c.index<s))),s<i.getRows(t)&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("tbody",null,n.createSlot(c=>c.is("element","tableRow")&&c.index>=s)));for(const{positionOffset:c,filter:u}of e.additionalSlots)n.insert(n.createPositionAt(o,c),n.createSlot(u));return n.insert(n.createPositionAt(o,"after"),n.createSlot(c=>c.is("element","tableRow")?!1:!e.additionalSlots.some(({filter:u})=>u(c)))),e.asWidget?cj(a,n):a}}function lj(){return(i,{writer:e})=>i.isEmpty?e.createEmptyElement("tr"):e.createContainerElement("tr")}function TT(i){return(t,{writer:n})=>{if(i.cellTypeEnabled?.()){const g=t.getAttribute("tableCellType")==="header"?"th":"td";return e(n,g)}const s=t.parent,o=s.parent,a=o.getChildIndex(s),c=new Pe(o,{row:a}),u=o.getAttribute("headingRows")||0,h=o.getAttribute("headingColumns")||0;let m=null;for(const g of c)if(g.cell==t){const w=g.row<u||g.column<h;m=e(n,w?"th":"td");break}return m};function e(t,n){return i.asWidget?ZA(t.createEditableElement(n),t,{withAriaRole:!1}):t.createContainerElement(n)}}function ET(i={}){return(e,{writer:t})=>{if(!e.parent.is("element","tableCell")||!nx(e))return null;if(i.asWidget)return t.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const n=t.createContainerElement("p");return t.setCustomProperty("dataPipeline:transparentRendering",!0,n),n}}}function nx(i){return i.parent.childCount==1&&!uj(i)}function cj(i,e){return e.setCustomProperty("table",!0,i),Qh(i,e,{hasSelectionHandle:!0})}function uj(i){for(const e of i.getAttributeKeys())if(!(e.startsWith("selection:")||e=="htmlEmptyBlock"))return!0;return!1}function dj(i){return(e,t)=>{const n=i.plugins.has("PlainTableOutput"),s=t.options.isClipboardPipeline,o=i.config.get("experimentalFlags.useExtendedTableBlockAlignment");return!n&&!(o&&s)?null:fj(e,t,i)}}function hj(i){return(e,{writer:t,options:n})=>{const s=i.plugins.has("PlainTableOutput"),o=n.isClipboardPipeline,a=i.config.get("experimentalFlags.useExtendedTableBlockAlignment");return!s&&!(a&&o)?null:e.parent.name==="table"?t.createContainerElement("caption"):null}}function fj(i,e,t){const n=e.writer,s=i.getAttribute("headingRows")||0,o=n.createSlot(w=>w.is("element","tableRow")&&w.index<s),a=n.createSlot(w=>w.is("element","tableRow")&&w.index>=s),c=n.createSlot(w=>!w.is("element","tableRow")),u=n.createContainerElement("thead",null,o),h=n.createContainerElement("tbody",null,a),m=[];s&&m.push(u),s<i.childCount&&m.push(h);const g={class:"table"};if(t.plugins.has("TablePropertiesEditing")&&e.options.isClipboardPipeline){const w=Ow(t.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),_=i.getAttribute("tableAlignment");let v=w.alignment;i.getAttribute("tableType")==="layout"&&(v="");const C=_||v;C&&(g.class+=" "+Id[C].className,g.style=Id[C].style,Id[C].align!==void 0&&(g.align=Id[C].align))}return n.createContainerElement("table",g,[c,...m])}function mj(i){const e={"border-width":"tableBorderWidth","border-color":"tableBorderColor","border-style":"tableBorderStyle","background-color":"tableBackgroundColor"};for(const[t,n]of Object.entries(e))i.conversion.for("dataDowncast").add(s=>s.on(`attribute:${n}:table`,(o,a,c)=>{const{item:u,attributeNewValue:h}=a,{mapper:m,writer:g}=c,w=i.plugins.has("PlainTableOutput"),_=c.options.isClipboardPipeline,v=i.config.get("experimentalFlags.useExtendedTableBlockAlignment");if(!w&&!(v&&_)||!c.consumable.consume(u,o.name))return;const C=m.toViewElement(u);h?g.setStyle(t,h,C):g.removeStyle(t,C)},{priority:"high"}))}class gj extends me{refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema;this.isEnabled=pj(t,n)}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("TableUtils"),o=t.config.get("table.defaultHeadings.rows"),a=t.config.get("table.defaultHeadings.columns");e.headingRows===void 0&&o&&(e.headingRows=o),e.headingColumns===void 0&&a&&(e.headingColumns=a),n.change(c=>{const u=s.createTable(c,e);n.insertObject(u,null,null,{findOptimalPosition:"auto"}),c.setSelection(c.createPositionAt(u.getNodeByPath([0,0,0]),0))})}}function pj(i,e){const t=i.getFirstPosition().parent,n=t===t.root?t:t.parent;return e.checkChild(n,"table")}class ST extends me{order;constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="above",o=n.getSelectionAffectedTableCells(t),a=n.getRowIndexes(o),c=s?a.first:a.last,u=o[0].findAncestor("table");n.insertRows(u,{at:s?c:c+1,copyStructureFromAbove:!s})}}class AT extends me{order;constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="left",o=n.getSelectionAffectedTableCells(t),a=n.getColumnIndexes(o),c=s?a.first:a.last,u=o[0].findAncestor("table");n.insertColumns(u,{columns:1,at:s?c:c+1})}}class xT extends me{direction;constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(t,2):e.splitCellVertically(t,2)}}class Pd extends me{direction;isHorizontal;constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,s=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(t.selection)[0],o=this.value,a=this.direction;e.change(c=>{const u=a=="right"||a=="down",h=u?s:o,m=u?o:s,g=m.parent;_j(m,h,c);const w=this.isHorizontal?"colspan":"rowspan",_=parseInt(s.getAttribute(w)||"1"),v=parseInt(o.getAttribute(w)||"1");c.setAttribute(w,_+v,h),c.setSelection(c.createRangeIn(h));const C=this.editor.plugins.get("TableUtils"),T=g.findAncestor("table");Rw(T,C)})}_getMergeableCell(){const t=this.editor.model.document,n=this.editor.plugins.get("TableUtils"),s=n.getTableCellsContainingSelection(t.selection)[0];if(!s)return;const o=this.isHorizontal?bj(s,this.direction,n):wj(s,this.direction,n);if(!o)return;const a=this.isHorizontal?"rowspan":"colspan",c=parseInt(s.getAttribute(a)||"1");if(parseInt(o.getAttribute(a)||"1")===c)return o}}function bj(i,e,t){const s=i.parent.parent,o=e=="right"?i.nextSibling:i.previousSibling,a=(s.getAttribute("headingColumns")||0)>0;if(!o)return;const c=e=="right"?i:o,u=e=="right"?o:i,{column:h}=t.getCellLocation(c),{column:m}=t.getCellLocation(u),g=parseInt(c.getAttribute("colspan")||"1"),w=pb(t,c),_=pb(t,u);return a&&w!=_?void 0:h+g===m?o:void 0}function wj(i,e,t){const n=i.parent,s=n.parent,o=s.getChildIndex(n);if(e=="down"&&o===t.getRows(s)-1||e=="up"&&o===0)return null;const a=parseInt(i.getAttribute("rowspan")||"1"),c=s.getAttribute("headingRows")||0,u=e=="down"&&o+a===c,h=e=="up"&&o===c;if(c&&(u||h))return null;const m=parseInt(i.getAttribute("rowspan")||"1"),g=e=="down"?o+m:o,w=[...new Pe(s,{endRow:g})],v=w.find(T=>T.cell===i).column,C=w.find(({row:T,cellHeight:A,column:L})=>L!==v?!1:e=="down"?T===g:g===T+A);return C&&C.cell?C.cell:null}function _j(i,e,t){IT(i)||(IT(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function IT(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}class yj extends me{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),a=e.getRows(s)-1,c=e.getRowIndexes(t),u=c.first===0&&c.last===a;this.isEnabled=!u}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0],a=o.findAncestor("table"),c=t.getCellLocation(o).column;e.change(u=>{const h=s.last-s.first+1;t.removeRows(a,{at:s.first,rows:h});const m=vj(a,s.first,c,t.getRows(a));u.setSelection(u.createPositionAt(m,0))})}}function vj(i,e,t,n){const s=i.getChild(Math.min(e,n-1));let o=s.getChild(0),a=0;for(const c of s.getChildren()){if(a>t)return o;o=c,a+=parseInt(c.getAttribute("colspan")||"1")}return o}class Cj extends me{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),o=e.getColumns(s),{first:a,last:c}=e.getColumnIndexes(t);this.isEnabled=c-a<o-1}else this.isEnabled=!1}execute(){const e=this.editor.plugins.get("TableUtils"),[t,n]=Tj(this.editor.model.document.selection,e),s=t.parent.parent,o=[...new Pe(s)],a={first:o.find(u=>u.cell===t).column,last:o.find(u=>u.cell===n).column},c=kj(o,t,n,a);this.editor.model.change(u=>{const h=a.last-a.first+1;e.removeColumns(s,{at:a.first,columns:h}),u.setSelection(u.createPositionAt(c,0))})}}function kj(i,e,t,n){return parseInt(t.getAttribute("colspan")||"1")>1?t:e.previousSibling||t.nextSibling?t.nextSibling||e.previousSibling:n.first?i.reverse().find(({column:o})=>o<n.first).cell:i.reverse().find(({column:o})=>o>n.last).cell}function Tj(i,e){const t=e.getSelectionAffectedTableCells(i),n=t[0],s=t.pop(),o=[n,s];return n.isBefore(s)?o:o.reverse()}class Ej extends me{refresh(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection);if(n.length===0){this.isEnabled=!1,this.value=!1;return}const s=n[0].findAncestor("table");this.isEnabled=t.schema.checkAttribute(s,"headingRows"),this.value=n.every(o=>this._isInHeading(o,o.parent.parent))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:a,last:c}=t.getRowIndexes(s),u=this.value?a:c+1,h=o.getAttribute("headingRows")||0;n.change(m=>{if(u){const g=u>h?h:0,w=K2(o,u,g);for(const{cell:_}of w)Y2(_,u,m)}t.setHeadingRowsCount(m,o,u)})}_isInHeading(e,t){const n=parseInt(t.getAttribute("headingRows")||"0");return!!n&&e.parent.index<n}}class Sj extends me{refresh(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection);if(n.length===0){this.isEnabled=!1,this.value=!1;return}const s=n[0].findAncestor("table");this.isEnabled=t.schema.checkAttribute(s,"headingColumns"),this.value=n.every(o=>pb(e,o))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:a,last:c}=t.getColumnIndexes(s),u=this.value?a:c+1;n.change(h=>{if(u){const m=J2(o,u);for(const{cell:g,column:w}of m)Q2(g,w,u,h)}t.setHeadingColumnsCount(h,o,u)})}}function Aj(i){if(i.is("element","tableColumnGroup"))return i;const e=i.getChildren();return Array.from(e).find(t=>t.is("element","tableColumnGroup"))}function xj(i){const e=Aj(i);return e?Array.from(e.getChildren()):[]}class Ot extends N{static get pluginName(){return"TableUtils"}static get isOfficialPlugin(){return!0}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,n=t.parent,s=n.getChildIndex(t),o=new Pe(n,{row:s});for(const{cell:a,row:c,column:u}of o)if(a===e)return{row:c,column:u};}createTable(e,t){const n=e.createElement("table"),s=t.rows||2,o=t.columns||2;return Op(e,n,0,s,o),t.headingRows&&this.setHeadingRowsCount(e,n,Math.min(t.headingRows,s)),t.headingColumns&&this.setHeadingColumnsCount(e,n,Math.min(t.headingColumns,o)),n}insertRows(e,t={}){const n=this.editor.model,s=t.at||0,o=t.rows||1,a=t.copyStructureFromAbove!==void 0,c=t.copyStructureFromAbove?s-1:s,u=gs(this.editor),h=this.getRows(e),m=this.getColumns(e);if(s>h)throw new E("tableutils-insertrows-insert-out-of-range",this,{options:t});n.change(g=>{let w=e.getAttribute("headingRows")||0;const _=e.getAttribute("headingColumns")||0;if(w>s&&(w+=o,this.setHeadingRowsCount(g,e,w,{shallow:!0})),!a&&(s===0||s===h)){const A=Op(g,e,s,o,m);if(u)for(let L=0;L<A.length;L++){const z=A[L];for(let j=0;j<m;j++){const Z=z[j];(s+L<w||j<_)&&g.setAttribute("tableCellType","header",Z)}}return}const v=a?Math.max(s,c):s,C=new Pe(e,{endRow:v}),T=new Array(m).fill(1);for(const{row:A,column:L,cellHeight:z,cellWidth:j,cell:Z}of C){const ne=A+z-1,M=A<s&&s<=ne,J=A<=c&&c<=ne;M?(g.setAttribute("rowspan",z+o,Z),T[L]=-j):a&&J&&(T[L]=j)}for(let A=0;A<o;A++){const L=g.createElement("tableRow");g.insert(L,e,s);for(let z=0;z<T.length;z++){const j=T[z],Z=g.createPositionAt(L,"end");if(j>0){const ne=cr(g,Z,j>1?{colspan:j}:void 0);u&&(s+A<w||z<_)&&g.setAttribute("tableCellType","header",ne)}z+=Math.abs(j)-1}}})}insertColumns(e,t={}){const n=this.editor.model,s=t.at||0,o=t.columns||1,a=gs(this.editor);n.change(c=>{const u=e.getAttribute("headingRows")||0;let h=e.getAttribute("headingColumns");s<h&&(h+=o,this.setHeadingColumnsCount(c,e,h,{shallow:!0}));const m=this.getColumns(e);if(s===0||m===s){let w=0;for(const _ of e.getChildren()){if(!_.is("element","tableRow"))continue;const v=ca(o,c,c.createPositionAt(_,s?"end":0));if(a)for(let C=0;C<v.length;C++)(s+C<h||w<u)&&c.setAttribute("tableCellType","header",v[C]);w++}return}const g=new Pe(e,{column:s,includeAllSlots:!0});for(const w of g){const{row:_,cell:v,cellAnchorColumn:C,cellAnchorRow:T,cellWidth:A,cellHeight:L}=w;if(C<s){c.setAttribute("colspan",A+o,v);const z=T+L-1;for(let j=_;j<=z;j++)g.skipRow(j)}else{const z=ca(o,c,w.getPositionBefore());if(a)for(let j=0;j<z.length;j++)(s+j<h||_<u)&&c.setAttribute("tableCellType","header",z[j])}}})}removeRows(e,t){const n=this.editor.model,s=t.rows||1,o=this.getRows(e),a=t.at,c=a+s-1;if(c>o-1)throw new E("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});n.change(u=>{const h={first:a,last:c},{cellsToMove:m,cellsToTrim:g}=Rj(e,h);if(m.size){const w=c+1;Oj(e,w,m,u)}for(let w=c;w>=a;w--)u.remove(e.getChild(w));for(const{rowspan:w,cell:_}of g)_t("rowspan",w,_,u);if(Pj(e,h,u),bb(e,this)||wb(e,this),gs(this.editor)){let w=e.getAttribute("headingRows")||0;const _=this.getRows(e);for(;w<_&&sa({table:e,row:w});)w++;this.setHeadingRowsCount(u,e,w,{shallow:!0})}})}removeColumns(e,t){const n=this.editor.model,s=t.at,o=t.columns||1,a=t.at+o-1;n.change(c=>{Ij(e,{first:s,last:a},c);const u=xj(e);for(let h=a;h>=s;h--){for(const{cell:m,column:g,cellWidth:w}of[...new Pe(e)])g<=h&&w>1&&g+w>h?_t("colspan",w-1,m,c):g===h&&c.remove(m);if(u[h]){const m=h===0?u[1]:u[h-1],g=parseFloat(u[h].getAttribute("columnWidth")),w=parseFloat(m.getAttribute("columnWidth"));c.remove(u[h]),c.setAttribute("columnWidth",g+w+"%",m)}}if(wb(e,this)||bb(e,this),gs(this.editor)){let h=e.getAttribute("headingColumns")||0;const m=this.getColumns(e);for(;h<m&&sa({table:e,column:h});)h++;this.setHeadingColumnsCount(c,e,h,{shallow:!0})}})}splitCellVertically(e,t=2){const n=this.editor.model,o=e.parent.parent,a=parseInt(e.getAttribute("rowspan")||"1"),c=parseInt(e.getAttribute("colspan")||"1");n.change(u=>{if(c>1){const{newCellsSpan:h,updatedSpan:m}=PT(c,t);_t("colspan",m,e,u);const g={};h>1&&(g.colspan=h),a>1&&(g.rowspan=a);const w=c>t?t-1:c-1;ca(w,u,u.createPositionAfter(e),g)}if(c<t){const h=t-c,m=[...new Pe(o)],{column:g}=m.find(({cell:C})=>C===e),w=m.filter(({cell:C,cellWidth:T,column:A})=>{const L=C!==e&&A===g,z=A<g&&A+T>g;return L||z});for(const{cell:C,cellWidth:T}of w)u.setAttribute("colspan",T+h,C);const _={};a>1&&(_.rowspan=a),ca(h,u,u.createPositionAfter(e),_);const v=o.getAttribute("headingColumns")||0;v>g&&_t("headingColumns",v+h,o,u)}})}splitCellHorizontally(e,t=2){const n=this.editor.model,s=e.parent,o=s.parent,a=o.getChildIndex(s),c=parseInt(e.getAttribute("rowspan")||"1"),u=parseInt(e.getAttribute("colspan")||"1");n.change(h=>{if(c>1){const m=[...new Pe(o,{startRow:a,endRow:a+c-1,includeAllSlots:!0})],{newCellsSpan:g,updatedSpan:w}=PT(c,t);_t("rowspan",w,e,h);const{column:_}=m.find(({cell:T})=>T===e),v={};g>1&&(v.rowspan=g),u>1&&(v.colspan=u);let C=0;for(const T of m){const{column:A,row:L}=T,z=L>=a+w,j=A===_;C>=g&&j&&(C=0),z&&j&&(C||ca(1,h,T.getPositionBefore(),v),C++)}}if(c<t){const m=t-c,g=[...new Pe(o,{startRow:0,endRow:a})];for(const{cell:v,cellHeight:C,row:T}of g)if(v!==e&&T+C>a){const A=C+m;h.setAttribute("rowspan",A,v)}const w={};u>1&&(w.colspan=u),Op(h,o,a+1,m,1,w);const _=o.getAttribute("headingRows")||0;_>a&&_t("headingRows",_+m,o,h)}})}getColumns(e){return[...e.getChild(0).getChildren()].filter(n=>n.is("element","tableCell")).reduce((n,s)=>{const o=parseInt(s.getAttribute("colspan")||"1");return n+o},0)}getRows(e){return Array.from(e.getChildren()).reduce((t,n)=>n.is("element","tableRow")?t+1:t,0)}createTableWalker(e,t={}){return new Pe(e,t)}getSelectedTableCells(e){const t=[];for(const n of this.sortRanges(e.getRanges())){const s=n.getContainedElement();s&&s.is("element","tableCell")&&t.push(s)}return t}setHeadingRowsCount(e,t,n,s={}){const{shallow:o,resetFormerHeadingCells:a=!0,autoExpand:c=!0}=s,u=t.getAttribute("headingRows")||0;if(n!==u&&(_t("headingRows",n,t,e,0),!(o||!gs(this.editor)))){for(const{cell:h,row:m,column:g}of new Pe(t,{endRow:n-1}))Rd({table:t,writer:e,cell:h,row:m,column:g});if(a&&n<u)for(let h=n;h<u&&sa({table:t,row:h});h++)for(const{cell:m,row:g,column:w}of new Pe(t,{row:h}))Rd({table:t,writer:e,cell:m,row:g,column:w});if(c&&n>u){const h=this.getRows(t);for(;n<h&&sa({table:t,row:n});)n++;_t("headingRows",n,t,e,0)}}}setHeadingColumnsCount(e,t,n,s={}){const{shallow:o,resetFormerHeadingCells:a=!0,autoExpand:c=!0}=s,u=t.getAttribute("headingColumns")||0;if(n!==u&&(_t("headingColumns",n,t,e,0),!(o||!gs(this.editor)))){for(const{cell:h,row:m,column:g}of new Pe(t,{endColumn:n-1}))Rd({table:t,writer:e,cell:h,row:m,column:g});if(a&&n<u)for(let h=n;h<u&&sa({table:t,column:h});h++)for(const{cell:m,row:g,column:w}of new Pe(t,{column:h}))Rd({table:t,writer:e,cell:m,row:g,column:w});if(c&&n>u){const h=this.getColumns(t);for(;n<h&&sa({table:t,column:n});)n++;_t("headingColumns",n,t,e,0)}}}getTableCellsContainingSelection(e){const t=[];for(const n of e.getRanges()){const s=n.start.findAncestor("tableCell");s&&t.push(s)}return t}getSelectionAffectedTableCells(e){const t=this.getSelectedTableCells(e);return t.length?t:this.getTableCellsContainingSelection(e)}getRowIndexes(e){const t=e.map(n=>n.parent.index);return this._getFirstLastIndexesObject(t)}getColumnIndexes(e){const t=e[0].findAncestor("table"),s=[...new Pe(t)].filter(o=>e.includes(o.cell)).map(o=>o.column);return this._getFirstLastIndexesObject(s)}isSelectionRectangular(e){if(e.length<2||!this._areCellInTheSameTableSection(e))return!1;const t=new Set,n=new Set;let s=0;for(const a of e){const{row:c,column:u}=this.getCellLocation(a),h=parseInt(a.getAttribute("rowspan"))||1,m=parseInt(a.getAttribute("colspan"))||1;t.add(c),n.add(u),h>1&&t.add(c+h-1),m>1&&n.add(u+m-1),s+=h*m}return Bj(t,n)==s}sortRanges(e){return Array.from(e).sort(Vj)}_getFirstLastIndexesObject(e){const t=e.sort((o,a)=>o-a),n=t[0],s=t[t.length-1];return{first:n,last:s}}_areCellInTheSameTableSection(e){const t=e[0].findAncestor("table"),n=this.getRowIndexes(e),s=parseInt(t.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(n,s))return!1;const o=this.getColumnIndexes(e),a=parseInt(t.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(o,a)}_areIndexesInSameSection({first:e,last:t},n){const s=e<n,o=t<n;return s===o}}function Op(i,e,t,n,s,o={}){const a=[];for(let c=0;c<n;c++){const u=i.createElement("tableRow");i.insert(u,e,t),a.push(ca(s,i,i.createPositionAt(u,"end"),o))}return a}function ca(i,e,t,n={}){const s=[];let o=t;for(let a=0;a<i;a++){const c=cr(e,o,n);s.push(c),o=e.createPositionAfter(c)}return s}function PT(i,e){if(i<e)return{newCellsSpan:1,updatedSpan:1};const t=Math.floor(i/e),n=i-t*e+t;return{newCellsSpan:t,updatedSpan:n}}function Ij(i,e,t){const n=i.getAttribute("headingColumns")||0;if(n&&e.first<n){const s=Math.min(n-1,e.last)-e.first+1;t.setAttribute("headingColumns",n-s,i)}}function Pj(i,{first:e,last:t},n){const s=i.getAttribute("headingRows")||0;if(e<s){const o=t<s?s-(t-e+1):e;_t("headingRows",o,i,n,0)}}function Rj(i,{first:e,last:t}){const n=new Map,s=[];for(const{row:o,column:a,cellHeight:c,cell:u}of new Pe(i,{endRow:t})){const h=o+c-1;if(o>=e&&o<=t&&h>t){const w=t-o+1,_=c-w;n.set(a,{cell:u,rowspan:_})}if(o<e&&h>=e){let w;h>=t?w=t-e+1:w=h-e+1,s.push({cell:u,rowspan:c-w})}}return{cellsToMove:n,cellsToTrim:s}}function Oj(i,e,t,n){const o=[...new Pe(i,{includeAllSlots:!0,row:e})],a=i.getChild(e);let c;for(const{column:u,cell:h,isAnchor:m}of o)if(t.has(u)){const{cell:g,rowspan:w}=t.get(u),_=c?n.createPositionAfter(c):n.createPositionAt(a,0);n.move(n.createRangeOn(g),_),_t("rowspan",w,g,n),c=g}else m&&(c=h)}function Vj(i,e){const t=i.start,n=e.start;return t.isBefore(n)?-1:1}function Bj(i,e){const t=Array.from(i.values()),n=Array.from(e.values()),s=Math.max(...t),o=Math.min(...t),a=Math.max(...n),c=Math.min(...n);return(s-o+1)*(a-c+1)}function Rd({writer:i,table:e,row:t,column:n,cell:s}){const o=e.getAttribute("headingRows")||0,a=e.getAttribute("headingColumns")||0;t>=o&&n>=a?i.removeAttribute("tableCellType",s):i.setAttribute("tableCellType","header",s)}class Mj extends me{refresh(){const e=this.editor.plugins.get(Ot),t=e.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=e.isSelectionRectangular(t)}execute(){const e=this.editor.model,t=this.editor.plugins.get(Ot);e.change(n=>{const s=t.getSelectedTableCells(e.document.selection),o=s.shift(),{mergeWidth:a,mergeHeight:c}=Lj(o,s,t);_t("colspan",a,o,n),_t("rowspan",c,o,n);for(const h of s)Nj(h,o,n);const u=o.findAncestor("table");Rw(u,t),n.setSelection(o,"in")})}}function Nj(i,e,t){RT(i)||(RT(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function RT(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}function Lj(i,e,t){let n=0,s=0;for(const h of e){const{row:m,column:g}=t.getCellLocation(h);n=OT(h,g,n,"colspan"),s=OT(h,m,s,"rowspan")}const{row:o,column:a}=t.getCellLocation(i),c=n-a,u=s-o;return{mergeWidth:c,mergeHeight:u}}function OT(i,e,t,n){const s=parseInt(i.getAttribute(n)||"1");return Math.max(t,e+s)}class Dj extends me{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0].findAncestor("table"),a=[];for(let c=s.first;c<=s.last;c++)for(const u of o.getChild(c).getChildren())a.push(e.createRangeOn(u));e.change(c=>{c.setSelection(a)})}}class Fj extends me{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection),s=n[0],o=n.pop(),a=s.findAncestor("table"),c=e.getCellLocation(s),u=e.getCellLocation(o),h=Math.min(c.column,u.column),m=Math.max(c.column,u.column),g=[];for(const w of new Pe(a,{startColumn:h,endColumn:m}))g.push(t.createRangeOn(w.cell));t.change(w=>{w.setSelection(g)})}}function zj(i){i.document.registerPostFixer(e=>Uj(e,i))}function Uj(i,e){const t=e.document.differ.getChanges();let n=!1;const s=new Set;for(const o of t){let a=null;o.type=="insert"&&o.name=="table"&&(a=o.position.nodeAfter),(o.type=="insert"||o.type=="remove")&&(o.name=="tableRow"||o.name=="tableCell")&&(a=o.position.findAncestor("table")),$j(o)&&(a=o.range.start.findAncestor("table")),a&&!s.has(a)&&(n=Hj(a,i)||n,n=jj(a,i)||n,s.add(a))}return n}function Hj(i,e){let t=!1;const n=qj(i);if(n.length){t=!0;for(const s of n)_t("rowspan",s.rowspan,s.cell,e,1)}return t}function jj(i,e){let t=!1;const n=Wj(i),s=[];for(const[u,h]of n.entries())!h&&i.getChild(u).is("element","tableRow")&&s.push(u);if(s.length){t=!0;for(const u of s.reverse())e.remove(i.getChild(u)),n.splice(u,1)}const o=n.filter((u,h)=>i.getChild(h).is("element","tableRow")),a=o[0];if(!o.every(u=>u===a)){const u=o.reduce((h,m)=>m>h?m:h,0);for(const[h,m]of o.entries()){const g=u-m;if(g){for(let w=0;w<g;w++)cr(e,e.createPositionAt(i.getChild(h),"end"));t=!0}}}return t}function qj(i){const e=parseInt(i.getAttribute("headingRows")||"0"),t=Array.from(i.getChildren()).reduce((s,o)=>o.is("element","tableRow")?s+1:s,0),n=[];for(const{row:s,cell:o,cellHeight:a}of new Pe(i)){if(a<2)continue;const u=s<e?e:t;if(s+a>u){const h=u-s;n.push({cell:o,rowspan:h})}}return n}function Wj(i){const e=new Array(i.childCount).fill(0);for(const{rowIndex:t}of new Pe(i,{includeAllSlots:!0}))e[t]++;return e}function $j(i){if(i.type!=="attribute")return!1;const e=i.attributeKey;return e==="headingRows"||e==="colspan"||e==="rowspan"}function Gj(i){i.document.registerPostFixer(e=>Kj(e,i))}function Kj(i,e){const t=e.document.differ.getChanges();let n=!1;for(const s of t)s.type=="insert"&&s.name=="table"&&(n=Yj(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableRow"&&(n=ix(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableCell"&&(n=_b(s.position.nodeAfter,i)||n),(s.type=="remove"||s.type=="insert")&&Jj(s)&&(n=_b(s.position.parent,i)||n);return n}function Yj(i,e){let t=!1;for(const n of i.getChildren())n.is("element","tableRow")&&(t=ix(n,e)||t);return t}function ix(i,e){let t=!1;for(const n of i.getChildren())t=_b(n,e)||t;return t}function _b(i,e){if(i.childCount==0)return e.insertElement("paragraph",i),!0;const t=Array.from(i.getChildren()).filter(n=>n.is("$text"));for(const n of t)e.wrap(e.createRangeOn(n),"paragraph");return!!t.length}function Jj(i){return i.position.parent.is("element","tableCell")?i.type=="insert"&&i.name=="$text"||i.type=="remove":!1}function Qj(i,e){const t=i.document.differ;for(const n of t.getChanges()){let s,o=!1;if(n.type=="attribute"){const h=n.range.start.nodeAfter;if(!h||!h.is("element","table")||n.attributeKey!="headingRows"&&n.attributeKey!="headingColumns")continue;s=h,o=n.attributeKey=="headingRows"}else(n.name=="tableRow"||n.name=="tableCell")&&(s=n.position.findAncestor("table"),o=n.name=="tableRow");if(!s)continue;const a=s.getAttribute("headingRows")||0,c=s.getAttribute("headingColumns")||0,u=new Pe(s);for(const h of u){const g=h.row<a||h.column<c?"th":"td",w=e.mapper.toViewElement(h.cell);w&&w.is("element")&&w.name!=g&&e.reconvertItem(o?h.cell.parent:h.cell)}}}function Xj(i,e){const t=i.document.differ,n=new Set;for(const s of t.getChanges()){const o=s.type=="attribute"?s.range.start.parent:s.position.parent;o.is("element","tableCell")&&n.add(o)}for(const s of n.values()){const o=Array.from(s.getChildren()).filter(a=>Zj(a,e.mapper));for(const a of o)e.reconvertItem(a)}}function Zj(i,e){if(!i.is("element","paragraph"))return!1;const t=e.toViewElement(i);return t?nx(i)!==t.is("element","span"):!1}class nf extends N{_additionalSlots;static get pluginName(){return"TableEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[Ot]}constructor(e){super(e),this._additionalSlots=[]}init(){const e=this.editor,t=e.model,n=t.schema,s=e.conversion,o=e.plugins.get(Ot);n.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),s.for("upcast").add(ij()),s.for("upcast").add(sj()),s.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:kT(o,{asWidget:!0,additionalSlots:this._additionalSlots})}),s.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:kT(o,{additionalSlots:this._additionalSlots})}),s.for("upcast").elementToElement({model:"tableRow",view:"tr"}),s.for("upcast").add(oj()),s.for("downcast").elementToElement({model:"tableRow",view:lj()}),s.for("upcast").elementToElement({model:"tableCell",view:"td"}),s.for("upcast").elementToElement({model:"tableCell",view:"th"}),s.for("upcast").add(CT("td")),s.for("upcast").add(CT("th")),s.for("editingDowncast").elementToElement({model:"tableCell",view:TT({asWidget:!0,cellTypeEnabled:()=>gs(this.editor)})}),s.for("dataDowncast").elementToElement({model:"tableCell",view:TT({cellTypeEnabled:()=>gs(this.editor)})}),s.for("editingDowncast").elementToElement({model:"paragraph",view:ET({asWidget:!0}),converterPriority:"high"}),s.for("dataDowncast").elementToElement({model:"paragraph",view:ET(),converterPriority:"high"}),s.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),s.for("upcast").attributeToAttribute({model:{key:"colspan",value:VT("colspan")},view:"colspan"}),s.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),s.for("upcast").attributeToAttribute({model:{key:"rowspan",value:VT("rowspan")},view:"rowspan"}),this._addPlainTableOutputConverters(),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.config.define("table.showHiddenBorders",!0),e.config.get("table.showHiddenBorders")&&e.editing.view.change(a=>{for(const c of e.editing.view.document.roots)a.addClass("ck-table-show-hidden-borders",c)}),e.commands.add("insertTable",new gj(e)),e.commands.add("insertTableRowAbove",new ST(e,{order:"above"})),e.commands.add("insertTableRowBelow",new ST(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new AT(e,{order:"left"})),e.commands.add("insertTableColumnRight",new AT(e,{order:"right"})),e.commands.add("removeTableRow",new yj(e)),e.commands.add("removeTableColumn",new Cj(e)),e.commands.add("splitTableCellVertically",new xT(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new xT(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new Mj(e)),e.commands.add("mergeTableCellRight",new Pd(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new Pd(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new Pd(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new Pd(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new Sj(e)),e.commands.add("setTableRowHeader",new Ej(e)),e.commands.add("selectTableRow",new Dj(e)),e.commands.add("selectTableColumn",new Fj(e)),zj(t),Gj(t),this.listenTo(t.document,"change:data",()=>{gs(e)||Qj(t,e.editing),Xj(t,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}_addPlainTableOutputConverters(){const e=this.editor;e.conversion.for("dataDowncast").elementToStructure({model:"table",view:dj(e),converterPriority:"high"}),e.plugins.has("TableCaptionEditing")&&e.conversion.for("dataDowncast").elementToElement({model:"caption",view:hj(e),converterPriority:"high"}),e.plugins.has("TablePropertiesEditing")&&mj(e)}}function VT(i){return e=>{const t=parseInt(e.getAttribute(i));return Number.isNaN(t)||t<=0?null:t}}class BT extends oe{items;keystrokes;focusTracker;constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new Ct,this.focusTracker=new dt,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(n,s)=>`${s}  ${n}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:t.to("label")}]}],on:{mousedown:t.to(n=>{n.preventDefault()}),click:t.to(()=>{this.fire("execute")})}}),this.on("boxover",(n,s)=>{const{row:o,column:a}=s.target.dataset;this.items.get((parseInt(o,10)-1)*10+(parseInt(a,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(n,s,o)=>{if(!o)return;const{row:a,column:c}=o.dataset;this.set({rows:parseInt(a),columns:parseInt(c)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),yA({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}reset(){this.set({rows:1,columns:1})}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map((n,s)=>{const o=Math.floor(s/10),a=s%10,c=o<e&&a<t;n.set("isOn",c)})}_createGridButton(e,t,n,s){const o=new ue(e);return o.set({label:s,class:"ck-insert-table-dropdown-grid-box"}),o.extendTemplate({attributes:{"data-row":t,"data-column":n}}),o}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const n=Math.floor(t/10),s=t%10,o=`${n+1}  ${s+1}`;e.push(this._createGridButton(this.locale,n+1,s+1,o))}return this.createCollection(e)}}class eq extends N{static get pluginName(){return"TableUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t,s=e.locale.contentLanguageDirection==="ltr";e.ui.componentFactory.add("insertTable",o=>{const a=e.commands.get("insertTable"),c=$t(o);c.bind("isEnabled").to(a),c.buttonView.set({icon:AC,label:t("Insert table"),tooltip:!0});let u;return c.on("change:isOpen",()=>{u||(u=new BT(o),c.panelView.children.add(u),u.delegate("execute").to(c),c.on("execute",()=>{e.execute("insertTable",{rows:u.rows,columns:u.columns}),e.editing.view.focus()}))}),c}),e.ui.componentFactory.add("menuBar:insertTable",o=>{const a=e.commands.get("insertTable"),c=new vn(o),u=new BT(o);return u.delegate("execute").to(c),c.on("change:isOpen",(h,m,g)=>{g||u.reset()}),u.on("execute",()=>{e.execute("insertTable",{rows:u.rows,columns:u.columns}),e.editing.view.focus()}),c.buttonView.set({label:t("Table"),icon:AC}),c.panelView.children.add(u),c.bind("isEnabled").to(a),c}),e.ui.componentFactory.add("tableColumn",o=>{const a=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:s?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:s?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),UN,a,o)}),e.ui.componentFactory.add("tableRow",o=>{const a=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),qN,a,o)}),e.ui.componentFactory.add("mergeTableCells",o=>{const a=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:s?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:s?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),HN,a,o)})}_prepareDropdown(e,t,n,s){const o=this.editor,a=$t(s),c=this._fillDropdownWithListOptions(a,n);return a.buttonView.set({label:e,icon:t,tooltip:!0}),a.bind("isEnabled").toMany(c,"isEnabled",(...u)=>u.some(h=>h)),this.listenTo(a,"execute",u=>{o.execute(u.source.commandName),u.source instanceof Gh||o.editing.view.focus()}),a}_prepareMergeSplitButtonDropdown(e,t,n,s){const o=this.editor,a=$t(s,Aa),c="mergeTableCells",u=o.commands.get(c),h=this._fillDropdownWithListOptions(a,n);return a.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),a.bind("isEnabled").toMany([u,...h],"isEnabled",(...m)=>m.some(g=>g)),this.listenTo(a.buttonView,"execute",()=>{o.execute(c),o.editing.view.focus()}),this.listenTo(a,"execute",m=>{o.execute(m.source.commandName),o.editing.view.focus()}),a}_fillDropdownWithListOptions(e,t){const n=this.editor,s=[],o=new Dt;for(const a of t)tq(a,n,s,o);return mo(e,o),s}}function tq(i,e,t,n){if(i.type==="button"||i.type==="switchbutton"){const s=i.model=new co(i.model),{commandName:o,bindIsOn:a}=i.model,c=e.commands.get(o);t.push(c),s.set({commandName:o}),s.bind("isEnabled").to(c),a&&s.bind("isOn").to(c,"value"),s.set({withText:!0})}n.add(i)}class oo extends N{static get pluginName(){return"TableSelection"}static get isOfficialPlugin(){return!0}static get requires(){return[Ot,Ot]}init(){const e=this.editor,t=e.model,n=e.editing.view;this.listenTo(t,"deleteContent",(s,o)=>this._handleDeleteContent(s,o),{priority:"high"}),this.listenTo(n.document,"insertText",(s,o)=>this._handleInsertTextEvent(s,o),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.plugins.get(Ot),t=this.editor.model.document.selection,n=e.getSelectedTableCells(t);return n.length==0?null:n}getSelectionAsFragment(){const e=this.editor.plugins.get(Ot),t=this.getSelectedTableCells();return t?this.editor.model.change(n=>{const s=n.createDocumentFragment(),{first:o,last:a}=e.getColumnIndexes(t),{first:c,last:u}=e.getRowIndexes(t),h=t[0].findAncestor("table");let m=u,g=a;if(e.isSelectionRectangular(t)){const v={firstColumn:o,lastColumn:a,firstRow:c,lastRow:u};m=Z2(h,v),g=ex(h,v)}const _=G2(h,{startRow:c,startColumn:o,endRow:m,endColumn:g},n);return n.insert(_,s,0),s}):null}setCellSelection(e,t){const n=this._getCellsToSelect(e,t);this.editor.model.change(s=>{s.setSelection(n.cells.map(o=>s.createRangeOn(o)),{backward:n.backward})})}getFocusCell(){const n=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return n&&n.is("element","tableCell")?n:null}getAnchorCell(){const e=this.editor.model.document.selection,n=Ze(e.getRanges()).getContainedElement();return n&&n.is("element","tableCell")?n:null}_defineSelectionConverter(){const e=this.editor,t=new Set;e.conversion.for("editingDowncast").add(s=>s.on("selection",(o,a,c)=>{const u=c.writer;n(u);const h=this.getSelectedTableCells();if(!h)return;for(const g of h){const w=c.mapper.toViewElement(g);u.addClass("ck-editor__editable_selected",w),t.add(w)}const m=c.mapper.toViewElement(h[h.length-1]);u.setSelection(m,0)},{priority:"lowest"}));function n(s){for(const o of t)s.removeClass("ck-editor__editable_selected",o);t.clear()}}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change(n=>{const s=n.createPositionAt(t[0],0),o=e.model.schema.getNearestSelectionRange(s);n.setSelection(o)})}})}_handleDeleteContent(e,t){const n=this.editor.plugins.get(Ot),s=t[0],o=t[1],a=this.editor.model,c=!o||o.direction=="backward",u=n.getSelectedTableCells(s);u.length&&(e.stop(),a.change(h=>{const m=u[c?u.length-1:0];a.change(w=>{for(const _ of u)a.deleteContent(w.createSelection(_,"in"))});const g=a.schema.getNearestSelectionRange(h.createPositionAt(m,0));s.is("documentSelection")?h.setSelection(g):s.setTo(g)}))}_handleInsertTextEvent(e,t){const n=this.editor,s=this.getSelectedTableCells();if(!s)return;const o=n.editing.view,a=n.editing.mapper,c=s.map(u=>o.createRangeOn(a.toViewElement(u)));t.selection=o.createSelection(c),t.preventDefault()}_getCellsToSelect(e,t){const n=this.editor.plugins.get("TableUtils"),s=n.getCellLocation(e),o=n.getCellLocation(t),a=Math.min(s.row,o.row),c=Math.max(s.row,o.row),u=Math.min(s.column,o.column),h=parseInt(t.getAttribute("colspan")||"1")-1,m=Math.max(s.column,o.column+h),g=new Array(c-a+1).fill(null).map(()=>[]),w={startRow:a,endRow:c,startColumn:u,endColumn:m};for(const{row:C,cell:T}of new Pe(e.findAncestor("table"),w))g[C-a].push(T);const _=o.row<s.row,v=o.column<s.column;return _&&g.reverse(),v&&g.forEach(C=>C.reverse()),{cells:g.flat(),backward:_||v}}}class nq extends N{static get pluginName(){return"TableClipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[ic,zn,oo,Ot]}init(){const t=this.editor.editing.view.document;this.listenTo(t,"copy",(n,s)=>this._onCopyCut(n,s)),this.listenTo(t,"cut",(n,s)=>this._onCopyCut(n,s)),this._listenToContentInsertion(),this.decorate("_replaceTableSlotCell")}_listenToContentInsertion(){const{editor:e}=this,t=e.plugins.get(zn),n=e.plugins.get(oo);let s=!1;t.on("contentInsertion",(o,a)=>{s=a.method==="paste"}),this.listenTo(e.model,"insertContent",(o,[a,c])=>{(s||n.getSelectedTableCells()!==null)&&this._onInsertContent(o,a,c)},{priority:"high"}),t.on("contentInsertion",()=>{s=!1},{priority:"lowest"})}_onCopyCut(e,t){const n=this.editor.editing.view,s=this.editor.plugins.get(oo),o=this.editor.plugins.get(ic);s.getSelectedTableCells()&&(e.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection)||(t.preventDefault(),e.stop(),this.editor.model.enqueueChange({isUndoable:e.name==="cut"},()=>{const a=o._copySelectedFragmentWithMarkers(e.name,this.editor.model.document.selection,()=>s.getSelectionAsFragment());n.document.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:this.editor.data.toView(a),method:e.name})})))}_onInsertContent(e,t,n){if(n&&!n.is("documentSelection"))return;const s=this.editor.model,o=this.editor.plugins.get(Ot),a=this.editor.plugins.get(ic),c=this.getTableIfOnlyTableInContent(t,s);if(!c)return;const u=o.getSelectionAffectedTableCells(s.document.selection);if(!u.length){Rw(c,o);return}e.stop(),t.is("documentFragment")?a._pasteMarkersIntoTransformedElement(t.markers,h=>this._replaceSelectedCells(c,u,h)):this.editor.model.change(h=>{this._replaceSelectedCells(c,u,h)})}_replaceSelectedCells(e,t,n){const s=this.editor.plugins.get(Ot),o={width:s.getColumns(e),height:s.getRows(e)},a=iq(t,o,n,s),c=a.lastRow-a.firstRow+1,u=a.lastColumn-a.firstColumn+1,h={startRow:0,startColumn:0,endRow:Math.min(c,o.height)-1,endColumn:Math.min(u,o.width)-1};e=G2(e,h,n);const m=t[0].findAncestor("table"),g=this._replaceSelectedCellsWithPasted(e,o,m,a,n);if(this.editor.plugins.get("TableSelection").isEnabled){const w=s.sortRanges(g.map(_=>n.createRangeOn(_)));n.setSelection(w)}else n.setSelection(g[0],0);return m}_replaceSelectedCellsWithPasted(e,t,n,s,o){const{width:a,height:c}=t,u=oq(e,a,c),h=[...new Pe(n,{startRow:s.firstRow,endRow:s.lastRow,startColumn:s.firstColumn,endColumn:s.lastColumn,includeAllSlots:!0})],m=[];let g;for(const T of h){const{row:A,column:L}=T;L===s.firstColumn&&(g=T.getPositionBefore());const z=A-s.firstRow,j=L-s.firstColumn,Z=u[z%c][j%a],ne=Z?o.cloneElement(Z):null,M=this._replaceTableSlotCell(T,ne,g,o);M&&(X2(M,A,L,s.lastRow,s.lastColumn,o),m.push(M),g=o.createPositionAfter(M))}const w=parseInt(n.getAttribute("headingRows")||"0"),_=parseInt(n.getAttribute("headingColumns")||"0"),v=s.firstRow<w&&w<=s.lastRow,C=s.firstColumn<_&&_<=s.lastColumn;if(v){const T={first:s.firstColumn,last:s.lastColumn},A=yb(n,w,T,o,s.firstRow);m.push(...A)}if(C){const T={first:s.firstRow,last:s.lastRow},A=vb(n,_,T,o);m.push(...A)}return m}_replaceTableSlotCell(e,t,n,s){const{cell:o,isAnchor:a}=e;return a&&s.remove(o),t?(s.insert(t,n),t):null}getTableIfOnlyTableInContent(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(e.childCount==1&&e.getChild(0).is("element","table"))return e.getChild(0);const n=t.createRangeIn(e);for(const s of n.getItems())if(s.is("element","table")){const o=t.createRange(n.start,t.createPositionBefore(s));if(t.hasContent(o,{ignoreWhitespaces:!0}))return null;const a=t.createRange(t.createPositionAfter(s),n.end);return t.hasContent(a,{ignoreWhitespaces:!0})?null:s}return null}}function iq(i,e,t,n){const s=i[0].findAncestor("table"),o=n.getColumnIndexes(i),a=n.getRowIndexes(i),c={firstColumn:o.first,lastColumn:o.last,firstRow:a.first,lastRow:a.last},u=i.length===1;return u&&(c.lastRow+=e.height-1,c.lastColumn+=e.width-1,sq(s,c.lastRow+1,c.lastColumn+1,n)),u||!n.isSelectionRectangular(i)?rq(s,c,t):(c.lastRow=Z2(s,c),c.lastColumn=ex(s,c)),c}function sq(i,e,t,n){const s=n.getColumns(i),o=n.getRows(i);t>s&&n.insertColumns(i,{at:s,columns:t-s}),e>o&&n.insertRows(i,{at:o,rows:e-o})}function oq(i,e,t){const n=new Array(t).fill(null).map(()=>new Array(e).fill(null));for(const{column:s,row:o,cell:a}of new Pe(i))n[o][s]=a;return n}function rq(i,e,t){const{firstRow:n,lastRow:s,firstColumn:o,lastColumn:a}=e,c={first:n,last:s},u={first:o,last:a};vb(i,o,c,t),vb(i,a+1,c,t),yb(i,n,u,t),yb(i,s+1,u,t,n)}function yb(i,e,t,n,s=0){return e<1?void 0:K2(i,e,s).filter(({column:c,cellWidth:u})=>sx(c,u,t)).map(({cell:c})=>Y2(c,e,n))}function vb(i,e,t,n){return e<1?void 0:J2(i,e).filter(({row:a,cellHeight:c})=>sx(a,c,t)).map(({cell:a,column:c})=>Q2(a,c,e,n))}function sx(i,e,t){const n=i+e-1,{first:s,last:o}=t,a=i>=s&&i<=o,c=i<s&&n>=s;return a||c}class aq extends N{static get pluginName(){return"TableKeyboard"}static get isOfficialPlugin(){return!0}static get requires(){return[oo,Ot]}init(){const e=this.editor,n=e.editing.view.document,s=e.t;this.listenTo(n,"arrowKey",(...o)=>this._onArrowKey(...o),{context:"table"}),this.listenTo(n,"tab",(...o)=>this._handleTabOnSelectedTable(...o),{context:"figure"}),this.listenTo(n,"tab",(...o)=>this._handleTab(...o),{context:["th","td"]}),e.accessibility.addKeystrokeInfoGroup({id:"table",label:s("Keystrokes that can be used in a table cell"),keystrokes:[{label:s("Move the selection to the next cell"),keystroke:"Tab"},{label:s("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:s("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:s("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]})}_handleTabOnSelectedTable(e,t){const o=this.editor.model.document.selection.getSelectedElement();!o||!o.is("element","table")||t.stopPropagation()}_handleTab(e,t){const n=this.editor,s=this.editor.plugins.get(Ot),o=this.editor.plugins.get("TableSelection"),a=n.model.document.selection,c=!t.shiftKey;let u=s.getTableCellsContainingSelection(a)[0];if(u||(u=o.getFocusCell()),!u)return;t.stopPropagation();const h=u.parent,m=h.parent,g=m.getChildIndex(h),_=h.getChildIndex(u)===h.childCount-1,v=g===s.getRows(m)-1;c&&v&&_&&n.execute("insertTableRowBelow")}_onArrowKey(e,t){const n=this.editor,s=t.keyCode,o=Fh(s,n.locale.contentLanguageDirection);this._handleArrowKeys(o,t.shiftKey)&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const n=this.editor.plugins.get(Ot),s=this.editor.plugins.get("TableSelection"),o=this.editor.model,a=o.document.selection,c=["right","down"].includes(e),u=n.getSelectedTableCells(a);if(u.length){let m;return t?m=s.getFocusCell():m=c?u[u.length-1]:u[0],this._navigateFromCellInDirection(m,e,t),!0}const h=a.focus.findAncestor("tableCell");if(!h)return!1;if(!a.isCollapsed)if(t){if(a.isBackward==c&&!a.containsEntireContent(h))return!1}else{const m=a.getSelectedElement();if(!m||!o.schema.isObject(m))return!1}return this._isSelectionAtCellEdge(a,h,c)?(this._navigateFromCellInDirection(h,e,t),!0):!1}_isSelectionAtCellEdge(e,t,n){const s=this.editor.model,o=this.editor.model.schema,a=n?e.getLastPosition():e.getFirstPosition();if(!o.getLimitElement(a).is("element","tableCell"))return s.createPositionAt(t,n?"end":0).isTouching(a);const c=s.createSelection(a);return s.modifySelection(c,{direction:n?"forward":"backward"}),a.isEqual(c.focus)}_navigateFromCellInDirection(e,t,n=!1){const s=this.editor.model,o=e.findAncestor("table"),a=[...new Pe(o,{includeAllSlots:!0})],{row:c,column:u}=a[a.length-1],h=a.find(({cell:L})=>L==e);let{row:m,column:g}=h;switch(t){case"left":g--;break;case"up":m--;break;case"right":g+=h.cellWidth;break;case"down":m+=h.cellHeight;break}const w=m<0||m>c,_=g<0&&m<=0,v=g>u&&m>=c;if(w||_||v){s.change(L=>{L.setSelection(L.createRangeOn(o))});return}g<0?(g=n?0:u,m--):g>u&&(g=n?u:0,m++);const C=a.find(L=>L.row==m&&L.column==g).cell,T=["right","down"].includes(t),A=this.editor.plugins.get("TableSelection");if(n&&A.isEnabled){const L=A.getAnchorCell()||e;A.setCellSelection(L,C)}else{const L=s.createPositionAt(C,T?0:"end");s.change(z=>{z.setSelection(L)})}}}class lq extends Ci{domEventType=["mousemove","mouseleave"];onDomEvent(e){this.fire(e.type,e)}}class cq extends N{static get pluginName(){return"TableMouse"}static get isOfficialPlugin(){return!0}static get requires(){return[oo,Ot]}init(){this.editor.editing.view.addObserver(lq),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor,t=e.plugins.get(Ot);let n=!1;const s=e.plugins.get(oo);this.listenTo(e.editing.view.document,"mousedown",(o,a)=>{const c=e.model.document.selection;if(!this.isEnabled||!s.isEnabled||!a.domEvent.shiftKey)return;const u=s.getAnchorCell()||t.getTableCellsContainingSelection(c)[0];if(!u)return;const h=this._getModelTableCellFromDomEvent(a);h&&MT(u,h)&&(n=!0,s.setCellSelection(u,h),a.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{n=!1}),this.listenTo(e.editing.view.document,"selectionChange",o=>{n&&o.stop()},{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,n,s=!1,o=!1;const a=e.plugins.get(oo);this.listenTo(e.editing.view.document,"mousedown",(c,u)=>{!this.isEnabled||!a.isEnabled||u.domEvent.shiftKey||u.domEvent.ctrlKey||u.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(u))}),this.listenTo(e.editing.view.document,"mousemove",(c,u)=>{if(!u.domEvent.buttons||!t)return;const h=this._getModelTableCellFromDomEvent(u);h&&MT(t,h)&&(n=h,!s&&n!=t&&(s=!0)),s&&(o=!0,a.setCellSelection(t,n),u.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{s=!1,o=!1,t=null,n=null}),this.listenTo(e.editing.view.document,"selectionChange",c=>{o&&c.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,n=this.editor.editing.view.createPositionAt(t,0);return this.editor.editing.mapper.toModelPosition(n).parent.findAncestor("tableCell",{includeSelf:!0})}}function MT(i,e){return i.parent.parent==e.parent.parent}class uq extends N{static get requires(){return[nf,eq,oo,cq,aq,nq,Ia]}static get pluginName(){return"Table"}static get isOfficialPlugin(){return!0}}function vh(i){const e=ox(i);return e||sf(i)}function ox(i){const e=i.getSelectedElement();return e&&rx(e)?e:null}function sf(i){const e=i.getFirstPosition();if(!e)return null;let t=e.parent;for(;t;){if(t.is("element")&&rx(t))return t;t=t.parent}return null}function rx(i){return i.is("element")&&!!i.getCustomProperty("table")&&ct(i)}class dq extends N{static get requires(){return[hh]}static get pluginName(){return"TableToolbar"}static get isOfficialPlugin(){return!0}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(hh),s=e.config.get("table.contentToolbar"),o=e.config.get("table.tableToolbar");s&&n.register("tableContent",{ariaLabel:t("Table toolbar"),items:s,getRelatedElement:sf}),o&&n.register("table",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:ox})}}class hq extends oe{options;focusTracker;focusCycler;_focusables;dropdownView;inputView;keystrokes;_stillTyping;constructor(e,t){super(e),this.set("value",""),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.options=t,this.focusTracker=new dt,this._focusables=new Gt,this.dropdownView=this._createDropdownView(),this.inputView=this._createInputTextView(),this.keystrokes=new Ct,this._stillTyping=!1,this.focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color"]},children:[this.dropdownView,this.inputView]}),this.on("change:value",(n,s,o)=>this._setInputValue(o))}render(){super.render(),[this.inputView,this.dropdownView.buttonView].forEach(e=>{this.focusTracker.add(e.element),this._focusables.add(e)}),this.keystrokes.listenTo(this.element)}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createDropdownView(){const e=this.locale,t=e.t,n=this.bindTemplate,s=this._createColorSelector(e),o=$t(e),a=new oe;return a.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:n.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",n.if("value","ck-hidden",c=>c!="")]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(a),o.buttonView.label=t("Color picker"),o.buttonView.tooltip=!0,o.panelPosition=e.uiLanguageDirection==="rtl"?"se":"sw",o.panelView.children.add(s),o.bind("isEnabled").to(this,"isReadOnly",c=>!c),o.on("change:isOpen",(c,u,h)=>{h&&(s.updateSelectedColors(),s.showColorGridsFragment())}),o}_createInputTextView(){const e=this.locale,t=new IA(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",()=>{const n=t.element.value,s=this.options.colorDefinitions.find(o=>n===o.label);this._stillTyping=!0,this.value=s&&s.color||n}),t.on("blur",()=>{this._stillTyping=!1,this._setInputValue(t.element.value)}),t.delegate("input").to(this),t}_createColorSelector(e){const t=e.t,n=this.options.defaultColorValue||"",s=t(n?"Restore default":"Remove color"),o=new _w(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:s,colorPickerLabel:t("Color picker"),colorPickerViewConfig:this.options.colorPickerConfig===!1?!1:{...this.options.colorPickerConfig,hideInput:!0}});o.appendUI(),o.on("execute",(c,u)=>{if(u.source==="colorPickerSaveButton"){this.dropdownView.isOpen=!1;return}this.value=u.value||n,this.fire("input"),u.source!=="colorPicker"&&(this.dropdownView.isOpen=!1)});let a=this.value;return o.on("colorPicker:cancel",()=>{this.value=a,this.fire("input"),this.dropdownView.isOpen=!1}),o.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{a=this.value}),o.bind("selectedColor").to(this,"value"),o}_setInputValue(e){if(!this._stillTyping){const t=NT(e),n=this.options.colorDefinitions.find(s=>t===NT(s.color));n?this.inputView.value=n.label:this.inputView.value=e||""}}}function NT(i){return i.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}const Bw=i=>i==="";function Mw(i){return{none:i("None"),solid:i("Solid"),dotted:i("Dotted"),dashed:i("Dashed"),double:i("Double"),groove:i("Groove"),ridge:i("Ridge"),inset:i("Inset"),outset:i("Outset")}}function ax(i){return i('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function lx(i){return i('The value is invalid. Try "10px" or "2em" or simply "2".')}function Ch(i){return i=i.trim().toLowerCase(),Bw(i)||$S(i)}function oc(i){return i=i.trim(),Bw(i)||dx(i)||jh(i)||GS(i)}function cx(i){return i=i.trim(),Bw(i)||dx(i)||jh(i)}function ux(i,e){const t=new Dt,n=Mw(i.t);for(const s in n){const o={type:"button",model:new co({_borderStyleValue:s,label:n[s],role:"menuitemradio",withText:!0})};s==="none"?o.model.bind("isOn").to(i,"borderStyle",a=>e==="none"?!a:a===s):o.model.bind("isOn").to(i,"borderStyle",a=>a===s),t.add(o)}return t}function Cb(i){const{view:e,icons:t,toolbar:n,labels:s,propertyName:o,nameToValue:a,defaultValue:c}=i;for(const u in s){const h=new ue(e.locale);h.set({role:"radio",isToggleable:!0,label:s[u],icon:t[u],tooltip:s[u]});const m=a?a(u):u;h.bind("isOn").to(e,o,g=>{let w=g;return g===""&&c&&(w=c),m===w}),h.on("execute",()=>{!c&&m&&e[o]===m?e[o]=void 0:e[o]=m}),n.items.add(h)}}const kh=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function Th(i){return(e,t,n)=>{const s=new hq(e.locale,{colorDefinitions:fq(i.colorConfig),columns:i.columns,defaultColorValue:i.defaultColorValue,colorPickerConfig:i.colorPickerConfig});return s.inputView.set({id:t,ariaDescribedById:n}),s.bind("isReadOnly").to(e,"isEnabled",o=>!o),s.bind("hasError").to(e,"errorText",o=>!!o),s.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused").to(s),s}}function dx(i){const e=parseFloat(i);return!Number.isNaN(e)&&i===String(e)}function fq(i){return i.map(e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}}))}class mq extends oe{options;focusTracker;keystrokes;children;borderStyleDropdown;borderWidthInput;borderColorInput;backgroundInput;paddingInput;widthInput;heightInput;horizontalAlignmentToolbar;verticalAlignmentToolbar;saveButtonView;cancelButtonView;_focusables;_focusCycler;constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:a}=this._createBorderFields(),{backgroundRowLabel:c,backgroundInput:u}=this._createBackgroundFields(),{widthInput:h,operatorLabel:m,heightInput:g,dimensionsLabel:w}=this._createDimensionFields(),{horizontalAlignmentToolbar:_,verticalAlignmentToolbar:v,alignmentLabel:C}=this._createAlignmentFields();this.focusTracker=new dt,this.keystrokes=new Ct,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=u,this.paddingInput=this._createPaddingField(),this.widthInput=h,this.heightInput=g,this.horizontalAlignmentToolbar=_,this.verticalAlignmentToolbar=v;const{saveButtonView:T,cancelButtonView:A}=this._createActionButtons();this.saveButtonView=T,this.cancelButtonView=A,this._focusables=new Gt,this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new fo(e,{label:this.t("Cell properties")})),this.children.add(new qt(e,{labelView:a,children:[a,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new qt(e,{labelView:c,children:[c,u],class:"ck-table-form__background-row"})),this.children.add(new qt(e,{children:[new qt(e,{labelView:w,children:[w,h,m,g],class:"ck-table-form__dimensions-row"}),new qt(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new qt(e,{labelView:C,children:[C,_,v],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new qt(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),or({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{this._focusCycler.chain(e.fieldView.focusCycler)}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Th({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,a=o("Style"),c=new ii(s);c.text=o("Border");const u=Mw(o),h=new Rt(s,BA);h.set({label:a,class:"ck-table-form__border-style"}),h.fieldView.buttonView.set({ariaLabel:a,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:a}),h.fieldView.buttonView.bind("label").to(this,"borderStyle",w=>u[w||"none"]),h.fieldView.on("execute",w=>{this.borderStyle=w.source._borderStyleValue}),h.bind("isEmpty").to(this,"borderStyle",w=>!w),mo(h.fieldView,ux(this,t.style),{role:"menu",ariaLabel:a});const m=new Rt(s,si);m.set({label:o("Width"),class:"ck-table-form__border-width"}),m.fieldView.bind("value").to(this,"borderWidth"),m.bind("isEnabled").to(this,"borderStyle",Od),m.fieldView.on("input",()=>{this.borderWidth=m.fieldView.element.value});const g=new Rt(s,n);return g.set({label:o("Color"),class:"ck-table-form__border-color"}),g.fieldView.bind("value").to(this,"borderColor"),g.bind("isEnabled").to(this,"borderStyle",Od),g.fieldView.on("input",()=>{this.borderColor=g.fieldView.value}),this.on("change:borderStyle",(w,_,v,C)=>{Od(v)||(this.borderColor="",this.borderWidth=""),Od(C)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:c,borderStyleDropdown:h,borderColorInput:g,borderWidthInput:m}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new ii(e);n.text=t("Background");const s=Th({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Rt(e,s);return o.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new ii(e);n.text=t("Dimensions");const s=new Rt(e,si);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new oe(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:""}]});const a=new Rt(e,si);return a.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),a.fieldView.bind("value").to(this,"height"),a.fieldView.on("input",()=>{this.height=a.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:a}}_createPaddingField(){const e=this.locale,t=this.t,n=new Rt(e,si);return n.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),n.fieldView.bind("value").to(this,"padding"),n.fieldView.on("input",()=>{this.padding=n.fieldView.element.value}),n}_createAlignmentFields(){const e=this.locale,t=this.t,n=new ii(e),s={left:dw,center:iA,right:oA,justify:sA,top:eN,middle:Z7,bottom:X7};n.text=t("Table cell text alignment");const o=new Qo(e),a=e.contentLanguageDirection==="rtl";o.set({isCompact:!0,role:"radiogroup",ariaLabel:t("Horizontal text alignment toolbar")}),Cb({view:this,icons:s,toolbar:o,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:u=>{if(a){if(u==="left")return"right";if(u==="right")return"left"}return u},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const c=new Qo(e);return c.set({isCompact:!0,role:"radiogroup",ariaLabel:t("Vertical text alignment toolbar")}),Cb({view:this,icons:s,toolbar:c,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:o,verticalAlignmentToolbar:c,alignmentLabel:n}}_createActionButtons(){const e=this.locale,t=this.t,n=new ue(e),s=new ue(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return n.set({label:t("Save"),icon:Wh,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...a)=>a.every(c=>!c)),s.set({label:t("Cancel"),icon:qh,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,n=t("Align cell text to the left"),s=t("Align cell text to the center"),o=t("Align cell text to the right"),a=t("Justify cell text");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n,justify:a}:{left:n,center:s,right:o,justify:a}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function Od(i){return i!=="none"}const kb=[xt.defaultPositions.northArrowSouth,xt.defaultPositions.northArrowSouthWest,xt.defaultPositions.northArrowSouthEast,xt.defaultPositions.southArrowNorth,xt.defaultPositions.southArrowNorthWest,xt.defaultPositions.southArrowNorthEast,xt.defaultPositions.viewportStickyNorth];function hx(i,e){const t=i.plugins.get("ContextualBalloon"),n=i.editing.view.document.selection;let s;e==="cell"?sf(n)&&(s=mx(i)):vh(n)&&(s=fx(i)),s&&t.updatePosition(s)}function fx(i){const e=i.model.document.selection,t=Ac(e),n=i.editing.mapper.toViewElement(t);return{target:i.editing.view.domConverter.mapViewToDom(n),positions:kb}}function mx(i){const e=i.editing.mapper,t=i.editing.view.domConverter,n=i.model.document.selection;if(n.rangeCount>1)return{target:()=>gq(n.getRanges(),i),positions:kb};const s=gx(n.getFirstPosition()),o=e.toViewElement(s);return{target:t.mapViewToDom(o),positions:kb}}function gx(i){return i.nodeAfter&&i.nodeAfter.is("element","tableCell")?i.nodeAfter:i.findAncestor("tableCell")}function gq(i,e){const t=e.editing.mapper,n=e.editing.view.domConverter,s=Array.from(i).map(o=>{const a=gx(o.start),c=t.toViewElement(a);return new pe(n.mapViewToDom(c))});return pe.getBoundingRect(s)}const pq=500,LT={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class bq extends N{_defaultContentTableCellProperties;_defaultLayoutTableCellProperties;_balloon;view;_viewWithContentTableDefaults;_viewWithLayoutTableDefaults;_undoStepBatch;_isReady;static get requires(){return[As]}static get pluginName(){return"TableCellPropertiesUI"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:kh,backgroundColors:kh})}init(){const e=this.editor,t=e.t;this._defaultContentTableCellProperties=Vw(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._defaultLayoutTableCellProperties=tf(void 0,{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._balloon=e.plugins.get(As),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",n=>{const s=new ue(n);s.set({label:t("Cell properties"),icon:zN,tooltip:!0}),this.listenTo(s,"execute",()=>this._showView());const o=Object.values(LT).map(a=>e.commands.get(a));return s.bind("isEnabled").toMany(o,"isEnabled",(...a)=>a.some(c=>c)),s})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(e){const t=this.editor,n=t.config.get("table.tableCellProperties"),s=Cc(n.borderColors),o=vc(t.locale,s),a=Cc(n.backgroundColors),c=vc(t.locale,a),u=n.colorPicker!==!1,h=new mq(t.locale,{borderColors:o,backgroundColors:c,defaultTableCellProperties:e,colorPickerConfig:u?n.colorPicker||{}:!1}),m=t.t;h.render(),this.listenTo(h,"submit",()=>{this._hideView()}),this.listenTo(h,"cancel",()=>{this._undoStepBatch.operations.length&&t.execute("undo",this._undoStepBatch),this._hideView()}),h.keystrokes.set("Esc",(_,v)=>{this._hideView(),v()}),sr({emitter:h,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const g=ax(m),w=lx(m);return h.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),h.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:h.borderColorInput,commandName:"tableCellBorderColor",errorText:g,validator:Ch})),h.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:h.borderWidthInput,commandName:"tableCellBorderWidth",errorText:w,validator:cx})),h.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:h.paddingInput,commandName:"tableCellPadding",errorText:w,validator:oc})),h.on("change:width",this._getValidatedPropertyChangeCallback({viewField:h.widthInput,commandName:"tableCellWidth",errorText:w,validator:oc})),h.on("change:height",this._getValidatedPropertyChangeCallback({viewField:h.heightInput,commandName:"tableCellHeight",errorText:w,validator:oc})),h.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:h.backgroundInput,commandName:"tableCellBackgroundColor",errorText:g,validator:Ch})),h.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),h.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),h}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(LT).map(([n,s])=>{const o=n,a=this.view===this._viewWithContentTableDefaults?this._defaultContentTableCellProperties[o]||"":this._defaultLayoutTableCellProperties[o]||"";return[n,e.get(s).value||a]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor,t=vh(e.editing.view.document.selection),n=t&&e.editing.mapper.toModelElement(t),s=!n||n.getAttribute("tableType")!=="layout";s&&!this._viewWithContentTableDefaults?this._viewWithContentTableDefaults=this._createPropertiesView(this._defaultContentTableCellProperties):!s&&!this._viewWithLayoutTableDefaults&&(this._viewWithLayoutTableDefaults=this._createPropertiesView(this._defaultLayoutTableCellProperties)),this.view=s?this._viewWithContentTableDefaults:this._viewWithLayoutTableDefaults,this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:mx(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;sf(t.selection)?this._isViewVisible&&hx(e,"cell"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,a=Ni(()=>{n.errorText=o},pq);return(c,u,h)=>{a.cancel(),this._isReady&&(s(h)?(this.editor.execute(t,{value:h,batch:this._undoStepBatch}),n.errorText=null):a())}}}class ji extends me{attributeName;_defaultValue;_defaultContentTableValue;_defaultLayoutTableValue;constructor(e,t,n){switch(super(e),this.attributeName=t,this._defaultContentTableValue=n,t){case"tableCellType":this._defaultLayoutTableValue="data";break;case"tableCellBorderStyle":this._defaultLayoutTableValue="none";break;case"tableCellHorizontalAlignment":this._defaultLayoutTableValue="left";break;case"tableCellVerticalAlignment":this._defaultLayoutTableValue="middle";break;default:this._defaultLayoutTableValue=void 0}}refresh(){const t=this.editor.model.document.selection,s=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(t),o=Ac(t);this._defaultValue=!o||o.getAttribute("tableType")!=="layout"?this._defaultContentTableValue:this._defaultLayoutTableValue,this.isEnabled=!!s.length,this.value=this._getSingleValue(s)}execute(e={}){const{value:t,batch:n}=e,s=this.editor.model,a=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(s.document.selection),c=this._getValueToSet(t);s.enqueueChange(n,u=>{c?a.forEach(h=>u.setAttribute(this.attributeName,c,h)):a.forEach(h=>u.removeAttribute(this.attributeName,h)),this.fire("afterExecute",{writer:u,tableCells:a,valueToSet:c})})}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]);return e.every(s=>this._getAttribute(s)===t)?t:void 0}}class wq extends ji{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=dr(e,"px"),e!==this._defaultValue)return e}}class _q extends N{static get pluginName(){return"TableCellWidthEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[nf]}init(){const e=this.editor,t=Vw(e.config.get("table.tableCellProperties.defaultProperties"));Gd(e.model.schema,e.conversion,{modelAttribute:"tableCellWidth",styleName:"width",attributeName:"width",attributeType:"length",defaultValue:t.width}),e.commands.add("tableCellWidth",new wq(e,t.width))}}class yq extends ji{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=dr(e,"px");if(t!==this._defaultValue)return t}}class vq extends ji{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){const t=dr(e,"px");if(t!==this._defaultValue)return t}}class Cq extends ji{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}class kq extends ji{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}class Tq extends ji{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}class Eq extends ji{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}class Sq extends ji{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}class Aq extends ji{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=dr(e,"px");if(t!==this._defaultValue)return t}}class xq extends ji{constructor(e){super(e,"tableCellType","data"),this.on("afterExecute",(t,n)=>{const{writer:s,tableCells:o}=n,a=this.editor.plugins.get(Ot),c=tj(o);px(a,s,c.keys())})}refresh(){super.refresh();const e=Ac(this.editor.model.document.selection);this.isEnabled&&e&&e.getAttribute("tableType")==="layout"&&(this.isEnabled=!1)}_getAttribute(e){return e?.getAttribute(this.attributeName)||"data"}}function px(i,e,t){let n=!1;for(const s of t){let o=s.getAttribute("headingRows")||0,a=s.getAttribute("headingColumns")||0;const c=a>o;if(c){const h=Vp(i,s,"column",a,o);h!==a&&(i.setHeadingColumnsCount(e,s,h,{shallow:!0}),a=h,n=!0)}const u=Vp(i,s,"row",o,a);if(u!==o&&(i.setHeadingRowsCount(e,s,u,{shallow:!0}),o=u,n=!0),!c){const h=Vp(i,s,"column",a,o);h!==a&&(i.setHeadingColumnsCount(e,s,h,{shallow:!0}),n=!0)}}return n}function Vp(i,e,t,n,s){const o=t==="row"?i.getRows(e):i.getColumns(e);let a=n;for(let c=0;c<o;c++){const u=new Pe(e,{[t]:c});let h=!0,m=!1;for(const{cell:g,row:w,column:_}of u){if(g.getAttribute("tableCellType")!=="header"){h=!1;break}(t==="row"?_:w)>=s&&(m=!0)}if(!h)return Math.min(a,c);m&&(a=Math.max(a,c+1))}return Math.min(a,o)}const DT=/^(top|middle|bottom)$/,FT=/^(left|center|right|justify)$/;class Iq extends N{static get pluginName(){return"TableCellPropertiesEditing"}static get licenseFeatureCode(){return"TCP"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return[nf,_q]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const s=Vw(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"});e.data.addStyleProcessorRules(YS),Pq(e,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableCellBorderStyle",new Eq(e,s.borderStyle)),e.commands.add("tableCellBorderColor",new Sq(e,s.borderColor)),e.commands.add("tableCellBorderWidth",new Aq(e,s.borderWidth)),Gd(t,n,{modelAttribute:"tableCellHeight",styleName:"height",attributeName:"height",attributeType:"length",defaultValue:s.height}),e.commands.add("tableCellHeight",new vq(e,s.height)),e.data.addStyleProcessorRules(P7),Gd(t,n,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:s.padding}),e.commands.add("tableCellPadding",new yq(e,s.padding)),e.data.addStyleProcessorRules(uw),Gd(t,n,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",attributeName:"bgcolor",attributeType:"color",defaultValue:s.backgroundColor}),e.commands.add("tableCellBackgroundColor",new Cq(e,s.backgroundColor)),Rq(t,n,s.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new Tq(e,s.horizontalAlignment)),Oq(t,n,s.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new kq(e,s.verticalAlignment)),e.config.get("experimentalFlags.tableCellTypeSupport")&&(Vq(e),e.commands.add("tableCellType",new xq(e)))}}function Pq(i,e){const{conversion:t}=i,{schema:n}=i.model,s={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};n.extend("tableCell",{allowAttributes:Object.values(s)});for(const o of Object.values(s))n.setAttributeProperties(o,{isFormatting:!0});gb(i,"td",s,e),gb(i,"th",s,e),sc(t,{modelElement:"tableCell",modelAttribute:s.style,styleName:"border-style"}),sc(t,{modelElement:"tableCell",modelAttribute:s.color,styleName:"border-color"}),sc(t,{modelElement:"tableCell",modelAttribute:s.width,styleName:"border-width"})}function Rq(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),i.setAttributeProperties("tableCellHorizontalAlignment",{isFormatting:!0}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:n=>({key:"style",value:{"text-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":FT}},model:{key:"tableCellHorizontalAlignment",value:(n,s,o)=>{const a=wi(t,"left",o),c=n.getStyle("text-align");if(c!==a)return c;s.consumable.consume(n,{styles:"text-align"})}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:FT}},model:{key:"tableCellHorizontalAlignment",value:(n,s,o)=>{const a=wi(t,"left",o),c=n.getAttribute("align");if(c!==a)return c;s.consumable.consume(n,{attributes:"align"})}}})}function Oq(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),i.setAttributeProperties("tableCellVerticalAlignment",{isFormatting:!0}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:n=>({key:"style",value:{"vertical-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":DT}},model:{key:"tableCellVerticalAlignment",value:(n,s,o)=>{const a=wi(t,"middle",o),c=n.getStyle("vertical-align");if(c!==a)return c;s.consumable.consume(n,{styles:"vertical-align"})}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:DT}},model:{key:"tableCellVerticalAlignment",value:(n,s,o)=>{const a=wi(t,"middle",o),c=n.getAttribute("valign");if(c!==a)return c;s.consumable.consume(n,{attributes:"valign"})}}})}function Vq(i){const{model:e,conversion:t,editing:n}=i,{schema:s}=e,o=i.plugins.get(Ot);s.extend("tableCell",{allowAttributes:["tableCellType"]}),s.setAttributeProperties("tableCellType",{isFormatting:!0}),s.addAttributeCheck(a=>{if(Array.from(a).reverse().find(u=>u.name==="table")?.getAttribute("tableType")==="layout")return!1},"tableCellType"),t.for("upcast").add(a=>{a.on("element:th",(c,u,h)=>{const{writer:m}=h,{modelRange:g}=u,w=g?.start.nodeAfter;w?.is("element","tableCell")&&m.setAttribute("tableCellType","header",w)}),a.on("element:table",(c,u,h)=>{const{writer:m}=h,{modelRange:g}=u,w=g?.start.nodeAfter;if(w?.is("element","table")&&w.getAttribute("tableType")==="layout"){for(const{cell:_}of new Pe(w))if(_.getAttribute("tableCellType")==="header"){m.setAttribute("tableType","content",w);break}}},{priority:_s.low-1})}),e.document.registerPostFixer(a=>{const c=e.document.differ.getChanges(),u=new Set;for(const h of c){if(h.type==="attribute"&&(h.attributeKey==="headingRows"||h.attributeKey==="headingColumns")){const m=h.range.start.nodeAfter;m?.is("element","table")&&m.root.rootName!=="$graveyard"&&u.add(m)}if(h.type==="attribute"&&h.attributeKey==="tableCellType"){const m=h.range.start.nodeAfter;if(m?.is("element","tableCell")&&m.root.rootName!=="$graveyard"){const g=m.findAncestor("table");g&&u.add(g)}}if(h.type==="insert"&&h.position.nodeAfter){for(const{item:m}of e.createRangeOn(h.position.nodeAfter))if(m.is("element","tableCell")&&m.getAttribute("tableCellType")&&m.root.rootName!=="$graveyard"){const g=m.findAncestor("table");g&&u.add(g)}}}return px(o,a,u)}),e.document.on("change:data",()=>{const{differ:a}=e.document,c=new Set;for(const u of a.getChanges())if(u.type==="attribute"&&u.attributeKey==="tableCellType"){const h=u.range.start.nodeAfter;h.is("element","tableCell")&&c.add(h)}for(const u of c){const h=n.mapper.toViewElement(u),g=u.getAttribute("tableCellType")==="header"?"th":"td";h?.name!==g&&n.reconvertItem(u)}})}class Bq extends N{static get pluginName(){return"TableCellProperties"}static get isOfficialPlugin(){return!0}static get requires(){return[Iq,bq]}}class hr extends me{attributeName;_defaultValue;_defaultContentTableValue;_defaultLayoutTableValue;constructor(e,t,n){super(e),this.attributeName=t,this._defaultContentTableValue=n,this._defaultLayoutTableValue=t==="tableBorderStyle"?"none":void 0}refresh(){const t=this.editor.model.document.selection,n=Ac(t);this._defaultValue=!n||n.getAttribute("tableType")!=="layout"?this._defaultContentTableValue:this._defaultLayoutTableValue,this.isEnabled=!!n,this.value=this._getValue(n)}execute(e={}){const t=this.editor.model,n=t.document.selection,{value:s,batch:o}=e,a=Ac(n),c=this._getValueToSet(s);t.enqueueChange(o,u=>{c?u.setAttribute(this.attributeName,c,a):u.removeAttribute(this.attributeName,a)})}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}}class Mq extends hr{constructor(e,t){super(e,"tableBackgroundColor",t)}}class Nq extends hr{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}class Lq extends hr{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}class Dq extends hr{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=ur(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=dr(e,"px");if(t!==this._defaultValue)return t}}class Fq extends hr{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=dr(e,"px"),e!==this._defaultValue)return e}}class zq extends hr{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){if(e=dr(e,"px"),e!==this._defaultValue)return e}}class Uq extends hr{constructor(e,t){super(e,"tableAlignment",t)}}class Hq extends N{static get pluginName(){return"TablePropertiesEditing"}static get licenseFeatureCode(){return"TCP"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}static get requires(){return[nf]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const s=Ow(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),o=e.config.get("table.tableProperties.alignment.useInlineStyles")!==!1;if(e.data.addStyleProcessorRules(QS),e.data.addStyleProcessorRules(YS),qq(e,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableBorderColor",new Nq(e,s.borderColor)),e.commands.add("tableBorderStyle",new Lq(e,s.borderStyle)),e.commands.add("tableBorderWidth",new Dq(e,s.borderWidth)),e.config.get("experimentalFlags.useExtendedTableBlockAlignment")?Wq(t,n,s.alignment,o):$q(t,n,s.alignment),e.commands.add("tableAlignment",new Uq(e,s.alignment)),UT(t,n,{modelAttribute:"tableWidth",styleName:"width",attributeName:"width",attributeType:"length",defaultValue:s.width}),e.commands.add("tableWidth",new Fq(e,s.width)),UT(t,n,{modelAttribute:"tableHeight",styleName:"height",attributeName:"height",attributeType:"length",defaultValue:s.height}),e.commands.add("tableHeight",new zq(e,s.height)),e.data.addStyleProcessorRules(uw),Yq(t,n,{modelAttribute:"tableBackgroundColor",styleName:"background-color",attributeName:"bgcolor",attributeType:"color",defaultValue:s.backgroundColor}),e.commands.add("tableBackgroundColor",new Mq(e,s.backgroundColor)),e.config.get("experimentalFlags.useExtendedTableBlockAlignment")){const a=e.editing.view.document;this.listenTo(a,"clipboardOutput",(c,u)=>{e.editing.view.change(h=>{for(const{item:m}of h.createRangeIn(u.content))jq(m,h);u.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(u.content))})},{priority:"lowest"})}}}function jq(i,e){if(!i.is("element","table"))return;const t=i.getAttribute("align"),n=i.getStyle("float"),s=i.getStyle("margin-left"),o=i.getStyle("margin-right");if(t&&t==="center"||n&&n==="right"&&t&&t==="right"){zT(e,t,i);return}n===void 0&&s==="auto"&&o==="0"&&zT(e,"right",i)}function zT(i,e,t){const n=i.createPositionBefore(t),s=i.createContainerElement("div",{align:e},t);i.insert(n,s)}function qq(i,e){const{conversion:t}=i,{schema:n}=i.model,s={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};n.extend("table",{allowAttributes:Object.values(s)});for(const o of Object.values(s))n.setAttributeProperties(o,{isFormatting:!0});gb(i,"table",s,e),Wd(t,{modelAttribute:s.color,styleName:"border-color"}),Wd(t,{modelAttribute:s.style,styleName:"border-style"}),Wd(t,{modelAttribute:s.width,styleName:"border-width"})}function Wq(i,e,t,n){i.extend("table",{allowAttributes:["tableAlignment"]}),i.setAttributeProperties("tableAlignment",{isFormatting:!0}),e.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment",values:["left","center","right","blockLeft","blockRight"]},view:{left:n?{key:"style",value:{float:"left","margin-right":"var(--ck-content-table-style-spacing, 1.5em)"}}:{key:"class",value:Xt.left.className},right:n?{key:"style",value:{float:"right","margin-left":"var(--ck-content-table-style-spacing, 1.5em)"}}:{key:"class",value:Xt.right.className},center:n?{key:"style",value:{"margin-left":"auto","margin-right":"auto"}}:{key:"class",value:Xt.center.className},blockLeft:n?{key:"style",value:{"margin-left":"0","margin-right":"auto"}}:{key:"class",value:Xt.blockLeft.className},blockRight:n?{key:"style",value:{"margin-left":"auto","margin-right":"0"}}:{key:"class",value:Xt.blockRight.className}},converterPriority:"high"}),ZH.forEach(s=>{e.for("upcast").attributeToAttribute({view:s.view,model:{key:"tableAlignment",value:(o,a,c)=>{if(Jq(o))return;const u=wi(t,"",c),h=s.getAlign(o),m=s.getConsumables(o);if(a.consumable.consume(o,m),h!==u)return h}}})}),e.for("upcast").add(Gq(t))}function $q(i,e,t){const n=/^(left|center|right)$/,s=/^(left|none|right)$/;i.extend("table",{allowAttributes:["tableAlignment"]}),i.setAttributeProperties("tableAlignment",{isFormatting:!0}),e.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment",values:["left","center","right"]},view:{left:{key:"style",value:{float:"left"}},right:{key:"style",value:{float:"right"}},center:(o,a,c)=>({key:"style",value:c.item.getAttribute("tableType")!=="layout"?{float:"none"}:{"margin-left":"auto","margin-right":"auto"}})},converterPriority:"high"}),e.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:s}},model:{key:"tableAlignment",value:(o,a,c)=>{if(o.name=="figure"&&!o.hasClass("table"))return;const u=wi(t,"",c);let h=o.getStyle("float");if(h==="none"&&(h="center"),h!==u)return h;a.consumable.consume(o,{styles:"float"})}}}).attributeToAttribute({view:{name:/^(table|figure)$/,styles:{"margin-left":"auto","margin-right":"auto"}},model:{key:"tableAlignment",value:(o,a,c)=>{if(o.name=="figure"&&!o.hasClass("table"))return;const u=wi(t,"",c),h="center";if(h!==u)return h;a.consumable.consume(o,{styles:["margin-left","margin-right"]})}}}).attributeToAttribute({view:{name:"table",attributes:{align:n}},model:{key:"tableAlignment",value:(o,a,c)=>{const u=wi(t,"",c),h=o.getAttribute("align");if(h!==u)return h;a.consumable.consume(o,{attributes:"align"})}}})}function Gq(i){return e=>{e.on("element:div",(t,n,s)=>{if(!s.consumable.test(n.viewItem,{name:!0,attributes:"align"}))return;const o=tx(n.viewItem);if(!o||!s.consumable.test(o,{name:!0}))return;s.consumable.consume(n.viewItem,{name:!0,attributes:"align"});const a=s.convertItem(o,n.modelCursor),c=Ze(a.modelRange.getItems());if(!c||!c.is("element","table")){s.consumable.revert(n.viewItem,{name:!0,attributes:"align"}),a.modelRange&&!a.modelRange.isCollapsed&&(n.modelRange=a.modelRange,n.modelCursor=a.modelCursor);return}const u=n.viewItem.getAttribute("align"),h=o.getAttribute("align"),m=wi(i,"",n),g=Kq(u,h,m);g&&s.writer.setAttribute("tableAlignment",g,c),s.convertChildren(n.viewItem,s.writer.createPositionAt(c,"end")),s.updateConversionResult(c,n)})}}function Kq(i,e,t){if(i)switch(i){case"right":return e==="right"?"right":e==="left"?"left":"blockRight";case"center":return"center";case"left":return e===void 0?"blockLeft":"left";default:return t}}function Yq(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),i.setAttributeProperties(n,{isFormatting:!0}),Pw(e,{viewElement:"table",...t}),Wd(e,t)}function UT(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),i.setAttributeProperties(n,{isFormatting:!0}),Pw(e,{viewElement:/^(table|figure)$/,shouldUpcast:s=>!(s.name=="table"&&s.parent.name=="figure"||s.name=="figure"&&!s.hasClass("table")),...t}),sc(e,{modelElement:"table",...t})}function Jq(i){return i.name=="figure"&&!i.hasClass("table")}class Qq extends oe{options;focusTracker;keystrokes;children;borderStyleDropdown;borderWidthInput;borderColorInput;backgroundInput;widthInput;heightInput;alignmentToolbar;saveButtonView;cancelButtonView;_focusables;_focusCycler;constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:a}=this._createBorderFields(),{backgroundRowLabel:c,backgroundInput:u}=this._createBackgroundFields(),{widthInput:h,operatorLabel:m,heightInput:g,dimensionsLabel:w}=this._createDimensionFields(),{alignmentToolbar:_,alignmentLabel:v}=this._createAlignmentFields();this.focusTracker=new dt,this.keystrokes=new Ct,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=u,this.widthInput=h,this.heightInput=g,this.alignmentToolbar=_;const{saveButtonView:C,cancelButtonView:T}=this._createActionButtons();this.saveButtonView=C,this.cancelButtonView=T,this._focusables=new Gt,this._focusCycler=new an({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new fo(e,{label:this.t("Table properties")})),this.children.add(new qt(e,{labelView:a,children:[a,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new qt(e,{labelView:c,children:[c,u],class:"ck-table-form__background-row"})),this.children.add(new qt(e,{children:[new qt(e,{labelView:w,children:[w,h,m,g],class:"ck-table-form__dimensions-row"}),new qt(e,{labelView:v,children:[v,_],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new qt(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),or({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{this._focusCycler.chain(e.fieldView.focusCycler)}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Th({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,a=o("Style"),c=new ii(s);c.text=o("Border");const u=Mw(o),h=new Rt(s,BA);h.set({label:a,class:"ck-table-form__border-style"}),h.fieldView.buttonView.set({ariaLabel:a,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:a}),h.fieldView.buttonView.bind("label").to(this,"borderStyle",w=>u[w||"none"]),h.fieldView.on("execute",w=>{this.borderStyle=w.source._borderStyleValue}),h.bind("isEmpty").to(this,"borderStyle",w=>!w),mo(h.fieldView,ux(this,t.style),{role:"menu",ariaLabel:a});const m=new Rt(s,si);m.set({label:o("Width"),class:"ck-table-form__border-width"}),m.fieldView.bind("value").to(this,"borderWidth"),m.bind("isEnabled").to(this,"borderStyle",Vd),m.fieldView.on("input",()=>{this.borderWidth=m.fieldView.element.value});const g=new Rt(s,n);return g.set({label:o("Color"),class:"ck-table-form__border-color"}),g.fieldView.bind("value").to(this,"borderColor"),g.bind("isEnabled").to(this,"borderStyle",Vd),g.fieldView.on("input",()=>{this.borderColor=g.fieldView.value}),this.on("change:borderStyle",(w,_,v,C)=>{Vd(v)||(this.borderColor="",this.borderWidth=""),Vd(C)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:c,borderStyleDropdown:h,borderColorInput:g,borderWidthInput:m}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new ii(e);n.text=t("Background");const s=Th({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Rt(e,s);return o.set({label:t("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new ii(e);n.text=t("Dimensions");const s=new Rt(e,si);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new oe(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:""}]});const a=new Rt(e,si);return a.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),a.fieldView.bind("value").to(this,"height"),a.fieldView.on("input",()=>{this.height=a.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:a}}_createAlignmentFields(){const e=this.locale,t=this.t,n=new ii(e);n.text=t("Alignment");const s=new Qo(e);return s.set({role:"radiogroup",isCompact:!0,ariaLabel:t("Table alignment toolbar")}),Cb({view:this,icons:{left:hw,center:rh,right:ah},toolbar:s,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:n,alignmentToolbar:s}}_createActionButtons(){const e=this.locale,t=this.t,n=new ue(e),s=new ue(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return n.set({label:t("Save"),icon:Wh,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...a)=>a.every(c=>!c)),s.set({label:t("Cancel"),icon:qh,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _alignmentLabels(){const e=this.locale,t=this.t,n=t("Align table to the left"),s=t("Center table"),o=t("Align table to the right");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n}:{left:n,center:s,right:o}}}function Vd(i){return i!=="none"}const Xq=500,HT={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class Zq extends N{_defaultContentTableProperties;_defaultLayoutTableProperties;_balloon;view=null;_viewWithContentTableDefaults=null;_viewWithLayoutTableDefaults=null;_undoStepBatch;_isReady;static get requires(){return[As]}static get pluginName(){return"TablePropertiesUI"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("table.tableProperties",{borderColors:kh,backgroundColors:kh})}init(){const e=this.editor;this._defaultContentTableProperties=Ow(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._defaultLayoutTableProperties=tf(),this._balloon=e.plugins.get(As),e.ui.componentFactory.add("tableProperties",()=>this._createTablePropertiesButton())}_createTablePropertiesButton(){const e=this.editor,t=e.t,n=new ue(e.locale);n.set({label:t("Table properties"),icon:jN,tooltip:!0}),this.listenTo(n,"execute",()=>this._showView());const s=Object.values(HT).map(o=>e.commands.get(o));return n.bind("isEnabled").toMany(s,"isEnabled",(...o)=>o.some(a=>a)),n}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(e){const t=this.editor,n=t.config.get("table.tableProperties"),s=Cc(n.borderColors),o=vc(t.locale,s),a=Cc(n.backgroundColors),c=vc(t.locale,a),u=n.colorPicker!==!1,h=new Qq(t.locale,{borderColors:o,backgroundColors:c,defaultTableProperties:e,colorPickerConfig:u?n.colorPicker||{}:!1}),m=t.t;h.render(),this.listenTo(h,"submit",()=>{this._hideView()}),this.listenTo(h,"cancel",()=>{this._undoStepBatch.operations.length&&t.execute("undo",this._undoStepBatch),this._hideView()}),h.keystrokes.set("Esc",(_,v)=>{this._hideView(),v()}),sr({emitter:h,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const g=ax(m),w=lx(m);return h.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),h.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:h.borderColorInput,commandName:"tableBorderColor",errorText:g,validator:Ch})),h.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:h.borderWidthInput,commandName:"tableBorderWidth",errorText:w,validator:cx})),h.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:h.backgroundInput,commandName:"tableBackgroundColor",errorText:g,validator:Ch})),h.on("change:width",this._getValidatedPropertyChangeCallback({viewField:h.widthInput,commandName:"tableWidth",errorText:w,validator:oc})),h.on("change:height",this._getValidatedPropertyChangeCallback({viewField:h.heightInput,commandName:"tableHeight",errorText:w,validator:oc})),h.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),h}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(HT).map(([n,s])=>{const o=n,a=this.view===this._viewWithContentTableDefaults?this._defaultContentTableProperties[o]||"":this._defaultLayoutTableProperties[o]||"";return[o,e.get(s).value||a]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor,t=vh(e.editing.view.document.selection),n=t&&e.editing.mapper.toModelElement(t),s=!n||n.getAttribute("tableType")!=="layout";s&&!this._viewWithContentTableDefaults?this._viewWithContentTableDefaults=this._createPropertiesView(this._defaultContentTableProperties):!s&&!this._viewWithLayoutTableDefaults&&(this._viewWithLayoutTableDefaults=this._createPropertiesView(this._defaultLayoutTableProperties)),this.view=s?this._viewWithContentTableDefaults:this._viewWithLayoutTableDefaults,this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:fx(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;vh(t.selection)?this._isViewVisible&&hx(e,"table"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,a=Ni(()=>{n.errorText=o},Xq);return(c,u,h)=>{a.cancel(),this._isReady&&(s(h)?(this.editor.execute(t,{value:h,batch:this._undoStepBatch}),n.errorText=null):a())}}}class eW extends N{static get pluginName(){return"TableProperties"}static get isOfficialPlugin(){return!0}static get requires(){return[Hq,Zq]}}function tW(i){i.plugins.get("FileRepository").createUploadAdapter=e=>({upload:async()=>{const t=await e.file;if(!t)throw new Error("No file provided");const n=new FormData;n.append("file",t);const s=await fetch(`${ws}/api/upload`,{method:"POST",body:n});if(!s.ok)throw new Error("Upload failed");return{default:(await s.json()).url}},abort:()=>{}})}function nW(i){const e=vt.c(9),{onChangeContent:t,fetchedContent:n}=i,[s,o]=P.useState("");let a,c;e[0]!==n?(a=()=>{n!==void 0&&o(n)},c=[n],e[0]=n,e[1]=a,e[2]=c):(a=e[1],c=e[2]),P.useEffect(a,c);let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u={licenseKey:"GPL",plugins:[VF,PD,Zh,g9,VD,zD,XD,jD,$D,YD,JH,l9,v9,mD,CH,BH,a8,LD,bF,x9,tU,iU,FU,$H,uq,dq,Bq,eW,iz,Qz,Ez,az,Jz,Nz,qo],extraPlugins:[tW],toolbar:{items:["heading","|","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","bold","italic","underline","strikethrough","subscript","superscript","code","removeFormat","|","alignment","|","bulletedList","numberedList","todoList","outdent","indent","|","link","imageUpload","mediaEmbed","insertTable","blockQuote","codeBlock","horizontalLine","|","undo","redo"],shouldNotGroupWhenFull:!0},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties"]},image:{toolbar:["imageStyle:inline","imageStyle:block","imageStyle:side","|","toggleImageCaption","imageTextAlternative"]},heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]}},e[3]=u):u=e[3];let h;e[4]!==t?(h=(g,w)=>{const _=w.getData();t(_),o(_)},e[4]=t,e[5]=h):h=e[5];let m;return e[6]!==s||e[7]!==h?(m=O.jsx("div",{className:"text-editor-container",children:O.jsx("div",{className:"ck-content",children:O.jsx(yE,{editor:yF,config:u,data:s,onChange:h})})}),e[6]=s,e[7]=h,e[8]=m):m=e[8],m}function iW(i,e){const[t,n]=P.useState(!1),[s,o]=P.useState(null),{token:a}=Ui();return{adding:t,error:s,addPost:async u=>{n(!0),o(null);try{const h={"Content-Type":"application/json"};a&&(h.Authorization=`Bearer ${a}`);const m=await fetch(i,{method:"POST",headers:h,body:JSON.stringify(u)});if(!m.ok)throw new Error(`Error: ${m.status} ${m.statusText}`);await m.json(),await e()}catch(h){h instanceof Error?o(h.message):console.error("An unknown error occurred while adding post")}finally{n(!1)}}}}function sW(i,e){const[t,n]=P.useState(null),[s,o]=P.useState(!1),[a,c]=P.useState(null),{token:u}=Ui();return{updatedPost:t,loading:s,error:a,updatePost:async m=>{o(!0),c(null);try{const g={"Content-Type":"application/json"};u&&(g.Authorization=`Bearer ${u}`);const w=await fetch(`${i}/${e}`,{method:"PUT",headers:g,body:JSON.stringify(m)});if(!w.ok)throw new Error("Error: "+w.status+" "+w.statusText);const _=await w.json();n(_)}catch(g){g instanceof Error?c(g.message):c("An unknown error occurred while updating post")}}}}function jT(){const i=vt.c(48),e=Zo(),{loggedIn:t}=Ui(),{id:n}=nE(),s=n||"",o=!!n,a=rW,[c,u]=P.useState(""),[h,m]=P.useState(""),[g]=P.useState("Abdulaziz Hamzah"),[w,_]=P.useState(""),[v,C]=P.useState(""),{adding:T,error:A,addPost:L}=iW(`${ws}/api/posts`,a),{updatePost:z}=sW(`${ws}/api/posts`,s),{post:j,fetchPost:Z}=fE(`${ws}/api/posts`,s),[ne,M]=P.useState("");let J;i[0]===Symbol.for("react.memo_cache_sentinel")?(J=[],i[0]=J):J=i[0];const[Y,ie]=P.useState(J);let Ee;i[1]===Symbol.for("react.memo_cache_sentinel")?(Ee=Kt=>{u(Kt.target.value),Kt.target.value.trim()&&_("")},i[1]=Ee):Ee=i[1];const Ve=Ee;let ot,rt;i[2]!==Z||i[3]!==s?(ot=()=>{s&&Z()},rt=[s,Z],i[2]=Z,i[3]=s,i[4]=ot,i[5]=rt):(ot=i[4],rt=i[5]),P.useEffect(ot,rt);let Ne,H;i[6]!==j?(Ne=()=>{j&&(u(j.title),m(j.content),ie(j.tags))},H=[j],i[6]=j,i[7]=Ne,i[8]=H):(Ne=i[7],H=i[8]),P.useEffect(Ne,H);let X;i[9]===Symbol.for("react.memo_cache_sentinel")?(X=Kt=>{M(Kt.target.value);const Uc=Kt.target.value.split(",").map(oW);ie(Uc)},i[9]=X):X=i[9];const de=X;let Te;i[10]!==h||i[11]!==c?(Te=()=>{let Kt=!0;return c.trim()||(_("Title is required"),Kt=!1),h.trim()||(C("Content is required"),Kt=!1),Kt},i[10]=h,i[11]=c,i[12]=Te):Te=i[12];const we=Te;let I;i[13]!==L||i[14]!==T||i[15]!==g||i[16]!==h||i[17]!==o||i[18]!==e||i[19]!==Y||i[20]!==c||i[21]!==z||i[22]!==A||i[23]!==we?(I=async()=>{we()&&(o?await z({title:c,content:h,tags:Y,author:g}):await L({title:c,content:h,tags:Y,author:g}),A&&e("/error",{state:{error:A}}),!T&&!A&&e("/posts"))},i[13]=L,i[14]=T,i[15]=g,i[16]=h,i[17]=o,i[18]=e,i[19]=Y,i[20]=c,i[21]=z,i[22]=A,i[23]=we,i[24]=I):I=i[24];const $=I;let te;i[25]===Symbol.for("react.memo_cache_sentinel")?(te=Kt=>{m(Kt),Kt.trim()&&C("")},i[25]=te):te=i[25];const ae=te;let be,ye;i[26]!==t||i[27]!==e?(be=()=>{t||e("/login")},ye=[t,e],i[26]=t,i[27]=e,i[28]=be,i[29]=ye):(be=i[28],ye=i[29]),P.useEffect(be,ye);let Re;i[30]===Symbol.for("react.memo_cache_sentinel")?(Re=O.jsx(Nn,{}),i[30]=Re):Re=i[30];let kt;i[31]===Symbol.for("react.memo_cache_sentinel")?(kt=O.jsx(xh,{className:"text-center mb-8",children:"Create New Post"}),i[31]=kt):kt=i[31];let We;i[32]!==t?(We=!t&&O.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-6 text-center",children:[O.jsx("h3",{className:"text-red-600 font-semibold text-lg",children:"Unauthorized"}),O.jsx("p",{className:"text-red-500 mt-2",children:"Please log in to create a post"})]}),i[32]=t,i[33]=We):We=i[33];let jn;i[34]!==v||i[35]!==o||i[36]!==$||i[37]!==n||i[38]!==t||i[39]!==e||i[40]!==j?.content||i[41]!==ne||i[42]!==c||i[43]!==w?(jn=t&&O.jsx("div",{className:"bg-white p-6 border-3 border-marker-black rounded-lg shadow-[3px_3px_0_0_#111827]",children:O.jsxs("form",{className:"space-y-6",children:[O.jsx(Yd,{type:"text",placeholder:"Title",label:"Title*",name:"title",onChange:Ve,value:c,error:w}),O.jsxs("div",{children:[O.jsx("label",{className:"font-semibold text-xl font-mono block mt-4 mb-1 mx-1",children:"Content*"}),O.jsx(nW,{onChangeContent:ae,fetchedContent:n?j?.content:void 0}),v&&O.jsx("p",{className:"text-red-500 text-sm mt-1",children:v})]}),O.jsx("div",{children:O.jsx(Yd,{type:"text",placeholder:'Tags separated by a comma ", "',label:"Tags (Separated by a comma)",name:"tags",onChange:de,value:ne})}),O.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[O.jsx(ps,{type:"button",color:"marker-btn-default",onClick:()=>e("/posts"),children:"Cancel"}),O.jsx(ps,{type:"button",color:"marker-btn-blue",onClick:$,children:o?"Update Post":"Publish Post"})]})]})}),i[34]=v,i[35]=o,i[36]=$,i[37]=n,i[38]=t,i[39]=e,i[40]=j?.content,i[41]=ne,i[42]=c,i[43]=w,i[44]=jn):jn=i[44];let qi;return i[45]!==We||i[46]!==jn?(qi=O.jsxs(Mn,{children:[Re,O.jsxs("div",{className:"max-w-4xl mx-auto w-full",children:[kt,We,jn]})]}),i[45]=We,i[46]=jn,i[47]=qi):qi=i[47],qi}function oW(i){return i.trim()}async function rW(){}const aW=i=>{const e=vt.c(15),{authorName:t,authorUsername:n,authorEmail:s,authorBio:o}=i,{loggedIn:a,logout:c}=Ui(),u=Zo(),[h,m]=P.useState(a);let g;e[0]!==c||e[1]!==u?(g=()=>{c(),m(!1),u("/")},e[0]=c,e[1]=u,e[2]=g):g=e[2];const w=g;let _;e[3]!==o||e[4]!==s||e[5]!==t||e[6]!==n||e[7]!==w||e[8]!==h?(_=h&&O.jsxs("div",{children:[O.jsxs("div",{className:"profile-box rounded-lg font-mono shadow-[3px_3px_0_0_#111827]",children:[O.jsxs("h2",{children:[" Author Name: ",O.jsx("span",{className:"font-semibold text-red-500",children:t})]}),O.jsxs("h3",{children:[" Author Username: ",O.jsx("span",{className:"font-semibold text-red-500",children:n})]}),O.jsxs("h3",{children:[" Author Email: ",O.jsx("span",{className:"font-semibold text-red-500",children:s})]}),O.jsx("hr",{}),O.jsx("h2",{className:"text-[20px] font-semibold",children:"Bio Snippet:"}),O.jsx("p",{className:"text-md mx-5",children:o})]}),O.jsx(ps,{onClick:w,color:"marker-btn-red",className:"mt-5 cursor-pointer",children:"Logout"})]}),e[3]=o,e[4]=s,e[5]=t,e[6]=n,e[7]=w,e[8]=h,e[9]=_):_=e[9];let v;e[10]!==h?(v=!h&&O.jsx("h2",{className:"text-[20px] font-semibold text-red-500",children:"Unauthorized"}),e[10]=h,e[11]=v):v=e[11];let C;return e[12]!==_||e[13]!==v?(C=O.jsxs(O.Fragment,{children:[_,v]}),e[12]=_,e[13]=v,e[14]=C):C=e[14],C},lW=i=>{const{token:e}=Ui(),[t,n]=P.useState(null),[s,o]=P.useState(!1),[a,c]=P.useState(null);return P.useEffect(()=>{if(!e)return;(async()=>{o(!0),c(null);try{const h=await fetch(i,{headers:{Authorization:`Bearer ${e}`}});if(h.status===401){c("Unauthorized"),n(null);return}if(!h.ok)throw new Error("Failed to fetch user");const m=await h.json();n(m)}catch{c("Network error"),n(null)}finally{o(!1)}})()},[i,e]),{user:t,userLoading:s,userError:a}};function cW(){const i=vt.c(20),e=Zo(),{loggedIn:t}=Ui(),{user:n,userLoading:s,userError:o}=lW("http://localhost:5000/auth/user");let a,c;i[0]!==t||i[1]!==e?(a=()=>{t||e("/login")},c=[t,e],i[0]=t,i[1]=e,i[2]=a,i[3]=c):(a=i[2],c=i[3]),P.useEffect(a,c);let u,h;i[4]===Symbol.for("react.memo_cache_sentinel")?(u=O.jsx(Nn,{}),h=O.jsx(ni,{children:"Profile"}),i[4]=u,i[5]=h):(u=i[4],h=i[5]);let m;i[6]!==o?(m=o&&O.jsx("h3",{className:"text-red-500",children:o}),i[6]=o,i[7]=m):m=i[7];let g;i[8]!==s?(g=s&&O.jsx("h3",{children:"Loading Profile..."}),i[8]=s,i[9]=g):g=i[9];let w;i[10]!==n?(w=n&&O.jsx(aW,{authorName:n.name,authorUsername:n.username,authorEmail:n.email,authorBio:n.bio}),i[10]=n,i[11]=w):w=i[11];let _;i[12]!==n||i[13]!==s?(_=!n&&!s&&O.jsx("h3",{className:"text-red-500 font-mono text-[18px]",children:"Unauthorized"}),i[12]=n,i[13]=s,i[14]=_):_=i[14];let v;return i[15]!==m||i[16]!==g||i[17]!==w||i[18]!==_?(v=O.jsxs(Mn,{children:[u,h,m,g,w,_]}),i[15]=m,i[16]=g,i[17]=w,i[18]=_,i[19]=v):v=i[19],v}function uW(){const i=vt.c(32),{loggedIn:e,loggingIn:t,loginError:n,login:s}=Ui(),[o,a]=P.useState(""),[c,u]=P.useState(""),h=Zo();let m;i[0]!==s||i[1]!==h||i[2]!==c||i[3]!==o?(m=async Ee=>{Ee.preventDefault();try{await s(o,c)}catch{h("/error",{state:{error:"Login failed. Please try again."}})}},i[0]=s,i[1]=h,i[2]=c,i[3]=o,i[4]=m):m=i[4];const g=m;let w,_;i[5]!==e||i[6]!==h?(w=()=>{e&&h("/")},_=[e,h],i[5]=e,i[6]=h,i[7]=w,i[8]=_):(w=i[7],_=i[8]),P.useEffect(w,_);let v,C;i[9]===Symbol.for("react.memo_cache_sentinel")?(v=O.jsx(Nn,{}),C=O.jsx(ni,{children:"Login"}),i[9]=v,i[10]=C):(v=i[9],C=i[10]);let T;i[11]!==n?(T=n&&O.jsx("h3",{className:"text-red-500",children:n}),i[11]=n,i[12]=T):T=i[12];let A;i[13]===Symbol.for("react.memo_cache_sentinel")?(A=Ee=>a(Ee.target.value),i[13]=A):A=i[13];const L=n?"error":"";let z;i[14]!==L||i[15]!==o?(z=O.jsx(Yd,{placeholder:"Username or email",label:"Username or email",name:"username",type:"text",value:o,onChange:A,className:L}),i[14]=L,i[15]=o,i[16]=z):z=i[16];let j;i[17]===Symbol.for("react.memo_cache_sentinel")?(j=Ee=>u(Ee.target.value),i[17]=j):j=i[17];const Z=n?"error":"";let ne;i[18]!==c||i[19]!==Z?(ne=O.jsx(Yd,{placeholder:"Password",label:"Password",name:"password",type:"password",value:c,onChange:j,className:Z}),i[18]=c,i[19]=Z,i[20]=ne):ne=i[20];let M;i[21]===Symbol.for("react.memo_cache_sentinel")?(M=O.jsx(ps,{type:"submit",color:"marker-btn-blue",className:"mt-4",children:"Login"}),i[21]=M):M=i[21];let J;i[22]!==g||i[23]!==ne||i[24]!==z?(J=O.jsxs("form",{onSubmit:g,children:[z,ne,M]}),i[22]=g,i[23]=ne,i[24]=z,i[25]=J):J=i[25];let Y;i[26]!==t?(Y=t&&O.jsx("h3",{children:"Loading..."}),i[26]=t,i[27]=Y):Y=i[27];let ie;return i[28]!==J||i[29]!==Y||i[30]!==T?(ie=O.jsxs(Mn,{children:[v,C,T,J,Y]}),i[28]=J,i[29]=Y,i[30]=T,i[31]=ie):ie=i[31],ie}function dW(i){const e=vt.c(4),{error:t}=i,s=zi().state?.error||t||"An unknown error occurred";let o,a;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=O.jsx(Nn,{}),a=O.jsx(xh,{className:"text-center mb-8",children:"Error"}),e[0]=o,e[1]=a):(o=e[0],a=e[1]);let c;return e[2]!==s?(c=O.jsxs(Mn,{children:[o,a,O.jsx(ni,{className:"text-red-600 text-center",children:s})]}),e[2]=s,e[3]=c):c=e[3],c}function hW(){const i=vt.c(9);let e;i[0]===Symbol.for("react.memo_cache_sentinel")?(e=O.jsx(Pi,{path:"/",element:O.jsx(VR,{})}),i[0]=e):e=i[0];let t;i[1]===Symbol.for("react.memo_cache_sentinel")?(t=O.jsx(Pi,{path:"/about",element:O.jsx(MR,{})}),i[1]=t):t=i[1];let n;i[2]===Symbol.for("react.memo_cache_sentinel")?(n=O.jsx(Pi,{path:"/posts",element:O.jsx(NR,{})}),i[2]=n):n=i[2];let s;i[3]===Symbol.for("react.memo_cache_sentinel")?(s=O.jsx(Pi,{path:"/post/:id",element:O.jsx(zR,{})}),i[3]=s):s=i[3];let o;i[4]===Symbol.for("react.memo_cache_sentinel")?(o=O.jsx(Pi,{path:"/create-post",element:O.jsx(jT,{})}),i[4]=o):o=i[4];let a;i[5]===Symbol.for("react.memo_cache_sentinel")?(a=O.jsx(Pi,{path:"/edit-post/:id",element:O.jsx(jT,{})}),i[5]=a):a=i[5];let c;i[6]===Symbol.for("react.memo_cache_sentinel")?(c=O.jsx(Pi,{path:"/profile",element:O.jsx(cW,{})}),i[6]=c):c=i[6];let u;i[7]===Symbol.for("react.memo_cache_sentinel")?(u=O.jsx(Pi,{path:"/login",element:O.jsx(uW,{})}),i[7]=u):u=i[7];let h;return i[8]===Symbol.for("react.memo_cache_sentinel")?(h=O.jsx("div",{children:O.jsx(wR,{children:O.jsxs(KP,{children:[e,t,n,s,o,a,c,u,O.jsx(Pi,{path:"/error",element:O.jsx(dW,{error:"Unknown error occurred"})})]})})}),i[8]=h):h=i[8],h}const fW=({children:i})=>{const[e,t]=P.useState(null),[n,s]=P.useState(!1),[o,a]=P.useState(!1),[c,u]=P.useState(null);P.useEffect(()=>{const w=localStorage.getItem("token");w&&(t(w),s(!0))},[]);const h=P.useCallback(async(w,_)=>{a(!0),u(null);try{const v=await fetch(`${ws}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:w,password:_})});if(v.status===401){const T=await v.json();u(T.message),s(!1),t(null),localStorage.removeItem("token");return}if(!v.ok)throw new Error("Login failed");const C=await v.json();t(C.token),s(!0),localStorage.setItem("token",C.token)}catch(v){v instanceof Error?u(v.message):u("Unknown login error")}finally{a(!1)}},[]),m=P.useCallback(()=>{s(!1),t(null),localStorage.removeItem("token")},[]),g={loggedIn:n,token:e,loggingIn:o,loginError:c,login:h,logout:m};return O.jsx(uE.Provider,{value:g,children:i})};YI.createRoot(document.getElementById("root")).render(O.jsx(P.StrictMode,{children:O.jsx(fW,{children:O.jsx(hW,{})})}));
